<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>iSight Programming Guide: The iSight Video Camera</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="The iSight Video Camera"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001417-CH202" title="The iSight Video Camera"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../HardwareDrivers/index.html#//apple_ref/doc/uid/TP30000440-TP40003576" target="_top">Hardware &amp; Drivers</a> &gt; <a href="../../../../HardwareDrivers/GraphicsImaging-date.html#//apple_ref/doc/uid/TP30000440-TP40003576-TP30000450" target="_top">Graphics &amp; Imaging</a> &gt; <a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_2">iSight Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><!-- Next button --></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_2" title="The iSight Video Camera"></a><h1><a name="//apple_ref/doc/uid/TP40001417-CH202-TP9" title="The iSight Video Camera"></a>The iSight Video Camera</h1><p>This document introduces you to the Apple iSight video camera and describes Apple’s enhancements to the product. If you’re a developer who needs to understand fully how the iSight camera works, you should also be familiar with the 1394 Trade Association’s IIDC 1.30 specification, as well as other standards. These standards are listed in the <span class="content_text"><a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-BAJFIJGE">“Reference and Additional Resources”</a></span> section of this document. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-TP15">Introduction</a>
				
			<br/>
			
        
			
			
				<a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-CJECBHJE">IIDC Video Unit</a>
				
			<br/>
			
        
			
			
				<a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-CJEDEHIC">Audio Unit</a>
				
			<br/>
			
        
			
			
				<a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-TP16">Iris Unit</a>
				
			<br/>
			
        
			
			
				<a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-TP17">Factory Unit</a>
				
			<br/>
			
        
			
			
				<a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_1">Mac OS X Support</a>
				
			<br/>
			
        
			
			
				<a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-BAJFIJGE">Reference and Additional Resources</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001417-CH202-TP15" title="Introduction"></a><h2>Introduction</h2><p>The Apple iSight camera is a FireWire video camera with audio input, based on the 1394 Trade Association’s IIDC 1.30 specification, with several Apple enhancements.</p><p>The iSight camera uses a CCD video sensor to generate a color image as large as 640 x 480 pixels. Digital image processing is performed within the camera before uncompressed video is sent over FireWire. Several frame sizes and frame rates are supported. The sensor is coupled to a motorized focus mechanism, which can be set to an auto-focus mode. An auto-exposure mode is also supported. Focus, exposure, and other video settings can be controlled over FireWire using IIDC mechanisms, as described in this document.</p><p>The iSight camera has two microphones arranged front-to-back on the long axis of the top of the enclosure. Audio from these microphones is digitized in the camera and transmitted uncompressed over FireWire to a host computer. Apple software in Mac OS X combines the two signals using beam forming into a single, monaural audio channel.</p><p>The iSight camera sends video packets on one FireWire isochronous channel and audio packets on another FireWire isochronous channel. These channels are allocated by a host computer, which then informs the iSight which channels to use. In any single FireWire cycle (1/8000 of a second) the iSight will send one video packet, or one audio packet, or no packet at all––but never both an audio and a video packet in the same cycle. Consequently, the most efficient isochronous allocation on FireWire can be obtained by taking the larger of the audio packet size and the video packet size, rather than by making independent allocations for both streams.</p><p>The iSight camera provides a notification mechanism for the iris state. When configured by a host computer, the iSight sends a status packet each time the iris is opened or closed. Closing the iris turns off isochronous audio and video streams. The FireWire interface remains fully active, except that it will not send any isochronous data until the iris is opened and the data flow is re-enabled by a host computer.</p><p>Although the audio and video portions of iSight are assembled into a single physical enclosure, they operate as separate logical devices. Each portion can be operated independently of the other.</p><p>The following sections describe in detail the video, audio, iris, and factory units of the iSight video camera. Each unit is identified in the Configuration ROM with a specified unit specification ID, as well as a unit software version. </p><a name="//apple_ref/doc/uid/TP40001417-CH202-CJECBHJE" title="IIDC Video Unit"></a><h2>IIDC Video Unit</h2><p>The video unit is identified in the Configuration ROM as a Unit Directory with Unit Specification ID 0x00A02D and Unit Software Version 0x000102. This unit is based on the IIDC 1.30 specification, with Apple-specific modifications. Developers can determine that the Apple-specific modifications are supported by finding the following two keys in the Root Directory: The Vendor ID key (value 0x000A27 or 0x080007) and the Model ID key (value 0x000008), when both present, uniquely identify the iSight camera.</p><p>iSight supports IIDC Video Format 0 (VGA), and (in Format 0) Mode 1, 2, and 3, as reported by the IIDC V_MODE_INQ_0 register.</p><p>Apple has added an additional vendor-specific Format (CIF) and Modes 8 through D (hex) for CIF-sized video used by Internet video chat software. The additional Modes have the parameters shown in <span class="content_text">Table 1-1</span>. </p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_3" title="Table 1-1Apple-added modes with parameters specified"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJHCACC" title="Table 1-1Apple-added modes with parameters specified"></a><strong>Table 1-1&nbsp;&nbsp;</strong>Apple-added modes with parameters specified</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p></p></th><th colspan="4" scope="col"><strong><p>Packet payload bytes, by frame rate</p></strong></th><th colspan="2" scope="col"><strong><p>Image size (pixels)</p></strong></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>YUV Format</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Bits per Pixel</p></th></tr><tr><td  scope="row"><p>Mode</p></td><td ><p>3.75 FPS</p></td><td ><p>7.5 FPS</p></td><td ><p>15 FPS</p></td><td ><p>30 FPS</p></td><td ><p>Wide</p></td><td ><p>High</p></td><td ><p></p></td><td ><p></p></td></tr><tr><td  scope="row"><p>8</p></td><td ><p>12</p></td><td ><p>24</p></td><td ><p>48</p></td><td ><p>96</p></td><td ><p>128</p></td><td ><p>96</p></td><td ><p>4:1:1</p></td><td ><p>12</p></td></tr><tr><td  scope="row"><p>9</p></td><td ><p>16</p></td><td ><p>32</p></td><td ><p>64</p></td><td ><p>128</p></td><td ><p>128</p></td><td ><p>96</p></td><td ><p>4:2:2</p></td><td ><p>16</p></td></tr><tr><td  scope="row"><p>A</p></td><td ><p>33</p></td><td ><p>66</p></td><td ><p>132</p></td><td ><p>264</p></td><td ><p>176</p></td><td ><p>144</p></td><td ><p>4:1:1</p></td><td ><p>12</p></td></tr><tr><td  scope="row"><p>B</p></td><td ><p>44</p></td><td ><p>88</p></td><td ><p>176</p></td><td ><p>352</p></td><td ><p>176</p></td><td ><p>144</p></td><td ><p>4:2:2</p></td><td ><p>16</p></td></tr><tr><td  scope="row"><p>C</p></td><td ><p>132</p></td><td ><p>264</p></td><td ><p>528</p></td><td ><p>1056</p></td><td ><p>352</p></td><td ><p>288</p></td><td ><p>4:1:1</p></td><td ><p>12</p></td></tr><tr><td  scope="row"><p>D</p></td><td ><p>176</p></td><td ><p>352</p></td><td ><p>704</p></td><td ><p>1408</p></td><td ><p>352</p></td><td ><p>288</p></td><td ><p>4:2:2</p></td><td ><p>16</p></td></tr></table></div><p>Modes 8 and 9 send 5760 video packets per second, and Modes A through D send 4320 video packets per second. Image data is packed in the same way as in Format 0 Modes 1, 2, and 3. As explained in the<span class="content_text"><a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-TP15">“Introduction,”</a></span> iSight will never send a video packet in the same isochronous cycle as it sends an audio packet.</p><p>Apple has added registers where the CIF formats may be detected, using the same bit conventions as defined by IIDC, as shown in <span class="content_text">Table 1-2</span>.</p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_4" title="Table 1-2Apple-added registers"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJBFAII" title="Table 1-2Apple-added registers"></a><strong>Table 1-2&nbsp;&nbsp;</strong>Apple-added registers</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Offset</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p>0xF00</p></td><td ><p>CIF_V_MODE_INQ_0</p></td><td ><p>CIF modes supported</p></td></tr><tr><td  scope="row"><p>0xF10</p></td><td ><p>CIF_V_RATE_INQ_0_8</p></td><td ><p>Valid frame rates for CIF mode 8</p></td></tr><tr><td  scope="row"><p>0xF14</p></td><td ><p>CIF_V_RATE_INQ_0_9</p></td><td ><p>Valid frame rates for CIF mode 9</p></td></tr><tr><td  scope="row"><p>0xF18</p></td><td ><p>CIF_V_RATE_INQ_0_A</p></td><td ><p>Valid frame rates for CIF mode A</p></td></tr><tr><td  scope="row"><p>0xF1C</p></td><td ><p>CIF_V_RATE_INQ_0_B</p></td><td ><p>Valid frame rates for CIF mode B</p></td></tr><tr><td  scope="row"><p>0xF20</p></td><td ><p>CIF_V_RATE_INQ_0_C</p></td><td ><p>Valid frame rates for CIF mode C</p></td></tr><tr><td  scope="row"><p>0xF24</p></td><td ><p>CIF_V_RATE_INQ_0_D</p></td><td ><p>Valid frame rates for CIF mode D</p></td></tr><tr><td  scope="row"><p>0xF90</p></td><td ><p>CIF_Cur_V_Mode</p></td><td ><p>Set or detect CIF video modes</p></td></tr></table></div><p>The CIF Modes supported, as indicated by CIF_V_MODE_INQ_0, have the following bit assignments within CIF_V_MODE_INQ_0 (<span class="content_text">Table 1-3</span>).</p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_5" title="Table 1-3Bit assignments"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJGGADA" title="Table 1-3Bit assignments"></a><strong>Table 1-3&nbsp;&nbsp;</strong>Bit assignments</caption><tr><td  scope="row"><p>InqBitMode_8</p></td><td ><p>0x00000800</p></td><td ><p>128 x 96 4:1:1</p></td><td ><p>12 bits</p></td></tr><tr><td  scope="row"><p>InqBitMode_9</p></td><td ><p>0x00000400</p></td><td ><p>128 x 96 4:2:2</p></td><td ><p>16 bits</p></td></tr><tr><td  scope="row"><p>InqBitMode_A</p></td><td ><p>0x00000200</p></td><td ><p>176 x 144 4:1:1</p></td><td ><p>12 bits</p></td></tr><tr><td  scope="row"><p>InqBitMode_B</p></td><td ><p>0x00000100</p></td><td ><p>176 x 144 4:2:2</p></td><td ><p>16 bits</p></td></tr><tr><td  scope="row"><p>InqBitMode_C</p></td><td ><p>0x00000080</p></td><td ><p>352 x 288 4:1:1</p></td><td ><p>12 bits</p></td></tr><tr><td  scope="row"><p>InqBitMode_D</p></td><td ><p>0x00000040</p></td><td ><p>352 x 288 4:2:2</p></td><td ><p>16 bits</p></td></tr></table></div><p>If a CIF Mode has been selected, it will be indicated in CIF_Cur_V_Mode as shown in <span class="content_text">Table 1-4</span>:</p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_6" title="Table 1-4CIF Mode selections indicated in CIF_Cur_V_Mode"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJDIBDF" title="Table 1-4CIF Mode selections indicated in CIF_Cur_V_Mode"></a><strong>Table 1-4&nbsp;&nbsp;</strong>CIF Mode selections indicated in CIF_Cur_V_Mode</caption><tr><td  scope="row"><p>Mode_8_128__96_411</p></td><td ><p>0x00000010</p></td><td ><p>128 x 96 4:1:1 12 bits</p></td></tr><tr><td  scope="row"><p>Mode_9_128__96_422</p></td><td ><p>0x00000020</p></td><td ><p>128 x 96 4:2:2 16 bits</p></td></tr><tr><td  scope="row"><p>Mode_A_176_144_411</p></td><td ><p>0x00000030</p></td><td ><p>176 x 144 4:1:1 12 bits</p></td></tr><tr><td  scope="row"><p>Mode_B_176_144_422</p></td><td ><p>0x00000040</p></td><td ><p>176 x 144 4:2:2 16 bits</p></td></tr><tr><td  scope="row"><p>Mode_C_352_288_411</p></td><td ><p>0x00000050</p></td><td ><p>352 x 288 4:1:1 12 bits</p></td></tr><tr><td  scope="row"><p>Mode_D_352_288_422</p></td><td ><p>0x00000060</p></td><td ><p>352 x 288 4:2:2 16 bits</p></td></tr></table></div><p>To select a CIF video mode, store the desired CIF mode in CIF_Cur_V_Mode and do not change Cur_V_Mode. To select a VGA video mode, store the desired VGA mode in Cur_V_Mode, and do not change CIF_Cur_V_Mode. When a CIF mode has been selected, reading Cur_V_Mode will return 0xE0000000.</p><p>Apple has added additional registers for vendor-unique features, as shown in <span class="content_text">Table 1-5</span>.</p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_7" title="Table 1-5Added Apple registers"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJFIHGD" title="Table 1-5Added Apple registers"></a><strong>Table 1-5&nbsp;&nbsp;</strong>Added Apple registers</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Offset</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p>0xD00-0xDFC</p></td><td ><p>Defaults</p></td><td ><p>Read-only copy of IIDC defaults in register offsets 0x800-0x8FC</p></td></tr><tr><td  scope="row"><p>0xE00</p></td><td ><p>Default Edge Enhancement</p></td><td ><p>Read-only copy of 0xFBC default</p></td></tr><tr><td  scope="row"><p>0xFBC</p></td><td ><p>Edge Enhancement Inquiry</p></td><td ><p>Works like IIDC brightness inquiry (0x500)</p></td></tr><tr><td  scope="row"><p>0xFC0</p></td><td ><p>Edge Enhancement</p></td><td ><p>Works like IIDC brightness register (0x800)</p></td></tr></table></div><p>At power up, the iSight sets its exposure settings to known good values. If a driver on the host changes the settings, they may no longer have suitable values. For best results, the driver on the host should not change the settings unless requested by the user. At any time, the driver can revert to known good values by reading the default registers and restoring the settings to the recommended values. </p><a name="//apple_ref/doc/uid/TP40001417-CH202-CJEDEHIC" title="Audio Unit"></a><h2>Audio Unit</h2><p>The audio unit is identified in the Configuration ROM as a Unit Directory with Unit Specification ID 0x000A27 and Unit Software Version 0x000010. Like the video unit, the audio unit is controlled by a register file. The base address of the register file is specified in the Unit Directory of the audio unit. The register file is organized as shown in <span class="content_text">Table 1-6</span>. </p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_8" title="Table 1-6The audio unit register file"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJFDJIA" title="Table 1-6The audio unit register file"></a><strong>Table 1-6&nbsp;&nbsp;</strong>The audio unit register file</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Offset</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p>0x000</p></td><td ><p>AudioEnable</p></td><td ><p>Write 0x80000000 to enable audio transmission (or 0 to disable)</p></td></tr><tr><td  scope="row"><p>0x204</p></td><td ><p>Default Audio Gain</p></td><td ><p>Read-only</p></td></tr><tr><td  scope="row"><p>0x210</p></td><td ><p>Gain: Raw Start</p></td><td ><p>Read-only Scale factor for Gain (at 0x500)</p></td></tr><tr><td  scope="row"><p>0x214</p></td><td ><p>Gain: Raw End</p></td><td ><p>Read-only Scale factor for Gain (at 0x500)</p></td></tr><tr><td  scope="row"><p>0x218</p></td><td ><p>Gain: Decibels Start</p></td><td ><p>Read-only Signed 32-bit value</p></td></tr><tr><td  scope="row"><p>0x21C</p></td><td ><p>Gain: Decibels End</p></td><td ><p>Read-only Signed 32-bit value</p></td></tr><tr><td  scope="row"><p>0x280</p></td><td ><p>Sample Rate Inquiry</p></td><td ><p>Read-only (see 0x400)</p></td></tr><tr><td  scope="row"><p>0x300</p></td><td ><p>Isochronous TX Config</p></td><td ><p>Isoch Channel + (Speed &lt;&lt; 16)</p></td></tr><tr><td  scope="row"><p>0x400</p></td><td ><p>Sample Rate</p></td><td ><p>Write 0x80000000 to select 48K samples/sec</p></td></tr><tr><td  scope="row"><p>0x500</p></td><td ><p>Gain</p></td><td ><p>Read/Write values within range given by Raw Start/Raw End registers</p></td></tr><tr><td  scope="row"><p>0x504</p></td><td ><p>Mute</p></td><td ><p>Write any non-zero value to mute audio without stopping isochronous stream</p></td></tr></table></div><p>Audio is sent in large chunks during gaps in the video, according to the format shown in <span class="content_text">Table 1-7</span>. As explained in the <span class="content_text"><a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-TP15">“Introduction,”</a></span> an audio packet will never be sent in the same isochronous cycle as a video packet. When 640 x 480 YUV 4:1:1 30 fps video is selected, the audio packets will be about twice as large (and half as numerous) as in any other video mode.</p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_9" title="Table 1-7Format of audio chunks"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJCGCCH" title="Table 1-7Format of audio chunks"></a><strong>Table 1-7&nbsp;&nbsp;</strong>Format of audio chunks</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Byte Offset</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Name</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description of Quadlet value</p></th></tr><tr><td  scope="row"><p>0x000</p></td><td ><p>1394 Packet Header</p></td><td ><p>See 1394 Chapter 6; Length and Channel #</p></td></tr><tr><td  scope="row"><p>0x004</p></td><td ><p>1394 Header CRC*</p></td><td ><p>CRC for header quadlet only</p></td></tr><tr><td  scope="row"><p>0x008</p></td><td ><p>Audio Sample Count</p></td><td ><p>Count of audio samples in this packet</p></td></tr><tr><td  scope="row"><p>0x00C</p></td><td ><p>Audio Signature</p></td><td ><p>ASCII “sght” (0x73676874)</p></td></tr><tr><td  scope="row"><p>0x010</p></td><td ><p>Audio Sample Total</p></td><td ><p>Total count of all previous samples</p></td></tr><tr><td  scope="row"><p>0x014</p></td><td ><p>Reserved</p></td><td ><p>Reserved</p></td></tr><tr><td  scope="row"><p>0x018-0xNNN</p></td><td ><p>Audio Data</p></td><td ><p>Two-channel audio data (see <span class="content_text">Table 1-8</span>). Up to 1900 bytes (depending on video format)</p></td></tr><tr><td  scope="row"><p>0xNNN+4</p></td><td ><p>1394 Data CRC*</p></td><td ><p>CRC for payload quadlets</p></td></tr><tr><td colspan="3"  scope="row"><p>* Most Link hardware (such as OHCI) removes these CRCs as the packet is received</p></td></tr></table></div><p>Each audio sample is a four-byte value containing two signed 16-bit samples. Viewed on 1394, the sample is structured as shown in <span class="content_text">Table 1-8</span>. </p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_10" title="Table 1-8Audio sample structures"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJIHFEA" title="Table 1-8Audio sample structures"></a><strong>Table 1-8&nbsp;&nbsp;</strong>Audio sample structures</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Byte 0 (bits 0-7)</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Byte 1 (bits 8-15)</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Byte 2 (bits 16-23)</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Byte 3 (bits 24-31)</p></th></tr><tr><td colspan="2"  scope="row"><p>16-bit audio sample (Front/”Left”)</p></td><td colspan="2" ><p>16-bit audio sample (Rear/”Right”)</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001417-CH202-TP16" title="Iris Unit"></a><h2>Iris Unit</h2><p>The Iris unit is identified in the Configuration ROM as a Unit Directory with Unit Specification ID 0x000A27 and Unit Software Version 0x000012. When properly configured, this unit provides asynchronous notification to a host when the iris (shutter) is opened or closed by the user.</p><p>The Iris unit provides an Iris Status Address register that specifies the 64-bit FireWire address where iris status will be sent by the iSight. This register is programmed by a host computer using an address value allocated by the host within its own FireWire address space, combined with the host’s FireWire bus and node IDs. The bus ID is typically 1023 (0x3ff), and the host memory address value is typically 0x0001.0000.0000 or higher, so the full 64-bit value would (if the host node ID is 2) look something like 0xffc2.0001.0000.0000.</p><p>Iris status is sent back to the host immediately after this register is set (to confirm the setting took effect, and to confirm the present iris state), and is then sent again any time the iris state changes.</p><p>The FireWire address of the Iris Status Address register within the iSight can be determined using the key 0x40080000, which is found in the Iris Unit Directory. This key indicates an offset address of 0x80000 quadlets (0x200000 bytes) past the base of the CSR range (at 0xFFFF.F000.0000), so the 48-bit address of the Iris Status Address register is 0xFFFF.F020.0000.</p><p>The Iris Status Address register is a write-only register and must be written using a single FireWire block write of size 8 bytes. </p><p>The Iris Status Address register is invalidated by a bus reset, and the iSight does not track changes in the host node ID that a bus reset might cause. After any bus reset, the host must reprogram this register if further status is desired.</p><p>An Iris status message is sent as a 1394 quadlet write packet with a payload value indicating the current iris state. The packet is sent to the address that was set in the Iris Status Address register. A payload value of 1 indicates the iris is open, and 0 indicates the iris is closed.</p><p>The following excerpt from Apple’s FireBug tool (<span class="content_text">Table 1-9</span>) shows a host (node FFC2) and an iSight (node FFC1), and the packets that are exchanged when the host programs the Iris Status Address register and then immediately receives a status packet indicating that the iris is open. </p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_11" title="Table 1-9An exchange of packets between host and iSight nodes"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJFIJEI" title="Table 1-9An exchange of packets between host and iSight nodes"></a><strong>Table 1-9&nbsp;&nbsp;</strong>An exchange of packets between host and iSight nodes</caption><tr><td  scope="row"><p><code>116:4249:0583</code></p></td><td ><p><code>Bwrite fr ffc2 to ffc1.ffff.f020.0000, sz 8 [actl 8], tLab 5 [ack 2]</code></p></td></tr><tr><td  scope="row"><p></p></td><td ><p><code> 0000   ffc20003 00000000                     ........</code></p></td></tr><tr><td  scope="row"><p><code>116:4249:2530</code></p></td><td ><p><code>WrResp from ffc1 to ffc2, tLabel 5, rCode 0 [ack 1]</code></p></td></tr><tr><td  scope="row"><p><code>116:4250:1048</code></p></td><td ><p><code>Qwrite from ffc1 to ffc2.0003.0000.0000, value 00000001, tLabel 0 [ack 1]</code></p></td></tr></table></div><p>The Iris Status Address Register provides an additional service. When a host has stored an address in this register, iSight will accept IIDC and audio register writes only from the host node ID stored in the register. Writes from other nodes will be rejected with <code>response_conflict_error</code>. This restriction prevents other nodes from changing the audio and video settings without the host’s knowledge. However, other hosts can still receive the audio and video stream, and may still inspect (read) all registers. If, after a bus reset, no host has stored an address in the Iris Status Address Register, then writes to IIDC and audio registers are accepted from any FireWire node.</p><p>For good behavior when multiple hosts are on one FireWire bus, a host that has previously gained control of the iSight by writing to the Iris Status Address Register should immediately rewrite this register after any bus reset. Any other host should wait at least one second after any bus reset before attempting to write this register. Any driver attempting to write this register for the first time should also wait one second in addition to any delay required due to a bus reset.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_12" title="Note"></a><p><strong>Note:</strong>&nbsp;Mac OS X developers can detect the iris state, and any changes in this state, using the "iris state" string property in the AppleIris object in the IO Registry. This object and property are automatically created and updated when the Apple_iSight.kext driver is loaded. Any update will generate a kIOMessagePropertiesChanged message. This property has one of four values, as shown in <span class="content_text">Table 1-10</span></p></div><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_13" title="Table 1-10Values and meaning of Iris state properties"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJGDFBH" title="Table 1-10Values and meaning of Iris state properties"></a><strong>Table 1-10&nbsp;&nbsp;</strong>Values and meaning of Iris state properties</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Value</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Meaning</p></th></tr><tr><td  scope="row"><p>“pending”</p></td><td ><p>Driver is waiting for iris status from camera</p></td></tr><tr><td  scope="row"><p>“open”</p></td><td ><p>Iris is open</p></td></tr><tr><td  scope="row"><p>“closed”</p></td><td ><p>Iris is closed</p></td></tr><tr><td  scope="row"><p>“login failed”</p></td><td ><p>Driver cannot gain control of camera, probably because another node on the FireWire bus has already taken control.</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001417-CH202-TP17" title="Factory Unit"></a><h2>Factory Unit</h2><p>The Factory unit is identified in the Configuration ROM as a Unit Directory with Unit Specification ID 0x000A27 and Unit Software Version 0x000011. This unit is for Apple use only, and is inactive in typical customer usage scenarios. Developers should not attempt to access this unit.</p><a name="//apple_ref/doc/uid/TP40001417-CH202-DontLinkElementID_1" title="Mac OS X Support"></a><h2>Mac OS X Support</h2><p>In Mac OS X, support for receiving video from iSight is provided by a QuickTime video digitizer. An application that uses QuickTime for video input can work with iSight.</p><p>Support for receiving audio from iSight is provided by a Core Audio HAL Plug-in. Any Core Audio or Sound Manager-based application can use audio from iSight.</p><p>The Apple_iSight kernel extension provides notification of the iris state, as described in <span class="content_text"><a href="isight.html#//apple_ref/doc/uid/TP40001417-CH202-TP15">“Introduction.”</a></span></p><p>The application iChat AV uses all of the above services to provide live audio-video chat on the Internet.</p><a name="//apple_ref/doc/uid/TP40001417-CH202-BAJFIJGE" title="Reference and Additional Resources"></a><h2>Reference and Additional Resources</h2><p>If you’re a developer who needs to work with the iSight video camera, you should read and understand the following documents. Note that these documents are not available from Apple and the necessary information contained therein is not repeated in this document.</p><ul class="ul"><li class="li"><p>IEEE 1394-1995: Standard for a High Performance Serial Bus</p></li><li class="li"><p>IEEE 1394a-2000: Standard for a High Performance Serial Bus––Amendment 1</p></li><li class="li"><p>IEEE 1212-2001: IEEE Standard for a Control and Status Registers (CSR) Architecture</p></li><li class="li"><p>IIDC 1.30 Digital Camera specification</p></li></ul><p>The IEEE standards listed above can be obtained from <span class="content_text"><a href="http://www.ieee.org" target="_blank">http://www.ieee.org</a></span></p><p>The IIDC specification listed above is available from <span class="content_text"><a href="http://www.1394ta.org" target="_blank">http://www.1394ta.org</a></span></p><p>Tools such as FireBug , mentioned in this document, are available in Apple’s FireWire SDK for Mac OS X, which can be downloaded from <span class="content_text"><a href="http://developer.apple.com/sdk" target="_top">http://developer.apple.com/sdk</a></span></p><p>Developers seeking further information about iSight may contact firewire@apple.com</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <!-- Previous button --><span style="margin-left: 8px"><!-- Next button --></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2004-10-05<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Hardware/Conceptual/iSightProgGuide/01introduction/isight.html%3Fid%3DTP40001417-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Hardware/Conceptual/iSightProgGuide/01introduction/isight.html%3Fid%3DTP40001417-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Hardware/Conceptual/iSightProgGuide/01introduction/isight.html%3Fid%3DTP40001417-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>