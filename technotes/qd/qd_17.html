<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note QD17: Drawing Icons</title><meta name="keywords" content="Mac OS 8 Drawing Icons QuickDraw ICN# open selected SrcBic"><meta name="Description" content="Technical Note QD17: This Technical Note discusses drawingicons and their different states for the Macintosh Computer.Technical Note details the ICON and ICN# resources, how iconscan be drawn opened or not opened, online and offline, etc,etc.">                                       <meta name="categories" content="QuickDraw"><meta name="week-posted" content="Sep 30, 1985 - Oct 4, 1985"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002730" title="Drawing Icons"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxGraphicsImaging-date.html">Graphics & Imaging</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/GraphicsImaging/index.html" target="_blank">Reference Library > Graphics & Imaging</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note QD17</div>
<div id="pageheadsub">Drawing Icons</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Introduction</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext"></p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1985]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A> <h2>Introduction</h2><P>Using resources of type ICON allows drawing of icons in <code>srcOr</code> mode. Using resources of type ICN# allows for more variety when drawing icons.</p><P>There are two different kinds of resources that contain icons: ICON and ICN#. An ICON is a 32 by 32 bit image of an icon and can be drawn using the following Toolbox Utilities calls:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    MyIconHndl:= GetIcon(iconID);    PlotIcon(destRect,iconID);</pre>	</TD></TR></TABLE></CENTER><p>While very convenient, this method only allows the drawing of icons in SrcOrmode (as in the MiniFinder). The Finder uses resources of type ICN# to drawicons on the desktop. Because the Finder uses ICN#s, it can draw icons in avariety of ways.</p><p>An ICN# resource is a list of 32 by 32 bit images that are grouped together.Common convention has been to group two 32 by 32 bit images together in eachICN#. The first image is the actual icon, the second image is the mask for theicon. To get a handle to an ICN#, we would use something like this:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>TYPE    iListHndl    = ^iListPtr;    iListPtr     = ^iListStruct;    iListStruct  = record        icon : packed array[0..31] of Longint;        mask : packed array[0..31] of Longint;    End; {iListStruct}VAR    myILHndl      : iListHndl;            {handle to an ICN#}    iBitMap       : BitMap;          {BitMap for the icon}    mBitMap       : BitMap;          {BitMap for the mask}    MyILHndl:= iListHndl(GetResource('ICN#',iconID));    if MyILHndl = NIL then HandleError;        {and exit or whatever is appropriate}</pre>	</TD></TR></TABLE></CENTER><p>Once we have a handle to the icons, we need to set up two <code>bitMaps</code> that we willbe using later in <code>CopyBits</code>:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        SetRect(icnRect,0,0,32,32); { define the icon's 'bounds'}    With iBitMap do Begin         baseAddr:= @MyILHndl^^.icon;         rowbytes:= 4;                            { 4 * 8 =32}         bounds:= icnRect;     End; {with}      With mBitMap do Begin         baseAddr:= @MyILHndl^^.mask;         rowbytes:= 4;         bounds:= icnRect;      End; {with}</pre>	</TD></TR></TABLE></CENTER><p>Icons can represent desktop objects that are either selected or not. Folder andvolume icons can either be open or not. The object (or the volume it is on) caneither be online or offline. The Finder draws icons using all permutations ofopen, selected and online:</p><p align=center><img src="images/qd_17_001.gif" alt="qd_172.gif" width=416 height=132></p><p>Drawing icons as non-open is basically the same for online and offline volumes.We need to punch a hole in the desktop for the icon. This is analogous topunching a hole in dough with an irregular shaped cookie-cutter. We can thensprinkle jimmies* all over the cookie and they will only stick in the area thatwe punched out (the mask). We do this by <code>copyBits</code>ing the mask onto the desktop(whatever pattern) to our <code>destRect</code>. For non-open, non-selected icons:</p><p align=center><img src="images/qd_17_002.gif" alt="qd_173.gif" width=64 height=40></p><p>we use the <code>SrcBic</code> mode so that we punch a white hole:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    SetRect(destRect,left,top,left+32,top+32);    CopyBits(mBitMap,thePort^.portBits,icnRect,destRect,SrcBic,NIL);</pre>	</TD></TR></TABLE></CENTER><p>Then we XOR in the icon:</p><p>That's all there is to drawing an icon as non-open, non-selected. To draw the icon as non-open, selected:</p><p align=center><img src="images/qd_17_003.gif" alt="qd_174.gif" width=96 height=45></p><p>we will <code>OR</code> in the mask, causing a mask-shaped BLACK hole to be punched in the desktop:</p><p>Then, as before, we <code>XOR</code> in the icon:</p><p>To draw icons as non-opened for offline volumes:</p><p align=center><img src="images/qd_17_004.gif" alt="qd_175.gif" width=64 height=41></p><p>we need to do a little more work. We need to <code>XOR</code> a <code>ltGray</code> pattern into the<code>boundsRect</code> of the icon. We will then punch the hole, draw the icon and then <code>XOR</code>out the <code>ltgray</code> pattern that does not fall inside the mask. So, to draw the iconas offline, non-open, non-selected we would:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    GetPenState(OldPen); {save the pen state so we can restore it}    PenMode(patXor);      PenPat(ltGray);      PaintRect(destRect); {paint a ltGray background for icon}      CopyBits(mBitMap,thePort^.portBits,icnRect,destRect,SrcBic,NIL); {punch}     PaintRect(destRect);{XOR out bits outside of the mask, leaving the mask}                {filled with ltGray}</pre>	</TD></TR></TABLE></CENTER><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre> CopyBits(iBitMap,thePort^.portBits,icnRect,destRect,SrcOr,NIL);{ OR in }                { the icon to the ltGray                mask}SetPenState(OldPen); {restore the old pen state}</pre>	</TD></TR></TABLE></CENTER><p align=center>To draw the icon as offline, non-open, selected:</p><p align=center><img src="images/qd_17_005.gif" alt="qd_176.gif" width=96 height=47></p><p>we would use a similar approach:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        GetPenState(OldPen); { save the pen state so we can restore it}    PenMode(patXor);    PenPat(dkGray);        { the icon is selected, so we need dkGray }      PaintRect(destRect);        { paint a dkGray background for icon }    {punch a hole in the background}      CopyBits(mBitMap,thePort^.portBits,icnRect,destRect,SrcBic,NIL);    PaintRect(destRect);        {XOR out bits outside of the mask, leaving                     the mask filled with dkGray}    {BIC the icon to the dkGray mask}    CopyBits(iBitMap,thePort^.portBits,icnRect,destRect,SrcBic,NIL);      SetPenState(OldPen); {restore the old pen state}</pre>	</TD></TR></TABLE></CENTER><p>Drawing the opened icons requires one less step. We don't have to<code>CopyBits</code> the icon in, we just use the mask. Online and offline iconsare drawn the same way. To draw icons as open, selected:</p><p align=center><img src="images/qd_17_006.gif" alt="qd_177.gif" width=64 height=34></p><p>we do the following:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>        GetPenState(OldPen); {save the pen state so we can restore it}      PenMode(patXor);      PenPat(dkGray);        { the icon is selected, so we need dkGray }       PaintRect(destRect);        { paint a dkGray background for icon}    {punch a hole in the background}      CopyBits(mBitMap,thePort^.portBits,icnRect,destRect,SrcBic,NIL);      PaintRect(destRect);      {XOR out bits outside of the mask, leaving                     the mask filled with dkGray}</pre>	</TD></TR></TABLE></CENTER><p>To draw icons as open, non-selected:</p><p align=center><img src="images/qd_17_007.gif" alt="qd_178.gif" width=64 height=32></p><p>we just need to change one line from above. Instead of <code>XOR</code>ing with a <code>dkGray</code>pattern, we use a <code>ltGray</code> pattern:</p><p>These techniques will work on any background, window-white or desktop-gray andall patterns in between. Have fun.</p><p>* <i>jimmies</i>: little bits of chocolate</p><P><A HREF="#top">Back to top</A></p><a id="References"></a><h2>References</h2><P>QuickDraw</p><p>Toolbox Utilities</p><a name="Downloads"></a>         <P><A HREF="#top">Back to top</A></p><H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (100K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/qd_17.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/qd/qd_17.html%3Fid%3DDTS10002730-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/qd/qd_17.html%3Fid%3DDTS10002730-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/qd/qd_17.html%3Fid%3DDTS10002730-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>