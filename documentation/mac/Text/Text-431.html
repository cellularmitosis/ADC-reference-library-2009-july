<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>NewTSMDocument(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING431></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-430.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-432.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-409.html"><B>Chapter 7 - Text Services Manager</B></A> / <A HREF="Text-425.html"><B>Text Services Manager Reference</B></A><BR><DL><DD><A HREF="Text-426.html"><B>Text Services Manager Routines for Client Applications</B></A> / <A HREF="Text-430.html"><B>Creating and Activating TSM Documents</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING431-0></A>
<H3><A NAME=MARKER-9-231></A><A NAME=MARKER-2-129></A>NewTSMDocument</H3>
 <A NAME=MARKER-2-233></A>The <CODE>NewTSMDocument</CODE> function creates a TSM document and returns a handle to the document's ID.<P>
<PRE>
FUNCTION NewTSMDocument (numOfInterface: Integer; 
                         VAR supportedInterfaceTypes: 
                         InterfaceTypeList; 
                         VAR idocID: TSMDocumentID; 
                         refCon: LongInt): OSErr;
</PRE>
<DL>
<DT><CODE>numOfInterface</CODE>
<DD> The number of supported text service interface types. Currently, this number must be 1.
<DT><CODE>supportedInterfaceTypes</CODE>
<DD> A list of supported interface types. This list helps the Text Services Manager to locate the text services that have the correct interface type. Currently, the Text Services Manager has defined one interface type: <CODE>kTextService</CODE> ( = <CODE>'tsvc'</CODE>). The data type <CODE>InterfaceTypeList</CODE> is a simple array of 4-character (<CODE>OSType</CODE>) tags.
<DT><CODE>idocID</CODE>
<DD> Upon successful completion of the call, contains the document identification number of the TSM document created.
<DT><CODE>refCon</CODE>
<DD> A reference constant to store in the TSM document record. It may have any value you wish.
</DL>
<A NAME=HEADING431-7></A>
<H5>DESCRIPTION</H5>
 Each time your client application calls the <CODE>NewTSMDocument</CODE> function, the Text Services Manager creates an internal record called a TSM document and returns its ID.<P>
 If the call is successful, <CODE>NewTSMDocument</CODE> opens the default input method text service component of the current keyboard script and assigns it to this document. If <CODE>NewTSMDocument</CODE> returns <CODE>tsmScriptHasNoIMErr</CODE>, it has still created a valid TSM document, but has not associated an input method with it.<P>
 If <CODE>NewTSMDocument</CODE> fails to create a new TSM document, it returns an error and sets <CODE>idocID</CODE> to <CODE>NIL</CODE>.<P>
<A NAME=HEADING431-11></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noEr<CODE>r</CODE><TD>No error<TR>
<TD>m<CODE>emFullErr</CODE><TD>Insufficient memory to open document<TR>
<TD>tsmUnsupportedTypeErr<TD>Supported type was not <CODE>'tsvc</CODE>'<TR>
<TD>t<CODE>smNeverRegisteredErr</CODE><TD>Application is not TSM-aware<TR>
<TD>t<CODE>smScriptHasNoIMErr</CODE><TD>Current script does not use input methods<TR>
<TD>t<CODE>smCantOpenComponentErr</CODE><TD>Cannot open default input of current script</TABLE>
</H5>
<A NAME=HEADING431-12></A>
<H5>SEE ALSO</H5>
 For sample code that uses the <CODE>NewTSMDocument</CODE> function, see <A HREF=Text-418.html#MARKER-9-124>Listing 7-2 on page 7-19</A>.<A NAME=MARKER-9-403></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-430.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-432.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
