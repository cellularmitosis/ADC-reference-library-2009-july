<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Performance Overview: Doing an Initial Performance Evaluation</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Doing an Initial Performance Evaluation"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001410-CH206" title="Doing an Initial Performance Evaluation"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000430" target="_top">Performance</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP40001410-CH202-DontLinkElementID_32">Performance Overview</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../PerformanceTools/PerformanceTools.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory/RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001410-CH206-CJBFHBDB" title="Doing an Initial Performance Evaluation"></a><h1>Doing an Initial Performance Evaluation</h1><p><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_113"></a>So, you have some code and you want to see if it is suffering from performance problems. Where do you start? Not all problems are immediately visible. You might notice that an operation took several seconds to perform, but you might not notice an operation that consumed too many CPU cycles or allocated too much memory. This is where Apple’s performance tools come into play. They can help you see aspects of your program that are easily overlooked. </p><p>The following sections provide a brief overview of how to use some key tools when starting to analyze your program. These tools are good for identifying potential problems and can provide a significant amount of performance data. Remember, though, that there may be other tools that provide more specific information related to the problem. Many of the Apple performance tools are designed for specific tasks, such as tracking memory allocations or finding leaks. Running your application with several other tools can help you confirm whether a particular area is a problem. </p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_29" title="Important:"></a><p><strong>Important:</strong>&nbsp;The performance tools are there to assist you in investigating performance problems. Make sure you gather as much data as you can during your analysis. Performance analysis is somewhat of an art and requires careful consideration of all available data to find the real problem.</p><p></p></div>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="InitialEvaluation.html#//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_17">Using top</a>
				
			<br/>
			
        
			
			
				<a href="InitialEvaluation.html#//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_18">Using Quartz Debug</a>
				
			<br/>
			
        
			
			
				<a href="InitialEvaluation.html#//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_19">Using Spin Control</a>
				
			<br/>
			
        
			
			
				<a href="InitialEvaluation.html#//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_20">Using Shark</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_17" title="Using top"></a><h2>Using top</h2><p>The <code>top</code><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_114"></a><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_115"></a> tool is an important tool for identifying potential problem areas in a process. This tool displays a periodically sampled set of statistics on system usage. Using <code>top</code> and understanding its output are an excellent way to identify potential performance problems. </p><p>The <code>top</code> tool displays periodically updated statistics on CPU usage, memory usage (in various categories), resource usage (such as threads and ports), and paging events. In the default mode, <code>top</code> displays CPU and memory utilization of all system processes. You can use this information to see how much memory your program is using and what percentage of the CPU time it is using. An idle program should not use any CPU time and an active one should consume a proportionate amount of CPU time based on the complexity of the task. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_30" title="Note"></a><p><strong>Note:</strong>&nbsp;If you want to track CPU usage and other statistics over time, use BigTop instead. BigTop graphs performance trends over time, providing a real-time display of memory usage, page faults, CPU usage, and other data. </p></div><p><span class="content_text">Listing 4-1</span> shows a typical statistical output from <code>top</code>. For application developers, the statistics you should be most interested in are the CPU usage, resident private memory usage (<code>RPRVT</code>), and pagein/pageout rates. These values tell you some key things about your application’s resource usage. High CPU usage may mean that your application tasks are not tuned appropriately. Increased memory usage and page-in/page-out rates may indicate a need to reduce your application’s memory footprint.</p><a name="//apple_ref/doc/uid/TP40001410-CH206-BCIEJDGI" title="Listing 4-1Typical output of top"></a><p class="codesample"><strong>Listing 4-1&nbsp;&nbsp;</strong>Typical output of top</p><div class="codesample"><table><tr><td scope="row"><pre>Processes:  36 total, 2 running, 34 sleeping... 81 threads<span></span></pre></td></tr><tr><td scope="row"><pre>Load Avg:  0.24, 0.27, 0.23     CPU usage:  12.5% user, 87.5% sys, 0.0% idle<span></span></pre></td></tr><tr><td scope="row"><pre>SharedLibs: num =   77, resident = 10.6M code, 1.11M data, 4.75M LinkEdit<span></span></pre></td></tr><tr><td scope="row"><pre>MemRegions: num = 1207, resident = 16.4M + 4.94M private, 22.2M shared<span></span></pre></td></tr><tr><td scope="row"><pre>PhysMem:  16.0M wired, 25.8M active, 48.9M inactive, 90.7M used, 37.2M free<span></span></pre></td></tr><tr><td scope="row"><pre>VM:  476M + 39.8M   6494(6494) pageins, 0(0) pageouts<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>  PID COMMAND      %CPU   TIME      #TH #PRTS #MREGS RPRVT  RSHRD  RSIZE  VSIZE<span></span></pre></td></tr><tr><td scope="row"><pre>  318 top           0.0%  0:00.36   1    23    13   172K   232K   380K  1.31M<span></span></pre></td></tr><tr><td scope="row"><pre>  316 zsh           0.0%  0:00.08   1    18    12   168K   516K   628K  1.67M<span></span></pre></td></tr><tr><td scope="row"><pre>  315 Terminal      0.0%  0:02.25   4   112    50  1.32M  3.55M  4.88M  31.7M<span></span></pre></td></tr><tr><td scope="row"><pre>  314 CPU Monito    0.0%  0:02.08   1    63    35   896K  1.34M  2.14M  27.9M<span></span></pre></td></tr><tr><td scope="row"><pre>  313 Clock         0.0%  0:01.51   1    57    38  1.02M  2.01M  2.69M  29.0M<span></span></pre></td></tr><tr><td scope="row"><pre>  312 Dock          0.0%  0:03.72   2    77    78  2.18M  2.28M  3.64M  30.0M<span></span></pre></td></tr><tr><td scope="row"><pre>  311 Finder        0.0%  0:07.68   4    86   171  7.96M  9.15M  15.1M  52.1M<span></span></pre></td></tr><tr><td scope="row"><pre>  308 pbs           0.0%  0:01.37   4    76    40   928K   684K  1.77M  15.4M<span></span></pre></td></tr><tr><td scope="row"><pre>  285 loginwindow   0.0%  0:07.19   2    70    58  1.64M  1.93M  3.45M  29.6M<span></span></pre></td></tr><tr><td scope="row"><pre>  282 cron          0.0%  0:00.00   1    11    14    88K   228K   116K  1.50M<span></span></pre></td></tr><tr><td scope="row"><pre>  245 sshd          0.0%  0:02.48   1    10    15   176K   312K   356K  1.41M<span></span></pre></td></tr><tr><td scope="row"><pre>  222 SecuritySe    0.0%  0:00.14   2    21    24   476K   828K  1.29M  3.95M<span></span></pre></td></tr><tr><td scope="row"><pre>  209 automount     0.0%  0:00.03   2    13    20   336K   748K   324K  4.36M<span></span></pre></td></tr><tr><td scope="row"><pre>  200 nfsiod        0.0%  0:00.00   1    10    12     4K   224K    52K  1.22M<span></span></pre></td></tr><tr><td scope="row"><pre>  199 nfsiod        0.0%  0:00.00   1    10    12     4K   224K    52K  1.2<span></span></pre></td></tr><tr><td scope="row"><pre>[...]<span></span></pre></td></tr></table></div>	<p>In its header area, <code>top</code> displays statistics on the global state of the system. This information includes load averages; total process and thread counts; and total memory, broken down into various categories such as private, shared, wired, and free. It also includes global information concerning the system frameworks. At regular intervals, <code>top</code> updates these statistics to account for recent system activity.</p><p><span class="content_text">Table 4-1</span> describes the columnar data that appears in the CPU and memory utilization mode using the <code>-w</code> parameter. For detailed information about how <code>top</code> reports information, see the <code><a href="../../../../Darwin/Reference/ManPages/man1/top.1.html#//apple_ref/doc/man/1/top" target="_top">top(1)</a></code> man page. </p><a name="//apple_ref/doc/uid/TP40001410-CH206-BAJDIHCD" title="Table 4-1Output from top using the -w option"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 4-1&nbsp;&nbsp;</strong>Output from top using the -w option</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Column</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code>PID</code></p></td><td ><p>The BSD process ID<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_116"></a>.</p></td></tr><tr><td  scope="row"><p><code>COMMAND</code></p></td><td ><p>The name of the executable or application package. (Note that Code Fragment Manager applications are named after the native process that launches them, <code>LaunchCFMApp</code>.)</p></td></tr><tr><td  scope="row"><p><code>%CPU</code></p></td><td ><p>The percentage of CPU cycles consumed during the interval on behalf of this process (both kernel and user space). </p></td></tr><tr><td  scope="row"><p><code>TIME</code></p></td><td ><p>The amount of CPU time<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_117"></a> (<em>minute</em>:<em>seconds</em>.<em>hundreths</em>) consumed by this process since it was launched.</p></td></tr><tr><td  scope="row"><p><code>#TH</code></p></td><td ><p>The number of threads<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_118"></a> owned by this process.</p></td></tr><tr><td  scope="row"><p><code>#PRTS (delta)</code></p></td><td ><p>The number of Mach port<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_119"></a> objects owned by this process. The delta value, which is enabled by the <code>-w</code> parameter, is relative to the value first displayed when <code>top</code> was launched.</p></td></tr><tr><td  scope="row"><p><code>#MREG</code></p></td><td ><p>The number of memory regions.</p></td></tr><tr><td  scope="row"><p><code>VPRVT</code></p></td><td ><p>The private address space<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_120"></a> currently allocated (with <code>-w</code> parameter only).</p></td></tr><tr><td  scope="row"><p><code>RPRVT (delta)</code></p></td><td ><p>The resident private memory<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_121"></a>. The delta value, which is enabled by the <code>-w</code> parameter, is relative to the previous sample.</p></td></tr><tr><td  scope="row"><p><code>RSHRD (delta)</code></p></td><td ><p>The resident shared memory<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_122"></a>. The delta value, which is enabled by the <code>-w</code> parameter, is relative to the previous sample</p></td></tr><tr><td  scope="row"><p><code>RSIZE (delta)</code></p></td><td ><p>The total resident memory as real pages that this process currently has associated with it. Some may be shared by other processes. The delta value, which is enabled by the <code>-w </code>parameter, is relative to the previous sample.</p></td></tr><tr><td  scope="row"><p><code>VSIZE (delta)</code></p></td><td ><p>The total address space currently allocated, including shared memory. The delta value, which is enabled by the <code>-w </code>parameter, is relative to the value first displayed when <code>top</code> was launched.</p><p>This value is mostly irrelevant for Mac OS X processes. Every application has a large virtual size because of the shared region used to hold framework and library code.</p></td></tr></table></div><p>The <code>RPRVT</code> data (for resident private pages) is a good measure of how much real memory an application is using. The <code>RSHRD</code> column (for resident shared pages) shows the resident pages of all the shared mapped files or memory objects that are shared with other tasks.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_31" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code>top</code> tool does not provide a separate count of the number of pages in shared libraries that are mapped into the task.</p>The <code>top</code> tool reports memory usage of windows in the “shared memory” category because window buffers are shared with the window server.</p></div><p><span class="content_text">Table 4-2</span> shows the columns displayed in the event-counting mode, which is enabled with either the <code>-e</code>, <code>-d</code>, or <code>-a</code> option on the command line. </p><a name="//apple_ref/doc/uid/TP40001410-CH206-BAJBABBB" title="Table 4-2Output from top using the -d option"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 4-2&nbsp;&nbsp;</strong>Output from top using the -d option</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Column</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code>PID</code></p></td><td ><p>The BSD process ID.</p></td></tr><tr><td  scope="row"><p><code>COMMAND</code></p></td><td ><p>The name of the executable or application package. (Note that Code Fragment Manager applications are named after the native process that launches them, <code>LaunchCFMApp</code>.)</p></td></tr><tr><td  scope="row"><p><code>%CPU</code></p></td><td ><p>The percentage of CPU cycles consumed during the interval on behalf of this process (both kernel and user space).</p></td></tr><tr><td  scope="row"><p><code>TIME</code></p></td><td ><p>The amount of CPU time consumed by this process (<em>minute</em>:<em>seconds</em>.<em>hundreths</em>) since it was launched.</p></td></tr><tr><td  scope="row"><p><code>FAULTS</code></p></td><td ><p>The total number of page faults<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_123"></a>.</p></td></tr><tr><td  scope="row"><p><code>PAGEINS</code></p></td><td ><p>The number of page-ins<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_124"></a>, requests for pages from a pager (each page-in represents a 4 kilobyte I/O operation).</p></td></tr><tr><td  scope="row"><p><code>COW_FAULTS</code></p></td><td ><p>The number of faults that caused a page to be copied (generally caused by copy-on-write faults<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_125"></a>).</p></td></tr><tr><td  scope="row"><p><code>MSGS_SENT</code></p></td><td ><p>The number of Mach messages<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_126"></a> sent by the process.</p></td></tr><tr><td  scope="row"><p><code>MSGS_RCVD</code></p></td><td ><p>The number of Mach messages received by the process.</p></td></tr><tr><td  scope="row"><p><code>BSDSYSCALL</code></p></td><td ><p>The number of BSD system calls<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_127"></a> made by the process.</p></td></tr><tr><td  scope="row"><p><code>MACHSYSCALL</code></p></td><td ><p>The number of Mach system calls<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_128"></a> made by the process.</p></td></tr><tr><td  scope="row"><p><code>CSWITCH</code></p></td><td ><p>The number of context switches<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_129"></a> to the process (the number of times the process has been given time to run by the kernel’s scheduler).</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_18" title="Using Quartz Debug"></a><h2>Using Quartz Debug</h2><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_130"></a><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_131"></a><p>Quartz Debug is an important tool for determining the efficiency of your drawing code. The tool collects information from your program’s drawing calls to find out where your program is drawing and whether it is redrawing content unnecessarily. <span class="content_text">Figure 4-1</span> shows the Quartz Debug options window. </p><br/><div><a name="//apple_ref/doc/uid/TP40001410-CH206-CJBJHCEH" title="Figure 4-1Quartz Debug options"></a><p><strong>Figure 4-1&nbsp;&nbsp;</strong>Quartz Debug options</p><img src = "../art/quartz_debug.gif" alt = "Quartz Debug options" width="203" height="165"></div><br/><p>In its primary mode, Quartz Debug shows you visually where your code is drawing. It places a yellow rectangle over an area where a redraw operation is about to occur and then pauses briefly before redrawing the content. This flickering yellow pattern can point out places where you are drawing more than is necessary. For example, if you update only a small portion of a custom view, you probably do not want to be forced to redraw the entire view. Alternatively, if you see a system control being redrawn several times in succession, it might point out the need to hide that control before changing its attributes. </p><p>The tool also has a mode that identifies parts of the screen that are being redrawn with the exact same content. If you select the “Flash identical updates” option, the tool displays red over any areas whose resulting bits are identical to the current content.</p><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_19" title="Using Spin Control"></a><h2>Using Spin Control</h2><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_132"></a><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_133"></a><p>If an application becomes unresponsive at any time, the window server notifies the user of this situation by changing the cursor to a spinning<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_134"></a> wheel. If your application is the one that is unresponsive<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_135"></a>, sampling it during that time can help you determine why it is unresponsive. However, even if you have Shark or another tool ready to go, you might not be able start them fast enough to gather a set of samples during the unresponsive period. This is where Spin Control provides a helpful solution.</p><p>Spin Control is a monitoring tool that automatically samples unresponsive applications. You leave Spin Control running on your computer whenever you are testing your application. When the spinning cursor appears, Spin Control gathers the backtrace information and makes it available from the application’s main window, as shown in <span class="content_text">Figure 4-2</span>. </p><br/><div><a name="//apple_ref/doc/uid/TP40001410-CH206-CJBFEJHF" title="Figure 4-2Spin Control main window"></a><p><strong>Figure 4-2&nbsp;&nbsp;</strong>Spin Control main window</p><img src = "../art/spin_control_main.gif" alt = "Spin Control main window" width="644" height="332"></div><br/><p>To view the backtrace for a particular session, select that session and click Open. Spin Control displays the browser window (<span class="content_text">Figure 4-3</span>) along with the sample data. You can use the data in this window to identify the code that was executing when your application became unresponsive. The controls in the bottom-left corner of the window let you change the way you view the samples. The buttons at the bottom right let you prune the call stacks and focus on the most relevant call stack entries.</p><br/><div><a name="//apple_ref/doc/uid/TP40001410-CH206-CJBBCFEH" title="Figure 4-3Spin Control sample window"></a><p><strong>Figure 4-3&nbsp;&nbsp;</strong>Spin Control sample window</p><img src = "../art/sc_sample_window.gif" alt = "Spin Control sample window" width="630" height="326"></div><br/><p>If you want to view a complete listing of the call stacks, click the “Show text report” button on the main window. This format shows a formatted version of the entire data set that you can copy and paste into other documents. </p><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_20" title="Using Shark"></a><h2>Using Shark</h2><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_136"></a><a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_137"></a><p>Shark is one of the most powerful analysis tools you can use to find performance problems in your code. Shark can generate a time-based profile of your program’s execution, trace function calls, and graph memory allocations<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_138"></a> over time. You can use Shark to track information for your program or for the entire system. Shark even captures execution information for kernel entities such as drivers<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_139"></a> and kernel extensions<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_140"></a>.</p><p>Despite the power of Shark, using the tool is very simple. Upon launch, Shark presents you with the window shown in <span class="content_text">Figure 4-4</span>. Click Start (or use the Option-Escape global shortcut) to start sampling all system processes. Click the button again (or use the same global shortcut) to stop gathering data and display the samples (<span class="content_text">Figure 4-5</span>).</p><br/><div><a name="//apple_ref/doc/uid/TP40001410-CH206-CJBBEJCJ" title="Figure 4-4Shark launch window"></a><p><strong>Figure 4-4&nbsp;&nbsp;</strong>Shark launch window</p><img src = "../art/shark_main.gif" alt = "Shark launch window" width="598" height="126"></div><br/><p>If you want to limit sampling to only one process, you can use the pop-up menu on the right side of the window to select that process. Also, if you want to do something other than a statistical time profile, choose the appropriate option from the configuration pop-up menu before you click Start. </p><p>When you stop sampling, Shark displays the profile window (<span class="content_text">Figure 4-5</span>) with the gathered data. This is the main window you use to identify potential problems. You can configure this window to display a heavy view, tree view, or both. </p><br/><div><a name="//apple_ref/doc/uid/TP40001410-CH206-CJBEJEHF" title="Figure 4-5Shark profile window"></a><p><strong>Figure 4-5&nbsp;&nbsp;</strong>Shark profile window</p><img src = "../art/shark_samples.gif" alt = "Shark profile window" width="607" height="455"></div><br/><p>The heavy view<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_141"></a> sorts function calls based on the frequency by which they appeared. This view identifies your program’s hot spots. If you see one of your program’s functions near the top of this view, you should investigate. Functions tend to have higher weights if they are poorly optimized but a more likely scenario is that the function is being called too frequently from some other place. This can indicate an inefficient higher-level algorithm.</p><p>The tree view<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_142"></a> shows the same data organized by calling hierarchy. This view offers a convenient way to understand the context in which a particular function is called. This is the more traditional way to view call stack data and can be used in conjunction with the heavy view to track down hot spots and to see the surrounding context quickly.</p><p>The Shark profile window makes it easy to filter out irrelevant code and libraries through a feature called data mining<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_143"></a>. The Data Mining menu has several options for excluding or flattening symbols and libraries. If you apply these commands, Shark rolls the costs of calling those symbols and libraries into the function that called them. For example, if you know your code makes several calls to Core Foundation and you exclude the Core Foundation library, the time spent in Core Foundation now appears as time spent in your code. If the amount of time spent in your code jumps significantly afterward, you might want to investigate ways to call fewer Core Foundation functions. </p><p>Shark also can help you identify performance issues within a given function through the code view. When you double-click a function, Shark displays the source code for that function if it is available (see <span class="content_text">Figure 4-6</span>). It applies color to lines of code based on the amount of time spent in that code. For each line of source, brighter shades of yellow indicate where more time was spent during the profile. </p><br/><div><a name="//apple_ref/doc/uid/TP40001410-CH206-CJBFDEAE" title="Figure 4-6Shark code display"></a><p><strong>Figure 4-6&nbsp;&nbsp;</strong>Shark code display</p><img src = "../art/shark_code_listing.gif" alt = "Shark code display" width="681" height="452"></div><br/><p>Shark occasionally offers specific tuning tips<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_144"></a> and comments in the margin. Clicking the exclamation-point icon displays a tip that you can use to improve your code. The comment column displays a summary of the tip.</p><p>For more information about Shark and its features, choose Help > Shark Help to display the Shark User Guide.<a name="//apple_ref/doc/uid/TP40001410-CH206-DontLinkElementID_145"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../PerformanceTools/PerformanceTools.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory/RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-10-03<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Performance/Conceptual/PerformanceOverview/InitialEvaluation/InitialEvaluation.html%3Fid%3DTP40001410-1.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Performance/Conceptual/PerformanceOverview/InitialEvaluation/InitialEvaluation.html%3Fid%3DTP40001410-1.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Performance/Conceptual/PerformanceOverview/InitialEvaluation/InitialEvaluation.html%3Fid%3DTP40001410-1.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>