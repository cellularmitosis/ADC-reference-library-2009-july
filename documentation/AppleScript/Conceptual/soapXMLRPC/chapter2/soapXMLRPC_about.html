<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>XML-RPC and SOAP Programming Guide: About AppleScript&acirc;&#128;&#153;s Support for XML-RPC and SOAP</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="About AppleScript&acirc;&#128;&#153;s Support for XML-RPC and SOAP"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001721" title="About AppleScript&acirc;&#128;&#153;s Support for XML-RPC and SOAP"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/InternetWeb-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000526" target="_top">Internet &amp; Web</a> &gt; <a href="../chapter1/soapXMLRPC_intro.html#//apple_ref/doc/uid/20001722-DontLinkElementID_1">XML-RPC and SOAP Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter1/soapXMLRPC_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter3/soapXMLRPC_scripts.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001721-DontLinkElementID_4" title="About AppleScript&acirc;&#128;&#153;s Support for XML-RPC and SOAP"></a><h1><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-TPXREF101" title="About AppleScript&acirc;&#128;&#153;s Support for XML-RPC and SOAP"></a>About AppleScript’s Support for XML-RPC and SOAP</h1><p>Starting with Mac OS X version 10.1, AppleScript and the Apple Event Manager provide XML-RPC and SOAP support such that:</p><ul class="ul"><li class="li"><p>Scripters can make XML-RPC calls and SOAP requests from scripts.</p></li><li class="li"><p>Developers can make XML-RPC calls and SOAP requests from applications or other code by sending Apple events.</p></li></ul>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-TPXREF150">The XML-RPC and SOAP Protocols</a>
				
			<br/>
			
        
			
			
				<a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-TPXREF151">AppleScript Support for Remote Procedure Calls</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-TPXREF150" title="The XML-RPC and SOAP Protocols"></a><h2>The XML-RPC and SOAP Protocols</h2><p>A <strong>remote procedure call</strong> is a request to a server application at another location to perform operations and return information. <strong>XML-RPC</strong> is a simple protocol that allows software running in different environments to make remote procedure calls over the Internet. XML-RPC uses two industry standards: XML (extensible markup language) for encoding messages, and HTTP (hypertext transfer protocol) for transporting them. A properly formatted XML-RPC message is an HTTP POST request whose body is in XML. The specified remote server executes the requested call and returns any requested data in XML format.</p><p>XML-RPC recognizes procedure parameters by position. Parameters and return values can be simple types such as numbers, strings, and dates, or more complex types such as structures and arrays. To learn more about XML-RPC messages, see the XML-RPC specification at <span class="content_text"><a href="http://www.xmlrpc.com/spec" target="_blank">http://www.xmlrpc.com/spec</a></span>.</p><p><strong>SOAP (Simple Object Access Protocol)</strong> is an RPC protocol designed for a distributed environment, where a server may consist of a hierarchy of objects whose methods can be called over the Internet. A goal of SOAP is to establish a standard protocol that will serve both web service providers and service users. As with other remote procedure call protocols, SOAP uses XML to encode messages and HTTP to transport them. A SOAP request contains a header and an envelope; the envelope in turn contains the body of the request.</p><p>One key difference between the SOAP and XML-RPC protocols is that with SOAP, parameters are notational (a request must encode the method parameter names within its XML), rather than positional (recognized by position). To learn more about SOAP messages, see the SOAP specification at <span class="content_text"><a href="http://www.w3.org/TR/" target="_blank">http://www.w3.org/TR/</a></span>.</p><p>Remote procedure calls provide a powerful tool for accessing services over the Internet. For example, there are already a variety of web-based servers that can check spelling, translate text between languages, provide stock prices, supply weather and traffic information, and more. You can find available services at sites such as XMethods at <span class="content_text"><a href="http://www.xmethods.net/" target="_blank">http://www.xmethods.net/</a></span>. There you can also find information you’ll need to make remote procedure calls to these services.</p><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-TPXREF151" title="AppleScript Support for Remote Procedure Calls"></a><h2>AppleScript Support for Remote Procedure Calls</h2><p>This section describes how to make XML-RPC and SOAP requests from scripts and from applications or other code. Using this support, both scripters and developers can take advantage of the growing number of XML-RPC and SOAP servers available on the Internet.</p><p>With Mac OS X version 10.1, the Apple Event Manager is able to process Apple events that encapsulate remote procedure calls, whether the events originate from scripts or applications. <span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-CJBGHCIA">Figure 2-1</a></span> shows a simplified view of this process.</p><br/><div><a name="//apple_ref/doc/uid/20001721-DontLinkElementID_5" title="Figure 1-1The Apple Event Manager processing a remote procedure call Apple Event."></a><p><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-CJBGHCIA" title="Figure 1-1The Apple Event Manager processing a remote procedure call Apple Event."></a><strong>Figure 1-1&nbsp;&nbsp;</strong>The Apple Event Manager processing a remote procedure call Apple Event.</p><img src = "../art/amngr_rpc_ae.gif" alt = "The Apple Event Manager processing a remote procedure call Apple Event." width="138" height="498"></div><br/><p>The Apple Event Manager recognizes a remote procedure call Apple event by its address descriptor, which uses the descriptor type <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/typeApplicationURL" target="_top">typeApplicationURL</a></code>. To process a remote procedure call Apple event (assuming the event and the XML it contains are properly formatted), the Apple Event Manager performs these basic steps:</p><ol class="ol"><li class="li"><p>It uses information from the Apple event to build the XML that represents the remote procedure call.</p></li><li class="li"><p>It opens a connection to the specified server.</p></li><li class="li"><p>It sends the XML via HTTP POST request.</p></li><li class="li"><p>It waits for a response.</p></li><li class="li"><p>It parses the XML of the response.</p></li><li class="li"><p>It constructs a reply Apple event.</p></li><li class="li"><p>It returns the reply.</p></li></ol><p>Scripters can take advantage of this capability by adding statements to their scripts that specify XML-RPC or SOAP requests. Application developers can create and send Apple events directly to invoke XML-RPC or SOAP requests.</p><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-TPXREF152" title="Remote Procedure Calls From Scripts"></a><h3>Remote Procedure Calls From Scripts</h3><p>When you compile and execute a script, the AppleScript component works with the Apple Event Manager to convert script statements into Apple events that are sent to the specified applications. The following sections describe the terminology and syntax for making XML-RPC calls and SOAP requests from scripts.</p><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-TPXREF153" title="AppleScript Terminology for Remote Procedure Calls"></a><h4>AppleScript Terminology for Remote Procedure Calls</h4><p>AppleScript 1.7 for Mac OS X version 10.1 can specify Internet applications as targets of Tell statements or within Using Terms From blocks. When you specify an XML-RPC server or a SOAP server in one of these statements, the Apple Event Manager generates a dictionary that makes the terminology for remote procedure calls available to your script. That terminology includes the following terms that specify XML-RPC and SOAP requests:</p><ul class="spaceabove"><li class="li"><p><code>call xmlrpc</code></p></li><li class="li"><p><code>call soap</code></p></li></ul><p>The next sections describe how to use AppleScript’s remote procedure call terminology.</p><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJCBCBJ" title="XML-RPC Script Statements"></a><h4>XML-RPC Script Statements</h4><p>To make an XML-RPC request from a script, you must specify an XML-RPC server as the target application for the request. To do so, you use a statement like the following, which specifies an XML-RPC server that provides spell-checking services over the Internet:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "http://www.stuffeddog.com/speller/speller-rpc.cgi"<span></span></pre></td></tr></table></div><p>In this statement, the XML-RPC server application is <code>speller-rpc.cgi</code> and the remote location is specified by the URL <code>http://www.stuffeddog.com/speller/</code>. You can also use the following alternate syntax (where the symbol <code>¬</code> (Option-l) denotes a continuation of one script statement onto more than one line), but this form is converted to the above form when the script is compiled:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "speller-rpc.cgi" of machine ¬<span></span></pre></td></tr><tr><td scope="row"><pre>     "http://www.stuffeddog.com/speller"<span></span></pre></td></tr></table></div><p>Once you have specified an XML-RPC server, you can make remote procedure calls within a script block (such as a Tell statement) that specifies that server:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "http://www.stuffeddog.com/speller/speller-rpc.cgi"<span></span></pre></td></tr><tr><td scope="row"><pre>    -- remote procedure calls here<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>To specify a name and parameters for the remote procedure call, you use script statements like the following:</p><div class="codesample"><table><tr><td scope="row"><pre>set returnValue to¬<span></span></pre></td></tr><tr><td scope="row"><pre>    call xmlrpc {method name:"someMethod",¬<span></span></pre></td></tr><tr><td scope="row"><pre>        parameters: {parameter1, parameter2} }<span></span></pre></td></tr></table></div><p>This statement specifies a remote procedure call with two parameters. (You use the same terminology, <code>method name:</code>, whether specifying a function or method.) The parameters are represented as a list. The returned information is stored in the variable <code>returnValue</code>. Because XML-RPC parameter syntax is positional, you don’t need to provide the parameter names for a given procedure call. An XML-RPC server returns an error if the passed XML is not properly formatted.</p><p>The following example combines a Tell block with a remote procedure call to the spell-checking server specified earlier.</p><div class="codesample"><table><tr><td scope="row"><pre>set myText to "My frst naem is John"<span></span></pre></td></tr><tr><td scope="row"><pre>tell application "http://www.stuffeddog.com/speller/speller-rpc.cgi"<span></span></pre></td></tr><tr><td scope="row"><pre>    set returnValue to call xmlrpc {method name:"speller.spellCheck",¬<span></span></pre></td></tr><tr><td scope="row"><pre>        parameters: {myText} }<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>This sample shows how easy it can be to set up a remote procedure call from a script. The first line sets a local variable to a text string to be checked. Then the Tell statement specifies an Internet spell-checking server. The single statement in the Tell block calls the <code><!--a-->speller.spellCheck<!--/a--></code> function, passing the local string variable as the single parameter (the text to be checked) and storing the result in a second local variable. This particular remote procedure returns a list that contains, for each misspelled word, a list of suggested corrections, the location of the word in the text, and the misspelled word itself. <span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJFBCGA">Listing 2-1</a></span> shows an example of such a list.</p><a name="//apple_ref/doc/uid/20001721-DontLinkElementID_6" title="Listing 1-1Sample list of misspelled words returned by spellCheck remote procedure call."></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJFBCGA" title="Listing 1-1Sample list of misspelled words returned by spellCheck remote procedure call."></a><strong>Listing 1-1&nbsp;&nbsp;</strong>Sample list of misspelled words returned by spellCheck remote procedure call.</p><div class="codesample"><table><tr><td scope="row"><pre>        {{suggestions:{"fast", "fest", "first", "fist", "Forst",<span></span></pre></td></tr><tr><td scope="row"><pre>        "frat", "fret", "frist", "frit", "frost", "frot", "fust"},<span></span></pre></td></tr><tr><td scope="row"><pre>        location:4, |word|:"frst"}, {suggestions:{"haem", "na em",<span></span></pre></td></tr><tr><td scope="row"><pre>        "na-em", "naam", "nae", "nae m", "nae-m", "nael", "Naim",<span></span></pre></td></tr><tr><td scope="row"><pre>        "nam", "name", "neem"}, location:9, |word|:"naem"}}<span></span></pre></td></tr></table></div><p>Note that this is not the raw data returned from the remote procedure call. When you execute the script shown above, the AppleScript component calls on the Apple Event Manager to convert the <code>call xmlrpc</code> statement to an Apple event and send the event to the specified server. The Apple Event Manager recognizes the event and processes it by formatting the remote procedure call into proper XML, opening a connection, sending the message, waiting for a reply, formatting the returned XML into an Apple event, and returning the event.</p><p>For a complete script that uses remote procedure calls to check spelling, see <span class="content_text"><a href="../chapter3/soapXMLRPC_scripts.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001723-BAJGDBGC">“Scripting an XML-RPC Call.”</a></span></p><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJGHDCH" title="SOAP Script Statements"></a><h4>SOAP Script Statements</h4><p>The process for making SOAP requests in AppleScript scripts is very similar to the process for XML-RPC, though it uses the term <code>call soap</code> rather than <code>call xmlrpc</code>. To specify a SOAP server as the target application for a SOAP request, you use a statement like the following:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "http://services.xmethods.net:80/perl/soaplite.cgi"<span></span></pre></td></tr></table></div><p>In this statement, the SOAP server application is <code>soaplite.cgi</code>, a server that can perform English to French translation, and the remote location is specified by the URL <code>http://services.xmethods.net:80/perl/</code>. Once you have specified a SOAP server on a remote machine, you can make SOAP requests within a script block that specifies that server:</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "http://services.xmethods.net:80/perl/soaplite.cgi"<span></span></pre></td></tr><tr><td scope="row"><pre>    -- SOAP requests here<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>To specify a method name and parameters for the SOAP request, you use script statements like the following (where the symbol <code>¬</code> (Option-l) denotes a continuation of one script statement onto more than one line):</p><div class="codesample"><table><tr><td scope="row"><pre>    set returnValue to call soap {method name:"BabelFish", ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        method namespace uri:"urn:xmethodsBabelFish", ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        parameters:{translationmode:direction as string, ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        sourcedata:theText as string}, ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        SOAPAction:"urn:xmethodsBabelFish#BabelFish"}<span></span></pre></td></tr></table></div><p>This statement specifies a SOAP request to a method named <code>BabelFish</code> with two parameters, <code>translationmode</code> (such as English to French) and <code>sourcedata</code> (the text to be translated). The returned information (translated text) is stored in the variable <code>returnValue</code>. Unlike the case with XML-RPC calls, for a SOAP request you must specify the names of the parameters for the specified method. While an XML-RPC call represents parameters as a list, a SOAP request represents them as a record. The server will return an error if the passed XML is not properly formatted.</p><p>The following example combines a Tell block with a SOAP request to the translation server specified earlier.</p><div class="codesample"><table><tr><td scope="row"><pre>set theText to "The spirit is willing but the flesh is weak."<span></span></pre></td></tr><tr><td scope="row"><pre>set direction to "en_fr"<span></span></pre></td></tr><tr><td scope="row"><pre>tell application "http://services.xmethods.net:80/perl/soaplite.cgi"<span></span></pre></td></tr><tr><td scope="row"><pre>    set resultText to call soap {method name:"BabelFish", ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        method namespace uri:"urn:xmethodsBabelFish", ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        parameters:{translationmode:direction as string, ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        sourcedata:theText as string}, ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        SOAPAction:"urn:xmethodsBabelFish#BabelFish"}<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>The first two lines set local variables for the text to be translated and the direction of translation (from English to French). The Tell statement specifies an Internet language translation server. The <code>call soap</code> statement in the Tell block calls the <code><!--a-->BabelFish<!--/a--></code> function, specifying two parameters by name (<code>translationmode</code> and <code>sourcedata</code>), and passing the local variables as the parameter values. All the terms shown in the <code>call soap</code> statement in this example are required except <code>parameters:</code> (because a SOAP method may have no parameters). The resulting translated text is stored in another local variable.</p><p>You obtain values for the <code>method namespace uri:</code> and <code>SOAPAction:</code> terms from the services themselves. For example, many SOAP services publish the information needed to use their services at sites such as XMethods at <span class="content_text"><a href="http://www.xmethods.net/" target="_blank">http://www.xmethods.net/</a></span>. You can learn more about SOAP name spaces and SOAPAction in the SOAP specification at <span class="content_text"><a href="http://www.w3.org/TR/" target="_blank">http://www.w3.org/TR/</a></span>.</p><p>When you execute this script, AppleScript and the Apple Event Manager take care of formatting the SOAP request into proper XML, opening a connection, sending the message, waiting for a reply, formatting the returned XML into an Apple event, and returning the event.</p><p>For a complete script that uses SOAP requests to translate English text to French, see <span class="content_text"><a href="../chapter3/soapXMLRPC_scripts.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001723-BAJBFJBD">“Scripting a SOAP Request.”</a></span></p><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJHAJDD" title="Remote Procedure Calls From Applications"></a><h3>Remote Procedure Calls From Applications</h3><p>As described earlier, the Apple Event Manager is now able (in Mac OS X version 10.1) to process Apple events that encapsulate remote procedure calls, whether the events originate from scripts or applications. Assuming the Apple event and the XML it contains are properly formatted, the Apple Event Manager extracts the XML, establishes a connection to the specified server, sends the request via HTTP, waits for a response, parses the XML of the response, constructs a reply Apple event, and returns the reply.</p><p>To take advantage of this support, applications and other code can create Apple events to send either XML-RPC or Soap requests. The process includes the following steps:</p><ol class="ol"><li class="li"><p>Link with <code>Carbon.framework</code>.</p></li><li class="li"><p>Prepare any necessary Apple event descriptors, including an address descriptor of type <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/typeApplicationURL" target="_top">typeApplicationURL</a></code> that specifies the target for the request (a remote server).</p></li><li class="li"><p>Create an Apple event with event class <code><!--a  -->kAERPCClass<!--/a--></code> and event type <code><!--a  -->kAEXMLRPCScheme<!--/a--></code> (for XML-RPC) or <code><!--a  -->kAESOAPScheme<!--/a--></code> (for SOAP), and with the target address descriptor created previously.</p></li><li class="li"><p>Create the direct object for the Apple event and insert parameters for the method name, method parameter list, and any other required information for the remote procedure call.</p></li><li class="li"><p>Insert the direct object into the Apple event.</p></li><li class="li"><p>Send the Apple event with <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/AESend" target="_top">AESend</a></code>.</p></li><li class="li"><p>Process the reply Apple event to extract any needed information.</p></li></ol><p>More detailed steps for sending an XML-RPC Apple event are shown in <span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJGDHHJ">“Sending an XML-RPC Apple Event”</a></span> and for a SOAP request in <span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJGIEIA">“Sending a SOAP Apple Event.”</a></span> For examples with sample code, see <span class="content_text"><a href="../chapter4/soapXMLRPC_apps.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001724-TPXREF101">“Making Remote Procedure Calls From Applications.”</a></span></p><p>There is some overhead in creating Apple events to send remote procedure calls and in extracting information from the reply Apple event, but you gain the advantage of having the Apple Event Manager build the required XML for you. If, however, you already have code that, for example, automatically generates XML for remote procedure calls, it may be more efficient for you to write your own code to make the remote procedure calls as well.</p><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJBAFEG" title="Apple Event Manager API for Remote Procedure Calls"></a><h4>Apple Event Manager API for Remote Procedure Calls</h4><p>This section describes some of the key constants used to construct remote procedure call Apple events. These constants are defined in <code>AEDataModel.h</code> (in <code>AE.framework</code>, a subframework of <code>ApplicationServices.framework</code>). For step-by-step instructions that show how to create Apple events using these constants, see <span class="content_text"><a href="../chapter4/soapXMLRPC_apps.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001724-TPXREF101">“Making Remote Procedure Calls From Applications.”</a></span></p><p>The Apple Event Manager defines one event class constant and two event ID constants for remote procedure call Apple events. These constants are shown in <span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJJEBHA">Listing 2-2</a></span>. You use the constant <code><!--a  -->kAERPCClass<!--/a--></code> as the event class for both XML-RPC and SOAP requests. To specify the request type, you use either <code><!--a  -->kAEXMLRPCScheme<!--/a--></code> or <code><!--a  -->kAESOAPScheme<!--/a--></code> for the event ID.</p><a name="//apple_ref/doc/uid/20001721-DontLinkElementID_7" title="Listing 1-2Event class and event ID constants for remote procedure call Apple events."></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJJEBHA" title="Listing 1-2Event class and event ID constants for remote procedure call Apple events."></a><strong>Listing 1-2&nbsp;&nbsp;</strong>Event class and event ID constants for remote procedure call Apple events.</p><div class="codesample"><table><tr><td scope="row"><pre>    kAERPCClass     = 'rpc ', /* for outgoing XML events */<span></span></pre></td></tr><tr><td scope="row"><pre>    kAEXMLRPCScheme = 'RPC2', /* event ID: send to XMLRPC endpoint */<span></span></pre></td></tr><tr><td scope="row"><pre>    kAESOAPScheme   = 'SOAP', /* event ID: send to SOAP endpoint */<span></span></pre></td></tr></table></div><p><span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJHADHI">Listing 2-3</a></span> shows the constant <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/typeApplicationURL" target="_top">typeApplicationURL</a></code>. An Apple event for a remote procedure call must have an address descriptor of this type that specifies the target for the request. The Apple Event Manager recognizes this type as a remote procedure call and processes it appropriately.</p><a name="//apple_ref/doc/uid/20001721-DontLinkElementID_8" title="Listing 1-3Address descriptor type for remote procedure call Apple events."></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJHADHI" title="Listing 1-3Address descriptor type for remote procedure call Apple events."></a><strong>Listing 1-3&nbsp;&nbsp;</strong>Address descriptor type for remote procedure call Apple events.</p><div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>    //...some constants not shown<span></span></pre></td></tr><tr><td scope="row"><pre>    typeApplicationURL = 'aprl',<span></span></pre></td></tr><tr><td scope="row"><pre>    //...<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div><p>The SOAP specification defines a schema for encoding (or serializing) information. The Apple Event Manager can work with both the 1999 (or SOAP specification version 1.1) and 2001 (SOAP specification version 1.2) schemas. <span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJDCHFD">Listing 2-4</a></span> shows the constants for specifying the SOAP schema used to format the SOAP request in a remote procedure call Apple event.</p><p>You can specify a serialization schema by adding a parameter of type <code>typeType</code> and key <code><!--a  -->keySOAPSchemaVersion<!--/a--></code> to the direct object of a SOAP request Apple event. If you do not specify a schema, the default is <code><!--a  -->kSOAP1999Schema<!--/a--></code>.</p><a name="//apple_ref/doc/uid/20001721-DontLinkElementID_9" title="Listing 1-4Constants for specifying a SOAP schema."></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJDCHFD" title="Listing 1-4Constants for specifying a SOAP schema."></a><strong>Listing 1-4&nbsp;&nbsp;</strong>Constants for specifying a SOAP schema.</p><div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>    kSOAP1999Schema = 'ss99',<span></span></pre></td></tr><tr><td scope="row"><pre>    kSOAP2001Schema = 'ss01',<span></span></pre></td></tr><tr><td scope="row"><pre>    //...<span></span></pre></td></tr><tr><td scope="row"><pre>    keySOAPSchemaVersion = 'ssch'<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div><p><span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJDDEGC">Listing 2-5</a></span> shows some of the constants you use to identify the components of an XML-RPC or SOAP request. When you create a remote procedure call Apple event, you use these constants to add various information about the request to the direct object of the Apple event:</p><ul class="spaceabove"><li class="li"><p>You use the key <code><!--a  -->keyRPCMethodName<!--/a--></code> to add an Apple event parameter that specifies the procedure or method name for the request.</p></li><li class="li"><p>After you build a descriptor list that describes the parameters for a remote procedure call, you insert it into the direct object for the Apple event using the key <code><!--a  -->keyRPCMethodParam<!--/a--></code>.</p></li><li class="li"><p>For a SOAP request, you add the required SOAPAction header to the direct object using the key <code><!--a  -->keySOAPAction<!--/a--></code>.</p></li><li class="li"><p>For a SOAP request, you add the required SOAP name space URI to the direct object using the key <code><!--a  -->keySOAPMethodNameSpaceURI<!--/a--></code>.</p></li></ul><a name="//apple_ref/doc/uid/20001721-DontLinkElementID_10" title="Listing 1-5Constants used in constructing an XML-RPC or SOAP request in a remote procedure call Apple event."></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJDDEGC" title="Listing 1-5Constants used in constructing an XML-RPC or SOAP request in a remote procedure call Apple event."></a><strong>Listing 1-5&nbsp;&nbsp;</strong>Constants used in constructing an XML-RPC or SOAP request in a remote procedure call Apple event.</p><div class="codesample"><table><tr><td scope="row"><pre>    keyRPCMethodName    = 'meth', /* name of the method to call */<span></span></pre></td></tr><tr><td scope="row"><pre>    keyRPCMethodParam   = 'parm', /* the list (or structure) of parameters*/<span></span></pre></td></tr><tr><td scope="row"><pre>    keySOAPAction       = 'sact', /* the SOAPAction header */<span></span></pre></td></tr><tr><td scope="row"><pre>    keySOAPMethodNameSpaceURI= 'mspu',/* Required namespace URI */<span></span></pre></td></tr></table></div><p><span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJCABGI">Listing 2-6</a></span> shows constants you can specify in an attribute to a remote procedure call Apple event to turn on Apple Event Manager debugging. Depending on which debug information you specify with these constants, the reply Apple event from an XML-RPC or SOAP request can supply the header or the body of the outgoing request, or of the reply.</p><a name="//apple_ref/doc/uid/20001721-DontLinkElementID_11" title="Listing 1-6Constants for turning on the Apple Event Manager&acirc;&#128;&#153;s remote procedure call debugging."></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJCABGI" title="Listing 1-6Constants for turning on the Apple Event Manager&acirc;&#128;&#153;s remote procedure call debugging."></a><strong>Listing 1-6&nbsp;&nbsp;</strong>Constants for turning on the Apple Event Manager’s remote procedure call debugging.</p><div class="codesample"><table><tr><td scope="row"><pre>enum {<span></span></pre></td></tr><tr><td scope="row"><pre>    kAEDebugPOSTHeader = (1 &lt;&lt; 0), /* headers of the HTTP post - typeChar */<span></span></pre></td></tr><tr><td scope="row"><pre>    kAEDebugReplyHeader = (1 &lt;&lt; 1), /* headers returned by the server */<span></span></pre></td></tr><tr><td scope="row"><pre>    kAEDebugXMLRequest = (1 &lt;&lt; 2), /* the XML request we sent */<span></span></pre></td></tr><tr><td scope="row"><pre>    kAEDebugXMLResponse = (1 &lt;&lt; 3), /* the XML reply from the server */<span></span></pre></td></tr><tr><td scope="row"><pre>    kAEDebugXMLDebugAll = 0xffffffff/* everything! */<span></span></pre></td></tr><tr><td scope="row"><pre>};<span></span></pre></td></tr></table></div><p>Depending on which debugging flags you specify with the constants shown in <span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJCABGI">Listing 2-6</a></span>, one or more attributes is added to the Apple event. You can extract those attributes using the keys shown in <span class="content_text"><a href="soapXMLRPC_about.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJDABEF">Listing 2-7</a></span>.</p><a name="//apple_ref/doc/uid/20001721-DontLinkElementID_12" title="Listing 1-7Key constants for remote procedure call debugging attributes."></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJDABEF" title="Listing 1-7Key constants for remote procedure call debugging attributes."></a><strong>Listing 1-7&nbsp;&nbsp;</strong>Key constants for remote procedure call debugging attributes.</p><div class="codesample"><table><tr><td scope="row"><pre>    keyAEPOSTHeaderData = 'phed', /* header of request to the server */<span></span></pre></td></tr><tr><td scope="row"><pre>    keyAEReplyHeaderData = 'rhed', /* header of server reply */<span></span></pre></td></tr><tr><td scope="row"><pre>    keyAEXMLRequestData = 'xreq', /* body of request to the server */<span></span></pre></td></tr><tr><td scope="row"><pre>    keyAEXMLReplyData = 'xrep', /* body of server reply */<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJGDHHJ" title="Sending an XML-RPC Apple Event"></a><h4>Sending an XML-RPC Apple Event</h4><p>To make an XML-RPC request from your application or other code, you’ll need to create an Apple event that encapsulates the procedure call and call <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/AESend" target="_top">AESend</a></code> to send it. This section describes the steps you need to follow. To see those steps implemented in code, see <span class="content_text"><a href="../chapter4/soapXMLRPC_apps.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001724-BCIGIJEB">“Making an XML-RPC Call.”</a></span></p><p>To use an Apple event to execute an XML-RPC request, you do the following:</p><ol class="ol"><li class="li"><p>Link with <code>Carbon.framework</code>.</p></li><li class="li"><p>Create a target address descriptor of type <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/typeApplicationURL" target="_top">typeApplicationURL</a></code> that specifies the target for the request (a remote server).</p></li><li class="li"><p>Create an Apple event with event class <code><!--a  -->kAERPCClass<!--/a--></code>, event ID <code><!--a  -->KAEXMLRPCScheme<!--/a--></code>, and with the target address descriptor created in a previous step.</p></li><li class="li"><p>Create the direct object for the Apple event.</p></li><li class="li"><p>Insert the method name, using the key <code><!--a  -->keyRPCMethodName<!--/a--></code>.</p></li><li class="li"><p>Create a list descriptor for the remote procedure call parameters and insert each parameter (using the key <code><!--a  -->keyRPCMethodParam<!--/a--></code>).</p></li><li class="li"><p>Add the parameter list to the direct object.</p></li><li class="li"><p>Insert the direct object into the Apple event.</p></li><li class="li"><p>Optionally turn on debugging by adding an attribute to the event with key <code><!--a  -->keyXMLDebuggingAttr<!--/a--></code>.</p></li><li class="li"><p>Send the Apple event with <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/AESend" target="_top">AESend</a></code>.</p></li><li class="li"><p>Process the reply Apple event to extract any needed information. If you turned on debugging, you can extract debugging information, according to which of the debugging constants (described above) you specified. For example, you can examine the header or the body of the posted message, or of the reply.</p></li></ol><a name="//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001721-BAJGIEIA" title="Sending a SOAP Apple Event"></a><h4>Sending a SOAP Apple Event</h4><p>To make a SOAP request from your application or other code, you’ll need to create an Apple event that encapsulates the request and call <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/AESend" target="_top">AESend</a></code> to send it. This section describes the steps you need to follow. To see those steps implemented in code, see <span class="content_text"><a href="../chapter4/soapXMLRPC_apps.html#//apple_ref/doc/uid/TP30001126-//apple_ref/doc/uid/20001724-BCIDEFFJ">“Making a SOAP Request.”</a></span></p><p>To use an Apple event to execute a SOAP request, you do the following:</p><ol class="ol"><li class="li"><p>Link with <code>Carbon.framework</code>.</p></li><li class="li"><p>Create a target address descriptor of type <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/typeApplicationURL" target="_top">typeApplicationURL</a></code> that specifies the target for the request (a remote server).</p></li><li class="li"><p>Create an Apple event with event class <code><!--a  -->kAERPCClass<!--/a--></code>, event ID <code><!--a  -->kAESOAPScheme<!--/a--></code>, and with the target address descriptor created in a previous step.</p></li><li class="li"><p>Create the direct object for the Apple event.</p></li><li class="li"><p>Insert the method name, using the key <code><!--a  -->keyRPCMethodName<!--/a--></code>.</p></li><li class="li"><p>Create a list descriptor for the SOAP method parameters and insert each parameter as character data.</p></li><li class="li"><p>Add the parameter list to the direct object, using the key <code><!--a  -->keyRPCMethodParam<!--/a--></code>.</p></li><li class="li"><p>Add the SOAP name space URI to the direct object, using the key <code><!--a  -->keySOAPMethodNameSpaceURI<!--/a--></code>.</p></li><li class="li"><p>Insert the direct object into the Apple event.</p></li><li class="li"><p>Optionally turn on debugging by adding an attribute to the event with key <code><!--a  -->keyXMLDebuggingAttr<!--/a--></code>.</p></li><li class="li"><p>Send the Apple event with <code><a href="../../../../Carbon/Reference/Apple_Event_Manager/Reference/reference.html#//apple_ref/doc/c_ref/AESend" target="_top">AESend</a></code>.</p></li><li class="li"><p>Process the reply Apple event to extract any needed information. If you turned on debugging, you can extract debugging information, according to which of the constants described above you specified. For example, you may be able to examine the header or the body of the posted message, or of the reply.</p></li></ol>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter1/soapXMLRPC_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter3/soapXMLRPC_scripts.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-03-03<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/soapXMLRPC/chapter2/soapXMLRPC_about.html%3Fid%3DTP30001126-2.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/soapXMLRPC/chapter2/soapXMLRPC_about.html%3Fid%3DTP30001126-2.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/soapXMLRPC/chapter2/soapXMLRPC_about.html%3Fid%3DTP30001126-2.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>