<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> NewWorld Boot Process</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.26.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.35.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.37.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H2.Heading2"><A NAME="pgfId=3411"> </A><A NAME="12566"> </A>NewWorld Boot Process</H1><P CLASS="T1.Text1"><A NAME="pgfId=3412"> </A>The following list provides a high-level overview of the execution path taken when a NewWorld-based computer boots the Mac OS:</P><OL><LI CLASS="N/.NList=1"><A NAME="pgfId=3413"> </A>User presses power key. Between the time that the power key is pressed and the boot beep is heard, while the screen is still black, a ROM checksum is taken, the processor is checked, the interrupt controller is started, all the clocks are determined, the memory controller is initialized, NVRAM is checked, RAM is sized checked and initialized, and the L2 cache is sized and prepared (L2 cache is enabled in POST).</LI><LI CLASS="N.NList"><A NAME="pgfId=4211"> </A>The POST code runs (preliminary diagnostics, boot beep, initialization, and setup). This is like similar code in an older Macintosh ROM, but it is different in that it does not contain code specific to an operating system.</LI><LI CLASS="N.NList"><A NAME="pgfId=3414"> </A>Open Firmware initializes begins probing the hardware and the PCI bus to locate attached interfaces and hardware so that is can begin building the device tree.</LI><LI CLASS="N.NList"><A NAME="pgfId=3415"> </A>Open Firmware loads the Mac OS ROM image file, based on defaults and the path settings found in NVRAM.</LI><LI CLASS="N.NList"><A NAME="pgfId=3416"> </A>Open Firmware executes the Forth script in the bootinfo file, which contains information about the rest of the file and instructions to read both the Trampoline code and the Mac OS ROM file and place them into a temporary place in memory.</LI><LI CLASS="N.NList"><A NAME="pgfId=3417"> </A>The Forth script transfers control to the Trampoline code, which functions as the transition between Open Firmware and the beginning of the Mac OS execution.</LI><LI CLASS="N.NList"><A NAME="pgfId=3418"> </A>The Trampoline code gathers information about the system from Open Firmware, creates data structures based on this information, terminates Open Firmware, and moves the contents of memory to an interim location in physical memory space. </LI><LI CLASS="N.NList"><A NAME="pgfId=3419"> </A>The Trampoline code transfers control to the Mac OS ROM initialization code.</LI></OL><P CLASS="T1.Text1"><A NAME="pgfId=3420"> </A>The boot sequence, up to loading and execution of the Mac OS ROM bootinfo file, is controlled by Open Firmware. To provide a user experience like that of previous Macintosh computers, Open Firmware supports keyboard input for searching for possible boot devices, and user redirection of boot devices. The keyboard input is done by holding down a specific key or key combinations. These keys are referred to as snag keys. The supported snag keys are listed in <A HREF="PCI_BOOK.36.html#25834" CLASS="XRef">Table&nbsp;3-1</A>.</P><b><P CLASS="Tb.Table"><A NAME="pgfId=3894"> </A>Table&nbsp;3-1	<A NAME="25834"> </A>Snag keys supported by Macintosh Open Firmware</P></b><TABLE border=1 cellpadding=3><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=3898"> </A>Key or key combination</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=3900"> </A>Definition</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3902"> </A>c</FONT></TD><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3904"> </A>Redirect booting to the device alias CD. If no bootable partition is found on the CD, display blinking folder.</FONT></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3906"> </A>d</FONT></TD><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3908"> </A>Redirect booting to the device alias hard drive. If no bootable partition is found on the hard drive, display blinking folder.</FONT></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3910"> </A>n</FONT></TD><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3912"> </A>Redirect booting to the device alias <TT CLASS="cv">enet</TT> for BOOTP or TFTP network booting. </FONT></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3914"> </A>z</FONT></TD><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3916"> </A>Redirect booting to the device alias ZIP. If no bootable partition is found on the Zip drive, display blinking folder.</FONT></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3918"> </A>Command-option-shift-delete</FONT></TD><TD ROWSPAN="1" COLSPAN="1"><FONT CLASS="TbT.TblText"><A NAME="pgfId=3920"> </A>Redirect booting to any device other than the device specified in the device alias boot-device. </FONT></TD></TR></TABLE><P CLASS="T1.Text1"><A NAME="pgfId=3421"> </A>When the user selects a startup device in the Startup Disk control panel, the control panel no longer sets a value in Mac OS PRAM, but rather generates an Open Firmware path to the device and saves that path in NVRAM as Open Firmware's <TT CLASS="cv">boot-device</TT> config variable. Open Firmware tries booting from the device specified by <TT CLASS="cv">boot-device</TT> first. If this device is unavailable or the user has overridden the standard startup behavior with keyboard input, Open Firmware scans other devices looking for bootable drives. Once Open Firmware selects a device, it reports a path to that device in the <TT CLASS="cv">bootpath </TT>property in the chosen device tree node. The <TT CLASS="cv">bootpath </TT>property is what the Mac OS ROM subsequently uses to locate and load the Mac OS from disk.</P><P CLASS="T1.Text1"><A NAME="pgfId=3423"> </A>Additional information about the requirements for participating in the boot process on a NewWorld-compatible Macintosh can be found in <A HREF="PCI_BOOK.3a.html#27578" CLASS="XRef">Startup and System Configuration</A></P><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.26.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.35.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.37.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>