<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>DragGrayRgn(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING247></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-246.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-248.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-188.html"><B>Chapter 4 - Window Manager</B></A> / <A HREF="Toolbox-213.html"><B>Window Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-221.html"><B>Window Manager Routines</B></A> / <A HREF="Toolbox-244.html"><B>Moving Windows</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING247-0></A>
<H3>DragGrayRgn</H3>
 <A NAME=MARKER-11-441></A><A NAME=MARKER-2-408></A>The <CODE>DragWindow</CODE> function calls the <CODE>DragGrayRgn</CODE> function to move an outline of a window around the screen as the user drags a window.<P>
<PRE>
FUNCTION DragGrayRgn (theRgn: RgnHandle; startPt: Point;
                        limitRect, slopRect: Rect; axis: Integer;
                        actionProc: ProcPtr): LongInt;
</PRE>
<DL>
<DT>theRgn
<DD> A handle to the region to be dragged.
<DT>startPt
<DD> The location, in the local coordinates of the current graphics port, of the cursor when the mouse button was pressed.
<DT>limitRect
<DD> A rectangle, in the local coordinates of the current graphics port, that limits where the region can be dragged. This parameter works in conjunction with the <CODE>slopRect</CODE> parameter, as illustrated in <A HREF=#MARKER-9-443>Figure 4-23 on page 4-90</A>.
<DT><CODE>slopRect</CODE>
<DD> A rectangle, in the local coordinates of the current graphics port, that gives the user some leeway in moving the mouse without violating <BR>the limits of the <CODE>limitRect</CODE> parameter, as illustrated in <A HREF=#MARKER-9-443>Figure 4-23 on page 4-90</A>. The <CODE>slopRect</CODE> rectangle should be larger than the <CODE>limitRect</CODE> rectangle. 
<DT><CODE>axis</CODE>
<DD> A constant that constrains the region's motion. The <CODE>axis</CODE> parameter can have one of these values:
</DL>
<PRE>
            CONST noConstraint   = 0;  {no constraints}
                  hAxisOnly      = 1;  {move on horizontal axis }
                                       { only}
                  vAxisOnly      = 2;  {move on vertical axis }
                                       { only}
</PRE>
<DL>
<DT>
<DD> If an axis constraint is in effect, the outline follows the cursor's movements along only the specified axis, ignoring motion along the other axis. With or without an axis constraint, the outline appears only when the mouse is inside the <CODE>slopRect</CODE> rectangle.
<DT><CODE>actionProc</CODE>
<DD> A pointer to a procedure that defines an action to be performed repeatedly as long as the user holds down the mouse button. The procedure can have no parameters. If the value of <CODE>actionProc</CODE> is <CODE>NIL</CODE>, <CODE>DragGrayRgn</CODE> simply retains control until the mouse button is released.
</DL>
<A NAME=HEADING247-11></A>
<H5>DESCRIPTION</H5>
 The <CODE>DragGrayRgn</CODE> function moves a gray outline of a region on the screen, following the movements of the cursor, until the mouse button is released. It returns the difference between the point where the mouse button was pressed and the <B>offset point</B>--that is, the point in the region whose horizontal and vertical offsets from the upper-left corner of the region's enclosing rectangle are the same as the offsets of the starting point when the user pressed the mouse button. The <CODE>DragGrayRgn</CODE> function stores the vertical difference between the starting point and the offset point in the high-order word of the return value and the horizontal difference in the low-order word.<P>
 The <CODE>DragGrayRgn</CODE> function limits the movement of the region according to the constraints set by the <CODE>limitRect</CODE> and <CODE>slopRect</CODE> parameters: <P>
<UL>
<LI>As long as the cursor is inside the <CODE>limitRect</CODE> rectangle, the region's outline follows it normally. If the mouse button is released while the cursor is within this rectangle, the return value reflects the simple distance that the cursor moved in each dimension.
<LI>When the cursor moves outside the <CODE>limitRect</CODE> rectangle, the offset point stops at the edge of the <CODE>limitRect</CODE> rectangle. If the mouse button is released while the cursor <BR>is outside the <CODE>limitRect</CODE> rectangle but inside the <CODE>slopRect</CODE> rectangle, the return value reflects only the difference between the starting point and the offset point, regardless of how far outside of the <CODE>limitRect</CODE> rectangle the cursor may have moved. (Note that part of the region can fall outside the <CODE>limitRect</CODE> rectangle, but not the offset point.)
<LI>When the cursor moves outside the <CODE>slopRect</CODE> rectangle, the region's outline disappears from the screen. The <CODE>DragGrayRgn</CODE> function continues to track the cursor, however, and if the cursor moves back into the <CODE>slopRect</CODE> rectangle, the outline reappears. If the mouse button is released while the cursor is outside the <CODE>slopRect</CODE> rectangle, both words of the return value are set to $8000. In this case, the Window Manager does not move the window from its original location.<P>
</UL>
 <A HREF=#MARKER-9-443>Figure 4-23 on page 4-90</A> illustrates how the region stops moving when the offset point reaches the edge of the <CODE>limitRect</CODE> rectangle. The cursor continues to move, but the region does not.<P>
 If the mouse button is released while the cursor is anywhere inside the <CODE>slopRect</CODE> rectangle, the Window Manager redraws the window in its new location, which is calculated from the value returned by <CODE>DragGrayRgn</CODE>.<P>
<B>Figure 4-23  <A NAME=MARKER-9-443></A>Limiting rectangle used by <CODE>DragGrayRgn</CODE></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/WM-L-13.jpg"><P>
<A NAME=HEADING247-21></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 <DFN>You can set the global variable <CODE>DragHook to point to an optional procedure, defined <BR>by your application, which will be called by DragGrayRgn</CODE></DFN> as long as the mouse <BR>button is held down. (If there's an <CODE>actionProc</CODE> procedure, it is called first.) If you <BR>want <CODE>DragGrayRgn</CODE> to draw the region's outline in a pattern other than gray, you <BR>can store the pattern in the global variable <CODE>DragPattern</CODE> and then invoke the macro <CODE>_DragTheRgn</CODE>. Note that the use of the Window Manager's global variables is not guaranteed to be compatible with system software versions later than System 6.<A NAME=MARKER-2-445></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-246.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-248.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
