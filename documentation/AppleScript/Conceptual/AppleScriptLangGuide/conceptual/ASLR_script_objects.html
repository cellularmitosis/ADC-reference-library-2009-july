<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Language Guide: Script Objects</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Script Objects"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000983-CH207" title="Script Objects"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../index.html" target="_top">AppleScript Language Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_variables.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ASLR_about_handlers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000983-CH207-BAJJCIAA" title="Script Objects"></a><h1>Script Objects</h1><p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_440"></a>This chapter describes the <code>script</code> object, which is used to implement all AppleScript scripts. Before reading this chapter, you should be familiar with the information in <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW1">“AppleScript and Objects.”</a></span></p><p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_441"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_442"></a>A <strong>script object</strong> is a user-defined object that can combine data (in the form of properties) and actions (in the form of handlers and additional <code>script</code> objects). Script objects support inheritance, allowing you to define a hierarchy of objects that share properties and handlers. You can also extend or modify the behavior of a handler in one <code>script</code> object when calling it from another <code>script</code> object.</p><p>The top-level <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5">script</a></code> object is the one that implements the overall script you are working on. Any <code>script</code> object can contain nested <code>script</code> objects, each of which is defined just like a top-level <code>script</code> object, except that a nested <code>script</code> object is bracketed with statements that mark its beginning and end.</p>
<p>This chapter describes <code>script</code> objects in the following sections:</p>
<ul class="ul">
<li class="li"><p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW2">“Defining Script Objects”</a></span> shows the syntax for defining <code>script</code> objects and includes a simple example .</p></li>
<li class="li"><p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW4">“Initializing Script Objects”</a></span> describes how AppleScript creates a <code>script</code> object with the properties and handlers you have defined.</p></li>
<li class="li"><p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW3">“Sending Commands to Script Objects”</a></span> describes how you use <code>tell</code> statements to send commands to <code>script</code> objects.</p></li>
<li class="li"><p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW5">“Inheritance in Script Objects”</a></span> describes inheritance works and how you can use it to share functionality in the <code>script</code> objects you define.</p></li></ul>
<a name="//apple_ref/doc/uid/TP40000983-CH207-SW2" title="Defining Script Objects"></a><h2>Defining Script Objects</h2>
<p>Each <code>script</code> object definition (except for the top-level <code>script</code> object) begins with the keyword <code>script</code>, followed by a variable name, and ends with the keyword <code>end</code> (or <code>end script</code>). The statements in between can be any combination of property definitions, handler definitions, nested <code>script</code> object definitions, and other AppleScript statements.</p>
<p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_443"></a>The syntax of a <code>script</code> object definition is as follows:</p><p><code>script</code> <em>variableName</em></p><p>    [ ( <code>property</code> | <code>prop</code> ) <code>parent :</code> <em>parentSpecifier</em> ]</p><p>    [ ( <code>property</code> | <code>prop</code> ) <em>propertyLabel</em> : <em>initialValue</em> ]...</p><p>    [ <em>handlerDefinition</em> ]...</p><p>    [ <em>statement</em> ]...</p><p><code>end</code> [ <code>script</code> ]</p><dl class="termdef">	<dt><em>variableName</em></dt><dd><p>A variable identifier for the script. You can refer to a script object by this name elsewhere in a script.</p></dd><dt><em>parentSpecifier</em></dt><dd><p>Specifies the parent of the <code>script</code> object, typically another <code>script</code> object.</p><p>For more information, see <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW5">“Inheritance in Script Objects.”</a></span></p></dd><dt><em>propertyLabel</em></dt><dd><p>An identifier, unique within the <code>script</code> object, that specifies a characteristic of the  object; equivalent to an instance variable.<a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_444"></a></p></dd><dt><em>initialValue</em></dt><dd><p>The value that is assigned to the property each time the <code>script</code> object is initialized. <code>script</code> objects are initialized when compiled. <em>initialValue</em> is required in property definitions.</p></dd><dt><em>handlerDefinition</em></dt><dd><p>A handler for a command the <code>script</code> object can respond to; equivalent to a method. For more information, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-CJBIDBJH">“About Handlers”</a></span> and <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163762">“Handler Reference.”</a></span></p></dd><dt><em>statement</em></dt><dd><p>Any AppleScript statement. Statements other than handler and property definitions are treated as if they were part of an implicit handler definition for the <code>run</code> command; they are executed when a <code>script</code> object receives the <code>run</code> command.<a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_445"></a></p></dd></dl><p>Here is a simple <code>script</code> object definition:</p><div class="codesample"><table><tr><td scope="row"><pre>script John<span></span></pre></td></tr><tr><td scope="row"><pre>    property HowManyTimes : 0<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    to sayHello to someone<span></span></pre></td></tr><tr><td scope="row"><pre>        set HowManyTimes to HowManyTimes + 1<span></span></pre></td></tr><tr><td scope="row"><pre>        return "Hello " &amp; someone<span></span></pre></td></tr><tr><td scope="row"><pre>    end sayHello<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr></table></div><p>It defines a <code>script</code> object that can handle the <code>sayHello</code> command. It assigns the <code>script</code> object to the variable <code>John</code>. The definition includes a handler for the <code>sayHello</code> command. It also includes a property, called <code>HowManyTimes</code>, that indicates how many times the <code>sayHello</code> command has been called.</p><p>A handler within a <code>script</code> object definition follows the same syntax rules as any other handler.</p><p>You can use a <code>tell</code> statement to send commands to a <code>script</code> object. For example, the following statement sends the <code>sayHello</code> command the <code>script</code> object defined above.</p><div class="codesample"><table><tr><td scope="row"><pre>tell John to sayHello to "Herb" --result: "Hello Herb"<span></span></pre></td></tr></table></div><p>You can manipulate the properties of <code>script</code> objects by using the <code>get</code> command to get the value of a property and the <code>set</code> or <code>copy</code> command to change the value. The value of a property is persistent—it gets reset every time you compile the script, but not when you run it.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH207-SW4" title="Initializing Script Objects"></a><h2>Initializing Script Objects</h2>
<p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_446"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_447"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_448"></a>When you define a <code>script</code> object, it can contain properties, handlers, and nested <code>script</code> object definitions. When you execute the script containing it, AppleScript creates a <code>script</code> object with the defined properties, handlers, and nested <code>script</code> objects. The process of creating an instance of a <code>script</code> object from its definition is called initialization. A <code>script</code> object must be initialized before it can respond to commands.</p>
<p>A top-level <code>script</code> object is initialized each time the script’s <code>run</code> handler is executed. Similarly, if you define a script within a handler, AppleScript initializes a <code>script</code> object each time the handler is called. The parameter variables in the handler definition become local variables of the <code>script</code> object.<a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_449"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_450"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_451"></a></p><p>For example, the <code>makePoint</code> handler in the following script contains a <code>script</code> object definition for the <code>script</code> object <code>thePoint</code>:</p>
<div class="codesample"><table><tr><td scope="row"><pre>on makePoint(x, y)<span></span></pre></td></tr><tr><td scope="row"><pre>    script thePoint<span></span></pre></td></tr><tr><td scope="row"><pre>        property xCoordinate:x<span></span></pre></td></tr><tr><td scope="row"><pre>        property yCoordinate:y<span></span></pre></td></tr><tr><td scope="row"><pre>    end script<span></span></pre></td></tr><tr><td scope="row"><pre>    return thePoint<span></span></pre></td></tr><tr><td scope="row"><pre>end makePoint<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>set myPoint to makePoint(10,20)<span></span></pre></td></tr><tr><td scope="row"><pre>get xCoordinate of myPoint  --result: 10<span></span></pre></td></tr><tr><td scope="row"><pre>get yCoordinate of myPoint  --result: 20<span></span></pre></td></tr></table></div>
<p>AppleScript initializes the <code>script</code> object <code>thePoint</code> when it executes the <code>makePoint</code> command. After the call to <code>makePoint</code>, the variable <code>myPoint</code> refers to this <code>script</code> object. The parameter variables in the <code>makePoint</code> handler, in this case, <code>x</code> and <code>y</code>, become local variables of the <code>script</code> object. The initial value of <code>x</code> is 10, and the initial value of <code>y</code> is 20, because those are the parameters passed to the <code>makePoint</code> handler that initialized the <code>script</code> object.</p><p>If you added the following line to the end of the previous script and ran it, the variable <code>myOtherPoint</code> would refer to a second instance of the <code>script</code> object <code>thePoint</code>, with different property values:</p><div class="codesample"><table><tr><td scope="row"><pre>set myOtherPoint to makePoint(30,50)<span></span></pre></td></tr></table></div>
<p>The <code>makePoint</code> script is a kind of constructor function that creates <code>script</code> objects representing points.<a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_452"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_453"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_454"></a> <a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_455"></a></p>
<a name="//apple_ref/doc/uid/TP40000983-CH207-SW3" title="Sending Commands to Script Objects"></a><h2>Sending Commands to Script Objects</h2>
<p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_456"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_457"></a>You can use <code>tell</code> statements to send commands to <code>script</code> objects. For example, the following <code>tell</code> statement sends two <code>sayHello</code> commands to the <code>script</code> object <code>John</code> (defined below):</p>
<div class="codesample"><table><tr><td scope="row"><pre>tell John<span></span></pre></td></tr><tr><td scope="row"><pre>    sayHello to "Herb"<span></span></pre></td></tr><tr><td scope="row"><pre>    sayHello to "Grace"<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div>
<p>For a <code>script</code> object to respond to a command within a <code>tell</code> statement, either the <code>script</code> object or its parent object must have a handler for the command. For more information about parent objects, see <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW5">“Inheritance in Script Objects.”</a></span></p>
<p>A <code>script</code> object definition may include an implicit <code>run</code> handler, consisting of all executable statements that are outside of any handler or nested <code>script</code> object, or it may include an explicit <code>run</code> handler that begins with <code>on run</code>, but it may not contain both—such a script will not compile. If a script has no run handler (for example, a script that serves as a library of handlers, as described in <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW12">“Saving and Loading Libraries of Handlers”</a></span>), executing the script does nothing. However, sending it an explicit <code>run</code> command causes an error. For more information, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW15">“run Handlers.”</a></span></p>
<p>The <code>display dialog</code> command in the following <code>script</code> object definition is the only executable statement at the top level, so it constitutes the <code>script</code> object’s implicit <code>run</code> handler and is executed when the script sends a <code>run</code> command to <code>script</code> object <code>John</code>, with the statement <code>tell John to run</code>. <a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_458"></a></p>
<div class="codesample"><table><tr><td scope="row"><pre>script John<span></span></pre></td></tr><tr><td scope="row"><pre>    property HowManyTimes : 0<span></span></pre></td></tr><tr><td scope="row"><pre>    to sayHello to someone<span></span></pre></td></tr><tr><td scope="row"><pre>        set HowManyTimes to HowManyTimes + 1<span></span></pre></td></tr><tr><td scope="row"><pre>        return "Hello " &amp; someone<span></span></pre></td></tr><tr><td scope="row"><pre>    end sayHello<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "John received the run command"<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell John to run<span></span></pre></td></tr></table></div><p>You can also use the possessive to send a command to a <code>script</code> object. For example, either of the following two forms send the <code>sayHello</code> command to script <code>John</code> (the first version compiles into the second):</p><div class="codesample"><table><tr><td scope="row"><pre>John's sayHello to "Jake" --result: "Hello Jake"<span></span></pre></td></tr><tr><td scope="row"><pre>sayHello of John to "Jake" --result: "Hello Jake"<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH207-SW5" title="Inheritance in Script Objects"></a><h2>Inheritance in Script Objects</h2>
<p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_459"></a>You can use the AppleScript inheritance mechanism to define related <code>script</code> objects in terms of one another. This allows you to share property and handler definitions among many <code>script</code> objects without repeating the shared definitions. Inheritance is described in the following sections:</p>
<ul class="ul"><li class="li"><p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW15">“The AppleScript Inheritance Chain”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW7">“Defining Inheritance Through the parent Property”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW8">“Some Examples of Inheritance”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW9">“Using the continue Statement in Script Objects”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP40000983-CH207-SW15" title="The AppleScript Inheritance Chain"></a><h3>The AppleScript Inheritance Chain</h3><p>The top-level <code>script</code> object is the parent of all other <code>script</code> objects, although any <code>script</code> object can specify a different parent object. The top-level <code>script</code> object also has a parent—AppleScript itself (the AppleScript component). And even AppleScript has a parent—the current application. The name of that application (which is typically Script Editor) can be obtained through the global constant <code>current application</code>. This hierarchy defines the <strong>inheritance chain</strong> that AppleScript searches to find the target for a command or the definition of a term.</p><p>Every <code>script</code> object has access to the properties, handlers, and script objects it defines, as well as to those defined by its parent, and those of any other object in the inheritance chain, including AppleScript. That’s why the constants and properties described in <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-BAJBDEJI">“Global Constants in AppleScript”</a></span> are available to any script.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH207-SW1" title="Note"></a><p><strong>Note:</strong>&nbsp;There is an exception to the previous claim. An explicit <code>local</code> variable can <em>shadow</em><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_460"></a> (or block access to) a <code>global</code> variable or property with the same name, making the global version inaccessible in the scope of the handler or <code>script</code> object. For related information, see <span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW1">“Scope of Variables and Properties.”</a></span></p></div>
<a name="//apple_ref/doc/uid/TP40000983-CH207-SW7" title="Defining Inheritance Through the parent Property"></a><h3>Defining Inheritance Through the parent Property</h3>
<p>When working with <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5">script</a></code> objects, <strong>inheritance</strong> is the ability of a child <code>script</code> object to take on the properties and handlers of a parent object. You specify inheritance with the <code>parent</code> property.<a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_461"></a></p>
<p>The object listed in a <code>parent</code> property definition is called the <a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_462"></a> <a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_463"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_464"></a><strong>parent object</strong>, or parent. A <code>script</code> object that includes a <code>parent</code> property is referred to as a <strong>child script object</strong> <a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_465"></a>  <a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_466"></a>, or child. The <code>parent</code> property is not required, though if one is not specified, every script is a child of the top-level script, as described in <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW15">“The AppleScript Inheritance Chain.”</a></span> A <code>script</code> object can have many children, but a child <code>script</code> object can have only one parent. The parent object may be any object, such as a <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDBHIE">list</a></code> or an <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW2">application</a></code> object, but it is typically another <code>script</code> object.</p>
<p>The syntax for defining a parent object is</p><p>( <code>property</code> | <code>prop</code> )<code> parent :</code> <em>variable</em></p><dl class="termdef">	<dt><em>variable</em></dt><dd><p>An identifier for a variable that refers to the parent object.</p></dd></dl>
<p>A <code>script</code> object must be initialized before it can be assigned as a parent of another <code>script</code> object. This means that the definition of a parent <code>script</code> object (or a command that calls a function that creates a parent <code>script</code> object) must come before the definition of the child in the same script.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH207-SW8" title="Some Examples of Inheritance"></a><h3>Some Examples of Inheritance</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_467"></a>The inheritance relationship between <code>script</code> objects should be familiar to those who are acquainted with C++ or other object-oriented programming languages. A child <code>script</code> object that inherits the handlers and properties defined in its parent is like a C++ class that inherits methods and instance variables from its parent class. If the child does not have its own definition of a property or handler, it uses the inherited property or handler. If the child has its own definition of a particular property or handler, then it ignores (or overrides) the inherited property or handler.</p>
<p><span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-SW10">Listing 4-1</a></span> shows the definitions of a parent <code>script</code> object called <code>Alex</code> and a child <code>script</code> object called <code>AlexJunior</code>.</p><a name="//apple_ref/doc/uid/TP40000983-CH207-SW10" title="Listing 4-1A pair of script objects with a simple parent-child relationship"></a><p class="codesample"><strong>Listing 4-1&nbsp;&nbsp;</strong>A pair of script objects with a simple parent-child relationship</p><div class="codesample"><table><tr><td scope="row"><pre>script Alex<span></span></pre></td></tr><tr><td scope="row"><pre>    on sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre>        return "Hello, " &amp; getName()<span></span></pre></td></tr><tr><td scope="row"><pre>    end sayHello<span></span></pre></td></tr><tr><td scope="row"><pre>    on getName()<span></span></pre></td></tr><tr><td scope="row"><pre>        return "Alex"<span></span></pre></td></tr><tr><td scope="row"><pre>    end getName<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>script AlexJunior<span></span></pre></td></tr><tr><td scope="row"><pre>    property parent : Alex<span></span></pre></td></tr><tr><td scope="row"><pre>    on getName()<span></span></pre></td></tr><tr><td scope="row"><pre>        return "Alex Jr"<span></span></pre></td></tr><tr><td scope="row"><pre>    end getName<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-- Sample calls to handlers in the script objects:<span></span></pre></td></tr><tr><td scope="row"><pre>tell Alex to sayHello() --result: "Hello, Alex"<span></span></pre></td></tr><tr><td scope="row"><pre>tell AlexJunior to sayHello() --result: "Hello, Alex Jr."<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell Alex to getName() --result: "Alex"<span></span></pre></td></tr><tr><td scope="row"><pre>tell AlexJunior to getName() --result: "Alex Jr"<span></span></pre></td></tr></table></div><p>Each <code>script</code> object defines a <code>getName()</code> handler to return its name. The <code>script</code> object <code>Alex</code> also defines the <code>sayHello()</code> handler. Because <code>AlexJunior</code> declares Alex to be its parent object, it inherits the <code>sayHello()</code> handler.</p><p>Using a <code>tell</code> statement to invoke the <code>sayHello()</code> handler of <code>script</code> object <code>Alex</code> returns <code>"Hello, Alex"</code>. Invoking the same handler of <code>script</code> object <code>AlexJunior</code> returns <code>"Hello, Alex Jr"</code>—although the same <code>sayHello()</code> handler in <code>Alex</code> is executed, when that handler calls <code>getName()</code>, it’s the <code>getName()</code> in <code>AlexJunior</code> that is executed.</p>
<p>The relationship between a parent <code>script</code> object and its child <code>script</code> objects is dynamic. If the properties of the parent change, so do the inherited properties of the children. For example, the <code>script</code> object <code>JohnSon</code> in the following script inherits its <code>vegetable</code> property from <code>script</code> object <code>John</code>.</p>
<div class="codesample"><table><tr><td scope="row"><pre>script John<span></span></pre></td></tr><tr><td scope="row"><pre>    property vegetable : "Spinach"<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre>script JohnSon<span></span></pre></td></tr><tr><td scope="row"><pre>    property parent : John<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre>set vegetable of John to "Swiss chard"<span></span></pre></td></tr><tr><td scope="row"><pre>vegetable of JohnSon<span></span></pre></td></tr><tr><td scope="row"><pre>--result: "Swiss chard"<span></span></pre></td></tr></table></div>
<p>When you change the <code>vegetable</code> property of <code>script</code> object <code>John</code> with the <code>set</code> command, you also change the <code>vegetable</code> property of the child <code>script</code> object <code>Simple</code>. The result of the last line of the script is <code>"Swiss chard"</code>.</p>
<p>Similarly, if a child changes one of its inherited properties, the value in the parent object also changes. For example, the <code>script</code> object <code>JohnSon</code> in the following script inherits the <code>vegetable</code> property from <code>script</code> object <code>John</code>.</p>
<div class="codesample"><table><tr><td scope="row"><pre>script John<span></span></pre></td></tr><tr><td scope="row"><pre>    property vegetable : "Spinach"<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre>script JohnSon<span></span></pre></td></tr><tr><td scope="row"><pre>    property parent : John<span></span></pre></td></tr><tr><td scope="row"><pre>    on changeVegetable()<span></span></pre></td></tr><tr><td scope="row"><pre>        set my vegetable to "Zucchini"<span></span></pre></td></tr><tr><td scope="row"><pre>    end changeVegetable<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre>tell JohnSon to changeVegetable()<span></span></pre></td></tr><tr><td scope="row"><pre>vegetable of John<span></span></pre></td></tr><tr><td scope="row"><pre>--result: "Zucchini"<span></span></pre></td></tr></table></div>
<p>When you change the <code>vegetable</code> property of <code>script</code> object <code>JohnSon</code> to <code>"Zucchini"</code> with the <code>changeVegetable</code> command, the <code>vegetable</code> property of <code>script</code> object <code>John</code> also changes.</p>
<p>The previous example demonstrates an important point about inherited properties: to refer to an inherited property from within a child <code>script</code> object, you must use the reserved word <code>my</code> or <code>of me</code> to indicate that the value to which you’re referring is a property of the current <code>script</code> object. (You can also use the words <code>of parent</code> to indicate that the value is a property of the parent <code>script</code> object.) If you don’t, AppleScript assumes the value is a local variable.</p>
<p>For example, if you refer to <code>vegetable</code> instead of <code>my vegetable</code> in the <code>changeVegetable</code> handler in the previous example, the result is <code>"Spinach"</code>. For related information, see <span class="content_text"><a href="ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW4">“The it and me Keywords.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH207-SW9" title="Using the continue Statement in Script Objects"></a><h3>Using the continue Statement in Script Objects</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_468"></a>In a child <code>script</code> object, you can define a handler with the same name as a handler defined in its parent object. In implementing the child handler, you have several options:</p><ul class="spaceabove"><li class="li"><p>The handler in the child <code>script</code> object can be independent of the one in its parent. This allows you to call either handler, as you wish.</p></li><li class="li"><p>The handler in the child can simply invoke the handler in its parent. This allows the child object to take advantage of the parent’s implementation (as shown in the <code>script</code> objects below that contain a <code>on identify</code> handler).</p></li><li class="li"><p>The handler in the child can invoke the handler in its parent, changing the values passed to it or executing additional statements before or after invoking the parent handler. This allows the child object to modify or add to the behavior of its parent, but still take advantage of the parent’s implementation.</p></li></ul><p>Normally, if a child <code>script</code> object and its parent both have handlers for the same command, the child uses its own handler. However, the handler in a child <code>script</code> object can handle a command first, and then use a <code>continue</code> statement to call the handler for the same command in the parent.</p>
<p>This handing off of control to another object is called <a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_469"></a><strong>delegation</strong>. By delegating commands to a parent <code>script</code> object, a child can extend the behavior of a handler contained in the parent without having to repeat the entire handler definition. After the parent handles the command, AppleScript continues at the place in the child where the <code>continue</code> statement was executed.</p>
<p>The syntax for a <code>continue</code> statement is shown in <code><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-SW1">“continue”</a></code>.</p>
<p>The following script includes two <code>script</code> object definitions, <code>Elizabeth</code> and <code>ChildOfElizabeth</code>.</p>
<div class="codesample"><table><tr><td scope="row"><pre>script Elizabeth<span></span></pre></td></tr><tr><td scope="row"><pre>    property HowManyTimes : 0<span></span></pre></td></tr><tr><td scope="row"><pre>    to sayHello to someone<span></span></pre></td></tr><tr><td scope="row"><pre>        set HowManyTimes to HowManyTimes + 1<span></span></pre></td></tr><tr><td scope="row"><pre>        return "Hello " &amp; someone<span></span></pre></td></tr><tr><td scope="row"><pre>    end sayHello<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>script ChildOfElizabeth<span></span></pre></td></tr><tr><td scope="row"><pre>    property parent : Elizabeth<span></span></pre></td></tr><tr><td scope="row"><pre>    on sayHello to someone<span></span></pre></td></tr><tr><td scope="row"><pre>        if my HowManyTimes > 3 then<span></span></pre></td></tr><tr><td scope="row"><pre>            return "No, I'm tired of saying hello."<span></span></pre></td></tr><tr><td scope="row"><pre>        else<span></span></pre></td></tr><tr><td scope="row"><pre>            continue sayHello to someone<span></span></pre></td></tr><tr><td scope="row"><pre>        end if<span></span></pre></td></tr><tr><td scope="row"><pre>    end sayHello<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre>tell Elizabeth to sayHello to "Matt"<span></span></pre></td></tr><tr><td scope="row"><pre>--result: "Hello Matt", no matter how often the tell is executed<span></span></pre></td></tr><tr><td scope="row"><pre>tell ChildOfElizabeth to sayHello to "Bob"<span></span></pre></td></tr><tr><td scope="row"><pre>--result: "Hello Bob", the first four times the tell is executed;<span></span></pre></td></tr><tr><td scope="row"><pre>--   after the fourth time: "No, I’m tired of saying hello."<span></span></pre></td></tr></table></div>
<p>In this example, the handler defined by <code>ChildOfElizabeth</code> for the <code>sayHello</code> command checks the value of the <code>HowManyTimes</code> property each time the handler is run. If the value is greater than 3, <code>ChildOfElizabeth</code> returns a message refusing to say hello. Otherwise, <code>ChildOfElizabeth</code> calls the <code>sayHello</code> handler in the parent <code>script</code> object (<code>Elizabeth</code>), which returns the standard hello message. The word <code>someone</code> in the <code>continue</code> statement is a parameter variable. It indicates that the parameter received with the original <code>sayHello</code> command will be passed to the handler in the parent script.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH207-SW11" title="Note"></a><p><strong>Note:</strong>&nbsp;The reserved word <code>my</code> in the statement <code>if</code> <code>my HowManyTimes > 10</code> in this example is required to indicate that <code>HowManyTimes</code> is a property of the <code>script</code> object. Without the word <code>my</code>, AppleScript assumes that <code>HowManyTimes</code> is an undefined local variable.<a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_470"></a></p></div>
<p>A <code>continue</code> statement can change the parameters of a command before delegating it. For example, suppose the following <code>script</code> object is defined in the same script as the preceding example. The first <code>continue</code> statement changes the direct parameter of the <code>sayHello</code> command from <code>"Bill"</code> to <code>"William"</code>. It does this by specifying the value <code>"William"</code> instead of the parameter variable <code>someone</code>.</p>
<div class="codesample"><table><tr><td scope="row"><pre>script AnotherChildOfElizabeth<span></span></pre></td></tr><tr><td scope="row"><pre>    property parent : Elizabeth<span></span></pre></td></tr><tr><td scope="row"><pre>    on sayHello to someone<span></span></pre></td></tr><tr><td scope="row"><pre>        if someone = "Bill" then<span></span></pre></td></tr><tr><td scope="row"><pre>            continue sayHello to "William"<span></span></pre></td></tr><tr><td scope="row"><pre>        else<span></span></pre></td></tr><tr><td scope="row"><pre>            continue sayHello to someone<span></span></pre></td></tr><tr><td scope="row"><pre>        end if<span></span></pre></td></tr><tr><td scope="row"><pre>    end sayHello<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell AnotherChildOfElizabeth to sayHello to "Matt"<span></span></pre></td></tr><tr><td scope="row"><pre>--result: "Hello Matt"<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell AnotherChildOfElizabeth to sayHello to "Bill"<span></span></pre></td></tr><tr><td scope="row"><pre>--result: "Hello William"<span></span></pre></td></tr></table></div>
<p>If you override a parent’s handler in this manner, the reserved words <code>me</code> and <code>my</code> in the parent’s handler no longer refer to the parent, as demonstrated in the example that follows.</p>
<div class="codesample"><table><tr><td scope="row"><pre>script Hugh<span></span></pre></td></tr><tr><td scope="row"><pre>    on identify()<span></span></pre></td></tr><tr><td scope="row"><pre>        me<span></span></pre></td></tr><tr><td scope="row"><pre>    end identify<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre>script Andrea<span></span></pre></td></tr><tr><td scope="row"><pre>    property parent : Hugh<span></span></pre></td></tr><tr><td scope="row"><pre>    on identify()<span></span></pre></td></tr><tr><td scope="row"><pre>        continue identify()<span></span></pre></td></tr><tr><td scope="row"><pre>    end identify<span></span></pre></td></tr><tr><td scope="row"><pre>end script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell Hugh to identify()<span></span></pre></td></tr><tr><td scope="row"><pre>--result: «script Hugh»<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell Andrea to identify()<span></span></pre></td></tr><tr><td scope="row"><pre>--result: «script Andrea»<span></span></pre></td></tr></table></div><p><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_471"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_472"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_473"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_474"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_475"></a><a name="//apple_ref/doc/uid/TP40000983-CH207-DontLinkElementID_476"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_variables.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ASLR_about_handlers.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_script_objects.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_script_objects.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_script_objects.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>