<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Programming Guide: Mail Search Tutorial: Create the Interface</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Mail Search Tutorial: Create the Interface"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001255" title="Mail Search Tutorial: Create the Interface"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-TPXREF101">AppleScript Studio Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter07/studio_ms_design_app.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter09/studio_ms_connect_intf.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001255-TPXREF101" title="Mail Search Tutorial: Create the Interface"></a><h1>Mail Search Tutorial: Create the Interface</h1><p>Mail Search is a fairly complex AppleScript Studio application that searches for specified text in messages in the Mac OS X Mail application. In this chapter you’ll create an AppleScript Studio project for Mail Search and build the user interface. These tasks are described in the following sections:</p><ol class="ol"><li class="li"><p><span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF153">“Create a Project.”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-CJBHJBIG">“Add an Image File to the Project”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF154">“Build the Interface.”</a></span></p></li></ol><p>This chapter assumes you have completed <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF101">“Mail Search Tutorial: Design the Application”</a></span> the previous Mail Search tutorial chapter.</p><a name="//apple_ref/doc/uid/20001255-TPXREF153" title="Create a Project"></a><h2>Create a Project</h2><p>To create a new AppleScript Studio project for Mail Search, perform these steps:</p><ol class="ol"><li class="li"><p>Use Xcode to create a new AppleScript Studio project, as described in <span class="content_text"><a href="../chapter02/studio_about_book.html#//apple_ref/doc/uid/20001249-TPXREF130">“Creating a Hello World Application,”</a></span> but choose the AppleScript Document-based Application for the project template—you use this template for an application that creates and manages multiple documents— and name the project “Mail Search”.</p></li><li class="li"><p>Open the groups in the Files list in the Groups &amp; Files list to show their contents, as in <span class="content_text">Figure 7-1</span>. Each of the items is described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF164">“Default Project Contents.”</a></span></p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BAJFCBJJ" title="Figure 7-1Default contents of a document-based AppleScript Studio project"></a><p><strong>Figure 7-1&nbsp;&nbsp;</strong>Default contents of a document-based AppleScript Studio project</p><img src = "../art/watson_exp_groups.gif" alt = "Default contents of a document-based AppleScript Studio project" width="181" height="352"></div></li><li class="li"><p><code>Document.applescript</code> is the default document script file, which is created as an empty file. Mail Search doesn’t use this file, so select the file and press the Delete key to remove it from the project. You’ll then see the dialog shown in <span class="content_text">Figure 7-2</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIDIDGH" title="Figure 7-2Deleting a file from a project"></a><p><strong>Figure 7-2&nbsp;&nbsp;</strong>Deleting a file from a project</p><img src = "../art/delete_refs_dialog.gif" alt = "Deleting a file from a project" width="612" height="132"></div><p>Click the Delete References &amp; Files button to delete the file on disk, as well as from the project.</p></li><li class="li"><p>Select the script file <code>Application.applescript</code> and choose Rename from the Project menu. Rename the file <code>Mail Search.applescript</code>.</p></li></ol><p>At this point you can build the project and create a working application that can create multiple document windows, expand and minimize them, display an About window, and respond to a number of menu choices. To build and run the application, do one of the following:</p><ul class="ul"><li class="li"><p>type Command-R</p></li><li class="li"><p>choose Build and Run from the Build menu</p></li><li class="li"><p>click the Build and Run button, which is represented by a hammer and green go button</p></li></ul><a name="//apple_ref/doc/uid/20001255-CJBHJBIG" title="Add an Image File to the Project"></a><h2>Add an Image File to the Project</h2><p>The Mail Search sample project included with AppleScript Studio includes an image of a magnifying glass you’ll need for the search window. Open the folder for the Mail Search sample project and drag the file <code>find.tiff</code> to the Files list in the Groups &amp; Files list of your new Mail Search project. You can drag it directly to the Resources group.</p><p>You can also add a file to the Mail Search project by choosing Add Files from the Project menu in Xcode, then navigating to the file <code>find.tiff</code> in the directory for the Mail Search sample project. Select it and click Open. Whichever approach you choose, you’ll get the dialog shown in <span class="content_text">Figure 7-3</span>.</p><br/><div><a name="//apple_ref/doc/uid/20001255-TPXREF212" title="Figure 7-3Adding a file to a project"></a><p><strong>Figure 7-3&nbsp;&nbsp;</strong>Adding a file to a project</p><img src = "../art/adding_file_to_proj.gif" alt = "Adding a file to a project" width="400" height="373"></div><br/><p>Select the checkbox “Copy items into destination group’s folder (if needed),” then click Add to add the file to your project. If you used the Add Files menu choice, drag the file <code>find.tiff</code> into the Resources group in the Groups &amp; Files list.</p><a name="//apple_ref/doc/uid/20001255-TPXREF154" title="Build the Interface"></a><h2>Build the Interface</h2><p>You’ll build the interface for Mail Search with Interface Builder, a Mac OS X development tool located in <code>/Developer/Applications</code>. You should be familiar with Interface Builder from reading about it in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF137">“Interface Builder Features for AppleScript Studio,”</a></span> and from completing the <span class="content_text"><a href="../chapter06/studio_cur_converter.html#//apple_ref/doc/uid/20001253-TPXREF101">“Currency Converter Tutorial.”</a></span> In particular, you should be familiar with the nib files Interface Builder uses to store interface definitions.</p><p>Each of the following sections provides instructions for building one of the interface items described in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-TPXREF152">“Design the Interface.”</a></span> You’ll start with the simpler items and with nib files that are created automatically as part of the project, then move to more complex interface items that require the creation of new nib files.</p><p>As you work through the steps to create Mail Search’s interface, you can build and run the application at any point. You won’t see much difference in the application’s interface until you’ve completed the section <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF168">“Create the Search Window.”</a></span> That’s because except for the menus and the main search window, the interface won’t become visible until after you connect it to event handlers and write the handlers in later sections.</p><p>To Build the interface for Mail Search, you’ll work through these steps:</p><ol class="ol"><li class="li"><p><span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF147">“Examine the Default Menus”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF163">“Create the Message Window”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIJBFBF">“Create a Status Dialog”</a></span></p></li><li class="li"><p><span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF168">“Create the Search Window”</a></span></p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF147" title="Examine the Default Menus"></a><h3>Examine the Default Menus</h3><p>You won’t make any changes to Mail Search’s menus until <span class="content_text"><a href="../chapter12/studio_ms_customize.html#//apple_ref/doc/uid/20001259-BCIIAFBC">“Customize Menus.”</a></span> In this section you’ll examine the menus in Interface Builder. To examine the default menus in a Document-based AppleScript Studio project template, you do the following:</p><ol class="ol"><li class="li"><p>Open the Mail Search project in Xcode.</p></li><li class="li"><p>Open the <code>MainMenu.nib</code> file by double-clicking its icon in the Files list in Xcode’s Groups &amp; Files list, shown in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BAJFCBJJ">Figure 7-1</a></span>.</p><p>Interface Builder opens, displaying the four windows shown and described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation.”</a></span></p></li></ol><br/><div><a name="//apple_ref/doc/uid/20001255-BAJEEGIG" title="Figure 7-4Interface Builder windows after opening Mail Search&acirc;&#128;&#153;s MainMenu.nib file"></a><p><strong>Figure 7-4&nbsp;&nbsp;</strong>Interface Builder windows after opening Mail Search’s <code>MainMenu.nib</code> file</p><img src = "../art/main_menu_nib.gif" alt = "Interface Builder windows after opening Mail Search’s MainMenu.nib file" width="389" height="329"></div><br/><p><span class="content_text">Figure 7-4</span> shows just the MainMenu.nib window and the application’s menus. The four icons in the Instances pane visible in <span class="content_text">Figure 7-4</span> are described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation.”</a></span> The File’s Owner instance represents NSApp, a global constant for the application object that serves as the master controller for the application. You’ll use this instance in <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-TPXREF182">“Connect the Application Object.”</a></span></p><p>At this point, you can use any of Interface Builder’s capabilities for creating and modifying menus, such as adding or deleting menus or menu items. You don’t need to do anything now to change the default menus. But in <span class="content_text"><a href="../chapter12/studio_ms_customize.html#//apple_ref/doc/uid/20001259-BCIIAFBC">“Customize Menus,”</a></span> you’ll find steps for changing menu and menu item names so that they match the menus shown in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCIBBFIE">Figure 6-4</a></span>. When you are finished looking at the menus, close the nib file window; otherwise, you’ll end up with a lot of open nib windows as you work through the tutorial.</p><a name="//apple_ref/doc/uid/20001255-TPXREF163" title="Create the Message Window"></a><h3>Create the Message Window</h3><p><span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCICJDCA">Figure 6-5</a></span> shows the design for a Mail Search message window as it appears in Interface Builder. The message window is a simple window with one main view and no special features. To create the message window, you need to:</p><ol class="ol"><li class="li"><p>Create a new nib file.</p></li><li class="li"><p>Add a window instance to the nib file.</p></li><li class="li"><p>Add interface objects (in this case, a single text view object, enclosed within a scroll view) to the window.</p></li></ol><p>These steps are described in the following sections.</p><a name="//apple_ref/doc/uid/20001255-TPXREF164" title="Create a Nib File"></a><h4>Create a Nib File</h4><p>To create a new nib file, perform these steps:</p><ol class="ol"><li class="li"><p>Open the Mail Search project in Xcode.</p></li><li class="li"><p>Double-click one of the nib file icons (such as <code>MainMenu.nib</code>) in the Files list in the Groups &amp; Files list to start Interface Builder.</p></li><li class="li"><p>In Interface Builder, choose New from the File menu. Interface Builder opens the dialog shown in <span class="content_text">Figure 7-5</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIBBACB" title="Figure 7-5Creating a new nib file in Interface Builder"></a><p><strong>Figure 7-5&nbsp;&nbsp;</strong>Creating a new nib file in Interface Builder</p><img src = "../art/new_nib_dialog.gif" alt = "Creating a new nib file in Interface Builder" width="365" height="357"></div></li><li class="li"><p>Select Empty in the Cocoa section and click New. The new nib file is shown in <span class="content_text">Figure 7-6</span>. The icons in the Instances pane visible in <span class="content_text">Figure 7-6</span> are described in <span class="content_text"><a href="../chapter03/studio_components.html#//apple_ref/doc/uid/20001250-TPXREF161">“Interface Creation.”</a></span></p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCICHBGF" title="Figure 7-6A new nib file in Interface Builder"></a><p><strong>Figure 7-6&nbsp;&nbsp;</strong>A new nib file in Interface Builder</p><img src = "../art/new_untitled_nib.gif" alt = "A new nib file in Interface Builder" width="387" height="265"></div></li><li class="li"><p>Choose Save As from the File menu and navigate to the <code>English.lproj</code> directory in your Mail Search project. Save the file as <code>Message.nib</code> (you just type “Message” and Interface Builder adds the extension). You will be prompted for a nib file format. Your three choices are:</p><ul class="ul"><li class="li"><p>Pre-10.2 format: Use this if you want your application to run in Mac OS X versions earlier than 10.2.</p></li><li class="li"><p>10.2 and later format: Use this if you want your application to run in Mac OS X version 10.2 and later.</p></li><li class="li"><p>Both formats: Use this if you want to run your application in all versions of Mac OS X.</p></li></ul><p>Select the option for 10.2 and later.</p></li><li class="li"><p>After saving the file, you should be prompted to add the file directly to the Mail Search project. Click Add to add the nib file to the project.</p><p>If for any reason you don’t have the opportunity to automatically add the new nib file to the Mail Search project, you can add it directly by opening the project in Xcode, and dragging it into the Resources group in the Groups &amp; Files list, which is shown in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BAJFCBJJ">Figure 7-1</a></span>, or by choosing Add Files from the Project menu, navigating to the <code>Message.nib</code> file, and choosing that file. If you use Add Files, you should then drag the icon for the nib file to the Resources group.</p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF165" title="Add the Message Window to the Nib File"></a><h4>Add the Message Window to the Nib File</h4><p>To add a message window to the nib file, perform these steps:</p><ol class="ol"><li class="li"><p>In Interface Builder, click the Cocoa Windows button in the Palette window toolbar. The Palette window, showing the Cocoa Windows palette, is shown in <span class="content_text">Figure 7-7</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIJBACA" title="Figure 7-7The Cocoa-Windows palette of Interface Builder&acirc;&#128;&#153;s Palette window"></a><p><strong>Figure 7-7&nbsp;&nbsp;</strong>The Cocoa-Windows palette of Interface Builder’s Palette window</p><img src = "../art/ib_windows_palette.gif" alt = "The Cocoa-Windows palette of Interface Builder’s Palette window" width="393" height="254"></div></li><li class="li"><p>Drag an instance of Window from the Palette window to any convenient space on your desktop. You’ll see a window that looks similar to the image you dragged from the Palette window. You’ll also see an icon for the window added to the Message.nib window, as shown in <span class="content_text">Figure 7-8</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIBECGE" title="Figure 7-8The Message.nib window, showing a window instance"></a><p><strong>Figure 7-8&nbsp;&nbsp;</strong>The Message.nib window, showing a window instance</p><img src = "../art/msg_wind_with_nib.gif" alt = "The Message.nib window, showing a window instance" width="389" height="267"></div></li><li class="li"><p>Double-click the word “Window” in the window instance in the nib window and type “Message” to change the instance name.</p></li><li class="li"><p>You need to provide an AppleScript name for the window too, so you can access it in scripts. To do so, click in the nib window to select the Message window instance, then choose Show Info from the Tools menu or type Command-Shift-I to open the Info window. Use the pop-up menu at the top of the window to display the AppleScript pane. The result is shown in <span class="content_text">Figure 7-9</span>.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_44" title="Note"></a><p><strong>Note:</strong>&nbsp; You can use command shortcuts to choose the AppleScript pane or other panes, but the exact shortcut can vary between releases of Interface Builder. For example, in Interface Builder version 2.4.2, you can display the AppleScript pane by typing Command-8. </p></div><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIGFHIG" title="Figure 7-9The AppleScript pane in the Info window for a window object"></a><p><strong>Figure 7-9&nbsp;&nbsp;</strong>The AppleScript pane in the Info window for a window object</p><img src = "../art/wind_obj_info_wind.gif" alt = "The AppleScript pane in the Info window for a window object" width="284" height="478"></div><p>To name the window, simply type “message” in the Name field. Remember that this is the object’s AppleScript name, which you can use in a script to identify the object. It is a different entity than the name of the window object in the nib window, and is also different from the window’s title in the running application.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_45" title="Note"></a><p><strong>Note:</strong>&nbsp;The first time you make a change in the AppleScript pane, Interface Builder adds a new instance named AppleScript Info to the nib window. The type of this instance is ASKNibObjectInfoManager. An example is visible in <span class="content_text">Figure 7-10</span>.</p>The AppleScript Info object stores information the application needs at runtime, such as object names and event handler connections. This information is saved with the nib file and retrieved when the application’s objects are unarchived from the nib file at application launch.</p>You can delete the AppleScript Info instance if you want to remove all such information from your application. If you do so, you will then have to reconnect your event handlers.</p></div><p>If it makes sense, you can use the same AppleScript name for objects of different types in the same window (such as a button and a text field), or for objects of the same type (such as buttons) in different windows. However, if you name two buttons in the same window “button,” you won’t be able to differentiate between them by name in an application script.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF169" title="Figure 7-10The Message.nib window showing an AppleScript Info object (not selected)"></a><p><strong>Figure 7-10&nbsp;&nbsp;</strong>The Message.nib window showing an AppleScript Info object (not selected)</p><img src = "../art/nib_with_as_info.gif" alt = "The Message.nib window showing an AppleScript Info object (not selected)" width="388" height="267"></div></li><li class="li"><p>Save the changes to the <code>Message.nib</code> file. You should save changes periodically as you work through this tutorial.</p><p>When you are finished with a nib file, you should also close its window to avoid a clutter of nib-related windows as you work through the tutorial.</p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF166" title="Set Up Interface Objects in the Message Window"></a><h4>Set Up Interface Objects in the Message Window</h4><p>To set up interface objects in the message window (in this case, there is just one object, a text view), perform these steps:</p><ol class="ol"><li class="li"><p>Click the Cocoa Text Views button in the Palette window toolbar. The Cocoa-Text palette is shown in <span class="content_text">Figure 7-11</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIIADDC" title="Figure 7-11The Cocoa-Text palette of Interface Builder&acirc;&#128;&#153;s Palette window"></a><p><strong>Figure 7-11&nbsp;&nbsp;</strong>The Cocoa-Text palette of Interface Builder’s Palette window</p><img src = "../art/ib_text_palette.gif" alt = "The Cocoa-Text palette of Interface Builder’s Palette window" width="392" height="255"></div></li><li class="li"><p>Drag a text view object (the item containing Latin text and one scroll bar) from the Palette window to the message window you created previously. Drag it to the top-left corner of the window (below the title bar). Interface Builder provides feedback to aid in alignment and resizing, as shown in <span class="content_text">Figure 7-12</span>. The text view is actually enclosed within a scroll view with one scroll bar.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCICEJCC" title="Figure 7-12Positioning a text view object"></a><p><strong>Figure 7-12&nbsp;&nbsp;</strong>Positioning a text view object</p><img src = "../art/placing_text_view.gif" alt = "Positioning a text view object" width="576" height="133"></div></li><li class="li"><p>Drag the bottom-right corner of the text view object to resize it until it fills the whole window. Again, you get resizing feedback from Interface Builder. The result is shown in <span class="content_text">Figure 7-13</span>. The small dots below the title bar and just inside the other sides of the window indicate that the text view is still selected.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIFDIGF" title="Figure 7-13The finished message window"></a><p><strong>Figure 7-13&nbsp;&nbsp;</strong>The finished message window</p><img src = "../art/final_msg_wind.gif" alt = "The finished message window" width="576" height="439"></div></li><li class="li"><p>To provide an AppleScript name for the text view, open the Info window and display the AppleScript pane. The result is similar to <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIGFHIG">Figure 7-9</a></span>. Type “message” in the Name field.</p></li><li class="li"><p>To support Undo in the text view, you’ll have to modify its default attributes. While the Info window is still open, use the pop-up menu at the top of the window (or type Command-1) to display the Attributes pane.</p></li><li class="li"><p>In the Options section, select the “Undo allowed” checkbox. The result is shown in <span class="content_text">Figure 7-14</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIJDFDE" title="Figure 7-14Attributes pane in Info window for text vie"></a><p><strong>Figure 7-14&nbsp;&nbsp;</strong>Attributes pane in Info window for text vie</p><img src = "../art/text_view_attribs.gif" alt = "Attributes pane in Info window for text vie" width="285" height="479"></div></li><li class="li"><p>As always, save the nib file after completing your changes.</p></li></ol><a name="//apple_ref/doc/uid/20001255-BCIJBFBF" title="Create a Status Dialog"></a><h3>Create a Status Dialog</h3><p><span class="content_text">Figure 7-15</span> shows a status dialog as it appears in Interface Builder. Mail Search displays the status dialog as a sheet on the search window during lengthy operations. The status dialog contains a progress bar and an invisible text field in which Mail Search can write status messages.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_46" title="Note"></a><p><strong>Note:</strong>&nbsp;As mentioned in <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCICCEHH">“Arrange the User Interface”</a></span> the Mail Search application often refers to the status dialog as a status panel because you use an object that Interface Builder calls a Panel to create the status dialog. Whether you see status dialog or status panel, you’ll know it refers to the same object.</p></div><p>To create the status dialog, you’ll perform steps very similar to those in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF163">“Create the Message Window.”</a></span> You need to:</p><ol class="ol"><li class="li"><p>Create a new nib file. This process is described in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF164">“Create a Nib File.”</a></span></p><p>In this case, name the nib file <code>StatusPanel.nib</code>.</p></li><li class="li"><p>Use the same process described in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF165">“Add the Message Window to the Nib File”</a></span> to add a window instance to the nib, but with these differences:</p><ol class="ol"><li class="ol ol"><p>drag an instance of the user interface object labeled “Panel” from the Cocoa-Windows palette, rather than the one labeled “Window”</p></li><li class="ol ol"><p>name the instance “Status”</p></li><li class="ol ol"><p>type “status” in the Name field in the AppleScript pane of the Info window for the instance</p></li></ol></li><li class="li"><p>Adjust its size and attributes for the status dialog.</p></li><li class="li"><p>Set up a progress bar in the window.</p></li><li class="li"><p>Set up a text field to display progress text.</p></li></ol><p>Steps 3, 4, and 5 are described in the following sections.</p><a name="//apple_ref/doc/uid/20001255-BCIJFFEG" title="Adjust the Size and Attributes of the Status Dialog"></a><h4>Adjust the Size and Attributes of the Status Dialog</h4><p>You need to change certain window attributes to use the window as a pane. You also need to reduce the size of the status dialog so that it looks appropriate when it appears below the title bar of the search window. The previously designed status dialog, shown again in <span class="content_text">Figure 7-15</span>, is smaller than the minimum size for a default window in Interface Builder, so you have to adjust the minimum size.</p><br/><div><a name="//apple_ref/doc/uid/20001255-BCIDIFEE" title="Figure 7-15The status dialog as previously designed"></a><p><strong>Figure 7-15&nbsp;&nbsp;</strong>The status dialog as previously designed</p><img src = "../art/final_status_wind.gif" alt = "The status dialog as previously designed" width="293" height="122"></div><br/><p>To make these changes, perform the following steps:</p><ol class="ol"><li class="li"><p>Select the Status window instance in the StatusPanel.nib window, then display the Attributes pane in the Info window.</p></li><li class="li"><p>In the Window Title field, change the title from Panel to Status. The result is shown in <span class="content_text">Figure 7-16</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIJAGGE" title="Figure 7-16The revised Attributes pane in the Info window for the status dialog"></a><p><strong>Figure 7-16&nbsp;&nbsp;</strong>The revised Attributes pane in the Info window for the status dialog</p><img src = "../art/status_attribs_info.gif" alt = "The revised Attributes pane in the Info window for the status dialog" width="285" height="478"></div></li><li class="li"><p>With the Info window still open, use the pop-up menu at the top of the window to display the Size pane. The result is shown in <span class="content_text">Figure 7-17</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIIEJAD" title="Figure 7-17The Size pane in the Info window for the status dialog"></a><p><strong>Figure 7-17&nbsp;&nbsp;</strong>The Size pane in the Info window for the status dialog</p><img src = "../art/status_size_info.gif" alt = "The Size pane in the Info window for the status dialog" width="286" height="479"></div></li><li class="li"><p>In the Min Size section, type 110 for the width and 50 for the height. (These values just have to be at least as small as the values you’ll enter in the next step.)</p></li><li class="li"><p>In the Content Rect section, type 260 for the width and 75 for the height. The resized status dialog that results from these changes is shown in <span class="content_text">Figure 7-18</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIBDIBG" title="Figure 7-18The resized status dialog"></a><p><strong>Figure 7-18&nbsp;&nbsp;</strong>The resized status dialog</p><img src = "../art/resized_status_panel.gif" alt = "The resized status dialog" width="292" height="120"></div></li></ol><a name="//apple_ref/doc/uid/20001255-BCIHEHII" title="Set Up a Progress Bar"></a><h4>Set Up a Progress Bar</h4><p>To set up a progress bar in the status dialog, do the following:</p><ol class="ol"><li class="li"><p>Click the Controls button in the Palette window toolbar. The Cocoa-Controls palette is shown in <span class="content_text">Figure 7-19</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF170" title="Figure 7-19The Cocoa-Controls palette of Interface Builder&acirc;&#128;&#153;s Palette window"></a><p><strong>Figure 7-19&nbsp;&nbsp;</strong>The Cocoa-Controls palette of Interface Builder’s Palette window</p><img src = "../art/ib_controls_palette.gif" alt = "The Cocoa-Controls palette of Interface Builder’s Palette window" width="393" height="254"></div></li><li class="li"><p>Drag a progress bar object (the horizontal striped cylinder near the bottom of the window) from the Palette window to the status dialog you just created and position it as shown in <span class="content_text">Figure 7-20</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF207" title="Figure 7-20Positioning the progress bar"></a><p><strong>Figure 7-20&nbsp;&nbsp;</strong>Positioning the progress bar</p><img src = "../art/placing_progress.gif" alt = "Positioning the progress bar" width="292" height="121"></div></li><li class="li"><p>Select the progress bar, then grab the lower-right corner and resize it. Use Interface Builder’s feedback to help you resize the progress bar, as shown in <span class="content_text">Figure 7-21</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF208" title="Figure 7-21Resizing the progress bar"></a><p><strong>Figure 7-21&nbsp;&nbsp;</strong>Resizing the progress bar</p><img src = "../art/resizing_progress.gif" alt = "Resizing the progress bar" width="292" height="121"></div></li><li class="li"><p>You need to provide an AppleScript name for the progress bar so you can access it in scripts. To do so, select the progress bar, then open the Info window to the AppleScript pane. The result is similar to <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIGFHIG">Figure 7-9</a></span>.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_47" title="Note"></a><p><strong>Note:</strong>&nbsp;As mentioned previously, the AppleScript Studio terminology for a progress bar is <code>progress indicator</code> and you’ll see the class name “NSProgressIndicator” as part of the Info window title.</p></div><p>To name the progress bar, simply type “progress” in the Name field.</p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF176" title="Set Up a Text Field"></a><h4>Set Up a Text Field</h4><p>To set up a text field to display progress text in the status dialog, do the following:</p><ol class="ol"><li class="li"><p>Drag a text field object (a rectangular, unlabeled field with a white background) from the Cocoa-Text palette (shown in <span class="content_text"><a href="../chapter06/studio_cur_converter.html#//apple_ref/doc/uid/20001253-TPXREF209">Figure 5-10</a></span>) in the Palette window to the status dialog. Position the text field above the progress bar you added in a previous step. Use Interface Builder’s feedback to help you align the left side of the text field with the progress bar and just above it, as shown in <span class="content_text">Figure 7-22</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF171" title="Figure 7-22Positioning a status text field above the progress bar"></a><p><strong>Figure 7-22&nbsp;&nbsp;</strong>Positioning a status text field above the progress bar</p><img src = "../art/placing_status_text.gif" alt = "Positioning a status text field above the progress bar" width="291" height="121"></div></li><li class="li"><p>Select the text field, then grab the middle selection handle on the right and resize the field, as shown in <span class="content_text">Figure 7-23</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIBHAHD" title="Figure 7-23Resizing the status text field"></a><p><strong>Figure 7-23&nbsp;&nbsp;</strong>Resizing the status text field</p><img src = "../art/resizing_status_text.gif" alt = "Resizing the status text field" width="291" height="122"></div></li><li class="li"><p>You don’t want a user to enter text in the text field and you do want the field (though not the status messages that get written to it) to be invisible. To choose the correct settings, select the text field and open the Info window to the Attributes pane. The result is shown in <span class="content_text">Figure 7-24</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCICHECC" title="Figure 7-24The Attributes pane in the Info window for the text field"></a><p><strong>Figure 7-24&nbsp;&nbsp;</strong>The Attributes pane in the Info window for the text field</p><img src = "../art/status_text_info.gif" alt = "The Attributes pane in the Info window for the text field" width="284" height="479"></div><p>Now make these adjustments, in the order shown:</p><ol class="ol"><li class="ol ol"><p>Deselect the Editable checkbox.</p></li><li class="ol ol"><p>Deselect the Selectable checkbox.</p></li><li class="ol ol"><p>Select the Small option in the Size pop-up menu.</p></li><li class="ol ol"><p>In the Border section, click the button on the left to select no border.</p></li><li class="ol ol"><p>In the Backgrnd Color section, deselect the Draw checkbox.</p></li><li class="ol ol"><p>In the Layout section, select the Wraps radio button. The resulting invisible text field is shown in <span class="content_text">Figure 7-25</span>.</p></li></ol><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF172" title="Figure 7-25The invisible status text field"></a><p><strong>Figure 7-25&nbsp;&nbsp;</strong>The invisible status text field</p><img src = "../art/invisible_status_text.gif" alt = "The invisible status text field" width="293" height="121"></div></li><li class="li"><p>You need to provide an AppleScript name for the text field so you can access it in scripts. To do so, display the AppleScript pane in the Info window, then type “statusmessage” in the Name field.</p></li><li class="li"><p>Save all the changes to the <code>StatusPanel.nib</code> file.</p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF168" title="Create the Search Window"></a><h3>Create the Search Window</h3><p>Now that you’ve used Interface Builder to create and modify several relatively simple nibs, you’ll get a chance to work with a more interesting and challenging example, the nib for Mail Search’s search window. <span class="content_text"><a href="../chapter07/studio_ms_design_app.html#//apple_ref/doc/uid/20001254-BCIJGGCH">Figure 6-2</a></span> shows the design for the search window. To put together a nib that implements that window requires the following steps:</p><ol class="ol"><li class="li"><p>Open the nib file <code>Document.nib</code>.</p><p>The steps for opening a nib file are listed in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF147">“Examine the Default Menus.”</a></span></p></li><li class="li"><p>Rename the default window instance in the nib window.</p><p>Double-click the instance name “Window” and type “Mail Search” as the new name. The Mail Search search window is a little larger than the default window size (with a width of about 525 and a height of about 440). You can resize with the same steps you used in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIJFFEG">“Adjust the Size and Attributes of the Status Dialog,”</a></span> though in this case you won’t need to reset the minimum size for the window. The resulting window is shown in <span class="content_text">Figure 7-26</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIHFIIG" title="Figure 7-26The resized, empty search window"></a><p><strong>Figure 7-26&nbsp;&nbsp;</strong>The resized, empty search window</p><img src = "../art/empty_search_wind.gif" alt = "The resized, empty search window" width="559" height="492"></div><p>You should also follow the same steps you used in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF165">“Add the Message Window to the Nib File”</a></span> to display the AppleScript pane in the Info window, then type “mail search” in the Name field to supply an AppleScript name for the window.</p></li><li class="li"><p>Set up a popup button for the search type.</p></li><li class="li"><p>Set up a text field for the search text.</p></li><li class="li"><p>Set up a button to initiate searches.</p></li><li class="li"><p>Set up an outline view to display the available mailboxes.</p></li><li class="li"><p>Set up a table view to display matching messages.</p></li><li class="li"><p>Group the outline and table views in a split view.</p></li></ol><p>Steps 3 through 8 are described in the following sections.</p><p>Once you’ve completed these steps, you can build the application, view the search window, and perform operations such as opening the pop-up menu, resizing the table and outline views, and rearranging the columns in the search result table. You can also build the application periodically to view the search window at various stages of completion. However, you won’t be able to do any searching until you connect scripts to the user interface in later sections. To build and run the application, open the project in Xcode and type Command-R, choose Build and Run from the Build menu, or click the Build and Run button.</p><a name="//apple_ref/doc/uid/20001255-TPXREF177" title="Set Up a Popup Button"></a><h4>Set Up a Popup Button</h4><p>Mail Search uses a popup button to provide a pop-up menu of search locations (in the To, From, or Subject fields of messages or in the message contents). To set up a popup button in the search window (the Mail Search window instance in the Document nib), perform these steps:</p><ol class="ol"><li class="li"><p>With the search window still open as shown in <span class="content_text">Figure 7-26</span>, drag a popup button from the Cocoa-Controls palette in the Palette window (shown in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF170">Figure 7-19</a></span>) to the search window. Use the automatic feedback to position the button in the top left corner of the window. As the button nears the corner, Interface Builder provides dashed feedback lines to help align the object according to the Aqua guidelines, as shown in <span class="content_text">Figure 7-27</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIDCJGG" title="Figure 7-27Positioning a popup button in the search window"></a><p><strong>Figure 7-27&nbsp;&nbsp;</strong>Positioning a popup button in the search window</p><img src = "../art/placing_popup.gif" alt = "Positioning a popup button in the search window" width="373" height="153"></div></li><li class="li"><p>You need to provide menu items in the popup button for the possible search locations: Contents, Subject, To, and From. Double-click the button to reveal its default contents, as shown in <span class="content_text">Figure 7-28</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIJCDBD" title="Figure 7-28The default contents of a popup button"></a><p><strong>Figure 7-28&nbsp;&nbsp;</strong>The default contents of a popup button</p><img src = "../art/popup_default_items.gif" alt = "The default contents of a popup button" width="329" height="132"></div></li><li class="li"><p>To add a fourth item, simply choose Copy from the Edit menu (copying the selected Item1) and then Paste from the Edit menu. The result is shown in <span class="content_text">Figure 7-29</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIHHHHE" title="Figure 7-29A popup button with a new item"></a><p><strong>Figure 7-29&nbsp;&nbsp;</strong>A popup button with a new item</p><img src = "../art/popup_with_4_items.gif" alt = "A popup button with a new item" width="329" height="154"></div></li><li class="li"><p>To rename the first item, double-click it, type “Contents” as the new text, then tab to the next field. The result is shown in <span class="content_text">Figure 7-30</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIIJGCE" title="Figure 7-30A renamed popup button item"></a><p><strong>Figure 7-30&nbsp;&nbsp;</strong>A renamed popup button item</p><img src = "../art/popup_with_contents.gif" alt = "A renamed popup button item" width="334" height="156"></div></li><li class="li"><p>Rename the remaining three items as Subject, To, and From. <span class="content_text">Figure 7-31</span> shows the renamed items.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCICCABC" title="Figure 7-31Popup button with renamed items"></a><p><strong>Figure 7-31&nbsp;&nbsp;</strong>Popup button with renamed items</p><img src = "../art/popup_all_items.gif" alt = "Popup button with renamed items" width="341" height="158"></div></li><li class="li"><p>Open the Info window for the popup button to the Attributes pane and select the Small checkbox in the Options section. The result is shown in <span class="content_text">Figure 7-32</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF210" title="Figure 7-32The popup button after checking the Small checkbox"></a><p><strong>Figure 7-32&nbsp;&nbsp;</strong>The popup button after checking the Small checkbox</p><img src = "../art/popup_set_to_small.gif" alt = "The popup button after checking the Small checkbox" width="336" height="120"></div></li><li class="li"><p>Adjust the size of the button so that it is just large enough for the item with the longest name, Contents. To do so, select the popup button, then drag the middle selection handle on the right side. As you resize, Interface Builder again provides alignment guides, as shown in <span class="content_text">Figure 7-33</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIGBHHE" title="Figure 7-33Resizing the popup button"></a><p><strong>Figure 7-33&nbsp;&nbsp;</strong>Resizing the popup button</p><img src = "../art/resizing_popup.gif" alt = "Resizing the popup button" width="255" height="85"></div></li><li class="li"><p>You should also follow the same steps you used in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIHEHII">“Set Up a Progress Bar”</a></span> to display the AppleScript pane in the Info window, then type “where” in the Name field to supply an AppleScript name for the popup button.</p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF178" title="Set Up a Text Field"></a><h4>Set Up a Text Field</h4><p>Mail Search uses a text field to allow a user to provide text to search for. To set up a text field in the search window, perform these steps:</p><ol class="ol"><li class="li"><p>Drag a text field from the Cocoa-Text palette in the Palette window to the search window. Use the automatic feedback to position the field in the top left corner of the window next to the previously placed popup button, as shown in <span class="content_text">Figure 7-34</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIHJCCJ" title="Figure 7-34Positioning a text field in the search window"></a><p><strong>Figure 7-34&nbsp;&nbsp;</strong>Positioning a text field in the search window</p><img src = "../art/placing_search_text.gif" alt = "Positioning a text field in the search window" width="359" height="125"></div></li><li class="li"><p>To resize the text field, select it, then grab the middle selection handle on the right. Stretch the text field across the window, leaving room on the right for the find button. The result is shown in <span class="content_text">Figure 7-35</span></p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIIFGGF" title="Figure 7-35Resized text field in the search window"></a><p><strong>Figure 7-35&nbsp;&nbsp;</strong>Resized text field in the search window</p><img src = "../art/resized_search_text.gif" alt = "Resized text field in the search window" width="560" height="98"></div></li><li class="li"><p>While the text field is still selected, open the Info window to the Attributes pane. In the Send Action On section, click the radio button for Enter only. With this setting, the Mail Search application begins searching if a user types search text and presses the Return or Enter keys, in addition to when a user clicks the find button. The keystrokes only initiate a search when the text field has the focus. (See <span class="content_text"><a href="../chapter05/studio_cookbook.html#//apple_ref/doc/uid/20001252-BBCBDHFH">“Setting the Keyboard Focus”</a></span> for related information.)</p></li><li class="li"><p>In the same window, select the Small option in the Size pop-up menu, as you did previously for the popup button.</p></li><li class="li"><p>While you still have the Info window open for the text field, display the AppleScript pane, then type “what” in the Name field to supply an AppleScript name for the text field.</p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF179" title="Set Up a Button"></a><h4>Set Up a Button</h4><p>Mail Search uses a button to initiate a search. To set up a button in the search window, perform these steps:</p><ol class="ol"><li class="li"><p>Drag a round button from the Cocoa-Controls palette in the Palette window to the search window. Use the automatic feedback to position the button in the top right corner of the window next to the previously placed text field, as shown in <span class="content_text">Figure 7-36</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCICHAHD" title="Figure 7-36Positioning a button in the search window"></a><p><strong>Figure 7-36&nbsp;&nbsp;</strong>Positioning a button in the search window</p><img src = "../art/placing_find_button.gif" alt = "Positioning a button in the search window" width="560" height="117"></div></li><li class="li"><p>Open the Info window for the button, display the AppleScript pane, then type “find” in the Name field to supply an AppleScript name for the button.</p></li><li class="li"><p>In <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-TPXREF153">“Create a Project,”</a></span> you added an image file named <code>find.tiff</code> to the Mail Search project. That image file contains an image of a magnifying glass that you will now add to the button. With the Info window still open from the previous step, display the Attributes pane, then type “find” (the name of the image file, without the extension) into the “Icon:” field, as shown in <span class="content_text">Figure 7-37</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIHGHBJ" title="Figure 7-37The Info window for the find button"></a><p><strong>Figure 7-37&nbsp;&nbsp;</strong>The Info window for the find button</p><img src = "../art/find_but_attributes.gif" alt = "The Info window for the find button" width="285" height="478"></div><p>Alternatively, you can simply drag the image from the Images pane in the nib window to the find button.</p><p>To center the icon, click the middle button in the top row under “Icon Position” in the Info window shown in <span class="content_text">Figure 7-37</span>. The result is shown in <span class="content_text">Figure 7-38</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIJFJIH" title="Figure 7-38The button and magnifying glass"></a><p><strong>Figure 7-38&nbsp;&nbsp;</strong>The button and magnifying glass</p><img src = "../art/find_with_mag_glass.gif" alt = "The button and magnifying glass" width="559" height="123"></div></li><li class="li"><p>You have a couple of options for correctly positioning the button in relation to the right side of the window. You can drag the button to the right and use Interface Builder’s alignment guides to align it with the edge of the window, then expand the text field toward the button until it is also aligned. Or you can resize the window itself, moving the right edge toward the button, again using Interface Builder’s alignment guides to align the window edge. <span class="content_text">Figure 7-39</span> shows the latter process.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIFIHGH" title="Figure 7-39Aligning the right edge of the window with the button"></a><p><strong>Figure 7-39&nbsp;&nbsp;</strong>Aligning the right edge of the window with the button</p><img src = "../art/resizing_search_wind.gif" alt = "Aligning the right edge of the window with the button" width="516" height="491"></div></li></ol><a name="//apple_ref/doc/uid/20001255-BCIBADDE" title="Set Up an Outline View"></a><h4>Set Up an Outline View</h4><p>Mail Search uses an outline view to show the Mail folders that can be searched. It can be difficult to determine in Interface Builder whether you have selected an outline view or the scroll view that contains it. Single-clicking selects the containing scroll view, while double-clicking selects the outline view. The tutorial steps that follow describe visual cues to determine which view is selected.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_48" title="Note"></a><p><strong>Note:</strong>&nbsp;If you have not already experimented with AppleScript Studio’s Outline sample application, you should consider doing so before performing the steps in this section.</p></div><p>To be certain whether an outline view or the containing scroll view is selected, you can also open an Info window to the AppleScript pane. When that pane is displayed, the window title for the Info window shows the class of the selected item: either NSScrollView if the scroll view is selected, or NSOutlineView if the outline view is selected (or NSTableView when a table view is selected).</p><p>As a final alternative, you can display the objects in a nib window in outline view (as described in <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-BCICCIGJ">“Examining an Object Hierarchy in the Nib View”</a></span>), find the object (either an outline view, a scroll view, or any other object) in the view hierarchy, and double-click the object to select it in its window and to display it in the Info window.</p><p>To set up an outline view in the search window, perform these steps:</p><ol class="ol"><li class="li"><p>Drag an outline view from the Cocoa-Data palette in the Palette window to the search window. The outline view is in the upper-left corner with “Name” and “Description” columns.</p><p>Use the automatic feedback to position the outline view in the top left corner of the search window, below the previously placed popup button. Align it with the left side of the window, as shown in <span class="content_text">Figure 7-40</span>.</p><p>When you release the outline view, it takes on a more generic format, as shown (after resizing) in <span class="content_text">Figure 7-41</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIDEAJF" title="Figure 7-40Inserting an outline view in the search window"></a><p><strong>Figure 7-40&nbsp;&nbsp;</strong>Inserting an outline view in the search window</p><img src = "../art/placing_outline_view.gif" alt = "Inserting an outline view in the search window" width="515" height="229"></div></li><li class="li"><p>To resize the outline view, click to select it, then drag the lower-right corner. The text field should stretch all the way across the window and about half the way down (leaving room for a table view to display the search results), as shown in <span class="content_text">Figure 7-41</span>.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_49" title="Note"></a><p><strong>Note:</strong>&nbsp;The outline view text visible in <span class="content_text">Figure 7-41</span> (for colors and sizes) is simply filler text displayed by Interface Builder to help you see the rows and columns in the outline view. It will not be visible when you build the application.</p></div><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIJHAIC" title="Figure 7-41Resizing the outline view in the search window"></a><p><strong>Figure 7-41&nbsp;&nbsp;</strong>Resizing the outline view in the search window</p><img src = "../art/resizing_outline_view.gif" alt = "Resizing the outline view in the search window" width="514" height="273"></div></li><li class="li"><p>By default, a new outline view has two columns, but you only need one column to display mailboxes. To change the number of columns, double-click the outline view. The result is shown in <span class="content_text">Figure 7-42</span>.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_50" title="Important:"></a><p><strong>Important:</strong>&nbsp;If you single-click an outline view in Interface Builder, you will see the outline view object name in the Info window, but you have only selected the scroll view that is part of the outline view. You know the outline view is selected when it takes on the appearance shown in <span class="content_text">Figure 7-42</span>, with the whole view showing the selection color.</p><p>You must also double-click to select a table view or other data view object. See also the section <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-BCICCIGJ">“Examining an Object Hierarchy in the Nib View.”</a></span></p><p></p></div><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIEAFIB" title="Figure 7-42A selected outline view"></a><p><strong>Figure 7-42&nbsp;&nbsp;</strong>A selected outline view</p><img src = "../art/selected_outline_view.gif" alt = "A selected outline view" width="514" height="489"></div><p>Now open the Info window to the Attributes pane. The result is shown in <span class="content_text">Figure 7-43</span>. Make the following changes to the default settings:</p><ol class="ol"><li class="ol ol"><p>In the Allow section, select the Multiple Selection checkbox.</p></li><li class="ol ol"><p>In the Display section, deselect Horizontal Scroller.</p></li><li class="ol ol"><p>In the Options section, select the “Autoresizes Columns to fit” checkbox; deselect the Allows Reordering checkbox.</p></li><li class="ol ol"><p>Set the row height to 14.</p></li><li class="ol ol"><p>Set the number of columns to 1.</p></li></ol><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIDIDFB" title="Figure 7-43The Info window for the outline view, after changes"></a><p><strong>Figure 7-43&nbsp;&nbsp;</strong>The Info window for the outline view, after changes</p><img src = "../art/info_for_changed_outline.gif" alt = "The Info window for the outline view, after changes" width="286" height="478"></div></li><li class="li"><p>While you still have the Info window open for the outline view, display the AppleScript pane, then type “mailboxes” in the Name field to supply an AppleScript name for the outline view.</p></li><li class="li"><p>To add a column title to the outline view, double-click the view to select it, then double-click the title row at the top. You can then type “Mailboxes” for the column title. The result is shown in <span class="content_text">Figure 7-44</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF173" title="Figure 7-44The outline view after naming the Mailboxes column"></a><p><strong>Figure 7-44&nbsp;&nbsp;</strong>The outline view after naming the Mailboxes column</p><img src = "../art/outline_column_title.gif" alt = "The outline view after naming the Mailboxes column" width="508" height="233"></div></li><li class="li"><p>Mail Search also requires an AppleScript name for the scroll view that contains the outline view. To provide this name, single-click the outline view, open the Info window (for the scroll view) to the AppleScript pane, then type “mailboxes” in the Name field. The result is shown in <span class="content_text">Figure 7-45</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIEAIJA" title="Figure 7-45The Info window for the scroll view containing the outline view"></a><p><strong>Figure 7-45&nbsp;&nbsp;</strong>The Info window for the scroll view containing the outline view</p><img src = "../art/info_for_scroll_view.gif" alt = "The Info window for the scroll view containing the outline view" width="284" height="478"></div></li><li class="li"><p>If you haven’t saved the Document.nib file recently, do so now.</p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF180" title="Set Up a Table View"></a><h4>Set Up a Table View</h4><p>Mail Search uses a table view to show search results—the messages that contain the search text.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_51" title="Note"></a><p><strong>Note:</strong>&nbsp;If you have not already experimented with AppleScript Studio’s Table sample application, you should consider doing so before performing the steps in this section. The version that uses a data source object is recommended.</p></div><p>To set up a table view in the search window, perform these steps:</p><ol class="ol"><li class="li"><p>Drag a table view from the Cocoa-Data palette in the Palette window to the search window. The table view is in the lower-left corner with “Address” and “Name” columns.</p><p>Use the automatic feedback to position the table view below the previously placed outline view. Align it with the left side of the window, as shown in <span class="content_text">Figure 7-46</span>.</p><p>When you release the table view, it takes on a more generic format.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIBIDFF" title="Figure 7-46Inserting a table view in the search window"></a><p><strong>Figure 7-46&nbsp;&nbsp;</strong>Inserting a table view in the search window</p><img src = "../art/placing_table_view.gif" alt = "Inserting a table view in the search window" width="419" height="316"></div></li><li class="li"><p>To resize the table view, click to select it, then drag the lower-right corner. The text field should stretch all the way across the window and all the way to the bottom.</p></li><li class="li"><p>By default, a new table view has two columns, but you need three columns (for From, Subject, and Mailbox). Use the same steps described in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIBADDE">“Set Up an Outline View”</a></span> to open the Info window for the table view. Make the following changes to the default settings:</p><ol class="ol"><li class="ol ol"><p>In the Display section, deselect the Horizontal Scroller checkbox.</p></li><li class="ol ol"><p>In the lower options section, select the “Autoresizes Columns to fit” checkbox.</p></li><li class="ol ol"><p>Set the row height to 14.</p></li><li class="ol ol"><p>Set the number of columns to 3.</p><p>The resulting Info window is shown in <span class="content_text">Figure 7-47</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCIHHFGA" title="Figure 7-47The Info window for the table view, after changes"></a><p><strong>Figure 7-47&nbsp;&nbsp;</strong>The Info window for the table view, after changes</p><img src = "../art/info_for_table_view.gif" alt = "The Info window for the table view, after changes" width="284" height="478"></div></li></ol></li><li class="li"><p>While you still have the Info window open for the table view, display the AppleScript pane, then type “messages” in the Name field to supply an AppleScript name for the table view.</p></li><li class="li"><p>To resize a column in the table view, double-click the view to select it, then position the cursor over the column divider in the title row. The cursor changes to indicate when you can resize. Simply click and drag to resize a column.</p><p>Start by moving the right-most column divider to the left, which reduces the size of the middle column. Then move the left-most divider to the right, increasing the size of the left column. Adjust the column sizes as needed so that the Subject and Mailbox columns are wider than the From column. </p></li><li class="li"><p>To add column titles to the table view, use the same steps described in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIBADDE">“Set Up an Outline View.”</a></span> You can tab from column title to column title as you add titles. The result is shown in <span class="content_text">Figure 7-48</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-BCICGAJF" title="Figure 7-48The table view with titles"></a><p><strong>Figure 7-48&nbsp;&nbsp;</strong>The table view with titles</p><img src = "../art/table_with_named_cols.gif" alt = "The table view with titles" width="559" height="254"></div></li><li class="li"><p>Mail Search also requires an AppleScript name for the scroll view that contains the table view. To name the scroll view, follow the same steps you used in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIBADDE">“Set Up an Outline View”</a></span>:</p><ol class="ol"><li class="ol ol"><p>Single-click the table view to select the scroll view that contains it.</p></li><li class="ol ol"><p>In the AppleScript pane of the Info window for the scroll view, type “messages” in the Name field.</p></li></ol></li><li class="li"><p>If you haven’t saved the Document.nib file recently, do so now.</p></li></ol><a name="//apple_ref/doc/uid/20001255-TPXREF181" title="Group the Outline View and Table View in a Split View"></a><h4>Group the Outline View and Table View in a Split View</h4><p>Mail Search uses a split view to combine the outline and table views you’ve previously installed. The split view allows a user to adjust the size of either view, depending on how much space they want to devote to the available mailboxes (in the outline view) and how much to the found messages (in the table view).</p><p>To group the outline view and table view in a split view, perform these steps:</p><ol class="ol"><li class="li"><p>In the search window you have been working on, click to select the table view. The view should have selection handles (small dots) on all sides, and you should see “NSTableView Info” as the title of the Info window. Shift-click to also select the outline view. The outline view should have selection handles and the Info window should display “Multiple Selection” in the Attributes pane.</p></li><li class="li"><p>In the Layout menu, choose Split View in the “Make subviews of” submenu to make these two views into subviews of a split view. The result is shown in <span class="content_text">Figure 7-49</span>. The distinguishing feature of a split view is the handle for modifying the relative sizes of the contained outline and table views.</p><div class="item_figure"><a name="//apple_ref/doc/uid/20001255-TPXREF175" title="Figure 7-49The final search window, now containing a split view"></a><p><strong>Figure 7-49&nbsp;&nbsp;</strong>The final search window, now containing a split view</p><img src = "../art/final_table_view.gif" alt = "The final search window, now containing a split view" width="507" height="492"></div></li><li class="li"><p>Mail Search also requires an AppleScript name for the split view that contains the outline and table views. To name the split view, you follow similar steps to those listed in <span class="content_text"><a href="studio_ms_create_intf.html#//apple_ref/doc/uid/20001255-BCIBADDE">“Set Up an Outline View”</a></span>:</p><ol class="ol"><li class="ol ol"><p>Single-click to select the split view. You may have to click on another object, then click the split view to select it.</p></li><li class="ol ol"><p>In the AppleScript pane of the Info window for the split view, type “splitter” in the Name field.</p></li></ol><div class="importantbox"><a name="//apple_ref/doc/uid/20001255-DontLinkElementID_52" title="Important:"></a><p><strong>Important:</strong>&nbsp;Once you have grouped the outline and table views in a split view, it takes more effort to select the table or outline view. For example, to select the Mailboxes outline view when the window is currently selected, you click once to select the split view, double-click to select the scroll view that contains the outline view (which causes it to have a thin black outline), and double-click again to select the outline view (causing the whole view to take on the current selection color).</p><p>For more detail on selecting subviews, see <span class="content_text"><a href="../chapter09/studio_ms_connect_intf.html#//apple_ref/doc/uid/20001256-BCICCIGJ">“Examining an Object Hierarchy in the Nib View.”</a></span></p><p></p></div></li><li class="li"><p>Congratulations—you’ve completed Mail Search’s user interface. If you haven’t saved recently, do so now.</p></li></ol>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../chapter07/studio_ms_design_app.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../chapter09/studio_ms_connect_intf.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-04-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter08/studio_ms_create_intf.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter08/studio_ms_create_intf.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/chapter08/studio_ms_create_intf.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>