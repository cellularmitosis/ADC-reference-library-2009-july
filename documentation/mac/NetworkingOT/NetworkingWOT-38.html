<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>About Options and Option Negotiation</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING38></A>
<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->

<!-- Main Body -->

<CENTER>
<P>
<A HREF="NetworkingWOT-37.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-39.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="NetworkingWOT-2.html"><B>Networking With Open Transport </B></A> / <A HREF="NetworkingWOT-10.html"><B>Part 1 - Open Transport Essentials</B></A><BR><DD><A HREF="NetworkingWOT-37.html"><B>Chapter 7 - Option Management</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING38-0></A>
<H1>About Options and Option Negotiation</H1>
 For every endpoint, Open Transport maintains an options buffer. When you create an endpoint provider, Open Transport fills this buffer with a default value for each option supported for the endpoint. Option values have meaning for and are defined by the protocol to which they apply. Typically, Open Transport uses endpoint options to control aspects of the endpoint's operation. For example, if a protocol guarantees reliable delivery of data, the protocol might define an option that specifies the number of times a send operation is retried before the send fails and an error message is generated. Protocol implementations provide default values for options to ensure maximum portability for your application across protocol families.<A NAME=MARKER-13-24></A><P>
 In writing a networking application, you can use an endpoint provider's default option values or you can replace these with other values to control the behavior of an endpoint. <A NAME=MARKER-13-25></A><B>Option negotiation</B> describes the process that results when you decide to replace default values with option values that you choose. A successful negotiation results in your obtaining exactly the option values you requested, a partly successful negotiation results in your getting different values for the options you requested, and a failed negotiation results in your not being able to change existing values at all.<P>
 Depending on the option you want to modify, a negotiation might involve a client and its endpoint provider, or it might involve both a local and remote client and their endpoint providers. In either case, it's important to keep in mind that the process is a negotiation--that is, before you can change the characteristics of an endpoint or change the way in which it transfers data or establishes a connection, an agreement has to be reached. If you cannot reach this agreement, the operation you are attempting to complete could fail. In this case, you might have to find a way of implementing the service you need other than through the use of options.<P>
<A NAME=HEADING38-4></A>
<H2>Explicit Use of <A NAME=MARKER-13-26></A>Options and Portability of Code</H2>
 The goal of the Open Transport architecture is to enable networking applications to migrate across protocol families and system platforms with little or no change to code. However, the price of transport independence or, ideally, transport transparency is that an application must be ready to forego features that are unique to a specific protocol in order to work equally well with protocols offering a similar type of service, such as connection-oriented transactionless service or connectionless transaction-based service. Because options are often coupled with a particular protocol or protocol family, making explicit use of options degrades portability across protocol families. Similarly, different system platforms might offer different option support for the same protocols due to different implementations. Thus, making use of options can also endanger portability across different system platforms. <A NAME=MARKER-13-27></A><P>
 Note, however, that protocols are not necessarily interchangeable and that you might very reasonably want to take advantage of a protocol feature that is only available through the use of options. If this is the case, you need to become familiar with the material presented in the following sections, which describe the Open Transport rules for option management and negotiation.<P>
<A NAME=HEADING38-7></A>
<H2>Types of Options</H2>
 The process of option negotiation is affected by the type of option involved. Options can be association-related, privileged, read-only, or absolute. For more information about these distinction and how they affect option negotiation, see <A HREF=NetworkingWOT-485.html#MARKER-9-7>"XTI Option Summary"</A>.<P>
<A NAME=HEADING38-9></A>
<H2>The Format of Option Information</H2>
 An option has a name and a value, it is defined for a specific protocol, and it takes up a certain amount of room in memory. The <A NAME=MARKER-13-28></A><CODE>TOption</CODE> structure used to define an option contains fields for each of these characteristics. As <A HREF=#MARKER-9-29>Figure 7-1</A> shows, an option is described by an option header and a value.<P>
<B>Figure 7-1  <A NAME=MARKER-9-29></A>The format of option information </B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/OTOM-L-02.gif"><P>
 The option header is the same for all options. It contains four fields that specify: <P>
<UL>
<P><LI>The length of the entire structure. The length includes the length of <BR>the option header and the length of the value field; it does not include <BR>added padding.
<P><LI>The protocol (level) for which the option applies. It is possible to set an option for any protocol that is part of an endpoint provider's configuration. For example, if you open an AppleTalk Transaction Protocol (ATP) endpoint, it is possible to set an option at the Datagram Delivery Protocol (DDP) level by specifying DDP for the <CODE>level</CODE> field. 
<P><LI>The name of the option. Each protocol implementation defines the names of options it supports.
<P><LI>The status of the option. The endpoint provider fills in this field to indicate the outcome of the option negotiation. <P>
</UL>
 The length and format of data in the value field depend on the option <BR>being defined. <P>
 <A NAME=MARKER-13-33></A>You store option information for an endpoint in a buffer containing one or more <CODE>TOption</CODE> structures. A <CODE>TNetbuf</CODE> structure describes the buffer. <A HREF=#MARKER-9-32>Figure 7-2</A> shows a <CODE>TNetbuf</CODE> structure, <CODE>MyOptBuf</CODE>, that describes an options buffer containing three options. The field <CODE>MyOptBuf.buf</CODE> points to the buffer; the field <CODE>MyOptBuf.len</CODE> specifies the actual length of the buffer.<A NAME=MARKER-13-40></A><P>
<B>Figure 7-2  <A NAME=MARKER-9-32></A>An options buffer</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/OTOM-L-03.gif"><P>
 You can concatenate several <CODE>TOption</CODE> structures in a buffer, as shown in <A HREF=#MARKER-9-32>Figure 7-2</A>, provided you observe the following rules: <P>
<UL>
<P><LI><CODE>TOption</CODE> structures must be quad-byte aligned within the buffer.
<P><LI>If you are using the <CODE>OTOptionManagement</CODE> function to set or verify option values, all options in the buffer must be for the same protocol. That is, the value of the <CODE>level</CODE> field must be the same. When used with any other function, the options buffer can contain options set for different protocols. <A NAME=MARKER-13-33></A><P>
</UL>
<A NAME=HEADING38-25></A>
<H2><A NAME=MARKER-9-34></A>XTI-Level Options and General Options </H2>
 In addition to options defined for specific protocols, Open Transport defines options called <I>XTI-level options</I> that are not specific to a particular endpoint. Some of these options are absolute requirements, which means that whatever protocol you are using must support these options. You need to consult the documentation for your protocol to determine the meaning of the option for your endpoint and for additional information about default values and ranges or valid values supported for the option. <A HREF=NetworkingWOT-216.html#MARKER-9-50>Table 7-1</A> provides a brief summary of XTI-level options. For more detailed information about these options, see "XTI-Level Options"<A HREF=NetworkingWOT-245.html#MARKER-9-20></A>.<P>
<B>Table 7-1  XTI-level options</B>
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-50></A></CAPTION>
<TH>Option name<TH>Description<TR>
<TD><CODE>XTI_DEBUG</CODE><TD>Enables debugging.<TR>
<TD><CODE>XTI_LINGER</CODE><TD>Specifies a linger period which delays the execution of the <CODE>OTCloseProvider</CODE> function.<TR>
<TD><CODE>XTI_RCVBUF</CODE><TD>Specifies the size of your endpoint's internal receive buffer.<TR>
<TD><CODE>XTI_RCVLOWAT</CODE><TD>Specifies the number of bytes that must accumulate in the endpoint's internal receive buffer before your application receives a <CODE>T_DATA</CODE> event signalling the arrival <BR>of data.<TR>
<TD><CODE>XTI_SNDBUF</CODE><TD>Specifies the size of your endpoint's internal send buffer.<TR>
<TD><CODE>XTI_SNDLOWAT&nbsp;&nbsp;</CODE><TD>Specifies the minimum number of bytes that can accumulate in the endpoint's internal send buffer before the provider actually sends the data.</TABLE>
<A NAME=MARKER-13-35></A><P>
 In addition to the XTI-level options, Open Transport defines the set of generic options listed in <A HREF=#MARKER-9-2>Table 7-2</A>. None of these options are absolute requirements. This means that if an Open Transport protocol supports the functionality of one of these options, it should use this option to do it. For additional information about generic options, see "Generic Options"<A HREF=NetworkingWOT-246.html#MARKER-9-32></A>.<P>
<B>Table 7-2  Open Transport generic options</B>
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-2></A></CAPTION>
<TH>Option name<TH>Description<TR>
<TD><CODE>OPT_CHECKSUM</CODE><TD>Specifies whether packets have checksums calculated <BR>on receipt.<TR>
<TD><CODE>OPT_RETRYCNT</CODE><TD>Specifies the number of times a function can attempt <BR>packet delivery.<TR>
<TD><CODE>OPT_INTERVAL</CODE><TD>Specifies the amount of time to wait between attempts to deliver a packet or request.<TR>
<TD><CODE>OPT_ENABLEEOM</CODE><TD>Specifies whether the <CODE>T_MORE</CODE> flag for the <CODE>OTSnd</CODE> function can be used to signal the end of a logical unit.<TR>
<TD>OPT_SELFSEND<TD>Specifies whether self-sending is enabled for broadcast messages.<TR>
<TD>OPT_SERVERSTATUS&nbsp;&nbsp;<TD>Specifies the status string that is used to answer a SendStatus request from a client.<TR>
<TD><CODE>OPT_KEEPALIVE</CODE><TD>Specifies the amount of time a connection should be maintained in the absence of data transfer.</TABLE>
<A NAME=MARKER-13-36></A><P>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DT><A HREF="NetworkingWOT-38.html#HEADING38-4">Explicit Use of Options and Portability of Code</A>
<DD>
<DT><A HREF="NetworkingWOT-38.html#HEADING38-7">Types of Options</A>
<DD>
<DT><A HREF="NetworkingWOT-38.html#HEADING38-9">The Format of Option Information</A>
<DD>
<DT><A HREF="NetworkingWOT-38.html#HEADING38-25">XTI-Level Options and General Options </A>
<DD>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="NetworkingWOT-37.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-39.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="NetworkingWOT-4.html">&copy; Apple Computer, Inc.</A><br>15 JAN 1998<P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML> 
