<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Automator Programming Guide: Developing an Action</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Developing an Action"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001511" title="Developing an Action"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000418" target="_top">Apple Applications</a> &gt; <a href="../../../Automator-date.html#//apple_ref/doc/uid/TP30000440-TP30000418-TP40001673" target="_top">Automator</a> &gt; <a href="../index.html" target="_top">Automator Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="AMDesignGuidelines.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ShowWhenRun.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001511-BAJBICGH" title="Developing an Action"></a><hr /><H1>Developing an Action</H1><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_114"></a>It’s easy to develop an Automator action. Because an action is a loadable bundle, its scope is limited and hence the amount of code you need to write is limited. Apple also eases the path to developing an action because of all the resources it places at your disposal. When you create an action project, the Xcode development environment provides you with all the necessary files and settings to build an action. You just need to follow certain steps—described in this document—to arrive at the final product.</p><p>The steps for developing an action don’t necessarily have to happen in the order given below. For example, you can write an action description at any time and you can specify the Automator properties at any time.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-96845">Creating an Automator Action Project</a>
				
			<br/>
			
        
			
			
				<a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-96877-BAJGBJEG">Constructing the User Interface</a>
				
			<br/>
			
        
			
			
				<a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-102207-BAJDJJHA">Specifying Action Properties</a>
				
			<br/>
			
        
			
			
				<a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-96903-BAJJJEGJ">Writing the Action Description</a>
				
			<br/>
			
        
			
			
				<a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-96961">Writing the Action Code</a>
				
			<br/>
			
        
			
			
				<a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-98896-BAJIHDGG">Internationalizing the Action</a>
				
			<br/>
			
        
			
			
				<a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-99146-BAJEGGBC">Testing, Debugging, and Installing the Action</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001511-96845" title="Creating an Automator Action Project"></a><h2>Creating an Automator Action Project</h2><p>To create an Automator action project<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_115"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_116"></a>, launch the Xcode<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_117"></a> application and choose New Project from the File Menu. From the first window of the New Project assistant, select one of the two Automator action projects, depending on your language choice:</p><ul class="simple"><li><p>AppleScript Automator Action</p></li><li><p>Cocoa Automator Action</p></li><li><p>Shell Script Automator Action</p></li></ul><p><span class="content_text">Figure 1</span> shows the selection of the Cocoa Automator action.</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-97059-BAJEFDJA" title="Figure 1Choosing a Cocoa Automator Action project type in Xcode"></a><p><a name="//apple_ref/doc/uid/TP40001511-97059" title="Figure 1Choosing a Cocoa Automator Action project type in Xcode"></a><strong>Figure 1&nbsp;&nbsp;</strong>Choosing a Cocoa Automator Action project type in Xcode</p><img src = "Art/automator_project_type.gif" alt = "Choosing a Cocoa Automator Action project type in Xcode" width="466" height="391"></div><br/><p>Complete the remaining window of the New Project assistant as usual—specify a file-system location for the project and enter a project name. When you finish, an Xcode window similar to the one in <span class="content_text">Figure 2</span> is displayed.</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-97088-BAJEGDBB" title="Figure 2Template files for a Cocoa Automator Action project"></a><p><a name="//apple_ref/doc/uid/TP40001511-97088" title="Figure 2Template files for a Cocoa Automator Action project"></a><strong>Figure 2&nbsp;&nbsp;</strong>Template files for a Cocoa Automator Action project</p><img src = "Art/automator_xcode_files.gif" alt = "Template files for a Cocoa Automator Action project" width="723" height="485"></div><br/><p>You’ll become more familiar with many of the files and file wrappers displayed here in the sections that follow. But here is a summary of the more significant items:</p><ul class="ul"><li class="li"><p><code>Automator.framework</code>—The project automatically adds the Automator framework<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_118"></a> to the project.</p></li><li class="li"><p><code>Info.plist<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_119"></a></code>—The information property list for the bundle includes the Automator properties; comments inserted in the value elements provide helpful hints. See <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-102207">“Specifying Action Properties”</a></span> for further information.</p></li><li class="li"><p><em>projectName</em><code>.h</code> and <em>projectName</em><code>.m</code>—A Cocoa action project includes header and implementation template files prepared for an AMBundleAction<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_120"></a> subclass (including a null implementation of <code>runWithInput:fromAction:error:</code><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_121"></a>).</p><p>An AppleScript action project includes a template <code>main.applescript<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_122"></a></code> file instead of Objective-C template files. A shell script action project includes a <code>main.command</code><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_123"></a> file instead.</p></li><li class="li"><p><code>main.nib<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_124"></a></code>—The bundle’s nib file, partially prepared for the action. See <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-96877">“Constructing the User Interface”</a></span> for details.</p></li></ul><a name="//apple_ref/doc/uid/TP40001511-96877" title="Constructing the User Interface"></a><a name="//apple_ref/doc/uid/TP40001511-96877-BAJGBJEG" title="Constructing the User Interface"></a><h2>Constructing the User Interface</h2><p>In the Xcode project browser, double-click <code>main.nib</code><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_125"></a> to open the nib file of the action in Interface Builder<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_126"></a>. The nib file<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_127"></a> contains the usual File’s Owner and First Responder instances, but it also contains two other items specific to actions:</p><ul class="ul"><li class="li"><p>A blank NSView object (known as the content view of the action, or simply, action view<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_128"></a>) on which you set the controls, text fields, and other user-interface elements for setting the parameters of the action. </p></li><li class="li"><p>An instance of the NSObjectController class<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_129"></a> named Parameters. The Parameters instance<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_130"></a> is used for establishing bindings between objects on the user interface and the action instance.</p></li><li class="li"><p>For AppleScript-based actions, an AppleScript Info instance<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_131"></a> that AppleScript Studio<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_132"></a> uses to contain the names and event handlers for objects in the nib file.</p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_11" title="Note"></a><p><strong>Note:</strong>&nbsp;Some actions, such as the Connect to Server action, do not have a user interface because there is no possible setting the user can make. Yet these actions still appear in a workflow showing their titles and accepted and provided data types. If your action is not supposed to have a user interface, remove the action-view instance from the nib file window or remove <code>main.nib</code> from the project.</p></div><p>Several objects and relationships in <code>main.nib</code> are already initialized for you. For example, File’s Owner<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_133"></a> is set in the Custom Class pane of the Info window to be an instance of the AMBundleAction class<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_134"></a> (as shown in <span class="content_text">Figure 3</span>). (If your project is for an AppleScript Automator action, File’s Owner is set instead to AMAppleScriptAction<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_135"></a>.) With File’s Owner still selected, if you choose the Connections pane of the Info window, you will see that the <code>view</code> outlet of the AMAction object has been connected to the action’s view. </p><br/><div><a name="//apple_ref/doc/uid/TP40001511-97121-BAJCJIEG" title="Figure 3FIle&acirc;&#128;&#153;s Owner set to an instance of AMBundleAction"></a><p><a name="//apple_ref/doc/uid/TP40001511-97121" title="Figure 3FIle&acirc;&#128;&#153;s Owner set to an instance of AMBundleAction"></a><strong>Figure 3&nbsp;&nbsp;</strong>FIle’s Owner set to an instance of AMBundleAction</p><img src = "Art/automator_files_owner.gif" alt = "FIle’s Owner set to an instance of AMBundleAction" width="733" height="451"></div><br/><p>Construct the user interface of the action as you would for any view in Interface Builder. However, keep in mind that actions, because they share space in an Automator workflow with other actions, should be compact, even minimal. Place only those controls, text fields, and other user-interface objects that are absolutely necessary. And try to be conservative in your use of vertical space; for example, prefer pop-up menus over radio buttons for presenting users with a choice among multiple options. For more on user-interface guidelines<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_136"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_137"></a> for actions, see <span class="content_text"><a href="AMDesignGuidelines.html#//apple_ref/doc/uid/TP40001510-97018">“The User Interface of an Action”</a></span> in <span class="content_text"><a href="AMDesignGuidelines.html#//apple_ref/doc/uid/TP40001510-BAJDDJAB">“Design Guidelines for Actions.”</a></span></p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_12" title="Note"></a><p><strong>Note:</strong>&nbsp;To learn how to use Interface Builder, read <em><a href="../../AutomatorTutorialAppleScript/index.html#//apple_ref/doc/uid/TP40002010" target="_top">Automator AppleScript Actions Tutorial</a></em> and consult the <em><a href="../../../../DeveloperTools/Conceptual/IBTips/index.html#//apple_ref/doc/uid/10000179i" target="_top">Interface Builder</a></em> documentation.</p></div><p>An important feature of Automator actions is Show When Run<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_138"></a>. This feature enables the users of workflows (as distinct from the <em>writers</em> of workflows) to set the parameters of actions when they run the workflow as an application. By default, actions have an Options<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_139"></a> disclosure button in their lower-left corner that, when enabled, exposes additional controls; these controls allow a workflow writer to select the parts of an action’s view that are presented to users when the workflow is executed. Developers can customize the Show When Run feature; see <span class="content_text"><a href="ShowWhenRun.html#//apple_ref/doc/uid/TP40001567-BAJEGHJF">“Show When Run”</a></span> for details.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_13" title="Important:"></a><p><strong>Important:</strong>&nbsp;If you are deploying the action in multiple localizations<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_140"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_141"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_142"></a>, make sure you create a separate nib file and user interface for each localization. See <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-98896">“Internationalizing the Action”</a></span> for further information.</p><p></p></div><a name="//apple_ref/doc/uid/TP40001511-125808" title="Using the Cocoa-Automator Palette"></a><a name="//apple_ref/doc/uid/TP40001511-125808-BAJJDECE" title="Using the Cocoa-Automator Palette"></a><h3>Using the Cocoa-Automator Palette</h3><p>The Automator development environment includes an Interface Builder palette<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_143"></a> with user-interface objects designed for actions. This palette is named Cocoa-Automator<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_144"></a>. To load this palette<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_145"></a>, select the Palettes pane in the Interface Builder preferences, click Add, and select <code>AMPalette.palette</code><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_146"></a> in <code>/Developer/Extras/Palettes</code>. </p><p>The Cocoa-Automator palette (see <span class="content_text">Figure 4</span>) contains three specially implemented pop-up menus for presenting easily configurable lists of applications, directories, and files to users. </p><br/><div><a name="//apple_ref/doc/uid/TP40001511-126177-CJBJIJJG" title="Figure 4Cocoa-Automator palette"></a><p><a name="//apple_ref/doc/uid/TP40001511-126177" title="Figure 4Cocoa-Automator palette"></a><strong>Figure 4&nbsp;&nbsp;</strong>Cocoa-Automator palette</p><img src = "Art/ampalette.gif" alt = "Cocoa-Automator palette" width="449" height="327"></div><br/><p>These lists provide access to standard or frequently accessed applications, folders, and files in the file system. For example, the Directories pop-up menu in an action looks something like the example in <span class="content_text">Figure 5</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-126781-BAJGAAGD" title="Figure 5The Directories pop-up menu in an action"></a><p><a name="//apple_ref/doc/uid/TP40001511-126781" title="Figure 5The Directories pop-up menu in an action"></a><strong>Figure 5&nbsp;&nbsp;</strong>The Directories pop-up menu in an action</p><img src = "Art/ampalette_popup_live.gif" alt = "The Directories pop-up menu in an action" width="183" height="209"></div><br/><p>You can also configure<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_147"></a> the pop-up menus so that users can locate items other than the standard ones on the list or (in the case of the Directories pop-up menu) create new items.</p><p>To place one of these pop-up menus, simply drag it from the palette to the action view. Then to configure the pop-up menu, choose Show Inspector from the Tools menu and select the Attributes pane (<span class="content_text">Figure 6</span>). The Attributes pane of Interface Builder allows you to configure a user-interface object in various ways. </p><br/><div><a name="//apple_ref/doc/uid/TP40001511-126210-CJBIFBDB" title="Figure 6Attributes inspector for Cocoa-Automator palette objects"></a><p><a name="//apple_ref/doc/uid/TP40001511-126210" title="Figure 6Attributes inspector for Cocoa-Automator palette objects"></a><strong>Figure 6&nbsp;&nbsp;</strong>Attributes inspector for Cocoa-Automator palette objects</p><img src = "Art/ampalette_inspect.gif" alt = "Attributes inspector for Cocoa-Automator palette objects" width="306" height="482"></div><br/><p>For Automator pop-up menus (AMPathPopUpButton objects), the special path options are the following:</p><dl class="termdef">	<dl class="content_text"><b>Types</b><dd><p>Allows users to choose either applications, directories, or files, or any combination of the three types. For example, if you check Directories and Files, users are able to select both directories and files from the pop-up menu.</p></dd></dl><dl class="content_text"><b>Choose</b><dd><p>Selecting New Paths adds a New item at the bottom of the pop-up menu. In the Directories pop-up menu, this allows users to create a new directory using a file-system browser; the New item does not appear in the other kinds of pop-up menus.</p><p>Selecting Existing Paths adds an Other item at the bottom of the pop-up menu. In all pop-up menu types, this item allows users to select anything in a file-system browser.</p></dd></dl><dl class="content_text"><b>Display</b><dd><p>When either the New or Open item is chosen and the Choose Panel as Sheet option is selected, the action displays the file-system browser as a worksheet-window-modal sheet rather than as an application-modal dialog.</p></dd></dl><dl class="content_text"><b>Show</b><dd><p>When the Standard Paths option is selected, the pop-up menu has the following items, depending on its type:</p><ul class="termdef"><li class="termdef"><p>If it is a Directories pop-up menu, standard locations such as Home, Desktop, Movies, and Pictures are included.</p></li><li class="termdef"><p>If it is an Applications pop-up menu, the list of items includes all applications in <code>/Applications</code>.</p></li><li class="termdef"><p>If it is a Files pop-up menu, nothing happens.</p></li></ul><p>When the Path Components option is selected, the full path of the current chosen item is displayed. </p><p>When the Placeholder option is selected, whatever you enter in the Placeholder text field directly under the option is displayed as the first pop-up item. This placeholder is typically a string such as “Choose an application” or “No selection”.</p></dd></dl></dl><p>Before an AMPathPopUpButton pop-up menu<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_148"></a> can properly function in an action view, you must establish a binding between the pop-up menu and a property of the action parameters. To do this, specify a key for the property as an attribute of the Parameters instance (see <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-127776">“Establishing Bindings”</a></span> for the procedure). Finally, select the pop-up menu in the user interface and then specify the key in the Bindings pane of the inspector, using the path binding; see <span class="content_text">Figure 7</span> for an example.</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-127768-BAJGDCJI" title="Figure 7The path binding for the pop-up menu"></a><p><a name="//apple_ref/doc/uid/TP40001511-127768" title="Figure 7The path binding for the pop-up menu"></a><strong>Figure 7&nbsp;&nbsp;</strong>The path binding for the pop-up menu</p><img src = "Art/ampalette_path_bind.gif" alt = "The path binding for the pop-up menu" width="260" height="403"></div><br/><a name="//apple_ref/doc/uid/TP40001511-127776" title="Establishing Bindings"></a><a name="//apple_ref/doc/uid/TP40001511-127776-BAJEEADD" title="Establishing Bindings"></a><h3>Establishing Bindings</h3><p>After constructing the action’s view, establish the bindings<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_149"></a> between the objects on the user interface and the action object. Bindings are a Cocoa technology conceptually based in the Model-View-Controller paradigm<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_150"></a>. In Model-View-Controller, objects in a well-designed program assume one of three roles: view objects that present data and receive user input; model objects that contain data and operate on that data; and controller objects that mediate the transfer of data between view and model objects. The bindings mechanism automatically synchronizes the exchange of data between view and model objects, reducing the need for custom controller objects and all the “glue” code they usually entail. Automator actions use bindings to communicate data between objects in an action’s view and the parameters<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_151"></a> dictionary (or record) that all actions have to record the settings users specify for an action.</p><p>The project templates for Automator actions are pre-configured to use bindings instead of the target-action<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_152"></a> and outlet<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_153"></a> mechanisms (for Cocoa-based actions) or event handlers<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_154"></a> specified in the AppleScript pane of Interface Builder for AppleScript-based actions. If you prefer, you may use these mechanisms along with the Automator framework’s “update parameters” API to update an action’s parameters manually<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_155"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_156"></a>. For information on this approach, see <span class="content_text"><a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-98354">“Updating Non-bound Parameters”</a></span> (for AppleScript-based actions) or <span class="content_text"><a href="ImplementObjCAction.html#//apple_ref/doc/uid/TP40001513-98935">“Updating Action Parameters”</a></span> (for Objective-C actions).</p><p>The following steps summarize what you must do to establish the bindings of an action in Interface Builder. For a thorough description of the Cocoa bindings technology, see <em><a href="../../../../Cocoa/Conceptual/CocoaBindings/index.html#//apple_ref/doc/uid/10000167i" target="_top">Cocoa Bindings Programming Topics</a></em>.</p><ol class="ol"><li class="li"><p>Select the Parameters instance in the nib file window and choose the Attributes pane of the Info window. In the table labeled “Keys” add the keys for each user-interface object whose setting or value you need to access. See <span class="content_text">Figure 8</span> for an example.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001511-125907-BAJEDIJF" title="Figure 8Adding the keys of the Parameters instance (NSObjectController)"></a><p><a name="//apple_ref/doc/uid/TP40001511-125907" title="Figure 8Adding the keys of the Parameters instance (NSObjectController)"></a><strong>Figure 8&nbsp;&nbsp;</strong>Adding the keys of the Parameters instance (NSObjectController)</p><img src = "Art/automator_binding_keys.gif" alt = "Adding the keys of the Parameters instance (NSObjectController)" width="708" height="470"></div><p>The keys that you specify here are used elsewhere in the action to identify the controls of the action. You must therefore use the same strings you used for the binding keys in the following places in the action project: </p><ul class="ul"><li class="li"><p>As the keys for the <code>AMDefaultParameters<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_157"></a></code> property of Automator. (The <code>AMDefaultParameters</code> property specifies the initial settings of an action; see <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-102207">“Specifying Action Properties”</a></span> and <span class="content_text"><a href="AutomatorPropRef.html#//apple_ref/doc/uid/TP40001515-BCIJHBJC">“Automator Action Property Reference”</a></span> for details.) A matching <code>AMDefaultParameters</code> entry must be added for each key used with a binding.</p></li><li class="li"><p>As the names of outlet instance variables and accessor methods in Objective-C actions</p></li><li class="li"><p>As the keys to the parameters record passed into an AppleScript-based action in its <code>on run</code> handler; see <span class="content_text"><a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-97148">“The Structure of the on run Command Handler”</a></span> for further information.</p></li><li class="li"><p>As the environment variables set for a shell script action; see <span class="content_text"><a href="ShellScriptActions.html#//apple_ref/doc/uid/TP40002078-BCIBAEAC">“Creating Shell Script Actions”</a></span> for details.</p></li></ul></li><li class="li"><p>With the Parameters instance still selected, choose the Bindings pane of the Info window and expand the “contentObject” subpane. Set the “Bind to” pop-up item to File’s Owner and enter <code>parameters</code> in the “Model Key Path” field. </p><p>The parameters key path refers to the <code>parameters</code> property defined by the AMBundleAction class—that is, the dictionary or record used to capture the settings users make in an action’s view.</p></li><li class="li"><p>For each user-interface object of the action, establish a binding to the appropriate parameters key. For example, <span class="content_text">Figure 9</span> shows the binding for a pop-up menu.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001511-125997-BAJDCCAI" title="Figure 9Establishing a binding for a pop-up menu"></a><p><a name="//apple_ref/doc/uid/TP40001511-125997" title="Figure 9Establishing a binding for a pop-up menu"></a><strong>Figure 9&nbsp;&nbsp;</strong>Establishing a binding for a pop-up menu</p><img src = "Art/automator_set_binding.gif" alt = "Establishing a binding for a pop-up menu" width="485" height="620"></div><p>The binding varies by type of user-interface object. For example, pop-up menus usually work off the index of the item (<code>selectedIndex</code>), check boxes have a Boolean <code>value</code>, and text fields have a string <code>value</code>.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_14" title="Important:"></a><p><strong>Important:</strong>&nbsp;When establishing a binding between a text field and a parameter key, make sure that the "Continuously Updates Value" checkbox in the inspector pane for the <code>value</code> binding is enabled. Otherwise, the parameter is not updated if the insertion point does not exit the text field (as happens, for example, when the user presses Tab). </p><p></p></div></li></ol><p>When you are finished with the action’s user interface, save the nib file and return to the Xcode project. </p><a name="//apple_ref/doc/uid/TP40001511-102207" title="Specifying Action Properties"></a><a name="//apple_ref/doc/uid/TP40001511-102207-BAJDJJHA" title="Specifying Action Properties"></a><h2>Specifying Action Properties</h2><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_158"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_159"></a>The Automator application uses special properties in an action’s information property list (<code>Info.plist<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_160"></a></code>) to get various pieces of information it needs for presenting and handling the action. This information includes:</p><ul class="ul"><li class="li"><p>The name<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_161"></a> of the action</p></li><li class="li"><p>The icon<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_162"></a> for the action</p></li><li class="li"><p>The application, category, and keywords<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_163"></a> for the action</p></li><li class="li"><p>The types of data the action<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_164"></a> accepts and the types of data it provides</p></li><li class="li"><p>The description of the action</p></li></ul><p>Automator properties have the prefix “AM”. The project template for actions includes almost all of the properties you need (or may need) to specify. As shown in <span class="content_text">Figure 10</span>, the template provides helpful comments as placeholders for key values. In creating an action, you need to supply real values for these keys. <span class="content_text"><a href="AutomatorPropRef.html#//apple_ref/doc/uid/TP40001515-BCIJHBJC">“Automator Action Property Reference”</a></span> describes the Automator properties, including their purpose, value types, and representative values.</p><p>Because the values of some Automator properties appear in the user interface, you should include translations of them in an <code>Infoplist.strings<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_165"></a></code> file for each action localization<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_166"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_167"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_168"></a> you provide. See <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-98896">“Internationalizing the Action”</a></span> for further information.</p><p>In addition to properties that are specific to Automator, an action’s <code>Info.plist</code> file contains properties that are common to all bundles, including applications as well as action bundles. The values of most of these generic bundle properties are supplied automatically when you create a project. However, you must specify the value of the <code>CFBundleIdentifier</code> property. Automator uses this property to find an action and its resources. The identifier needs to be unique, and should use the standard format:</p><p><code>com.</code><em>CompanyName</em><code>.Automator.</code><em>ActionIdentifier</em></p><p>For example, if your company’s name is Acme and your action is named Find Foo Items, a suitable <code>CFBundleIdentifier</code> would be <code>com.Acme.Automator.FindFooItems</code>.</p><p>The Automator project templates preset two properties, <code>AMName</code> and the action-identifier portion of <code>CFBundleIdentifier</code>, with placeholder text. When you create a project, the name of the project is substituted for the placeholders. (If the project name contains spaces, Xcode substitutes underscore character for the spaces in the bundle identifier.)</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-102274-BAJIEGBI" title="Figure 10Part of the template for the Automator properties in Info.plist"></a><p><a name="//apple_ref/doc/uid/TP40001511-102274" title="Figure 10Part of the template for the Automator properties in Info.plist"></a><strong>Figure 10&nbsp;&nbsp;</strong>Part of the template for the Automator properties in Info.plist</p><img src = "Art/automator_properties.gif" alt = "Part of the template for the Automator properties in Info.plist" width="682" height="414"></div><br/><p>To edit <code>Info.plist</code> manually in an Xcode window, just double-click the filename in the project window. If you would like always to open up the <code>Info.plist</code> file in a different editor for property lists, such as the Property List Editor application or BBEdit, use the Finder’s Get Info window to set the default application for files with extension <code>.plist</code>. Then in Xcode, use the contextual menu command Open with Finder. However, the preferred tool for editing Automator properties is to use the built-in Automator property Inspector, which was introduced in Xcode 2.1.</p><a name="//apple_ref/doc/uid/TP40001511-126304" title="Using the Automator Property Inspector"></a><h3>Using the Automator Property Inspector</h3><p>You can edit the information property list as a text file in Xcode. Just double-click the <code>Info.plist</code> file in the project window and the file will open in a separate window or pane. However, syntax errors can frequently happen when you edit a property list by hand. Instead you can use the Automator property inspector<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_169"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_170"></a>, which makes the entering of property values easier and less susceptible to error. </p><p>This inspector is built into Xcode for all Automator project types. To access the inspector, do the following:</p><ol class="ol"><li class="li"><p>Choose Edit Active Target ‘<em>Target</em>’ from the Project menu.</p></li><li class="li"><p>Click the Properties tab.</p></li></ol><p>The lower part of the inspector, which is usually reserved for specifying document types, is here used for Automator-specific properties. The inspector breaks the properties into logical collections; the first collection shows the General properties (<span class="content_text">Figure 11</span>).</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-126431-BAJBEFID" title="Figure 11Automator property inspector&acirc;&#128;&#148;General properties"></a><p><a name="//apple_ref/doc/uid/TP40001511-126431" title="Figure 11Automator property inspector&acirc;&#128;&#148;General properties"></a><strong>Figure 11&nbsp;&nbsp;</strong>Automator property inspector—General properties</p><img src = "Art/amproperty_inspector1.gif" alt = "Automator property inspector—General properties" width="459" height="422"></div><br/><p>In an inspector view such as the one in <span class="content_text">Figure 11</span>, double-click a cell under Value to open the cell for entering a value. If, for example, you want to enable the Show When Run feature for the action, click the appropriate check boxes.</p><p>If you expose the Collection pop-up menu, you’ll see other logical collections of Automator properties. <span class="content_text">Figure 12</span> shows the collection for the <code>AMAccepts</code> property (Input).</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-126452-BAJHDEDD" title="Figure 12Automator property inspector&acirc;&#128;&#148;Input properties"></a><p><a name="//apple_ref/doc/uid/TP40001511-126452" title="Figure 12Automator property inspector&acirc;&#128;&#148;Input properties"></a><strong>Figure 12&nbsp;&nbsp;</strong>Automator property inspector—Input properties</p><img src = "Art/amproperty_inspector2.gif" alt = "Automator property inspector—Input properties" width="459" height="422"></div><br/><p>When the property is an array, as with <code>AMAccepts</code>, click the plus sign in the lower left corner of the inspector to open a new field for editing. Enter the value (in this case a type identifier). To delete an item from the array, select it and click the minus sign.<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_171"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_172"></a></p><a name="//apple_ref/doc/uid/TP40001511-96903" title="Writing the Action Description"></a><a name="//apple_ref/doc/uid/TP40001511-96903-BAJJJEGJ" title="Writing the Action Description"></a><h2>Writing the Action Description</h2><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_173"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_174"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_175"></a>A small but important part of action development is writing the action description. Automator displays the description it its lower-left view whenever the user selects the action. The description briefly describes what the action does and tells users anything else they should know about the action. <span class="content_text">Figure 13</span> shows what a typical description looks like.</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-101559-BAJCHFGA" title="Figure 13An sample action description"></a><p><a name="//apple_ref/doc/uid/TP40001511-101559" title="Figure 13An sample action description"></a><strong>Figure 13&nbsp;&nbsp;</strong>An sample action description</p><img src = "Art/description_example.gif" alt = "An sample action description" width="425" height="182"></div><br/><p>Because the description fits into a relatively small area of the Automator window, you should make it as concise and brief as possible. Ideally the user should not have to scroll the description view to see all of the text.</p><p>A description has several parts, each of which you specify through an Automator property in the bundle’s information property list (<code>Info.plist</code>):</p><ul class="ul"><li class="li"><p><strong>Icon</strong>. <a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_176"></a>A 32 x 32 pixel TIFF image displayed in the upper-left corner of the description. It is the application icon that the <code>AMIconName<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_177"></a></code> property specifies (see <span class="content_text"><a href="AutomatorPropRef.html#//apple_ref/doc/uid/TP40001515-99973">“Property Keys and Values”</a></span>).</p></li><li class="li"><p><strong>Title</strong>. <a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_178"></a>The string that you specify for the <code>AMName<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_179"></a></code> property (see <span class="content_text"><a href="AutomatorPropRef.html#//apple_ref/doc/uid/TP40001515-99973">“Property Keys and Values”</a></span>). </p></li><li class="li"><p><strong>Summary</strong>. A sentence or two directly under the title that succinctly states what the action does. </p></li><li class="li"><p><strong>Input</strong> and <strong>Result</strong>. States the types of data that the action accepts and provides. Automator enters default values for these sections if you do not specify anything.</p></li><li class="li"><p><strong>Options</strong>. Summarizes the configuration options on the action’s user interface.</p></li><li class="li"><p><strong>Requires</strong>. Describes any requirement for the action to work properly—for example, Safari must be displaying a web page.</p></li><li class="li"><p><strong>Alert</strong>. Warns the user of any likely consequence of the action—for example, if it will delete a calendar.</p></li><li class="li"><p><strong>Note</strong>. Presents additional information that is not as critical as an alert.</p></li><li class="li"><p><strong>Related actions</strong>. Indicates actions that are related to this one—for example, an Import Image action might mention an Export Image action.</p></li></ul><p>A description’s icon, title, summary, input, and result sections are required or strongly recommended. All of the properties listed above, except for icon and title, are subproperties of the description-specific <code>AMDescription<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_180"></a></code> property. The <code>AMDescription</code> example in <span class="content_text">Listing 1</span> shows the subproperties specified for the Send Birthday Greeting description depicted in <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-101559-BAJCHFGA">Figure 13</a></span>. </p><a name="//apple_ref/doc/uid/TP40001511-101754-BAJFBGAI" title="Listing 1AMDescription properties for Send Birthday Greetings description"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001511-101754" title="Listing 1AMDescription properties for Send Birthday Greetings description"></a><strong>Listing 1&nbsp;&nbsp;</strong>AMDescription properties for Send Birthday Greetings description</p><div class="codesample"><table><tr><td scope="row"><pre>    &lt;key>AMDescription&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>AMDInput&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Address Book entries from previous action.&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>AMDOptions&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>Birthday message. Choice of picture.<span></span></pre></td></tr><tr><td scope="row"><pre>            Randomly chosen picture. &lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>AMDSummary&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>This action sends an email birthday greeting, with a<span></span></pre></td></tr><tr><td scope="row"><pre>            picture, to each of the Address Book entries.&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/dict><span></span></pre></td></tr></table></div><p>See <span class="content_text"><a href="AutomatorPropRef.html#//apple_ref/doc/uid/TP40001515-99973">“Property Keys and Values”</a></span> for further information on the <code>AMDescription</code> keys and values.<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_181"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_182"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_183"></a></p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_15" title="Important:"></a><p><strong>Important:</strong>&nbsp;If you are deploying the action in multiple localizations, make sure you create a separate description for each localization. See <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-98896">“Internationalizing the Action”</a></span> for further information.</p><p></p></div><a name="//apple_ref/doc/uid/TP40001511-96961" title="Writing the Action Code"></a><h2>Writing the Action Code</h2><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_184"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_185"></a>The most important step in creating an action is writing the Objective-C or AppleScript code (or Objective-C <em>and</em> AppleScript code) that implements the logic for your action. The project template for Automator actions gives you template<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_186"></a> files for action implementation:</p><ul class="ul"><li class="li"><p><em>projectName</em><code>.h</code> and <em>projectName</em><code>.m</code> files for Objective-C actions</p></li><li class="li"><p><code>main.applescript<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_187"></a></code> for AppleScript<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_188"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_189"></a> actions</p></li><li class="li"><p><code>main.command</code> for shell script actions</p></li></ul><p>The template files fill out as much of the required structure as possible. The Objective-C header file, for example, has the necessary framework imports and an <code>@interface</code> declaration showing inheritance from AMBundleAction<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_190"></a>. The Objective-C implementation includes a null implementation of the method that all actions must implement, <code>runWithInput:fromAction:error: <a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_191"></a></code> (see <span class="content_text">Figure 14</span>). The <code>main.applescript</code> file, on the other hand, has a skeletal structure for the <code>on run<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_192"></a></code> command handler that all AppleScript-based actions must implement.</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-97191-BAJJJBJJ" title="Figure 14Template for an Objective-C action implementation"></a><p><a name="//apple_ref/doc/uid/TP40001511-97191" title="Figure 14Template for an Objective-C action implementation"></a><strong>Figure 14&nbsp;&nbsp;</strong>Template for an Objective-C action implementation</p><img src = "Art/automator_m_template.gif" alt = "Template for an Objective-C action implementation" width="584" height="280"></div><br/><p>See <span class="content_text"><a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-CJBJEJBE">“Implementing an AppleScript Action”</a></span> and <span class="content_text"><a href="ImplementObjCAction.html#//apple_ref/doc/uid/TP40001513-BCICCECC">“Implementing an Objective-C Action”</a></span> for requirements, suggestions, and examples related to implementing an Automator action. For guidelines on implementing shell script actions, see <span class="content_text"><a href="ShellScriptActions.html#//apple_ref/doc/uid/TP40002078-98117">“Writing the Script.”</a></span></p><a name="//apple_ref/doc/uid/TP40001511-98896" title="Internationalizing the Action"></a><a name="//apple_ref/doc/uid/TP40001511-98896-BAJIHDGG" title="Internationalizing the Action"></a><h2>Internationalizing the Action</h2><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_193"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_194"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_195"></a>Most polished applications that are brought to market feature multiple localizations. These applications not only include the localizations—that is, translations and other locale-specific modifications of text, images, and other resources—but have been internationalized to make those localizations immediately accessible. Internationalizing involves a number of techniques that depend on a “preferred languages” user preference and a system architecture for accessing resources in bundles. Loadable bundles (which, of course, are bundles just as applications are) depend upon the same mechanisms for internationalization. </p><p>The following sections summarize what you must do to internationalize your actions. For the complete picture, see <em><a href="../../../../MacOSX/Conceptual/BPInternational/index.html#//apple_ref/doc/uid/10000171i" target="_top">Internationalization Programming Topics</a></em> for a general description of internationalization and <em><a href="../../../../MacOSX/Conceptual/BPInternational/index.html#//apple_ref/doc/uid/10000171i" target="_top">Internationalization Programming Topics</a></em>, for a discussion that is specific to Cocoa.</p><a name="//apple_ref/doc/uid/TP40001511-99011" title="Localized Strings"></a><a name="//apple_ref/doc/uid/TP40001511-99011-BAJGCIBJ" title="Localized Strings"></a><h3>Localized Strings</h3><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_196"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_197"></a>If your action programmatically generates strings and you want localized versions displayed, you need to internationalize your software using access techniques that are different for Objective-C actions and script-based actions.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_16" title="Note"></a><p><strong>Note:</strong>&nbsp;Programmatically generated strings have their basis in code, such as a message that appears in an error dialog. They do not include text that appears in a user interface unarchived from a nib file. Nib files are localized just as are other resource files; see <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-99123">“Internationalizing Resource Files”</a></span> for a summary of the procedure. </p></div><p>Both Objective-C and AppleScript actions require you to create for each localization a strings file<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_198"></a>, which is a file with an extension of <code>.strings</code>. (The conventional, or default, name for a strings file is <code>Localizable.strings<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_199"></a></code>.) Each entry in a strings file contains a key and a value; the key is the string in the development language and the value is the translated string. An entry can also have a comment to aid translators. Use a semicolon to terminate an entry. Here are a few examples:</p><div class="codesample"><table><tr><td scope="row"><pre>/* Title of alert panel which brings up a warning about<span></span></pre></td></tr><tr><td scope="row"><pre>saving over the same document */<span></span></pre></td></tr><tr><td scope="row"><pre>"Are you sure you want to overwrite the document?" =<span></span></pre></td></tr><tr><td scope="row"><pre>"Souhaitez-vous vraiment écraser le document ?";<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>/* Encoding pop-up entry indicating automatic choice of encoding */<span></span></pre></td></tr><tr><td scope="row"><pre>"Automatic" = "Automatique";<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>/* Button choice allowing user to cancel. */<span></span></pre></td></tr><tr><td scope="row"><pre>"Cancel" = "Annuler";<span></span></pre></td></tr></table></div><p>When you have completed a <code>Localizable.strings</code> file for a localization, you must internationalize it just as you would any other language- or locale-specific resource file of the bundle. See <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-99123">“Internationalizing Resource Files”</a></span> for a summary.</p><p>For Objective-C code, use the <code><a href="../../../../Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/doc/c_ref/NSLocalizedString" target="_top">NSLocalizedString</a></code><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_200"></a>macro or one of the other <code><!--a-->NSLocalizedString...<!--/a--></code> macros to request a localization appropriate for the current user preference. <span class="content_text">Listing 2</span> gives an example that shows the use of <code><a href="../../../../Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/doc/c_ref/NSLocalizedString" target="_top">NSLocalizedString</a></code> in conjunction with the NSString <code>stringWithFormat:</code> method.</p><a name="//apple_ref/doc/uid/TP40001511-99895-BAJICAHB" title="Listing 2Using NSLocalizedString in Objective-C code"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001511-99895" title="Listing 2Using NSLocalizedString in Objective-C code"></a><strong>Listing 2&nbsp;&nbsp;</strong>Using NSLocalizedString in Objective-C code</p><div class="codesample"><table><tr><td scope="row"><pre>- (NSString *)displayName<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    int cnt = [pdfView pageCount];<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString *name;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (cnt == 1) {<span></span></pre></td></tr><tr><td scope="row"><pre>        NSString *format = NSLocalizedString(@"%@ (1 page)",<span></span></pre></td></tr><tr><td scope="row"><pre>            @"Window title for a document with a single page");<span></span></pre></td></tr><tr><td scope="row"><pre>        name = [NSString stringWithFormat:format, fileName];<span></span></pre></td></tr><tr><td scope="row"><pre>    } else {<span></span></pre></td></tr><tr><td scope="row"><pre>        NSString *format = NSLocalizedString(@"%@ (%d pages)",<span></span></pre></td></tr><tr><td scope="row"><pre>            @"Window title for a document with multiple pages");<span></span></pre></td></tr><tr><td scope="row"><pre>        name = [NSString stringWithFormat:format, fileName, cnt];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return name;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>For AppleScript scripts the command equivalent to <code><a href="../../../../Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/doc/c_ref/NSLocalizedString" target="_top">NSLocalizedString</a></code> is <code>localized string<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_201"></a></code>. One good approach is to have a local subroutine that takes the string to localize as a parameter and uses the <code>localized string</code> command on it, as in <span class="content_text">Listing 3</span>.</p><a name="//apple_ref/doc/uid/TP40001511-100637-BAJECDEF" title="Listing 3Script handler for localizing strings"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40001511-100637" title="Listing 3Script handler for localizing strings"></a><strong>Listing 3&nbsp;&nbsp;</strong>Script handler for localizing strings</p><div class="codesample"><table><tr><td scope="row"><pre>on localized_string(key_string)<span></span></pre></td></tr><tr><td scope="row"><pre>return localized string key_string in bundle with identifier "com.apple.Automator.myAction"<span></span></pre></td></tr><tr><td scope="row"><pre>end localized_string<span></span></pre></td></tr></table></div><p>Elsewhere in <code>main.applescript</code> and in other scripts for the action, call this subroutine when you need to get a string in the current localization:<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_202"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_203"></a></p><div class="codesample"><table><tr><td scope="row"><pre>    if the calendar_name is my localized_string("No Calendars") then        error my localized_string("The copy of iCal on this computer contains no calendars to clear.")<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001511-99930" title="Localizing the Automator Properties"></a><h3>Localizing the Automator Properties</h3><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_204"></a>A standard variant of a strings file for projects is <code>Infoplist.strings</code>. In this file you assign localized strings (that is, translations) to the keys that appear in the <code>Info.plist</code> file. For Automator, this includes not only the top-level properties such as <code>AMName</code> but subproperties of Automator properties. For example, the following excerpt is from the <code>Infoplist.strings</code> file for the Crop Images action:</p><div class="codesample"><table><tr><td scope="row"><pre>AMName = "Crop Images";<span></span></pre></td></tr><tr><td scope="row"><pre>ApplyButton = "Add";<span></span></pre></td></tr><tr><td scope="row"><pre>IgnoreButton = "Don't Add";<span></span></pre></td></tr><tr><td scope="row"><pre>Message = "This action will change the image files passed into it.  Would you like to add a Copy Files action so that the copies are changed and your originals are preserved?";<span></span></pre></td></tr></table></div><p>The key-value pairs in this example include not only an English-localized value for the <code>AMName</code> property but localized strings for the subproperties of the <code>AMWarning</code> property. </p><a name="//apple_ref/doc/uid/TP40001511-99123" title="Internationalizing Resource Files"></a><a name="//apple_ref/doc/uid/TP40001511-99123-BAJGHGJI" title="Internationalizing Resource Files"></a><h3>Internationalizing Resource Files</h3><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_205"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_206"></a>You should internationalize any file in your action project that contains data that is specific to a language or locale. These files include:</p><ul class="spaceabove"><li class="li"><p>Nib files</p></li><li class="li"><p>Image files</p></li><li class="li"><p>Strings files (<code>Localizable.strings<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_207"></a></code>)</p></li><li class="li"><p><code>Infoplist.strings<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_208"></a></code></p></li></ul><p>Internationalization of a resource file simply entails the assignment of a language or locale to the file. When you build the action project, Xcode automatically puts the resource in a localization subdirectory of the bundle’s <code>Resources</code> directory. Localization subdirectories have an extension of <em>.lproj</em> (for example, <code>French.lproj</code>). </p><p>To internationalize a resource file, do the following:</p><ol class="ol"><li class="li"><p>Select the Resources folder in Xcode.</p></li><li class="li"><p>Add the file to the project (Project > Add Files).</p></li><li class="li"><p>Select the file and choose Get Info from the Project menu.</p></li><li class="li"><p>Click Make File Localizable.</p></li><li class="li"><p>Click Add Localization and enter or select a language or locale.<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_209"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_210"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_211"></a></p></li></ol><a name="//apple_ref/doc/uid/TP40001511-99146" title="Testing, Debugging, and Installing the Action"></a><a name="//apple_ref/doc/uid/TP40001511-99146-BAJEGGBC" title="Testing, Debugging, and Installing the Action"></a><h2>Testing, Debugging, and Installing the Action</h2><p>An action project is automatically set up in Xcode<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_212"></a> so that when you choose the Run or Debug commands, Xcode launches the Automator action and adds your action to the set of actions loaded by Automator. To see how this is done, select Automator in the Executables smart group and choose Edit Active Executable from the Project menu. As you can see, in the General pane of the inspector the “Executable path” value is set to <code>/Applications/Automator.app</code>. Select the Arguments pane of the inspector and note that the <code>-action</code> launch-time argument has been set to your action (<span class="content_text">Figure 15</span>).</p><br/><div><a name="//apple_ref/doc/uid/TP40001511-97307-BAJBBJGE" title="Figure 15Setting the launch argument for Automator"></a><p><a name="//apple_ref/doc/uid/TP40001511-97307" title="Figure 15Setting the launch argument for Automator"></a><strong>Figure 15&nbsp;&nbsp;</strong>Setting the launch argument for Automator</p><img src = "Art/automator_exec_args.gif" alt = "Setting the launch argument for Automator" width="615" height="550"></div><br/><a name="//apple_ref/doc/uid/TP40001511-103180" title="Testing and Debugging Strategies"></a><h3>Testing and Debugging Strategies</h3><p>To test<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_213"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_214"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_215"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_216"></a> your action, build and run the action project (Build > Build and Run). As Automator builds the project it runs the <code>amlint</code> utility<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_217"></a> in a build phase. The <code>amlint</code> tool performs integrity checks to make sure the action is properly constructed; for example, it verifies that all required Automator properties have been set. It integrates its warning messages with the other messages in the Xcode Build Results window. Although amlint does not generate error messages (thereby halting the build), you should investigate and fix all reported problems before you build a deployment version of the action. To find out more about <code>amlint</code>, see the man page for it (which you can access from Xcode’s Help menu).</p><p>When Automator launches, you should create a workflow which contains your action. Run the workflow and observe how your action performs. To get better data from testing, consider the following steps:</p><ul class="spaceabove"><li class="li"><p>Use the View Results action to see the output of prior actions.</p></li><li class="li"><p>Use the Confirmation Dialog action to pause or cancel execution of the workflow.</p></li><li class="li"><p>Add one each of the above two actions between each action.</p></li></ul><p>If the action is based on AppleScript, you can use the Run AppleScript action<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_218"></a> to test your <code>on run<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_219"></a></code> command handler as you write it.</p><p>If your action is based on an Objective-C implementation, you can debug<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_220"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_221"></a> an action just as you would any other Objective-C binary. Simply set a breakpoint in Xcode. When your action is run in Automator, the breakpoint will trigger in <code>gdb</code>. You can also debug AppleScript actions using a special graphical debugger, which is preset for AppleScript action projects. This debugger looks and behaves very much like the graphical debugger for <code>gdb</code> does. It stops at breakpoints, displays variables, and lets you step through the script. The variables include globals, locals, and properties. <span class="content_text">Figure 16</span> shows the AppleScript debugger<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_222"></a> in action.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_17" title="Note"></a><p><strong>Note:</strong>&nbsp;To learn about strategies for debugging shell script actions, see <span class="content_text"><a href="ShellScriptActions.html#//apple_ref/doc/uid/TP40002078-98705">“Debugging and Testing Shell Script Actions.”</a></span> For related information on AppleScript actions, see “Building and Testing the Action” in <em><a href="../../AutomatorTutorialAppleScript/index.html#//apple_ref/doc/uid/TP40002010" target="_top">Automator AppleScript Actions Tutorial</a></em>.</p></div><br/><div><a name="//apple_ref/doc/uid/TP40001511-127235-BAJCAHHF" title="Figure 16The AppleScript debugger"></a><p><a name="//apple_ref/doc/uid/TP40001511-127235" title="Figure 16The AppleScript debugger"></a><strong>Figure 16&nbsp;&nbsp;</strong>The AppleScript debugger</p><img src = "Art/applescript_debugger.gif" alt = "The AppleScript debugger" width="623" height="731"></div><br/><p>To debug AppleScript actions, you can also insert <code>log</code> or <code>display dialog</code> statements in the code. If the log statement is inside an application <code>tell</code> block, use the <code>tell me to log</code> expression instead of the simple <code>log</code>.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_18" title="Note"></a><p><strong>Note:</strong>&nbsp;If you install an action in one of the standard locations and then make certain changes to it—for example, changing its <code>AMAccepts</code> and <code>AMProvides</code> types—then you must clear the action cache before you can see your changes. To clear the cache, hold the Option key when Automator launches. (You do not need to clear the cache when the action is run during the normal development processes—that is, with the action specified in the <code>-action</code> parameter when Automator is launched by Xcode.) </p></div><a name="//apple_ref/doc/uid/TP40001511-103292" title="Installing Actions"></a><h3>Installing Actions</h3><p>When your action has been thoroughly debugged and tested, build a deployment version of the bundle (using the proper optimizations). Then create an installation package for the action (or add the action to your application’s installation<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_223"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_224"></a> package). The installer should copy the action to <code>/Library/Automator</code> or <code>~/Library/Automator</code>, depending on whether access to the action should be system wide or restricted to the installing user.</p><p>Instead of installing your action separately, you can put it inside the <a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_225"></a>bundle of your application, especially if the action uses the features of that application. When Automator searches for actions to display, it looks inside registered applications as well in the standard Automator directories. The advantage of packaging your actions<a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_226"></a><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_227"></a> inside an application is that you don’t need to create a separate installation package to install the actions. To install the actions, users need only drag the application to a standard location.</p><p>Action bundles should be stored inside the application wrapper at <code>Contents/Library/Automator</code>. Thus, if your action is <code>MyAction.action</code> and your application is <code>MyApp.app</code>, the path inside the application would be:</p><div class="codesample"><table><tr><td scope="row"><pre>MyApp.app/Contents/Library/Automator/MyAction.action<span></span></pre></td></tr></table></div><p>You can either manually copy an action into this location (after creating the necessary subdirectories) or you have Xcode copy it using a Copy Files build phase. If you copy an action into an application bundle but the application is already installed on a system, you must get Launch Services to recognize that the application has new content to register (that is, the new action) by changing the application’s modification date. You can do this by entering the <code>touch</code> command in the Terminal application.</p><div class="codesample"><table><tr><td scope="row"><pre>$> sudo touch /Applications/MyApp.app<span></span></pre></td></tr></table></div><p>Or you can rename the application in Finder to something else, change it back to the original name, and then launch the application once.</p><p><a name="//apple_ref/doc/uid/TP40001511-DontLinkElementID_228"></a></p><a name="//apple_ref/doc/uid/TP40001511-SW1" title="Frequently Asked Questions About Debugging Automator Actions"></a><h3>Frequently Asked Questions About Debugging Automator Actions</h3><p><strong>Question:</strong> How can I determine which version of an action Automator is using if multiple versions of my application (possibly containing multiple versions of the action) are installed (locally or on my network)?</p><p><strong>Answer:</strong> There is no way to <em>specify</em> which version of your application Automator should get actions from if multiple versions of the application are installed. However, there are several ways to <em>determine</em> the version of an action that is actually being used:</p><ul class="spaceabove"><li class="li"><p>In Mac OS X v10.5, when you select an action in the Action list, you can see its version in the description view. You can also Control-click an action in the workflow view and choose Show in Finder to see where the action is located, so that you can examine it directly.</p></li><li class="li"><p>In Mac OS X v10.4, Automator does not show the action version in the description view or allow you to show the action in the Finder. A possible work around is to delete any unwanted actions, if that option is available to you, so that only the desired version of the action is available.</p></li></ul><p><strong>Question:</strong> How can I view log or error messages?</p><p><strong>Answer:</strong> If you are developing a shell script action, and the action exits with a non-zero status code, anything your action wrote to <code>stderr</code> will show up in the Automator log, as described in <span class="content_text"><a href="ShellScriptActions.html#//apple_ref/doc/uid/TP40002078-98705">“Debugging and Testing Shell Script Actions.”</a></span></p><p>If you are developing an AppleScript action, output of AppleScript statements such as <code>log</code> or <code>tell me to log</code> appear in the Console log (not in the Automator log).</p><p>If you are developing a Cocoa action, output from <code>NSLog</code> statements will also appear in the Console log.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="AMDesignGuidelines.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="ShowWhenRun.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-12-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/DevelopAction.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/DevelopAction.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/DevelopAction.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
