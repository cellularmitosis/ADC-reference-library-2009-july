<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Open Directory Programming Guide: Concepts</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Concepts"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000917-CH3" title="Concepts"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000429" target="_top">Networking</a> &gt; <a href="../../../MacOSXServer-date.html#//apple_ref/doc/uid/TP30000440-TP30000429-TP30000542" target="_top">Mac OS X Server</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP40000917-CH1-DontLinkElementID_4">Open Directory Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Introduction/Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../workingWithNodes/workingWithNodes.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000917-CH3-SW1" title="Concepts"></a><h1>Concepts</h1><p>Open Directory is a directory service architecture whose programming interface provides a centralized way for applications and services to retrieve information stored in directories. Often, the information that is being sought is configuration information stored in a NetInfo database or in flat files, with each file having its own record format and field delimiters. Examples of configuration information include users and groups (<code>/etc/passwd</code> and <code>/etc/group</code>), and automount information  (<code>/mounts</code>). Open Directory uses standard record types and attributes to describe configuration information so that Open Directory clients have no need to know the details of record formats and data encoding.</p><p>Earlier directory services, such as <code>lookupd</code> and NetInfo, took the first steps in providing access to configuration information but were limited in their capabilities. For example, <code>lookupd</code> provides support for reading but does not provide support for writing, and it does not provide support for authentication. Open Directory continues the evolution of directory services by providing expanded functionality. For example, Open Directory can write data as well as read it, and Open Directory includes support for a variety of authentication methods.</p><p>While providing support for <code>lookupd</code> and NetInfo, Open Directory’s primary protocol is LDAP (supporting LDAPv2 and LDAPv3). As a result, Open Directory provides a way of accessing and sharing data using both LDAP and NetInfo. Open Directory provides seamless and automatic integration of Apple Computer’s directory services and third-party directory services including Active Directory, iPlanet and OpenLDAP.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-CIFEEJAH">Open Directory Overview</a>
				
			<br/>
			
        
			
			
				<a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-CIFDDEGG">Open Directory, lookupd, and NetInfo</a>
				
			<br/>
			
        
			
			
				<a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-BABIHDAH">Directory Service Command Line Utility</a>
				
			<br/>
			
        
			
			
				<a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-BABFBAFF">Debugging</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000917-CH3-67228" title="Open Directory Overview"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFEEJAH" title="Open Directory Overview"></a><h2>Open Directory Overview</h2><p>Open Directory consists of the DirectoryService daemon and Open Directory plug-ins. Apple Computer provides Open Directory plug-ins for LDAPv3 (which supports LDAPv2), NetInfo, AppleTalk, SLP, Windows, and Bonjour. The AppleTalk, SLP, SMB, and Bonjour Open Directory plug-ins discover services that are available on the local network. In Mac OS X, <code>lookupd</code> resolves DNS queries through UNIX function calls like <code>gethostbyname()</code>. The Open Directory LDAP plug-in provides information about users and groups of users. For information on writing your own Open Directory plug-in, see the document <em>Open Directory Plug-ins</em>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000917-CH3-67258" title="Figure 1-1Flow of an Open Directory request"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-BBHIJDCJ" title="Figure 1-1Flow of an Open Directory request"></a><p><strong>Figure 1-1&nbsp;&nbsp;</strong>Flow of an Open Directory request</p><img src = "../Art/od_01.gif" alt = "Flow of an Open Directory request" width="295" height="234"></div><br/><p>The Open Directory programming interface identifies the basic features that are common to many directory services and provides the functions necessary to support the development of high-quality applications that can work with a wide range of dissimilar directory services.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-67276" title="Nodes"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFFDDCB" title="Nodes"></a><h3>Nodes</h3><p>From the viewpoint of Open Directory, a directory service is a collection of one or more nodes, where a node is a place that can be searched for information. Each NetInfo database in a hierarchy and each LDAP service configured by the Directory Access tool is a separate node. The following rules apply to nodes.</p><ul class="spaceabove"><li class="li"><p>A node is either the root of a directory or a child of another node.</p></li><li class="li"><p>A registered node is a node that an Open Directory plug-in has registered with Open Directory or that an administrator has registered using the Directory Access tool.</p></li><li class="li"><p>A node is a collection of records and child nodes.</p></li><li class="li"><p>A record can belong only to one node.</p></li><li class="li"><p>A record has a type and can be of no more than one type. Examples of record types include user records and group records.</p></li><li class="li"><p>A record has a name and type that together make the record unique within its node. For example, there can’t be two user records that have the name “admin,” but there can be a user record named “admin” and a group record named “admin” within the same node.</p></li><li class="li"><p>Nodes and records can contain any number of attributes.</p></li><li class="li"><p>An attribute can have a value. Certain attributes can have more than one value.</p></li><li class="li"><p>An attribute value is arbitrary data whose structure is unknown to the Open Directory programming interface. Open Directory clients are responsible for interpreting the value of any particular attribute.</p></li></ul><p><span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-67347">Figure 1-2</a></span> shows how Open Directory and the Open Directory LDAPv3 and NetInfo plug-ins might locate nodes over a network.</p><br/><div><a name="//apple_ref/doc/uid/TP40000917-CH3-67347" title="Figure 1-2An Open Directory request over a network"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-BBHBBBCB" title="Figure 1-2An Open Directory request over a network"></a><p><strong>Figure 1-2&nbsp;&nbsp;</strong>An Open Directory request over a network</p><img src = "../Art/od_02.gif" alt = "An Open Directory request over a network" width="402" height="418"></div><br/><p>Given the topology shown in <span class="content_text">Figure 1-2</span>, the Open Directory function for listing registered nodes (<code>dsGetDirNodeList</code>) might return the following list:</p><div class="codesample"><table><tr><td scope="row"><pre>/NetInfo/root/AppleMarketing<span></span></pre></td></tr><tr><td scope="row"><pre>/NetInfo/root/AppleEngineering<span></span></pre></td></tr><tr><td scope="row"><pre>/NetInfo/root/ApplePublications<span></span></pre></td></tr><tr><td scope="row"><pre>/LDAPv3/private.example.com<span></span></pre></td></tr><tr><td scope="row"><pre>/LDAPv3/public.example.com<span></span></pre></td></tr></table></div><p>The first part of the node name (<code>LDAPv3</code> and <code>NetInfo</code> in this example) is the name of the plug-in that handles that node.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000917-CH3-DontLinkElementID_6" title="Note"></a><p><strong>Note:</strong>&nbsp;An Open Directory plug-in is not required to return information that conforms exactly to the information that the directory service maintains. A plug-in can generate information “on the fly.” In addition, a plug-in may not return information about certain nodes; the plug-in's behavior in this respect can be configurable.</p></div><a name="//apple_ref/doc/uid/TP40000917-CH3-67408" title="Search Policies and Search Nodes"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFJBGAJ" title="Search Policies and Search Nodes"></a><h3>Search Policies and Search Nodes</h3><p>A search policy defines the locations that are to be searched and the order in which those locations are searched in order to get certain kinds of information. The first location that a search policy defines must be the local NetInfo database.</p><p>Search nodes implement search policies, which are configured by administrators through the Directory Access application. Search nodes are easy for Open Directory applications to find and are guaranteed to always be available.</p><p>There are four search node types:</p><ul class="spaceabove"><li class="li"><p><em>authentication search node</em> — Use this search node when you are looking for information that is needed to authenticate a user. Use the pattern matching constant <code>eDSAuthenticationSearchNodeName</code> to locate the authentication search node. Examples of applications that use the authentication search node include the login window and applications that set System Preferences. The authentication search node is also used indirectly by all UNIX commands that use <code>lookupd</code>.</p></li><li class="li"><p><em>contacts search node</em> — Use this search node when you are looking for contact information, such as an e-mail address, a telephone number, or a street address. Use the pattern matching constant <code>eDSContactsSearchNodeName</code> to locate the contacts search node. Mail.app and Address Book use the contacts search node to look up e-mail addresses and other types of contact information.</p></li><li class="li"><p><em>network search node </em>— Use this search node, which consolidates all of the nodes that are local to a machine for service discovery purposes, to find services on the local network. When third-party Open Directory plug-ins are loaded, they register their nodes with Open Directory so they can be found by the network search node. Use the pattern matching constant <code>eDSNetworkSearchNodeName</code> to locate the network search node.</p></li><li class="li"><p><em>locally hosted nodes</em> — Use a locally hosted node to find NetInfo domains stored on this machine (that is, the local domain plus any shared domains that are running locally). Locally hosted nodes are a class of nodes that have a special pattern match. Use the pattern matching constant <code>eDSLocalHostedNodes</code> to locate locally hosted nodes.</p></li></ul><p>When an Open Directory client application uses a search node to search for information, it can request the fully qualified path for any record that matches a specific search criteria. As a result, Open Directory can perform extremely precise searches and a high degree of control over the type of information that is returned.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-67497" title="Record Types"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFBDHFE" title="Record Types"></a><h3>Record Types</h3><p>Apple Computer has defined a series of standard record types. The standard record types include but are not limited to user records, group records, machine records, and printer records.</p><p>Providers of services can define their own record types (known as native record types) and are encouraged to publish information about them. Developers are encouraged to use Apple’s standard record types whenever possible.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-67517" title="Table 1-1Standard record types "></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFEACBC" title="Table 1-1Standard record types "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 1-1&nbsp;&nbsp;</strong>Standard record types </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Constant</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeUsers</code></p></td><td ><p>Standard record for describing users</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeGroups</code></p></td><td ><p>Standard record for describing groups</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeMachines</code></p></td><td ><p>Standard record for describing machines</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeHosts</code></p></td><td ><p>Standard record for describing hosts</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypePrinters</code></p></td><td ><p>Standard record for describing printers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeNetworks</code></p></td><td ><p>Standard record for describing records in the networks file</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeServices</code></p></td><td ><p>Standard record for describing records in the services file</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeProtocols</code></p></td><td ><p>Standard record for describing records in the protocols file</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeRPC</code></p></td><td ><p>Standard record for describing RPC records</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypePrintService</code></p></td><td ><p>Standard records for describing print services</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeConfig</code></p></td><td ><p>Standard record for describing configuration records</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeAFPServer</code></p></td><td ><p>Standard record for describing AFP servers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeSMBServer</code></p></td><td ><p>Standard record for describing SMB servers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeFTPServer</code></p></td><td ><p>Standard record for describing FTP servers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeNFS</code></p></td><td ><p>Standard record for describing NFS servers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeWebServer</code></p></td><td ><p>Standard record for describing Web servers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeLDAPServer</code></p></td><td ><p>Standard record for describing LDAP servers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeQTSServer</code></p></td><td ><p>Standard record for describing QuickTime Streaming servers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeMounts</code></p></td><td ><p>Standard record for entries in the mount file</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeComputers</code></p></td><td ><p>Standard record for storing computer information</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeComputerLists</code></p></td><td ><p>Standard record for storing information about a list of computers</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypePresetUsers</code></p></td><td ><p>Standard record for storing “preset” information used to create new user records</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypePresetGroups</code></p></td><td ><p>Standard record for storing “preset” information used to create new group records</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypePresetComputerLists</code></p></td><td ><p>Standard record for storing “preset” information used to create new computer list records</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypePrintServiceUser</code></p></td><td ><p>Standard record for storing quota usage for a user in the local node</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeBootp</code></p></td><td ><p>Standard record for storing <code>bootp</code> information</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeNetDomains</code></p></td><td ><p>Standard record for storing net domains</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeEthernets</code></p></td><td ><p>Standard record for storing Ethernets</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeNetGroups</code></p></td><td ><p>Standard record for storing net groups</p></td></tr><tr><td  scope="row"><p><code>kDSStdRecordTypeHostServices</code></p></td><td ><p>Standard record for storing host services</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000917-CH3-67935" title="Standard Attribute Types"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFJEJBD" title="Standard Attribute Types"></a><h3>Standard Attribute Types</h3><p>Apple Computer has defined a series of standard attributes. Developers can define their own attributes (known as native attributes). An attribute can be required or optional. Each record type defines the attributes that it requires.</p><p>Open Directory clients are responsible for interpreting the value of any particular attribute. All configuration and discovery of information in the directory service can be accomplished by requesting the appropriate attribute value.</p><p><span class="content_text">Table 1-2</span> lists some of the standard attribute types. See the Open Directory Reference section for the complete list of attributes. Constants for attributes that start with <code>kDS1 </code>represent attributes that can only have one value; constants for attributes that start with <code>kDSN </code>represent attributes that can have multiple values.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-67972" title="Table 1-2Standard attribute types "></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CHBFGHGE" title="Table 1-2Standard attribute types "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 1-2&nbsp;&nbsp;</strong>Standard attribute types </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Constant</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code>kDS1AttrPassword</code></p></td><td ><p>Standard attribute for storing a password; commonly found in <code>kDSStdRecordTypeUsers</code> records</p></td></tr><tr><td  scope="row"><p><code>kDS1AttrUniqueID</code></p></td><td ><p>Standard attribute for storing a unique ID; commonly found in <code>kDSStdRecordTypeUsers</code> records</p></td></tr><tr><td  scope="row"><p><code>kDS1AttrPrimaryGroupID</code></p></td><td ><p>Standard attribute for storing a Primary Group ID; commonly found in <code>kDSStdRecordTypeUsers</code> and <code>kDSStdRecordTypeGroups</code> records</p></td></tr><tr><td  scope="row"><p><code>kDS1AttrComment</code></p></td><td ><p>Standard attribute for storing a comment; commonly found in <code>kDSStdRecordTypeGroup</code>, <code>kDSStdRecordTypeUsers</code>, <code>kDSStdRecordTypeComputers</code> and other preset records</p></td></tr><tr><td  scope="row"><p><code>kDS1AttrUserShell</code></p></td><td ><p>Standard attribute for storing the user’s shell; commonly found in <code>kDSStdRecordTypeUsers</code> records</p></td></tr><tr><td  scope="row"><p><code>kDS1AttrPrintServiceUserData</code></p></td><td ><p>Standard attribute for print quota configuration or statistics; commonly found in <code>kDStdRecordTypePrintServiceUser</code> records</p></td></tr><tr><td  scope="row"><p><code>kDS1AttrPort</code></p></td><td ><p>Standard attribute for storing the port number at which a service is available; commonly found in <code>kDSStdRecordTypeAFPServer</code>, <code>kDSStdRecordTypeFTPServer, </code><code>kDSStdRecordTypeLDAPServer</code>, <code>kDSStdRecordTypeWebServer</code>, and other service discovery records</p></td></tr><tr><td  scope="row"><p><code>kDSNAttrGroupMembership</code></p></td><td ><p>Standard attribute for storing group memberships</p></td></tr><tr><td  scope="row"><p><code>kDSNAttrAuthenticationAuthority</code></p></td><td ><p>Standard attribute for storing authentication authorities; commonly found in records of type <code>kDSStdRecordTypeUsers</code> and <code>kDSStdRecordTypeComputers</code></p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000917-CH3-92058" title="Native Attribute Types"></a><h3>Native Attribute Types</h3><p>Developers can define their own attributes (known as native attributes). Open Directory maps the namespace of each directory system onto native types, while the standard types are the same across all Open Directory plug-ins.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-68133" title="Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFCAIBB" title="Authentication"></a><h3>Authentication</h3><p>Open Directory for Mac OS X v10.2 supports authentication on a per-user basis whereby user records have an authentication authority attribute that specifies the type of authentication that is to be used to authenticate a particular user and all of the information required to use the specified authentication method, such as encoded password information.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000917-CH3-DontLinkElementID_7" title="Note"></a><p><strong>Note:</strong>&nbsp;The information in this section is of interest to Open Directory clients that create user records or that want to change the authentication authority for a user. These clients must write the authentication authority attribute and may have to do a set password operation to have the change take effect. Open Directory clients that only do directory native authentication or that only change existing passwords do not need to interpret the authentication authority attribute because the Open Directory plug-ins handle the supported authentication authority attribute values.</p></div><p>This version of Mac OS X supports the following types of authentication: </p><ul class="spaceabove"><li class="li"><p>Basic, which supports Crypt password authentication. For more information, see <span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-68270">“Basic Authentication.”</a></span></p></li><li class="li"><p>Apple Password Server authentication, which uses a Mac OS X Password Server to perform authentication. For more information, see <span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-68312">“Apple Password Server Authentication.”</a></span></p></li><li class="li"><p>Shadow Hash authentication, which uses salted SHA-1 hashes. The hash type of can be configured using the authentication authority data. By default, NT and LAN Manager hashes are not stored in local files, but storing them in local files can be enabled. This is the default authentication for this version of Mac OS X. For more information, see <span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-68474">“Shadow Hash Authentication.”</a></span></p></li><li class="li"><p>Local Windows authentication, which is legacy subset of Shadow Hash authentication. For more information, see <span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-68424">“Local Windows Hash Authentication.”</a></span></p></li><li class="li"><p>Local Cached User authentication, which is appropriate for mobile home directories using directory-based authentication such as LDAP. For more information, see <span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-68528">“Local Cached User Authentication.”</a></span></p></li><li class="li"><p>Kerberos Version 5 authentication, which is used to authenticate users to Kerberos v5 systems. For more information, see <span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-68599">“Kerberos Version 5 Authentication.”</a></span></p></li><li class="li"><p>Disabled User authentication, which prevents any authentication from taking place. For more information, see <span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-68697">“Disabled User Authentication.”</a></span></p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP40000917-CH3-DontLinkElementID_8" title="Note"></a><p><strong>Note:</strong>&nbsp;For compatibility with previous versions of Mac OS X, user records that do not have an authentication authority attribute are authenticated using Basic password authentication.</p></div><p>User records contain an optional authentication authority attribute. The authentication authority attribute can have one or more values specifying how authentication and password changing should be conducted for that user. The format of this attribute is a semicolon-delimited string consisting of fields in the following order:</p><ul class="spaceabove"><li class="li"><p><em>version</em> — a numeric value that identifies the structure of the attribute. This field is currently not used and usually is blank. This field may contain up to three 32-bit integer values (ASCII 0–9) separated by periods (.). If this field is empty or its value is 1, the version is consideration to be 1.0.0. If the second or the third field is empty; the version is interpreted as 0. Most client software will only needs to check the first digit of the version field. This field cannot contain a semi-colon (;) character.</p></li><li class="li"><p><em>authority tag </em>— a string value containing the authentication type for this user. Each authentication type defines the format of the authority data field and specifies how the authority data field is interpreted. The authority tag field is treated as a UTF8 string in which leading, embedded, and trailing spaces are significant. When compared with the list of known types of authentication, the comparison is case-insensitive. Open Directory clients that encounter an unrecognized type of authentication must treat the authentication attempt as a failure. This field cannot contain a semi-colon character.</p></li><li class="li"><p><em>authority data</em> — a field whose value depends on the type of authentication in the authority tag field. This field may be empty and is allowed to contain semi-colon characters.</p></li></ul><a name="//apple_ref/doc/uid/TP40000917-CH3-68270" title="Basic Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFCIEHC" title="Basic Authentication"></a><h4>Basic Authentication</h4><p>An Open Directory client that encounters a user record containing the Basic authentication type should conduct authentication in a manner consistent with the authentication method supported by Mac OS X v10.0 and v10.1, which was crypt password authentication.</p><p>If the user record does not have an authentication authority attribute, the Open Directory client should use the Basic authentication type.</p><p>Here are some examples of authentication authority attributes that use the Basic authentication type:</p><div class="codesample"><table><tr><td scope="row"><pre>;basic;<span></span></pre></td></tr><tr><td scope="row"><pre>1.0.0;basic;<span></span></pre></td></tr><tr><td scope="row"><pre>1;basic;<span></span></pre></td></tr></table></div><p>All three examples have the same result: authentication is conducted using crypt.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-68312" title="Apple Password Server Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFGGCGF" title="Apple Password Server Authentication"></a><h4>Apple Password Server Authentication</h4><p>The Apple Password Server authentication type requires an Open Directory client to contact a Simple Authentication and Security Layer (SASL) password server at the network address stored in the authority data field. After contacting the Password Server, the Open Directory client can interrogate it to determine an appropriate network-based authentication method, such as CRAM-MD5, APOP, NT, LAN Manager, DHX, or Web-DAV Digest. Note that the Password Server’s administrator may disable some authentication methods in accordance with local security policies.</p><p>The authority data field must contain two strings separated by a single colon (:) character. The first string begins with a SASL ID. The SASL ID is provided to the Password Server to identify who is attempting to authenticate. Apple’s Password Server implementation uses a unique pseudo-random 128-bit number encoded as hex-ASCII assigned when the password was created to identify user passwords in its private password database. However, Open Directory clients should not assume that the first string will always be a fixed-size value or a simple number.</p><p>The SASL ID is followed by a comma (<code>,</code>) and a public key, which is used when the client challenges the Password Server before authentication begins to confirm that the Password Server is not being spoofed.</p><p>The second string is a network address consisting of two sub-strings separated by the slash (<code>/</code>) character. The first substring is optional and indicates the type of network address specified by the second substring. The second substring is the actual network address. If the first substring and the slash character are not specified, the second substring is assumed to be an IPv4 address.</p><p>If specified, there are three possible values for the first substring:</p><ul class="spaceabove"><li class="li"><p><code>IPv4</code> — The client can expect the second substring to contain a standard 32-bit IPv4 network address in dotted decimal format.</p></li><li class="li"><p><code>IPv6</code> — The client can expect the second substring to contain a standard 64-bit IPv6 network address.</p></li><li class="li"><p><code>dns</code> — The client can expect the second substring to contain a fully qualified domain name representing the network location of the password server.</p></li></ul><p>If the authority data field is missing or malformed, the entire authentication authority attribute value must be ignored and any attempt to authenticate using it must be failed.</p><p>In the following example of an authentication authority attribute for Mac OS X Password Server authentication, the version field is empty, so the version is assumed to 1.0.0. The SASL ID is <code>0x3d069e157be9c1bd0000000400000004</code>. The IP address is not preceded by <code>ipv6/</code>, so the IP address is assumed to be an IPv4 address.</p><div class="codesample"><table><tr><td scope="row"><pre>;ApplePasswordServer;0x3d069e157be9c1bd0000000400000004,1024 35<span></span></pre></td></tr><tr><td scope="row"><pre>16223833417753121496884462913136720801998949213408033369934701878980130072<span></span></pre></td></tr><tr><td scope="row"><pre>13381175293354694885919239435422606359363041625643403628356164401829095281<span></span></pre></td></tr><tr><td scope="row"><pre>75978839978526395971982754647985811845025859418619336892165981073840052570<span></span></pre></td></tr><tr><td scope="row"><pre>65700881669262657137465004765610711896742036184611572991562110113110995997<span></span></pre></td></tr><tr><td scope="row"><pre>4708458210473 root@pwserver.example.com:17.221.43.124<span></span></pre></td></tr></table></div><p>In the following example, the appearance of <code>dns</code> indicates that the network address in the second substring is a fully qualified domain name.</p><div class="codesample"><table><tr><td scope="row"><pre>;ApplePasswordServer;0x3d069e157be9c1bd0000000400000004,1024 35<span></span></pre></td></tr><tr><td scope="row"><pre>16223833417753121496884462913136720801998949213408033369934701878980130072<span></span></pre></td></tr><tr><td scope="row"><pre>13381175293354694885919239435422606359363041625643403628356164401829095281<span></span></pre></td></tr><tr><td scope="row"><pre>75978839978526395971982754647985811845025859418619336892165981073840052570<span></span></pre></td></tr><tr><td scope="row"><pre>65700881669262657137465004765610711896742036184611572991562110113110995997<span></span></pre></td></tr><tr><td scope="row"><pre>4708458210473 root@pwserver.example.com:dns/sasl.password.example.com<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000917-CH3-68424" title="Local Windows Hash Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFDEEJB" title="Local Windows Hash Authentication"></a><h4>Local Windows Hash Authentication</h4><p>The Local Windows Hash authentication type was used on Mac OS X v10.2 in combination with Basic authentication, but its use is superseded by Shadow Hash authentication in this version of Mac OS X. With Local Windows Hash authentication, hashes for NT and LAN Manager authentication are stored in a local file that is readable only by root. The local file is updated to contain the proper hashes when the password changes. </p><p>This authentication type only supports the NT and LAN Manager authentication methods. In order to support other authentication methods, the Local Windows Hash authentication type is recommended for use in combination with the Basic authentication type. In this case, when a password is changed, both stored versions are updated.</p><p>Use of the Local Windows Hash authentication type only makes sense for non-network visible directories, such as the local NetInfo domain.</p><p>Here are some examples of properly formed authentication authority attribute values for Local Windows Hash authentication:</p><div class="codesample"><table><tr><td scope="row"><pre>;LocalWindowsHash;<span></span></pre></td></tr><tr><td scope="row"><pre>1.0.0;LocalWindowsHash;<span></span></pre></td></tr><tr><td scope="row"><pre>1;LocalWindowsHash;<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000917-CH3-68474" title="Shadow Hash Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-BABJEAFH" title="Shadow Hash Authentication"></a><h4>Shadow Hash Authentication</h4><p>The Shadow Hash authentication type is the default password method for Mac OS X v10.3 and later. Starting with Mac OS X v10.4, Mac OS X desktop systems do not store NT and LAN Manager hashes by default, while Mac OS X Server systems store certain hashes by default. When storage of hashes is enabled, only a salted SHA-1 hash is stored. When a password is changed, all stored versions of the password are updated.</p><p>If the value of the authority data field is <code>BetterHashOnly</code>, only the NT hash is used.</p><p>Shadow Hash authentication supports cleartext authentication (used, for example, by <code>loginwindow</code>) as well as the NT and LAN Manager authentication methods. Starting with Mac OS X v10.4, ShadowHash authentication also supports the CRAM-MD5, DIGEST-MD5, and APOP authentication methods if the proper hashes are stored.</p><p>Here are some examples of properly formed authentication authority attribute values for Shadow Hash authentication:</p><div class="codesample"><table><tr><td scope="row"><pre>;ShadowHash;<span></span></pre></td></tr><tr><td scope="row"><pre>1.0.0;ShadowHash;<span></span></pre></td></tr><tr><td scope="row"><pre>1;ShadowHash;<span></span></pre></td></tr></table></div><p>With Mac OS X v10.4,the authority data field can be customized with a list of hashes that are to be stored. Here is an example:</p><div class="codesample"><table><tr><td scope="row"><pre>;ShadowHash;HASHLIST:&lt;SALTED-SHA-1,SMB-NT,SMB-LAN-MANAGER><span></span></pre></td></tr></table></div><p>Other valid hash types are <code>CRAM-MD5</code>, <code>RECOVERABLE</code>, and <code>SECURE</code>.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-68528" title="Local Cached User Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-BABBHCAF" title="Local Cached User Authentication"></a><h4>Local Cached User Authentication</h4><p>Local Cached User authentication is used for mobile home directories. The authority data field must be present. Its format is</p><p><em>DS Nodename</em><code>:</code><em>DS Recordname</em><code>:</code><em>DS GUID</em></p><p>where the colon (<code>:</code>) character delimits the three individual strings. All three strings are required. The first string is any valid node name in UTF-8 format. The second string is any valid record name in UTF-8 format. The third string is any valid generated unique identifier (GUID) in UTF-8 format.</p><p>If the authority data field is absent or malformed, the authentication authority attribute value must be ignored and must result in failure to authenticate any client that attempts authentication using it. No other authentication type can be combined with this authentication type.</p><p>Here are some examples of properly formed authentication authority attribute values for Local Cached User authentication:</p><div class="codesample"><table><tr><td scope="row"><pre>;LocalCachedUser;/LDAPv3/bh1234.example.com:bjensen:AFE453BF-284E-4BCE-<span></span></pre></td></tr><tr><td scope="row"><pre>ADB2-206C2B169F41<span></span></pre></td></tr><tr><td scope="row"><pre>1.0.0;LocalCachedUser;/LDAPv3/bh1234.example.com:bjensen:AFE453BF-284E-<span></span></pre></td></tr><tr><td scope="row"><pre>4BCE-ADB2-206C2B169F41<span></span></pre></td></tr><tr><td scope="row"><pre>1;LocalCashedUser;/LDAPv3/bh1234.example.com:bjensen:AFE453BF-284E-4BCE-<span></span></pre></td></tr><tr><td scope="row"><pre>ADB2-206C2B169F41<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000917-CH3-68599" title="Kerberos Version 5 Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-BABBIFHG" title="Kerberos Version 5 Authentication"></a><h4>Kerberos Version 5 Authentication</h4><p>For Kerberos Version 5 authentication, the authority data field is formatted as follows:</p><p>[UID];[user principal (with realm)]; realm; [realm public key]</p><p>The optional 128-bit UID is encoded in the same way as for Apple Password Server authentication.</p><p>The optional user principal is the user principal for this user within the Kerberos system. If the user principal is not present, the user name and the realm are used to generate the principal name (<em>user</em>@<em>REALM</em>). This allows a fixed authentication authority value to be set up and applied to all user records in a database.</p><p>The required realm is the name of the Kerberos realm to which the user belongs.</p><p>The optional realm public key may be used to authenticate the KDC in a future release.</p><p>The following example yields a user principal of kerbdude@LDAP.EXAMPLE.COM:</p><div class="codesample"><table><tr><td scope="row"><pre>;Kerberosv5;;Kerberosv5;0x3f71f7ed60eb4a19000003dd000003dd;kerbdude@LDAP.<span></span></pre></td></tr><tr><td scope="row"><pre>EXAMPLE.COM;LDAP.EXAMPLE.COM;1024 35<span></span></pre></td></tr><tr><td scope="row"><pre>148426325667675065063924525312889134704829593528054246269765042088452509<span></span></pre></td></tr><tr><td scope="row"><pre>603776033113420195398827648618077455647972657589218029049259485673725023<span></span></pre></td></tr><tr><td scope="row"><pre>256091629016867281927895944614676546798044528623395270269558999209123531<span></span></pre></td></tr><tr><td scope="row"><pre>180552515499039496134710921013272317922619159540456184957773705432987195<span></span></pre></td></tr><tr><td scope="row"><pre>533509824866907128303 root@ldap.example.com<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000917-CH3-68697" title="Disabled User Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-BABHBADJ" title="Disabled User Authentication"></a><h4>Disabled User Authentication</h4><p>The Disabled User authentication is used to indicate that an account has been disabled. The complete previous authentication attribute value is retained in the authority data field and is enclosed by left and right angle brackets. If the authority data field is absent, Basic authentication is assumed.</p><p>Here are some examples of properly formed authentication authority attribute values for Disabled User authentication:</p><div class="codesample"><table><tr><td scope="row"><pre>;DisabledUser;;ShadowHash;<span></span></pre></td></tr><tr><td scope="row"><pre>;DisabledUser;&lt;;ShadowHash;><span></span></pre></td></tr></table></div><p>The left ( <code>&lt; </code>) and right ( <code>></code> ) angle brackets around the old authentication authority value are optional. Any tool that re-enables the user should check to see if the brackets are used and strip them when restoring the original authentication authority value.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-68729" title="Multiple Authentication Attribute Values"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFGFGBH" title="Multiple Authentication Attribute Values"></a><h4>Multiple Authentication Attribute Values</h4><p>An authentication attribute can have multiple values. When changing a password, all authentication authority values are tried until the password is successfully changed or an error occurs. When verifying a password, the order of authentication authority values determines which value is used first. The first authentication authority that returns something other than <code>eDSAuthMethodNotSupported</code> is used. For example, Local Windows Hash returns <code>eDSAuthMethodNotSupported</code> for all methods other than the change and set methods, cleartext authentication, and the SMB LM and SMB NT authentication methods.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-68751" title="Authentication Versus Authorization"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFJIFGC" title="Authentication Versus Authorization"></a><h4>Authentication Versus Authorization</h4><p>It is important to distinguish the difference between authentication and authorization:</p><ul class="spaceabove"><li class="li"><p><em>authentication</em> — a process that uses a piece of information provided by the user (typically a password) to verify the identity of that user</p></li><li class="li"><p><em>authorization</em> — the determination of whether a user has permission to access a particular set of information</p></li></ul><p>Open Directory allows an Open Directory client to use any method to authenticate a user. Open Directory does not provide any facility for determining whether a user is authorized to access any particular set of information. Moreover, Open Directory does not provide an authorization model. Instead, Open Directory clients are responsible for granting or denying a user access to a particular set of information based on the user’s authenticated identity.</p><p>When developing an authorization model, Open Directory clients must consider the following:</p><ul class="spaceabove"><li class="li"><p>the authorization information to store</p></li><li class="li"><p>where and how to store authorization information</p></li><li class="li"><p>which applications can see, create, or modify authorization information</p></li><li class="li"><p>who is authorized to see and change authorization information</p></li></ul><p>Often authorization is based on membership in a particular group. Many directory services store authorization information in the directory service itself. These directory services use the identity that is currently being used to access the directory service to determine whether to grant access to this information.</p><p>Other directory services store authorization information outside of the service. By providing an interface between clients of directory services and the directory services themselves, authorization information that is stored outside of the directory service can be shared. For example, you could design a system that controls authorization based on a common token (such as a user entry in a common directory) so that when an administrator creates, deletes, or modifies a token, all services use that same token for authorization. Accordingly, the Open Directory <code>dsDoDirNodeAuth</code> function’s <code>inDirNodeAuthOnlyFlag</code> parameter tells the plug-in whether the proof of identity process is being used to establish access to the foreign directory or whether the proof of identity process is being used only to verify a password.</p><p>Here are some ways that could be used to establish an identity that is authorized to access a foreign directory:</p><ul class="spaceabove"><li class="li"><p>have the Open Directory client use a preference to establish a “configuration” identity that can access a given directory</p></li><li class="li"><p>configure the Open Directory plug-in with identity information</p></li></ul><p>It will be necessary for the administrator of the foreign directory to set up, provide, or configure an identity with sufficient access so that a service or plug-in can access or modify all of the necessary information in the foreign directory. Allowing anonymous read access is an alternative to storing a username and password on each client machine. Whether this is possible depends on the directory server in use.</p><p>Mac OS X v10.4 optionally uses trusted directory binding, which establishes a trust relationship between a client machine and the directory server.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-68863" title="Directory Native Authentication"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFEHGGD" title="Directory Native Authentication"></a><h4>Directory Native Authentication</h4><p>Open Directory supports a mechanism that frees Open Directory clients from having to provide specific information about a particular authentication method. This mechanism is called directory native authentication.</p><p>When using directory native authentication to authenticate a user to a node, the Open Directory client passes to the Open Directory plug-in the user’s name, password, and an optional specification that cleartext is not an acceptable authentication method.</p><p>Upon receipt of the authentication request, the Open Directory plug-in determines the appropriate authentication method based on its configuration (if the plug-in is configurable) or on authentication methods the plug-in has been coded to handle. When the authentication is successful, the Open Directory client receives the authentication type that the plug-in used.</p><p>When cleartext is the only available authentication method, the plug-in would deny the authentication if the Open Directory client specifies that cleartext authentication is unacceptable.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-68893" title="Directory Proxy"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFIIDIB" title="Directory Proxy"></a><h3>Directory Proxy</h3><p>In previous versions of Mac OS X, an application could only open an Open Directory session with the local DirectoryService daemon. The Open Directory function <code>dsOpenDirService</code> is responsible for opening local Open Directory sessions and returning an Open Directory reference that the application passes to subsequent calls of Open Directory functions.</p><p>With Mac OS X v10.2 and later, applications can open an authenticated and encrypted Open Directory session with a remote DirectoryService daemon over TCP/IP. The Open Directory function <code>dsOpenDirServiceProxy</code> is responsible for opening remote Open Directory sessions. As with <code>dsOpenDirService</code>, <code>dsOpenDirServiceProxy</code> returns a Open Directory reference that the application passes to any Open Directory function that requires such a reference. Once a remote Open Directory session is successfully opened, Open Directory automatically sends all calls to Open Directory functions that use the remote directory reference to the DirectoryService daemon over the encrypted TCP/IP connection. Other than calling <code>dsOpenDirServiceProxy</code>, there is nothing the application has to do in order for its actions to take effect on the remote system.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-69115" title="Open Directory, lookupd, and NetInfo"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFDDEGG" title="Open Directory, lookupd, and NetInfo"></a><h2>Open Directory, lookupd, and NetInfo</h2><p>The process <code>lookupd</code> can be used to look up various categories of data, typically configuration information, such as users, groups, networks, services, protocols, remote procedure calls, (RPC), mounts, printers, boot parameters, aliases and netgroups, but also DNS information. This section describes how Open Directory works with <code>lookupd</code> and NetInfo.</p><p>The <code>lookupd</code> process works through the use of agents, with each agent designed to obtain a particular type of information. For example, there is an agent for resolving DNS queries, an agent for querying the local NetInfo database and its parents, and agent for querying LDAP directories, an agent for querying the Network Information System (NIS), and an agent for querying UNIX flat files in the file system. There is also an agent for querying the <code>lookupd</code> cache, in which <code>lookupd</code> stores information that has recently been looked up. The agents and the order in which the agents are used to look up information are configured through command-line utilities. By default, the <code>lookupd</code> cache is searched first, followed by NetInfo, and then Open Directory.</p><p>Like <code>lookupd</code>, Open Directory has a flexible architecture, provided by Open Directory plug-ins, for finding a wide variety of information. Unlike <code>lookupd</code>, Open Directory is configured by the graphical tool, Directory Access. While UNIX-based programs use <code>lookupd</code> to get information from external sources, Mac OS X applications use Open Directory.</p><p>The <code>lookupd</code> process can be configured to work with Open Directory through the use of the DSAgent. When a process that uses <code>lookupd</code> requires a piece of information, <code>lookupd</code> searches its cache and any other configured agents. If no results are found, the DSAgent queries Open Directory. Take, for example, the searching that occurs when “tjones” logs in using SSH, as shown in <span class="content_text"><a href="openDirectoryConcepts.html#//apple_ref/doc/uid/TP40000917-CH3-69219">Figure 1-3</a></span>. In this example, the <code>lookupd</code> cache is searched first. The user “tjones” is not in the cache, so <code>lookupd</code> queries NetInfo, which finds “tjones” in the local NetInfo database (<code>local.nidb</code>). Open Directory does not participate in this particular login process.</p><br/><div><a name="//apple_ref/doc/uid/TP40000917-CH3-69219" title="Figure 1-3lookupd and NetInfo interaction when using SSH"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFHDJBA" title="Figure 1-3lookupd and NetInfo interaction when using SSH"></a><p><strong>Figure 1-3&nbsp;&nbsp;</strong><code>lookupd and </code>NetInfo interaction when using SSH</p><img src = "../Art/od_03.gif" alt = "lookupd and NetInfo interaction when using SSH" width="334" height="265"></div><br/><p>In <span class="content_text">Figure 1-3</span>, the user’s record is located on the local system. <span class="content_text">Figure 1-4</span> shows what happens when the user’s record is located on a remote system.</p><br/><div><a name="//apple_ref/doc/uid/TP40000917-CH3-69249" title="Figure 1-4lookupd, NetInfo, and Open Directory interaction when using SSH"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-CIFDDGFE" title="Figure 1-4lookupd, NetInfo, and Open Directory interaction when using SSH"></a><p><strong>Figure 1-4&nbsp;&nbsp;</strong><code>lookupd</code>, NetInfo, and Open Directory interaction when using SSH</p><img src = "../Art/od_04.gif" alt = "lookupd, NetInfo, and Open Directory interaction when using SSH" width="426" height="349"></div><br/><p>In this example, <code>lookupd</code> queries its local cache and NetInfo, and gets negative responses — “tjones” could not be found in either location. Now, <code>lookupd</code> tells its DSAgent to query Open Directory. Searching the local NetInfo database is the first step in every Open Directory search, so Open Directory tells its NetInfo plug-in to search the local NetInfo database. Again, “tjones” is not found. In this case, Open Directory is configured to conduct LDAP searches next, so Open Directory tells its LDAP plug-in to search for “tjones” in the remote LDAP servers that it knows about. This time, “tjones” is found in <code>ldap.myplace.com</code>.</p><p>In summary, <code>lookupd</code> calls Open Directory when its local cache and NetInfo cannot find an answer. Whether Open Directory is called by <code>lookupd</code> or called by another application, Open Directory always searches its local NetInfo database first and then conducts other searches using whatever search technology it has been configured to use. Most of the time, that search technology is LDAP.</p><a name="//apple_ref/doc/uid/TP40000917-CH3-69542" title="Directory Service Command Line Utility"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-BABIHDAH" title="Directory Service Command Line Utility"></a><h2>Directory Service Command Line Utility</h2><p>The directory service command line utility, <code>dscl</code>, operates on Open Directory nodes. It is similar to the <code>nicl</code> utility, which only operates on NetInfo nodes. The <code>dscl</code> utility’s options allow you to create, read, and manage Open Directory data. For more information on the <code>dscl</code> utility, see the man page for <code>dscl.</code></p><a name="//apple_ref/doc/uid/TP40000917-CH3-69594" title="Debugging"></a><a name="//apple_ref/doc/uid/TP40000917-CH3-BABFBAFF" title="Debugging"></a><h2>Debugging</h2><p>You must be <code>root</code> to enter the DirectoryService <code>killall</code> commands that enable and disable debug logging. The following command, run by root, enables debug logging if debug logging is currently off and disables debug logging if debug logging is currently on:</p><div class="codesample"><table><tr><td scope="row"><pre>killall -USR1 DirectoryService<span></span></pre></td></tr></table></div><p>Debugging output is sent to <code>/Library/Logs/DirectoryService/DirectoryService.debug.log</code><code></code>. Debugging output includes input to Open Directory API calls, results, and timing, plus any debug information output by Open Directory plug-ins.</p><p>The following command, run by root, enables debug logging to <code>/var/log/system.log</code> if debug logging is currently off and disables debug logging if debug logging is currently on:</p><div class="codesample"><table><tr><td scope="row"><pre>killall -USR2 DirectoryService<span></span></pre></td></tr></table></div><p>When debug logging is enabled by <code>-USR2</code>, debug output includes API call results and timing. Debug logging enabled by <code>-USR2</code> is turned off automatically after five minutes.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Introduction/Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../workingWithNodes/workingWithNodes.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-01-08<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Networking/Conceptual/Open_Directory/openDirectoryConcepts/openDirectoryConcepts.html%3Fid%3DTP40000917-3.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Networking/Conceptual/Open_Directory/openDirectoryConcepts/openDirectoryConcepts.html%3Fid%3DTP40000917-3.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Networking/Conceptual/Open_Directory/openDirectoryConcepts/openDirectoryConcepts.html%3Fid%3DTP40000917-3.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>