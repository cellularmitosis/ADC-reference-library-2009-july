<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Spotlight Importer Programming Guide: Troubleshooting Spotlight Importers</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Troubleshooting Spotlight Importers"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001690" title="Troubleshooting Spotlight Importers"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000420" target="_top">Carbon</a> &gt; <a href="../../../FileManagement-date.html#//apple_ref/doc/uid/TP30000440-TP30000420-TP30000448" target="_top">File Management</a> &gt; <a href="../index.html" target="_top">Spotlight Importer Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Performance.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001690-CJBEJBHH" title="Troubleshooting Spotlight Importers"></a><hr /><H1>Troubleshooting Spotlight Importers</H1><p>Rare is the project that is flawless from the start. Troubleshooting a Spotlight importer can be difficult given that it is run by the system automatically as required and is run outside the development environment.</p><p>This article describes how to explicitly run your metadata importer for testing and provides a number of techniques for troubleshooting problems.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-222637">Where should I install my Spotlight importer?</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-224186">When will the Spotlight importer in my application bundle re-index files?</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-222678">How can I determine if my Spotlight importer is being found?</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-222978">Why isn’t my bundled importer being found?</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-DontLinkElementID_2">I've updated my importer and copied it to a Spotlight directory, but the old importer is still being used</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-222819">How do I test my importer?</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-DontLinkElementID_3">How do I debug my importer using gdb?</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-221695">What does the system think the UTI is for a document?</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-221760">Running mdimport returns nothing</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-221790">Running mdimport returns an unexpected UTI</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-221996">mdimport does not return my metadata attributes</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-222378">What are the imported metadata attributes for a specific file?</a>
				
			<br/>
			
        
			
			
				<a href="Troubleshooting.html#//apple_ref/doc/uid/TP40001690-224231">Why isn’t Spotlight finding my document bundles when they are saved by my application?</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001690-222637" title="Where should I install my Spotlight importer?"></a><h2>Where should I install my Spotlight importer?</h2><p>Your Spotlight importer typically resides within your application’s bundle in the subdirectory <code>MyApp.app/Contents/Library/Spotlight</code>. Importers can also be installed in one of the following locations:</p><div class="codesample"><table><tr><td scope="row"><pre>~/Library/Spotlight<span></span></pre></td></tr><tr><td scope="row"><pre>/Library/Spotlight<span></span></pre></td></tr></table></div><p>If your importer is not part of an application bundle, you should create an installer package that installs the importer in one of the above locations. In order to have existing files imported, you will need to have a <code>postinstall</code> script for your installer that includes the following command, specifying your importer install location:</p><div class="codesample"><table><tr><td scope="row"><pre>/usr/bin/mdimport -r InstallDirectory/YourPlug-In<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001690-224186" title="When will the Spotlight importer in my application bundle re-index files?"></a><h2>When will the Spotlight importer in my application bundle re-index files?</h2><p>When a user first runs your application, the Spotlight importer is found and Spotlight will begin importing any existing documents. If you update your application and the Spotlight importer, you should ensure that the importer bundle has a different date stamp. When the updated application is run for the first time Spotlight will re-index the existing files with the new importer.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001690-DontLinkElementID_7" title="Note"></a><p><strong>Note:</strong>&nbsp;This behavior was added in the Mac OS X 10.4.1.</p></div><a name="//apple_ref/doc/uid/TP40001690-222678" title="How can I determine if my Spotlight importer is being found?"></a><h2>How can I determine if my Spotlight importer is being found?</h2><p>Running the <code>mdimport</code> command (located in <code>/usr/bin</code>) with the <code>-L</code> option returns a list of all the currently recognized importers and their paths.</p><div class="codesample"><table><tr><td scope="row"><pre>/usr/bin/mdimport -L<span></span></pre></td></tr></table></div><div class="codesample"><table><tr><td scope="row"><pre>2005-01-16 02:56:37.634 mdimport[673] Paths: id(501) (<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/RichText.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/Image.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/Audio.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/Font.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/PDF.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/Chat.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/iCal.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/Mail.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/QuickTime.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/vCard.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/Users/me/Library/Spotlight/MyCustomImporter.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/QuartzComposer.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/PS.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/SystemPrefs.mdimporter",<span></span></pre></td></tr><tr><td scope="row"><pre>    "/System/Library/Spotlight/Application.mdimporter"<span></span></pre></td></tr><tr><td scope="row"><pre>)<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001690-222978" title="Why isn&acirc;&#128;&#153;t my bundled importer being found?"></a><h2>Why isn’t my bundled importer being found?</h2><p>If your importer resides within your application’s wrapper, it may not be found automatically during testing. Importers are detected when the bundle’s modification date is changed. You can explicitly register your application by specifying the <code>-f</code> flag to <code>lsregister</code>. The <code>lsregister</code> tool is found in <code>/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/Support/</code>.</p><div class="codesample"><table><tr><td scope="row"><pre>lsregister -f MyApp.app<span></span></pre></td></tr></table></div><p>Another possibility is that your application may be untrusted. Spotlight importers are not loaded from untrusted applications. Launching the application for the first time causes the application to be trusted.</p><a name="//apple_ref/doc/uid/TP40001690-DontLinkElementID_2" title="I&#39;ve updated my importer and copied it to a Spotlight directory, but the old importer is still being used"></a><h2>I've updated my importer and copied it to a Spotlight directory, but the old importer is still being used</h2><p>New Spotlight importers are detected by comparing the date of the top-level .mdimporter directory. If the date is the same as a previously loaded importer, the new importer is not detected. If you copy the updated importer to the Spotlight directory using <code>cp -r</code> the change is not noted by Spotlight. The solution is to either remove the existing importer before copying the updated version, or use the <code>touch</code> command on the importer's .mdimporter directory to explicitly update the date. </p><a name="//apple_ref/doc/uid/TP40001690-222819" title="How do I test my importer?"></a><h2>How do I test my importer?</h2><p>You can test your Spotlight importer using the <code>mdimport</code> command (located in <code>/usr/bin</code>). Run <code>mdimport</code> with the debug level set to 2 and specify a file that you can import data from:</p><div class="codesample"><table><tr><td scope="row"><pre>/usr/bin/mdimport -d2 test.myCustomDocument<span></span></pre></td></tr></table></div><p>This command produces out like this:</p><div class="codesample"><table><tr><td scope="row"><pre>2005-01-16 02:59:04.930 mdimport[678] Import '/Users/me/Documents/test.myCustomDocument'<span></span></pre></td></tr><tr><td scope="row"><pre>type 'com.apple.mycocoadocumentapp.mycustomdocument'<span></span></pre></td></tr><tr><td scope="row"><pre>using 'file://localhost/Users/me/Library/Spotlight/MyCustomImporter.mdimporter/'<span></span></pre></td></tr><tr><td scope="row"><pre>2005-01-16 02:59:04.931 mdimport[678] Sending attributes<span></span></pre></td></tr><tr><td scope="row"><pre>of '/Users/me/Documents/test.myCustomDocument' to server.<span></span></pre></td></tr><tr><td scope="row"><pre>Attributes: '{<span></span></pre></td></tr><tr><td scope="row"><pre>    "_kMDItemImporterCrashed" = &lt;null>;<span></span></pre></td></tr><tr><td scope="row"><pre>    "com_apple_metadata_modtime" = 127555123.1940155;<span></span></pre></td></tr><tr><td scope="row"><pre>    "com_apple_myCocoaDocumentApp_myCustomDocument_notes" = "Remember to feed the cats!";<span></span></pre></td></tr><tr><td scope="row"><pre>    kMDItemAuthors = ("Tori”,”Simon",”Daniel”);<span></span></pre></td></tr><tr><td scope="row"><pre>    kMDItemContentType = "com.apple.mycocoadocumentapp.mycustomdocument";<span></span></pre></td></tr><tr><td scope="row"><pre>    kMDItemContentTypeTree = ("com.apple.mycocoadocumentapp.mycustomdocument", "public.data", "public.item");<span></span></pre></td></tr><tr><td scope="row"><pre>    kMDItemDisplayName = {"" = "test.myCustomDocument"; };<span></span></pre></td></tr><tr><td scope="row"><pre>    kMDItemKind = {en = DocumentType; };<span></span></pre></td></tr><tr><td scope="row"><pre>    kMDItemTitle = "Be sure to remember to...";<span></span></pre></td></tr><tr><td scope="row"><pre>}'<span></span></pre></td></tr></table></div><p>The first line of the output indicates the file that is being imported, as well as the UTI that the file maps to. The remaining lines list the attribute keys and values that were imported from the file.</p><p>You should ensure that all the appropriate metadata keys that your importer returns are present in the output. You'll notice that a number of metadata keys specific to the file system are also available for each file. These are provided by the metadata system and are not your responsibility.</p><a name="//apple_ref/doc/uid/TP40001690-DontLinkElementID_3" title="How do I debug my importer using gdb?"></a><h2>How do I debug my importer using gdb?</h2><p>You can debug your importer by running <code>mdimport</code> under <code>gdb</code>.</p><p>The following command will load <code>mdimport</code> under <code>gdb</code>:</p><div class="codesample"><table><tr><td scope="row"><pre>gdb mdimport<span></span></pre></td></tr></table></div><p>Once <code>mdimport</code> has started set a breakpoint on your import function:</p><div class="codesample"><table><tr><td scope="row"><pre>b MyImporterGetAttributesFromFileFunction<span></span></pre></td></tr></table></div><p>Then start the <code>mdimport</code> process, specifying the file to import:</p><div class="codesample"><table><tr><td scope="row"><pre>r /path/to/my/test/file<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001690-221695" title="What does the system think the UTI is for a document?"></a><h2>What does the system think the UTI is for a document?</h2><p>You can determine the UTI that the system thinks belongs to your file by using the <code>mdimport</code> command with a debug level of 1:</p><div class="codesample"><table><tr><td scope="row"><pre>/usr/bin/mdimport -d1 test.myCustomDocument<span></span></pre></td></tr></table></div><p>The output shows the UTI type that the system has determined for the file:</p><div class="codesample"><table><tr><td scope="row"><pre> 2005-01-16 03:00:07.212 mdimport[683] Import '/Users/me/Documents/ test.myCustomDocument'<span></span></pre></td></tr><tr><td scope="row"><pre> type 'com.apple.mycocoadocumentapp.mycustomdocument'  using<span></span></pre></td></tr><tr><td scope="row"><pre>'file://localhost/Users/me/Library/Spotlight/MyCustomImporter.mdimporter/'<span></span></pre></td></tr></table></div><p>The type should match the UTI that your importer supports.</p><a name="//apple_ref/doc/uid/TP40001690-221760" title="Running mdimport returns nothing"></a><h2>Running mdimport returns nothing</h2><p>If running <code>mdimport</code> with a debug level of 1 returns no output, you should ensure that the file you're attempting to import is not in the <code>/tmp</code> directory or some other System directory. Files in those locations are not imported.</p><a name="//apple_ref/doc/uid/TP40001690-221790" title="Running mdimport returns an unexpected UTI"></a><h2>Running mdimport returns an unexpected UTI</h2><p>If running <code>mdimport</code> returns a UTI other than one you expect, you'll need to ensure that the file you're attempting to import is actually the type of file you think it is. The UTI of a file is determined by the extension or file type.</p><p>It is also possible that a dynamic UTI is returned:</p><div class="codesample"><table><tr><td scope="row"><pre>2005-01-16 03:01:16.989 mdimport[691] Import '/Users/me/Documents/test.myCustomDocument'<span></span></pre></td></tr><tr><td scope="row"><pre> type 'dyn.ah62d4rv4ge8048pdsz31k55rqv10g7prqz1hkqu' no mdimporter<span></span></pre></td></tr></table></div><p>Typically, the return of a dynamic UTI indicates that the file is not mapping to a known UTI. You should check that:</p><ol class="ol"><li class="li"><p>The test file is the correct file type.</p></li><li class="li"><p>The test file has the correct filename extension or file type set.</p></li><li class="li"><p>If your application is declaring the UTI type for the document, that the application's <code>Info.plist</code> file has the correct entries in the <code>UTExportedTypeDeclarations</code> entry as shown here:</p><p></p><div class="codesample"><table><tr><td scope="row"><pre>    &lt;key>UTExportedTypeDeclarations&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;key>UTTypeConformsTo&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;string>public.data&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;key>UTTypeDescription&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>My Document Type&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;key>UTTypeIdentifier&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>com.apple.mycocoadocumentapp.mycustomdocument&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;key>UTTypeTagSpecification&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;key>public.filename-extension&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>                    &lt;string>myCustomDocument&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;key>com.apple.ostype&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>T78q&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/dict><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/dict><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/array><span></span></pre></td></tr></table></div></li><li class="li"><p>Ensure that your application lives in a location where Launch Services can detect the mappings. Running the application also ensures that the mappings are made.</p></li></ol><a name="//apple_ref/doc/uid/TP40001690-221996" title="mdimport does not return my metadata attributes"></a><h2>mdimport does not return my metadata attributes</h2><p>If running <code>mdimport</code> with a debug level of 3 does not list any of your custom metadata attributes, you should check that:</p><ol class="ol"><li class="li"><p>Your metadata importer is being found using the <code>mdimport -L</code> command.</p></li><li class="li"><p>Your metadata importer's <code>Info.plist</code> file has the correct plug-in type for metadata importers in the <code>CFPlugInTypes</code> entry. The key should be <code>8B08C4BF-415B-11D8-B3F9-0003936726FC</code>:</p><p></p><div class="codesample"><table><tr><td scope="row"><pre>    &lt;key>CFPlugInTypes&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>8B08C4BF-415B-11D8-B3F9-0003936726FC&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>8AED83B3-C412-11D8-85A3-000393D59866&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/dict><span></span></pre></td></tr></table></div></li><li class="li"><p>The UUID that you created for your importer is unique and is in both the <code>CFPlugInFactories</code> and <code>CFPluginTypes</code> entries of the importer's <code>Info.plist</code> file. Here, the UUID is <code>8AED83B3-C412-11D8-85A3-000393D59866</code>:</p><p></p><div class="codesample"><table><tr><td scope="row"><pre>    &lt;key>CFPlugInFactories&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>8AED83B3-C412-11D8-85A3-000393D59866&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;string>MetadataImporterPluginFactory&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/dict><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;key>CFPlugInTypes&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;key>8B08C4BF-415B-11D8-B3F9-0003936726FC&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>8AED83B3-C412-11D8-85A3-000393D59866&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/dict><span></span></pre></td></tr></table></div></li><li class="li"><p>You have the correct UTI type for your importer listed in the <code>LSItemContentTypes</code> entry in the importer's <code>Info.plist</code> file:</p><p></p><div class="codesample"><table><tr><td scope="row"><pre>    &lt;key>CFBundleDocumentTypes&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;dict><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;key>CFBundleTypeRole&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;string>MDImporter&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;key>LSItemContentTypes&lt;/key><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;array><span></span></pre></td></tr><tr><td scope="row"><pre>                &lt;string>com.apple.mycocoadocumentapp.mycustomdocument&lt;/string><span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;/array><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/dict><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/array><span></span></pre></td></tr></table></div></li><li class="li"><p>Your UTI is all lowercase in the <code>Info.plist</code> and the <code>schema.xml</code> files.</p></li><li class="li"><p>If your importer reads metadata from a document package ensure that the   <code>UTTypeConformsTo</code> entry in the importer's <code>Info.plist</code> includes <code>com.apple.package</code> as a UTI. </p></li><li class="li"><p>Your <code>schema.xml</code> file is valid.</p><p>You can test whether your <code>schema.xml</code> file is well formed by running the command <code>mdcheckschema</code> (located in <code>/usr/bin</code>).</p><div class="codesample"><table><tr><td scope="row"><pre>/usr/bin/mdcheckschema ~/Library/Spotlight/MyCustomImporter.mdimporter/Contents/Resources/schema.xml<span></span></pre></td></tr></table></div><div class="codesample"><table><tr><td scope="row"><pre>/Users/me/Library/Spotlight/MyCustomImporter.mdimporter/Contents/Resources/schema.xml : succesfully parsed.<span></span></pre></td></tr></table></div></li><li class="li"><p>Your implementation of <code>GetMetadataForFile</code> is populating the dictionary with the correct metadata entries and is returning <code>true</code>.</p></li><li class="li"><p>You return only CFTypes of CFString, CFNumber, CFBoolean, and CFDate as attribute values. If an attribute is specified as multivalued, you must return a CFArray of the expected CFType.</p></li></ol><a name="//apple_ref/doc/uid/TP40001690-222378" title="What are the imported metadata attributes for a specific file?"></a><h2>What are the imported metadata attributes for a specific file?</h2><p>You can determine the metadata attributes and values in the system store for a file by using the <code>mdls</code> command:</p><div class="codesample"><table><tr><td scope="row"><pre>mdls /Applications/iTunes.app<span></span></pre></td></tr></table></div><div class="codesample"><table><tr><td scope="row"><pre>/Applications/iTunes.app -------------<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemAttributeChangeDate = 2005-01-16 03:03:14 -0500<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemContentType         = "com.apple.application-bundle"<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemContentTypeTree     = (<span></span></pre></td></tr><tr><td scope="row"><pre>    "com.apple.application-bundle",<span></span></pre></td></tr><tr><td scope="row"><pre>    "com.apple.application",<span></span></pre></td></tr><tr><td scope="row"><pre>    "public.executable",<span></span></pre></td></tr><tr><td scope="row"><pre>    "com.apple.bundle",<span></span></pre></td></tr><tr><td scope="row"><pre>    "public.directory",<span></span></pre></td></tr><tr><td scope="row"><pre>    "public.item",<span></span></pre></td></tr><tr><td scope="row"><pre>    "com.apple.package"<span></span></pre></td></tr><tr><td scope="row"><pre>)<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemCopyright           = "iTunes 4.7, Copyright 2000-2004 Apple Computer, Inc."<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemDisplayName         = "iTunes"<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSContentChangeDate = 2005-01-08 18:17:52 -0500<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSCreationDate      = 2005-01-08 18:17:52 -0500<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSCreatorCode       = 0<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSFinderFlags       = 0<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSInvisible         = 0<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSLabel             = 0<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSName              = "iTunes.app"<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSNodeCount         = 1<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSOwnerGroupID      = 80<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSOwnerUserID       = 0<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSSize              = 0<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemFSTypeCode          = 0<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemID                  = 64286<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemKind                = "Application"<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemLastUsedDate        = 2005-01-16 01:01:10 -0500<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemUsedDates           = (<span></span></pre></td></tr><tr><td scope="row"><pre>    2005-01-08 18:17:52 -0500,<span></span></pre></td></tr><tr><td scope="row"><pre>    2005-01-13 19:00:00 -0500,<span></span></pre></td></tr><tr><td scope="row"><pre>    2005-01-15 19:00:00 -0500<span></span></pre></td></tr><tr><td scope="row"><pre>)<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemVersion             = "4.7"<span></span></pre></td></tr></table></div><p>You can also specify a specific metadata attribute to return the value of:</p><div class="codesample"><table><tr><td scope="row"><pre>mdls -name kMDItemContentType /Applications/iTunes.app<span></span></pre></td></tr></table></div><div class="codesample"><table><tr><td scope="row"><pre>/Applications/iTunes.app -------------<span></span></pre></td></tr><tr><td scope="row"><pre>kMDItemContentType = "com.apple.application-bundle"<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001690-224231" title="Why isn&acirc;&#128;&#153;t Spotlight finding my document bundles when they are saved by my application?"></a><h2>Why isn’t Spotlight finding my document bundles when they are saved by my application?</h2><p>If your application saves its documents as a bundle, you must take precautions to ensure that Spotlight doesn’t attempt to import your document before all the data is written to the bundle.</p><p>See “<span class="content_text"><a href="../../MetadataIntro/Concepts/DocumentBundles.html#//apple_ref/doc/uid/TP40002007" target="_top">Spotlight and Document Bundles</a></span>” for additional details.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Performance.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-05-27<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/MDImporters/Concepts/Troubleshooting.html%3Fid%3DTP40001267-1.9&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/MDImporters/Concepts/Troubleshooting.html%3Fid%3DTP40001267-1.9&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/MDImporters/Concepts/Troubleshooting.html%3Fid%3DTP40001267-1.9&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
