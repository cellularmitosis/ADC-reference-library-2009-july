<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Dock Tile Programming Guide: Dock Tile Tasks for Carbon Applications</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Dock Tile Tasks for Carbon Applications"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000986-4" title="Dock Tile Tasks for Carbon Applications"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../Cocoa/index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../../Cocoa/UserExperience-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000465" target="_top">User Experience</a> &gt; <a href="../intro/dockintro.html#//apple_ref/doc/uid/TP30000986-1-TP1">Dock Tile Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../docktasks_cocoa/docktasks_cocoa.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../revisionhistory/dockrevhistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000986-4-SW1" title="Dock Tile Tasks for Carbon Applications"></a><h1><a name="//apple_ref/doc/uid/TP30000986-4-BCIDJIJF" title="Dock Tile Tasks for Carbon Applications"></a>Dock Tile Tasks for Carbon Applications</h1><p>There are two things you can do to customize your application’s Dock tile—modify the Dock icon or add custom items to the Dock menu. If you want to modify your application’s Dock icon see the <em><a href="../../../../../samplecode/Tiler/index.html#//apple_ref/doc/uid/DTS10000649" target="_top">Tiler</a></em> sample application.</p><p>You should also see the <em><a href="../../../Reference/Dock_Manager/index.html#//apple_ref/doc/uid/TP30000987" target="_top">Application Manager Reference</a></em> for a description of the functions you can use to modify and restore your application’s Dock icon. </p><p>This chapter shows you three ways you can add custom menu items to the contextual menu for your application’s Dock tile. </p><ul class="ul"><li class="li"><p>Add a property to the application’s information property list. If your application is a bundle and only needs to add static menu items, then the easiest way to add custom items to the contextual menu is to add the property <code>AppleDockMenu</code> to the application’s <code>Info.plist</code> file. See <span class="content_text"><a href="docktasks.html#//apple_ref/doc/uid/TP30000986-4-BAJEHGHH">“Adding a Property to the Information Property List.”</a></span></p></li><li class="li"><p>Use the functions <code><a href="../../../Reference/Dock_Manager/Reference/reference.html#//apple_ref/doc/c_ref/SetApplicationDockTileMenu" target="_top">SetApplicationDockTileMenu</a></code> and <code><a href="../../../Reference/Dock_Manager/Reference/reference.html#//apple_ref/doc/c_ref/GetApplicationDockTileMenu" target="_top">GetApplicationDockTileMenu</a></code>. If your application is not a bundle or if it needs to create the menu at runtime, then you can use these functions to set and retrieve the items in the menu. See <span class="content_text"><a href="docktasks.html#//apple_ref/doc/uid/TP30000986-4-BAJDFIED">“Using the Application Dock Tile Menu Functions.”</a></span></p></li><li class="li"><p>Handle the Dock tile menu event. If your application needs to create the contextual menu at the time the user clicks the application’s icon in the Dock, you can set up a handler to handle the associated Carbon event—event class <code>kEventClassApplication</code> and event kind <code>kEventAppGetDockTileMenu</code>. See <span class="content_text"><a href="docktasks.html#//apple_ref/doc/uid/TP30000986-4-BAJCCIFJ">“Handling the Get Dock Tile Menu Event.”</a></span></p></li></ul><p>Regardless of the method you use to customize your application Dock menu, each custom menu item must have a command ID, or the application won’t be notified by the Carbon Event Manager when that item is selected. </p><p>If you want to add an icon to an item in your application Dock menu, see <span class="content_text"><a href="docktasks.html#//apple_ref/doc/uid/TP30000986-4-TPXREF103">“Adding an Icon to a Dock Menu Item.”</a></span></p><a name="//apple_ref/doc/uid/TP30000986-4-BAJEHGHH" title="Adding a Property to the Information Property List"></a><h2>Adding a Property to the Information Property List</h2><p>You can customize the contextual menu for your application Dock tile by doing the following:</p><ol class="ol"><li class="li"><p>Create a contextual menu in Interface Builder.</p></li><li class="li"><p>Add a property to your application’s information property list to specify the name of the Interface Builder file that contains your contextual menu.</p></li></ol><p>Once you do this, Carbon automatically loads the nib file, creates the menu, and provides it to the Dock. Each step is detailed in the following sections.</p><a name="//apple_ref/doc/uid/TP30000986-4-TPXREF101" title="Creating a Contextual Menu in Interface Builder"></a><h3>Creating a Contextual Menu in Interface Builder</h3><p>You should open Interface Builder from your application’s Project Builder file, then create a new nib file just for your contextual menu. (See <em>Learning Carbon</em> for information on using Interface Builder.) The contextual menu needs to contain only those items you want to add to your application’s Dock menu; standard items (see <span class="content_text"><a href="../concepts/dockconcepts.html#//apple_ref/doc/uid/TP30000986-2-TPXREF103">“Dock Menu”</a></span>) are added automatically. <span class="content_text">“Setting the command for a custom item in a contextual menu”</span> shows custom items for a contextual menu that’s being built in Interface Builder. </p><p>Each menu item needs to have an associated four-character command that’s unique to your application. The command is what the Carbon Event Manager provides to your application to let you know which item was chosen by the user. The Next Song menu item in <span class="content_text">“Setting the command for a custom item in a contextual menu”</span> has the command <code>NEXT</code>. </p><br/><div><a name="//apple_ref/doc/uid/TP30000986-4-BAJJDIIG" title="Figure 3-1Setting the command for a custom item in a contextual menu"></a><p><strong>Figure 3-1&nbsp;&nbsp;</strong>Setting the command for a custom item in a contextual menu</p><img src = "../art/dockmenu.gif" alt = "Setting the command for a custom item in a contextual menu" width="317" height="338"></div><br/><p><span class="content_text">“Menu objects for a Dock menu”</span> shows an Interface Builder Instances pane for the <code>TestDockMenu.nib</code> file. This file contains two items, a contextual menu for the Dock, named <code>DockMenu</code>, and a submenu for the contextual menu, named <code>Submenu</code>.</p><br/><div><a name="//apple_ref/doc/uid/TP30000986-4-BAJEIBIA" title="Figure 3-2Menu objects for a Dock menu"></a><p><strong>Figure 3-2&nbsp;&nbsp;</strong>Menu objects for a Dock menu</p><img src = "../art/docknib.gif" alt = "Menu objects for a Dock menu" width="278" height="193"></div><br/><a name="//apple_ref/doc/uid/TP30000986-4-TPXREF102" title="Adding a Property for the Dock Menu"></a><h3>Adding a Property for the Dock Menu</h3><p>Follow these steps to add the <code>AppleDockMenu</code> property to the information property list for your application.</p><ol class="ol"><li class="li"><p>Open your application’s project in Project Builder.</p></li><li class="li"><p>Click the Targets tab, then click the appropriate target in the Targets list.</p></li><li class="li"><p>Click the Application Settings tab, then click Expert.</p></li><li class="li"><p>Click the New Sibling button.</p></li><li class="li"><p>Type <code>AppleDockMenu</code> in the Property List column.</p></li><li class="li"><p>Make sure the class is set to string.</p></li><li class="li"><p>In the Value column, type the name of the Interface Builder nib file that contains the Dock menu object, but do not include the <code>.nib</code> extension.</p><p><span class="content_text">“The AppleDockMenu property”</span> show an information property list as it appears in Project Builder. Note the value of the <code>AppleDockMenu</code> property is the string <code>TestDockMenu</code>. This implies the name of the nib file that contains the Dock menu items is <code>TestDockMenu.nib</code>. You must make sure the value you add matches the name of the nib file you create for your Dock menu.</p></li><li class="li"><p>Build and run the application.</p></li></ol><br/><div><a name="//apple_ref/doc/uid/TP30000986-4-BAJHCIHE" title="Figure 3-3The AppleDockMenu property"></a><p><strong>Figure 3-3&nbsp;&nbsp;</strong>The AppleDockMenu property</p><img src = "../art/dockproperty.gif" alt = "The AppleDockMenu property" width="359" height="258"></div><br/><a name="//apple_ref/doc/uid/TP30000986-4-BAJDFIED" title="Using the Application Dock Tile Menu Functions"></a><h2>Using the Application Dock Tile Menu Functions</h2><p>If your application is not a bundle or if it needs to create the application’s contextual menu at runtime, then you can use the functions <code><a href="../../../Reference/Dock_Manager/Reference/reference.html#//apple_ref/doc/c_ref/SetApplicationDockTileMenu" target="_top">SetApplicationDockTileMenu</a></code> and <code><a href="../../../Reference/Dock_Manager/Reference/reference.html#//apple_ref/doc/c_ref/GetApplicationDockTileMenu" target="_top">GetApplicationDockTileMenu</a></code> to set and retrieve the items in the menu.</p><p>You can use any method (for example Interface Builder or Menu Manager functions) to define and create a menu that contains your custom items. Regardless of how you create the menu, each menu item needs to have an associated four-character command that’s unique to your application. </p><p>Once the menu is created, you pass a reference to your menu to the function <code>SetApplicationDockTileMenu</code>. The items in the menu you pass to the function are inserted in the list, between the list of document windows and the standard items. </p><p>The function <code><a href="../../../Reference/Dock_Manager/Reference/reference.html#//apple_ref/doc/c_ref/SetApplicationDockTileMenu" target="_top">SetApplicationDockTileMenu</a></code> increments the reference count of the menu you pass to it. Before the contextual menu is displayed, it receives the Carbon events <code>kEventMenuPopulate</code>, <code>kEventMenuOpening</code>, and <code>kEventMenuEnableItems</code>, so any event handlers for these events can update the menu appropriately.</p><a name="//apple_ref/doc/uid/TP30000986-4-BAJCCIFJ" title="Handling the Get Dock Tile Menu Event"></a><h2>Handling the Get Dock Tile Menu Event</h2><p>If your application needs to create the contextual menu at the time the user clicks the application’s icon in the Dock, you can set up a handler to handle the Carbon event that is of event class <code>kEventClassApplication</code> and event kind <code>kEventAppGetDockTileMenu</code>. The default handler for this event returns the menu provided by <code><a href="../../../Reference/Dock_Manager/Reference/reference.html#//apple_ref/doc/c_ref/SetApplicationDockTileMenu" target="_top">SetApplicationDockTileMenu</a></code> or the menu located in the nib file for the Dock menu, if it exists. </p><p>You can override the default handler by writing and installing your own Carbon event handler. Your application needs to create the custom menu and your handler needs to call the Carbon Event Manager function <code><a href="../../../Reference/Carbon_Event_Manager_Ref/Reference/reference.html#//apple_ref/doc/c_ref/SetEventParameter" target="_top">SetEventParameter</a></code> with the Carbon event parameter <code>kEventParamMenuRef</code> and a reference to the menu you want to be displayed, as shown in <span class="content_text">“Passing a menu reference to the function SetEventParameter.”</span> </p><a name="//apple_ref/doc/uid/TP30000986-4-BAJFACCH" title="Listing 3-1Passing a menu reference to the function SetEventParameter"></a><p class="codesample"><strong>Listing 3-1&nbsp;&nbsp;</strong>Passing a menu reference to the function SetEventParameter</p><div class="codesample"><table><tr><td scope="row"><pre>        err = SetEventParameter (inEvent,<span></span></pre></td></tr><tr><td scope="row"><pre>                        kEventParamMenuRef,<span></span></pre></td></tr><tr><td scope="row"><pre>                        typeMenuRef,<span></span></pre></td></tr><tr><td scope="row"><pre>                        sizeof(menuRef),<span></span></pre></td></tr><tr><td scope="row"><pre>                        &amp;myCustomApplicationDockMenu<span></span></pre></td></tr><tr><td scope="row"><pre>                        );<span></span></pre></td></tr></table></div><p>Carbon releases the menu reference after the menu is passed to the Dock, so be sure to retain the menu reference with the Menu Manager function <code><a href="../../../Reference/Menu_Manager/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/RetainMenu" target="_top">RetainMenu</a></code> if you want to keep the menu reference for later use.</p><a name="//apple_ref/doc/uid/TP30000986-4-TPXREF103" title="Adding an Icon to a Dock Menu Item"></a><h2>Adding an Icon to a Dock Menu Item</h2><p>If you want to display an icon next to an item in your application Dock menu (as shown in <span class="content_text"><a href="../concepts/dockconcepts.html#//apple_ref/doc/uid/TP30000986-2-BAJCGCAJ">Figure 1-4</a></span>) you need to call the function <code><a href="../../../Reference/Menu_Manager/Reference/reference.html#//apple_ref/doc/c_ref/SetMenuItemIconHandle" target="_top">SetMenuItemIconHandle</a></code> with one of the new selectors provided by the Menu Manager—<code>kMenuSystemIconSelectorType</code> or <code>kMenuIconResourceType</code>. If your application uses a standard system icon provided by Icon Services, you should use the selector <code>kMenuSystemIconSelectorType</code>, as shown in <span class="content_text">“Using a standard system icon in the application Dock Menu.”</span> To load the icon, you need to call the Icon Services function <code><a href="../../../Reference/IconServices/Reference/reference.html#//apple_ref/doc/c_ref/GetIconRef" target="_top">GetIconRef</a></code>. </p><a name="//apple_ref/doc/uid/TP30000986-4-BAJGBCIG" title="Listing 3-2Using a standard system icon in the application Dock Menu"></a><p class="codesample"><strong>Listing 3-2&nbsp;&nbsp;</strong>Using a standard system icon in the application Dock Menu</p><div class="codesample"><table><tr><td scope="row"><pre>SetMenuItemIconHandle (myMenu,<span></span></pre></td></tr><tr><td scope="row"><pre>                        1,<span></span></pre></td></tr><tr><td scope="row"><pre>                        kMenuSystemIconSelectorType,<span></span></pre></td></tr><tr><td scope="row"><pre>                        (Handle) kGenericApplicationIcon);<span></span></pre></td></tr></table></div><p>If you application uses a <code>.icns</code> file located in the application bundle, you should use the selector <code>kMenuIconResourceType</code> with the function <code><a href="../../../Reference/Menu_Manager/Reference/reference.html#//apple_ref/doc/c_ref/SetMenuItemIconHandle" target="_top">SetMenuItemIconHandle</a></code>, as shown in <span class="content_text">“Using an icon specified in a .icns file.”</span> The <code>inIconHandle</code> parameter to this function must be a <code>CFStringRef</code> that specifies the name of the <code>.icns</code> file. The Menu Manager locates the file and registers the <code>IconRef</code> for the icon specified in the file, and then displays the icon with the menu item. The <code>CFStringRef</code> is retained by the Menu Manager.</p><a name="//apple_ref/doc/uid/TP30000986-4-BAJHBHEH" title="Listing 3-3Using an icon specified in a .icns file"></a><p class="codesample"><strong>Listing 3-3&nbsp;&nbsp;</strong>Using an icon specified in a .icns file</p><div class="codesample"><table><tr><td scope="row"><pre>SetMenuItemIconHandle (myMenu,<span></span></pre></td></tr><tr><td scope="row"><pre>                        2,<span></span></pre></td></tr><tr><td scope="row"><pre>                        kMenuIconResourceType,<span></span></pre></td></tr><tr><td scope="row"><pre>                        (Handle) CFSTR("mySpecialIcon.icns") );<span></span></pre></td></tr></table></div>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../docktasks_cocoa/docktasks_cocoa.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../revisionhistory/dockrevhistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-03-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/customizing_docktile/tasks/docktasks.html%3Fid%3DTP30000986-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/customizing_docktile/tasks/docktasks.html%3Fid%3DTP30000986-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/customizing_docktile/tasks/docktasks.html%3Fid%3DTP30000986-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>