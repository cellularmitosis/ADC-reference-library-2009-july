<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TE09: Script Manager 2.0 Date &amp; Time Problems</title>                                       <meta name="categories" content="Text"><meta name="week-posted" content="Jan 29, 1990 - Feb 2, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002817" title="Script Manager 2.0 Date & Time Problems"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxTools-date.html">Tools</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Java/idxTools-date.html" target="_blank">Reference Library > Tools</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TE09</div>
<div id="pageheadsub">Script Manager 2.0 Date &amp; Time Problems</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Introduction</A><BR><BR><A HREF="#Section2">You Said It Would Be A Long Time</A><BR><BR><A HREF="#Section3">Any String To Date</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note describes known bugs and features in and solutions to thedate and time routines introduced in Script Manager 2.0.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Feb 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2><P>From the beginning, the Macintosh's ability to handle dates was limited to arather small range--slightly more than a century.  Enhancements to the ScriptManager, introduced with System Software 6.0, extended this range to +/-35,000years.  Unfortunately, there is a minor bug in one of the crucial calls and a"feature" that looks like a bug in another.</p><P><A HREF="#top">Back to top</A></p><a name="Section2"></a><h2>You Said It Would Be A Long Time</h2><p><code>_LongSecs2Date</code>, the routine that translates a <code>LongDateTime</code> to a<code>LongDateRec</code>, has a bug caused by using a variable that has not beenproperly initialized.  This bug rears its ugly head when negative values arepassed to the routine.  System Software 6.0.4 and later fix this bug, and thereis a simple solution for earlier systems.</p><p>If using System Software 6.0.3 and earlier, if you call <code>_LongSecs2Date</code>once before you really want to use it, the variable is cleared.  After theinitial call, <code>_LongSecs2Date</code> works correctly.</p><p>For example:</p><h3>MPW Pascal</h3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>PROCEDURE DoDateStuff;VAR  lsecs: LongDateTime;  ldr:   LongDateRec;BEGIN  InitDateCache(dcr);  lsecs := 0;  LongSecs2Date(lsecs,ldr);  {now you can call LongSecs2Date for real}</pre>	</TD></TR></TABLE></CENTER><h3>MPW C</h3><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>void DoDateStuff(){  LongDateTime lsecs;  LongDateRec  ldr;/* work around the bug */  lsecs = 0;  LongSecs2Date(&amp;lsecs,&amp;ldr);/* now call LongSecs2Date for real */</pre>	</TD></TR></TABLE></CENTER><P><A HREF="#top">Back to top</A></p><a name="Section3"></a><h2>Any String To Date</h2><p>The routine <code>_String2Date</code> was originally designed to be as forgiving aspossible.  It is so forgiving that it accepts any non-alphabetic character as aseparator and accepts a single number as a valid date.  For instance, if youpass <code>_String2Date</code> a string like "&lt;20" it generously assumes thatthe less than sign (&lt;) is intended as a divider and that "20" must beintended as a day, since there are only 12 months in a year.  It returns aresult of <code>noErr</code> and a date which is the twentieth of the current monthin the current year.  The string "&lt;3*3" produces March 3 of the currentyear, while "4&gt;1" politely gives the date April 1 of the current year.</p><p>This forgiveness really is not a bug, but a feature.  Unfortunately it isn't afeature that has been greatly appreciated in the developer community.  For thatreason, the rules for date and time dividers are tighter in System 7.0.Current thinking is that all list separators now used in <code>'itl0'</code>resources will be allowed with a few common date separators used in the U.S.(e.g., colon (:) and hyphen (-)).  For now, it is important to be aware of,shall we say, the flexibility of <code>_String2Date</code> and avoid thinking of itas an intelligent date parser.  If you want to parse something, you can use<code>_IntlTokenize</code>.</p><P><A HREF="#top">Back to top</A></p><a name = "References"></a><h2>References</h2><P><i>Inside Macintosh</i>, Volume V, The Script Manager</p><P><i>The Script Manager 2.0</i>, Interim Chapter (DTS)</p>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/te_09.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/te/te_09.html%3Fid%3DDTS10002817-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/te/te_09.html%3Fid%3DDTS10002817-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/te/te_09.html%3Fid%3DDTS10002817-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>