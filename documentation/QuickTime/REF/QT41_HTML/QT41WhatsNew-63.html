<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"><HTML><head><script language="JavaScript" src="../../frametest.js"></script><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1"><META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css"><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><!-- Link line removed --><TITLE> Writing a Custom Action Handler Component</TITLE><script language=javascript> window.parent.focus(); </script></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: QuickTime Reference</I><P>| <A HREF="QT41WhatsNew-62.html">Previous</A> | <A HREF="QT41WhatsNew-1.html">Chapter Contents</A> | <A HREF="QT41WhatsNew.html">Chapter Top</A> | <A HREF="QT41WhatsNew-64.html">Next</A> |</P><!-- QTnavbar end --><H1 CLASS="H2-Heading2"><A NAME="pgfId-51554"></A>Writing a Custom Action Handler Component</H1><P CLASS="T1-Text1"><A NAME="pgfId-51753"></A>Any component type, whether it is a media handler, a codec, or your own component type, may be extended to handle custom actions. To extend your component, you implement the <TT>ExecuteWiredAction</TT> routine described below. If you are writing a component that is being used only to handle custom actions, you should use the component type <TT>'wire'</TT>.</P><TT><A NAME="pgfId-55281"></A>EXTERN_API(&nbsp;ComponentResult&nbsp;)<BR>CallComponentExecuteWiredAction&nbsp;(ComponentInstance&nbsp;&nbsp;ci,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QTAtomContainer&nbsp;actionContainer,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QTAtom&nbsp;&nbsp;actionAtom,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QTCustomActionTargetPtr&nbsp;target,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QTEventRecordPtr&nbsp;event);</TT><P CLASS="T1-Text1"><A NAME="pgfId-51567"></A>All the state passed to you in this routine is only valid for the duration of the execution of your custom action, which should be completed when you return from this routine.</P><P CLASS="T1-Text1"><A NAME="pgfId-51569"></A>The <TT>actionContainer</TT> contains all of the actions that are being executed in response to the current <TT>QTEvent</TT>. This atom container should not be edited, only read from, since other actions that have yet to be executed may be contained within it. </P><P CLASS="T1-Text1"><A NAME="pgfId-51571"></A>The <TT>actionAtom</TT>  specifies the <TT>kActionAtom</TT> that concerns you, since it contains all of the atoms describing the action type and parameters to your components custom action that are to be executed.  </P><P CLASS="T1-Text1"><A NAME="pgfId-51573"></A>The <TT>target</TT> parameter specifies the movie elements that you need in order to execute your action.</P><TT><A NAME="pgfId-55285"></A>struct&nbsp;QTCustomActionTargetRecord&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;Movie&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;movie;<BR>&nbsp;&nbsp;&nbsp;&nbsp;DoMCActionUPP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doMCActionCallbackProc;<BR>&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callBackRefcon;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Track&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;track;<BR>&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trackObjectRefCon;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Track&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defaultTrack;<BR>&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defaultObjectRefCon;<BR>&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reserved1;<BR>&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reserved2;<BR>};<BR>typedef&nbsp;struct&nbsp;QTCustomActionTargetRecord&nbsp;QTCustomActionTargetRecord;<BR>typedef&nbsp;QTCustomActionTargetRecord&nbsp;*&nbsp;QTCustomActionTargetPtr;</TT><P CLASS="T1-Text1"><A NAME="pgfId-51589"></A>The <TT>movie</TT> field is the movie that is or contains the movie element, which is the target of the action.</P><P CLASS="T1-Text1"><A NAME="pgfId-51591"></A>The <TT>doMCActionCallbackProc</TT> and <TT>callBackRefcon</TT> specify the movie controller and <TT>refCon</TT> for the target movie's movie controller. They may be used with the <TT>CallDoMCActionProc</TT> routine to invoke the movie controller functionality, including the new <TT>mcActionFetchParameterAs</TT>. </P><P CLASS="T1-Text1"><A NAME="pgfId-51593"></A>The <TT>track</TT> field is the track that is or contains the movie element, which is the target of the action.</P><P CLASS="T1-Text1"><A NAME="pgfId-51595"></A>The <TT>trackObjectRefCon</TT> field is the <TT>refCon</TT> or ID of the movie element that is the target of the action. If the target is a sprite, this will be the sprite ID.</P><P CLASS="T1-Text1"><A NAME="pgfId-51597"></A>The <TT>defaultTrack</TT> is the track that contains the movie element that handled the <TT>QTEvent</TT> and generated the custom action. For example, if a hypertext element of a text track generated a <TT>SetSpriteVisible</TT> action for a sprite in a sprite track, the <TT>defaultTrack</TT> would be the Text track, while the Sprite Track would be the target track.</P><P CLASS="T1-Text1"><A NAME="pgfId-51599"></A>The <TT>defaultObjectRefCon</TT> is the <TT>refCon</TT> or ID of the movie element that handled the QTEvent and generated the custom action.</P><P CLASS="T1-Text1"><A NAME="pgfId-51601"></A>The <TT>event</TT> specifies information about what <TT>QTEvent</TT> generated the custom action.</P><H4><A HREF="QT41WhatsNew-64.html" CLASS="Hypertext">The Action Being Executed</A></H4><H4><A HREF="QT41WhatsNew-65.html" CLASS="Hypertext">Fetching the Parameters</A></H4><hr>&#169; 2000 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: QuickTime Reference</I><P>| <A HREF="QT41WhatsNew-62.html">Previous</A> | <A HREF="QT41WhatsNew-1.html">Chapter Contents</A> | <A HREF="QT41WhatsNew.html">Chapter Top</A> | <A HREF="QT41WhatsNew-64.html">Next</A> |</P><!-- QTnavbar end --></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>