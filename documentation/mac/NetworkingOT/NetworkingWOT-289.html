<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>OTYieldPortRequest</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING289></A>
<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->

<!-- Main Body -->

<CENTER>
<P>
<A HREF="NetworkingWOT-288.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-290.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="NetworkingWOT-2.html"><B>Networking With Open Transport </B></A> / <A HREF="NetworkingWOT-81.html"><B>Part 2 - Open Transport Reference</B></A><BR><DD><A HREF="NetworkingWOT-263.html"><B>Chapter 26 - Ports Reference</B></A> / <A HREF="NetworkingWOT-273.html"><B>Functions</B></A><BR><DL><DD><A HREF="NetworkingWOT-288.html"><B>Requesting a Port to Yield Ownership</B></A> / </DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING289-0></A>
<H3><A NAME=MARKER-9-142></A><A NAME=MARKER-13-143></A>OTYieldPortRequest</H3>
 Requests that a port be yielded.<P>
<A NAME=HEADING289-2></A>
<H5>C INTERFACE</H5>
<PRE>
<A NAME=MARKER-0-95></A>OSStatus OTYieldPortRequest(ProviderRef ref, OTPortRef port, 
                     OTClientList* buffer, size_t bufferSize); 
</PRE>
<A NAME=HEADING289-4></A>
<H5>C++ INTERFACE</H5>
 None. C++ applications use the C interface to this function.<P>
<A NAME=HEADING289-6></A>
<H5>PARAMETERS</H5>
<DL>
<DT><CODE>ref</CODE>
<DD> The provider reference for the provider that wants to use the port. This provider (normally an endpoint) must be open on the requested port. You cannot use this provider while the yield request is being processed. 
<DT><CODE>port</CODE>
<DD> The port reference for the port you wish to use.
<DT><CODE>buffer</CODE>
<DD> If the request is denied, on output this contains a pointer to a client list structure, giving the names of all clients that rejected the request (normally only one). You can use a value of <CODE>NULL</CODE> to force the client to yield the port; this only works if the provider is <A NAME=MARKER-13-145></A>passively listening on the port. Use a value of <CODE>(void*)-1L</CODE> to cancel the yield request.
<DT><CODE>bufferSize</CODE>
<DD> The size of the buffer, including the <CODE>fNumClients</CODE> field in the  <A HREF=NetworkingWOT-271.html#MARKER-9-97>client list structure</A>.
<DT><I>function result</I>
<DD> See Discussion.
</DL>
<A NAME=HEADING289-12></A>
<H5>DISCUSSION</H5>
 The <CODE>OTYieldPortRequest</CODE> function requests the current owner of a port (normally a serial port or modem) to yield ownership of it. <P>
 Port yielding works in one of two ways. You get the first mechanism by calling <CODE>OTYieldPortRequest</CODE>, passing a value for <CODE>buffer</CODE> that points to a client list buffer.  Open Transport then looks through all the clients on the system.  If the client has any providers that use the port in question, Open Transport sends the client a <CODE>kOTClosePortRequest</CODE> event. The client either handles that request (by closing the provider), or returns an error that indicates why the request was denied.  Any client that doesn't have a notifier (as set by <CODE>OTRegisterAsClient</CODE>) is assumed to allow the request.<P>
 If any client denies the request, the <CODE>OTYieldPortRequest</CODE> function fails. The function could also fail because there is not enough memory (<CODE>kENOMEMErr</CODE>), the port does not support yielding (<CODE>kOTNotSupportedErr</CODE>), the provider does not use the port, or the port does not exist (<CODE>kOTBadReferenceErr</CODE>), or because the client currently using the port is already connected (<CODE>kENOENTErr</CODE>). Otherwise, Open Transport attempts to get the port for you from the driver.  If it succeeds, the port is ready for you to use.  The port remains available for a driver-specified amount of time (typically about 10 seconds).  If you don't bind or connect the port in that time, the port reverts back to its previous owner.  If you do bind or connect to the port before the timer expires, you now own the port.  When you unbind or disconnect, the port reverts back to its previous owner.<P>
 The second mechanism for port yielding comes into play when you set <CODE>buffer</CODE> to <CODE>nil</CODE>. In that case, Open Transport bypasses the check described above, and immediately attempts to grab the port. The call results depend solely on whether that succeeds or fails.<P>
 After getting a port, you have a number of choices:<P>
<OL>
<P><LI>You can open it, as described above.
<P><LI>You can decide not to open it, and ignore it.  After a while, the driver will time out, and the port will revert back to the previous owner.
<P><LI>You can decide not to open it, and be a good citizen by switching the port back to the previous owner immediately.  You do this by calling the function <CODE>OTYieldPortRequest</CODE> and passing <CODE>-1</CODE> for the <CODE>buffer</CODE> parameter. <P>
</OL>
<A NAME=HEADING289-21></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 On PowerPC computers, the <A HREF=#MARKER-9-142><CODE>OTYieldPortRequest</CODE></A> function is available only to PowerPC-native clients; there is no mixed-mode glue for the function, so you must build a fat application in order to use it.<P>
 You can only use this function at system task time.<P>
<A NAME=HEADING289-24></A>
<H5>SEE ALSO</H5>
 The <A HREF=NetworkingWOT-291.html#MARKER-9-148><CODE>OTRegisterAsClient</CODE></A> function.<A NAME=MARKER-13-146></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="NetworkingWOT-288.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="NetworkingWOT-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="NetworkingWOT-491.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A>  <A HREF="NetworkingWOT-290.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="NetworkingWOT-4.html">&copy; Apple Computer, Inc.</A><br>15 JAN 1998<P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML> 
