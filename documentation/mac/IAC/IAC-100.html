<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Accepting and Processing Apple Events(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING100></A>


<!-- Top of Header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- Bottom of Header -->


<!-- Main Body -->

<CENTER>
<P>

<A HREF="IAC-99.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-101.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-94.html"><B>Chapter 3 - Introduction to Apple Events</B></A> / <A HREF="IAC-99.html"><B>Responding to Apple Events</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING100-0></A>
<H2>Accepting and Processing Apple Events</H2>
 <A NAME=MARKER-2-7></A>To accept or send Apple events (or any other high-level events), you must set the appropriate flags in your application's <CODE>'SIZE'</CODE> resource and include code to handle high-level events in your application's main event loop. <P>
 Two flags in the <CODE>'SIZE'</CODE> resource determine whether an application receives high-level events: <P>
<UL>
<LI>The <CODE>isHighLevelEventAware</CODE> flag must be set for your application to receive any high-level events.
<LI>The <CODE>localAndRemoteHLEvents</CODE> flag must be set for your application to receive high-level events sent from another computer on the network.<P>
</UL>
 An Apple event (like all high-level events) is identified by a message class of <CODE>kHighLevelEvent</CODE> in the <CODE>what</CODE> field of the event record. You test the <CODE>what</CODE> field of the event record to determine whether it contains the value represented by the <CODE>kHighLevelEvent</CODE> constant; if your application defines any high-level events other than Apple events, you should also test the <CODE>message</CODE> field of the event record to determine whether the high-level event is something other than an Apple event. If the high-level event is not one that you've defined for your application, assume that it is an Apple event. (You are encouraged to use Apple events instead of defining your own high-level events whenever possible.)<P>
 After determining that an event is an Apple event, use the <CODE>AEProcessAppleEvent</CODE> function to let the Apple Event Manager identify the event. <A HREF=#MARKER-9-210>Figure 3-10</A> shows how the SurfWriter application accepts and begins to process an Apple event sent by the Finder.<P>
<B>Figure 3-10  <A NAME=MARKER-9-210></A><A NAME=MARKER-21-211></A>Accepting and processing an Open Documents event</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-14.jpg"><P>
 The <CODE>AEProcessAppleEvent</CODE> function first identifies the Apple event by examining the data in the event class and event ID attributes. The function then uses that data to call the Apple event handler that your application provides for that event. The Apple event handler extracts the pertinent data from the Apple event, performs the requested action, and returns a result. For example, if the event has an event class of <CODE>kCoreEventClass</CODE> and an event ID of <CODE>kAEOpenDocuments</CODE>, the <CODE>AEProcessAppleEvent</CODE> function calls your application's handler for the Open Documents event.<A NAME=MARKER-2-68></A> <P>
 Before your application attempts to accept or process any Apple events, it must use the <CODE>AEInstallEventHandler</CODE> function to install Apple event handlers. This function installs handlers in an <B>Apple event dispatch table </B>for your application; the Apple Event Manager uses this table to map Apple events to handlers in your application. When your application calls the <CODE>AEProcessAppleEvent</CODE> function to process an Apple event, the Apple Event Manager checks the Apple event dispatch table and, if your application has installed a handler for that Apple event, calls that handler. <A HREF=#MARKER-9-214>Figure 3-11</A> shows how the flow of control passes from your application to the Apple Event Manager and back to your application.<A NAME=MARKER-2-263></A><P>
<B>Figure 3-11  <A NAME=MARKER-9-214></A><A NAME=MARKER-21-215></A>The Apple Event Manager calling the handler for an Open Documents event<A NAME=MARKER-2-8></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-15.jpg"><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-99.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-101.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
