<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note PT530: MacApp Q&amp;As</title>                                       <meta name="categories" content="Platforms and Tools"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002699" title="MacApp Q&As"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note PT530</div>
<div id="pageheadsub">MacApp Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><p id="introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specifictopic--questions sent the Developer Support Center (DSC) along withanswers from the DSC engineers. Current Q&amp;A's can be found on the <A HREF = "../../qa/index.html">Macintosh Technical Q&amp;A's web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1990]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Extending MacApp FailOSErr call to include additional error strings</h2><p>Is there any way to extend the <code>FailOSErr</code> call in MacApp to include MacTCPerrors?</p><P>This is what happens: <code>FailOSErr</code> calls <code>Failure</code>, etc. Eventually<code>LookupErrString</code>(...,resourceID,...) gets called with <code>resourceID</code> = 128 -or-<code>errOperationsID</code>. <code>LookupErrString</code> then adds 1000 -or- <code>errAppTable</code>. It searchesfor resource 1128 of type <Code>'errs'</code>. If it finds the error table resource MacAppattempts to use that resource first else it uses the MacApp supplied <Code>'errs'</code>resource 128. Notice the last entry in resource 128 is defined to catch allerrors in the range of -32768..32767. The first entry in the <Code>'errs'</code> resourcedefines which <Code>'STR#'</code> to use.</p><p>To handle MacTCP errors, add a <Code>'errs'</code> resource ID 1128 which refers to a <Code>'STR#'</code>resource.</p><h2>MacApp "internal component is missing" compilation message</h2><P>Date Written:   3/12/93</p><P>Last reviewed: 6/24/93</p><p>When starting a new MacApp program, I get the message "Couldn't create newdocument because an internal component is missing. Please contact thedeveloper." How do I find out which component is missing?</p><P>When building a -nodebug version of an application, MABuild assumes that thecode is as optimized as possible, including making the code as small aspossible. Therefore the linker strips out any unused code from the finalapplication.</p><p>The problem is that the linker determines which code is to be stripped out byfinding all objects that are constructed with the "new" operator. Objectsderived from TView are instantiated through calls to <code>TViewServer</code> methodsinstead of calling the new operator. Because of this, the linker thinks thatcalls to your derived View objects aren't used, so they're stripped from thenodebug build. To circumvent this problem, you have to fool the linker into notstripping out this code.</p><p>MacApp defines a macro that makes this easy for you to trick the linker. Placethis line of code in your implementation of<code>TSomeApplication::ISomeApplication:</code></p><p>MacApp takes care of this for you for any View classes defined by MacApp, butyou do have to do it for any subclasses of <code>TView</code> defined in your own program.Good examples of the use of this routine can be found throughout the MacApp C++examples, in the "{MacApp}"Examples:CPlus Examples: folder, namely in theSkeleton example.</p><p>More information about this can be found in the MacApp tutorial (C++) on page166, and in the MacApp AppleLink archives.</p><h2>MacApp hierarchical menu ID range is 1-63</h2><P>Date Written:   2/24/93</p><P>Last reviewed: 4/9/93</p><p>Submenus aren't working correctly in my application. I'm using MacApp and my'CMNU' and 'MBAR' resources are set up correctly. The submenu appears to be setup properly in the hierarchical menu bar. The main menu highlights in responseto a command key for its submenu, but the submenu never shows up when selected.How can this be?</p><P>You'll see this behavior if your hierarchical menu IDs are greater than 63.MacApp requires that hierarchical menus be in the range of 1-63. For moreinformation on menus, look at the "Working with Menus" chapter in theProgrammer's Guide to MacApp.</p><h2>Use MacApp 3 "-NeedsSystem7 Mabuild" flag for System 6</h2><P>Date Written:  1/6/93</p><P>Last reviewed:  6/14/93</p><p>Now that I've converted my application from MacApp 2 to MacApp 3, it doesn'trun under System 6, even when I don't compile for large model addressing. Whatswitches or options do I need to observe for a System 6 application?</p><P>Your MacApp program will run under System 6 if you use MABuild's - <code>NoNeedsSystem7</code>option. The default is System 7 only. Using ModelFar for large model addressinghas no effect on System 7 dependencies.</p><h2>Why MacApp uses Initialize and Free methods</h2><P>Date Written:    11/20/92</p><P>Last reviewed:    6/14/93</p><p>Why does MacApp use the Initialize and Free methods instead of the normal C++constructor and destructor methods?</p><P>MacApp doesn't use constructors for historical reasons. Object Pascal was usedin MacApp 2.0.1, which doesn't have constructors and destructors as part of thelanguage, and as a result these facilities had to be provided as part of MacAppinstead of the language.</p><p>MacApp 3.0 designers tried to accomplish backward compatibility withapplications written with older versions of MacApp based on Object Pascal.Because of this, the designers decided to stay with the Initialize and Freefunctions rather than just have an instance of the objects declared anddestroyed with new and free.</p><h2>Which headers to use for MacApp program development</h2><P>Date Written:  9/15/92</p><P>Last reviewed:  6/14/93</p><p>As a MacApp developer, am I supposed to be using the .h files in the MPW:Interfaces folder, or the ones in the {MacApp}CPlusIncludes folder?</p><P>As a default, MacApp first searches through the {MacApp}CPlusIncludes folderfor header files specified in your source, so we suggest using the<code>CPlusIncludes</code> headers. The path to these include files is defined in the{MacApp}Startup Items:Startup folder.</p><h2>MacApp developer technical support options</h2><P>Date Written:  10/27/90</p><P>Last reviewed:  11/16/92</p><p>Is there a special address for MacApp technical support or is the DeveloperSupport Center the correct target?</p><P>For Apple Partners and Associates, DEVSUPPORT is an option, though there arealso other avenues of tech support for MacApp programmers as well. First thereare the group addresses MacApp2Tech$ and MacApp3Tech$. These are groups ofMacApp developers on AppleLink that ask and answer questions of each other. Youcan simply send your questions to that address and request replies back to yourpersonal account, or you can join a group and receive copies of all the mailsent to it by sending a request to MacApp.Admin.</p><p>Another avenue of support is from MADA. This is a nonprofit organization set upby MacApp lovers. It's got about 1500 members across the nation, and even has aEuropean counterpart. It has an annual MADA conference and a bimonthlymagazine. If you are interested, call them at (206) 253-2765, or write to themat AppleLink address MADA. Annual fee is $75.</P><h2>Debugging options for C++</h2><P>Date Written:  11/28/90</p><P>Last reviewed:  6/14/93</p><p>What is the C++ equivalent for the {$D+/-} Object Pascal compiler directive?I'd like the same debugging options for C++ that exist for Object Pascal.</p><P>The MacApp debugger is supported with C++ Object Pascal object information. Inother words, you can't trace other objects than those derived fromPascalObjects.</p><p>This works OK if you include a "-trace on" or "-trace always" with <code>CFront</code> whenyou compile your MacApp source code. We assume that you are using the latestMPW C++ (3.1 final and MPW 3.1&szlig; C tools). Use either the startup file andinclude this as one of you basic parameters, or send it from MABuild.</p><p>We did some testing, and it seemed to work OK. In general the S (stack info)command with the MacApp debugger has a lower signal/noise ratio than the R(recent PC) command concerning useful information, but both work OK.</P><h2>Extracting text from MacApp TEditText views in dialogs</h2><P>Date Written:  6/1/91</p><P>Last reviewed:  6/14/93</p><p>Where/when is the best place to extract text from my fill-in-the-blankMacintosh dialog with several <code>TEditText</code> views? Does a method get called whenanother field is selected or another view (like a button) is chosen? I canthink of several ways to accomplish what I want to do, but I'd rather use theMacApp view architecture the way it is DESIGNED to be used.</p><P>You can get one answer to this by looking in the <code>DemoDialogs</code> example (C++ orOP). TView has a method called <code>DoChoice</code>, which should be activated, forinstance, when a button, checkbox, or even with <code>TrackMouse</code> operating over aparticular view or groups of view, has triggered something, and the applicationwants something to be done. Using <code>MacBrowse</code>, do a Find References (orCommand-R) to find all references wherefrom DoChoice is called, such asTrackMouse or <code>DoKeyCommand</code>. Fields are Views, so they will inherit <code>DoChoice</code>,and in the case of <code>TEditText</code> you could, for instance, call <code>DoChoice</code> from<code>HandleMouseDown</code> (when clicking in a particular field).</p><p><code>HandleMouseDown</code> is also a <code>TView</code> method, so most views have this oneimplemented. Special sub-Views have additional indicators that something wastriggered inside the view.</p><h2>%_BP and %_EP routines</h2><P>Date Written:  6/17/91</p><P>Last reviewed:  6/14/93</p><p>When I attempt to link my program, the linker complains about %_BP and %_EPbeing undefined. What are these routines? Why are they needed? Why are they notbeing found?</p>__<P>The functions %_BP and %_EP are special routines that are conditionally calledat the beginning and end of each procedure or function. This is designed foruse by the MacApp debugger, which uses these calls to follow the execution ofthe code being debugged. You can also put them to any purpose you wish, such asprofiling.</p><p>Whether the calls to these routines are inserted is controlled through compilerdirectives: in MPW C, you can use the #pragma trace on|off directive to specifywhether you wish these calls to be inserted. This can also be done with thecompiler option -trace on|off|always|never, which makes the default stateeither on or off (the always and never options also override the #prgama tracedirectives). In MPW Pascal, you can control this feature with the {$D++} (whichturns the calls on) and {$D--} (which turns them off) directives.</p><p>Generally, the routines themselves are supplied by a library you link with,such as the MacApp debugger or a profiling tool, so you won't need to writeyour own. If however, you decide to use this feature for your own deviouspurposes, here's how.</p><p>The procedures called are passed no arguments, and so should be defined asfollows:</p><p>in MPW C:</p><p>or in MPW Pascal:</p><p>The only difficulty is that neither C nor Pascal allows you to create afunction that begins with a % sign. Thus, you need to explicitly tell thelinker to treat your functions, BP and EP, as %_BP and %_EP. To do this, addthe options -ma BP=%_BP -ma EP=%_EP to your link statement, and all will bewell.</p><h2>Saving window state in pre-3.0 MacApp</h2><P>Date Written:  8/23/91</p><P>Last reviewed:  9/17/91</p><p>How do I save new window size and location in a TWindows resource so it can bereused next time this window is opened or created?</p><P>To save your window state in a MacApp application, your implementation needs todo the following:</p><ol type="1" start="1">	<li>Create a record that holds the window state</li>	<li>Track whether the document is being opened or reopened</li>	<li>Read the window state information in your <code>DoRead</code> method</li>	<li>Restore or initialize the window state in your <code>DoMakeViews</code> method</li>	<li>Add in the number of bytes required for the window state when you compute the disk space required for the document file</li>	<li>Write the window state when you save the document You could store the window state record in the resource fork of the document file. Here's a simple example:</li></ol><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>TYPE    DocState   = RECORD         theLocation       : VPoint;         theSize           : VPoint;    END;    HDocState = ^PDocState;  {Handle to DocState information}</pre>	</TD></TR></TABLE></CENTER><p>In the document class, add some fields for keeping track of the state, as inthe following code:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    fDocState : DocState;  {the record with the window state information}</pre>	</TD></TR></TABLE></CENTER><p>The <code>fReopening</code> flag is used to test whether the window state needs to berestored. If this is true, <code>DoMakeViews</code> should then know that it needs torestore the window state from the <code>fDocState</code> record. You need to set thisBoolean false in the Initialization phase of the Document object.</p><p>In the <code>DoRead</code>, check if the resource fork is open, and read in the record tothe document field, and set the Boolean to true.</p><p>Inside <code>DoMakeViews</code>, call another special method called <code>RestoreWindow</code> (orsomething similar) which takes the information in <code>fDocState</code>, and acts upon thewindow. For example, for window location, call the window Locate method andprovide Locate with the values from the <code>fDocState</code> record. Then force the windowon the screen. Same with the scroll location, call the <code>ScrollTo</code>, and provideany possible <code>VCoordinates</code> from the <code>fDocState</code>. Same also with the window size,use <code>TWindow.Resize</code> and resize the window according to the saved values.</p><p>Finally, you need to save the <code>TView.fLocation</code>, <code>TView.fSize</code> and other values inthe <code>fDocRec</code> record, calculate how much space you need in <code>DoNeedDiskSpace</code>:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    rsrcForkbytes = rsrcForkBytes + kRsrcTypeOverhead                                  + kRsrcOverhead + sizeof(DocState);And in DoWrite you add the resource to the resource fork, and before that catchthe latest values in the various fields:    ...    docStateHandle := HDocState(NewPermHandle(sizeof(DocState)) );    with docStateHandle^^ DO      BEGIN        theLocation := aWindow.flocation;        ...      END;    AddResource(Handle(docStateHandle), kDocRsrcKind,                                        kDocStateID, 'Doc State');    FailOSErr(ResError);    ...</pre>	</TD></TR></TABLE></CENTER><p>All this is slightly different in MacApp 3.0, because locations are in <code>VPoints</code>,and windows are keeping track of the location and size directly (fields inTWindow), so you need to modify the source code for this. MacApp 3.0 DrawShapeswill also show how to save the window state information.</p><p>The LACS example in <i>develop</i> also has code that shows how to store andrestore the window location information.</p><p>X-Ref:</p><P>"Asynchronous Background Networking on the Macintosh,"<i> develop</i> #2:1,Winter 91</p><h2>MacApp libraries: Building debug versions</h2><P>Date Written:  11/18/91</p><P>Last reviewed:  12/12/91</p><p>I'm having problems building debug versions of the MacApp library ("-NeedsFPU-Debug" and others)--particularly with the UDebug.p unit, and its references to"Notification" structures. Is there a fix?</p><P>Assuming that you are using MPW 3.2, the solution to your problem is documentedin the MacApp 2.0.1 Release Notes dated September 28, 1990, located on theE.T.O. #5 CD. On page 18 is the following excerpt:</p><p>There are several incompatibilities between MPW 3.2 and 3.1. If you wish to useMPW 3.2 with MacApp, in the file "Startup," comment-out the line:</p><p>This should work with beta and final versions of MPW 3.2, although it's onlybeen verified with MPW 3.2b3, which was available at the time.</p><p>However, if you are developing on the Macintosh Quadra computers with MacApp2.01 or MacApp 3.0 (versions prior to b3) and are using -NeedsFPU or -Debug youmay have a problem with crashing. The workaround is to comment out thefollowing lines in procedure InstallInterceptors found in UDebug.incl.p, whichinstalls LineF exception handlers:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>     pOldexLineF := ProcPtrPtr(exLineF)^;</pre>	</TD></TR></TABLE></CENTER><p>Versions beginning with 3.0b3 no longer have this code.</p><p>The reason for commenting this code out is that the 68040 has a subset of theinstructions handled by the 68881/68882. Missing instructions must be emulatedvia the <code>LineF</code> exception handler. The above code blindly intercepts all <code>LineF</code>exceptions, including those that are now valid. Of course, removing this codediminishes MacApp's debugging capabilities somewhat, but this should be a minorinconvenience.</p><h2>Avoiding odd-address errors on 68000-based systems</h2><P>Date Written:  4/30/91</p><P>Last reviewed:  5/20/91</p><p>My application crashes on Macintosh SE but not Macintosh II systems whileattempting to read a block of code into memory and parse it. The routine passesa pointer created by <code>NewPermPtr</code> to various objects, so they can extractinformation and increment the pointer. The MacApp debugger gives me thefollowing message:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    Exception #3 Address error: Word or long-word reference made to an odd address</pre>	</TD></TR></TABLE></CENTER><P>You can get odd-address errors with 68000-based machines. Starting with 68020the CPU is able to fetch data from odd addresses. Anyway, it's a common problemto get into trouble with data fetched from odd addresses with 68000-basedplatforms. Possibly the data you are saving and later retrieving has oddlength, causing the next fetch to start on an odd address.</p><p>To guarantee that the data will always start on even boundaries, use the MacApp<code>OffsetPtr</code> global routine. Here's the new MacApp 3.0 C++ version of thisroutine:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    pascal void OffsetPtr(Ptr&amp; p, long offset)    {        p += offset;        if (((long) p) &amp; 1)            ++p;</pre>	</TD></TR></TABLE></CENTER><p>The function tests if the pointer is pointing at an odd address, and if so itincreases the pointer one byte. You could do something similar in your memberfunction, such as:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    short*  sptr = (short*)buf;    fValue = *sptr;</pre>	</TD></TR></TABLE></CENTER><h2>DAs shouldn't be written in MacApp</h2><P>Date Written:  4/29/91</p><P>Last reviewed:  6/21/91</p><p>Where can I find information about writing a desk accessory (DA) in MacApp?</p><P>First, take a look at the Macintosh Technical Note "Inside Object Pascal,"which explains why, as an application framework, MacApp should be used to writeonly applications and MPW tools. Apple's on-line MacApp forum and the MacAppDevelopers' Association (MADA) are good points of contact for exchanginginformation about MacApp development. Contact MacApp.Admin on AppleLink fordetails about the MacApp forum. MADA can be reached at (206) 253-2765 orAppleLink address MADA.</p><h2>MacApp <Code>'mem!'</code> and <Code>'seg!'</code> resources</h2><P>Date Written:  3/31/92</p><P>Last reviewed:  5/21/92</p><p>What's the purpose of the MacApp <Code>'mem!'</code> and <Code>'seg!'</code> resources, and where doesthe documentation for these resources exist?</p><P>The <Code>'mem!'</code> resource allows you to change MacApp's memory allocation reserves invarious ways. Each contains three numbers: the amount to add to the temporaryreserve, which is used for system allocations such as system resources andtemporary handles; an amount to add to the permanent reserve, which is used byyou for your memory allocation; and an amount of stack space. Having multiple<Code>'mem!'</code> resources causes their values to be summed; in this way, you can createa "debugging" <Code>'mem!'</code> resource that gives you extra space and delete it when youproduce a non-debug version. This is discussed in the MacApp 2.0 GeneralReference, in Chapter 3.</p><p>The <Code>'seg!'</code> resource is used to reserve space for code segments. If theMacintosh ever tries to load a code segment but fails due to lack of memory, itwill crash. Thus, MacApp keeps a store of memory solely for loading coderesources. It sizes this reserve by adding together the sizes of the segmentsnamed in the <Code>'seg!'</code> resource. One way to do this would be to just name all thesegments, so that you know there's room for them all; however, this would bewasteful, because many segments are often unused (your printing code, forexample). So what you do is name only those segments that represent the largestcode path you can have--the calling chain that would require the largest set ofcode segments to be loaded at any time. This is also described in Chapter 3 ofthe MacApp General Reference. In contrast, <Code>'res!'</code> names segments that must beresident all the time; they're actually loaded and made resident, as opposed tothe <Code>'seg!'</code> segments, which are used only to calculate how much memory should bereserved for segments in general.</p><h2>InitUMacApp parameter callsToMoreMasters maximum</h2><P>Date Written:  8/7/92</p><P>Last reviewed:  6/14/93</p><p>After testing, I believe the maximum value for the <code>InitUMacApp</code> parameter thatspecifies the number of calls to MoreMasters is 511. In nodebug mode, anynumber larger than that will yield one master pointer, and even that ismutated--$80 instead of $100 bytes in length. In debug mode, the applicationwill crash immediately after it is launched. Is this limitation documentedanywhere?</p><P>MacApp multiplies the value you provide by the current number of masterpointers in a block (which is how many would normally be allocated by a singlecall to <code>MoreMasters</code>). This value is usually 64. MacApp then stores the resultinto the field that specifies how many master pointers to allocate in eachblock and then calls <code>MoreMasters</code> once, which allocates all the master pointersyou want in one block, which is somewhat more efficient than having them inmany blocks. Unfortunately, if you call <code>InitUMacApp(512)</code>, it calculates thenumber of pointers as being 512*64 = 32768. You will note that the field in thezone header that holds the number of master pointers to be allocated at anytime is an integer; 32768 overflows the number of bits it has available,because it is a signed number. MacApp then tells the Memory Manager to allocateone master pointer block, with a negative number of pointers in it. Needless tosay, this is somewhat suboptimal. Here are a couple of possible solutions:</p><ol type="1" start="1">	<li> Fix MacApp. Modify the InitUMacApp source so that if it is called with an argument greater than 512, rather than attempting to allocate all the pointers at once, it allocates more than one block. For example, the call <code>InitUMacApp(2071)</code> might set up the zone header so that it would allocate 64*500=32000 master pointers at once, then call MoreMasters four times, then set it for 64*71=4544 master pointers at once, then call MoreMasters one last time.</li>	<li> If you don't want to muck with the MacApp source, you can just allocate the surplus pointers yourself; modify the zone header, allocate most of your pointers, and then call InitUMacApp to allocate the rest.</li></ol><p>This is an incredibly large number of handles; the Macintosh Memory Managerwasn't designed for an immense number of handles in a single heap; it'sprobably going to be very slow. You may want to consider working out your ownallocation scheme for some of these objects.</p><br>         <a name=Downloads></A>                  <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (51K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/pt_530.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/pt/pt_530.html%3Fid%3DDTS10002699-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/pt/pt_530.html%3Fid%3DDTS10002699-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/pt/pt_530.html%3Fid%3DDTS10002699-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>