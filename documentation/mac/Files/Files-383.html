<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>DIBadMount (IM: F)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING383></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Files-382.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-384.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Files-2.html"><B>Files</B></A> / <BR><DD><A HREF="Files-367.html"><B>Chapter 5 - Disk Initialization Manager</B></A> / <A HREF="Files-377.html"><B>Disk Initialization Manager Reference</B></A><BR><DL><DD><A HREF="Files-378.html"><B>Routines</B></A> / <A HREF="Files-382.html"><B>Initializing a Disk</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING383-0></A>
<H3><A NAME=MARKER-11-101></A><A NAME=MARKER-2-102></A>DIBadMount</H3>
 To respond to the user's insertion of an uninitialized or damaged disk, you can call the <CODE>DIBadMount</CODE> function.<P>
<PRE>
FUNCTION DIBadMount (where: Point; evtMessage: LongInt): Integer;
</PRE>
<DL>
<DT><CODE>where</CODE>
<DD> The desired location, in global coordinates, of the upper-left corner of the disk initialization dialog box. In system software versions 7.0 and later, this parameter is ignored, and the dialog box is automatically centered on the screen.
<DT><CODE>evtMessage</CODE>
<DD> The event message received when the disk is inserted. The high word of this message contains the result code associated with the disk insertion. The low word of this message indicates the number of the drive into which the user inserted the disk.
</DL>
<A NAME=HEADING383-5></A>
<H5>DESCRIPTION</H5>
 The <CODE>DIBadMount</CODE> function evaluates the result code in the high word of the <CODE>evtMessage</CODE> parameter and responds appropriately. If the result code is <CODE>noErr</CODE>, the function allows <BR>the user to erase the contents of the disk. If the result code is <CODE>ioErr</CODE>, <CODE>badMDBErr</CODE>, or <CODE>noMacDskErr</CODE>, initializing the disk might correct the problem, and so <CODE>DIBadMount</CODE> displays a dialog box that explains the problem and allows the user to initialize the disk. If the result code is <CODE>extFSErr</CODE>, <CODE>memFullErr</CODE>, <CODE>nsDrvErr</CODE>, <CODE>paramErr</CODE>, or <CODE>volOnLinErr</CODE>, then initializing the disk would not correct the problem. In this case, <CODE>DIBadMount</CODE> ejects the disk from the drive and returns the result code.<P>
 Before presenting the disk initialization dialog box, <CODE>DIBadMount</CODE> checks whether the drive contains an already mounted volume. If so, it ejects the disk and returns 2 as its result. This happens rarely and could reflect an error in your application (for example, you forgot to call <CODE>DILoad</CODE>, and the user had to switch to the disk containing the System resource file).<P>
 The <CODE>DIBadMount</CODE> function uses just one disk initialization dialog box to cover all disk initialization situations. The dialog box contains many dialog items, which are hidden and shown as appropriate. The dialog box always contains an icon indicating the drive containing the disk to be initialized.<P>
 The initial text of the disk initialization dialog box depends on the result code received. For example, if you pass <CODE>noMacDskErr</CODE> to <CODE>DIBadMount</CODE> in the <CODE>evtMessage</CODE> parameter, the dialog box displays the text "This is not a Macintosh disk." If you pass the result <BR>code <CODE>noErr</CODE>, you can customize the message by using the Dialog Manager's <CODE>ParamText</CODE> procedure.<P>
 The disk initialization dialog box contains a button allowing the user to cancel the initialization and one or two buttons allowing the user to request initialization of <BR>the disk. Usually, the cancel button is labeled Eject, but if the result code passed to <CODE>DIBadMount</CODE> within the <CODE>evtMessage</CODE> parameter is <CODE>noErr</CODE>, then the cancel button is labeled Cancel. If the user responds to the disk initialization dialog box by clicking <BR>the Eject button, <CODE>DIBadMount</CODE> ejects the disk and returns 1 as its result. If the user <BR>clicks the Cancel button, <CODE>DIBadMount</CODE> returns 1 but does not eject the disk.<P>
 In most cases, the Initialize button is the only alternative to the Eject or Cancel button. However, if the user inserts a double-sided (but not high-density) disk into a double-sided or high-density disk drive, <CODE>DIBadMount</CODE> presents buttons labeled One-Sided and Two-Sided. The user can then decide whether to make the disk single-sided or double-sided. If the user clicks the Initialize button, the One-Sided button, or the Two-Sided button, <CODE>DIBadMount</CODE> warns the user that the initialization process erases any existing data on the disks. If the user proceeds, <CODE>DIBadMount</CODE> allows the user to name the disk if it is not already named and then updates the text of the dialog box to inform the user of the progress of the operation. If the operation fails, <CODE>DIBadMount</CODE> alerts the user and ejects the disk, returning an appropriate result code.<P>
 You can use <CODE>DIBadMount</CODE> to format hard disks as well as floppy disks. However, you should not attempt to format the startup volume.<P>
<A NAME=HEADING383-13></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for <CODE>DIBadMount</CODE> are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_Pack2<TD>$0000</TABLE>
<P>
<A NAME=HEADING383-15></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Because the <CODE>DIBadMount</CODE> function might allocate memory, you should not call it at interrupt time.<P>
<A NAME=HEADING383-17></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>[no name]<TD>2<TD>Disk in specified drive is already mounted<TR>
<TD>[no name]<TD>1<TD>User canceled initializing<TR>
<TD>noErr<TD>0<TD>No error<TR>
<TD>paramErr<TD>-50<TD>Drive number specified is bad<TR>
<TD>volOnLinErr<TD>-55<TD>Volume is already online<TR>
<TD>nsDrvErr<TD>-56<TD>No such drive<TR>
<TD>extFSErr<TD>-58<TD>Disk has external file system<TR>
<TD>lastDskErr<TD>-64<TD>Last of the range of low-level disk errors<TR>
<TD>...<TD>&nbsp;<TD>&nbsp;<TR>
<TD>firstDskErr<TD>-84<TD>First of the range of low-level disk errors<TR>
<TD>memFullErr<TD>-108<TD>Not enough memory<A NAME=MARKER-2-1></A></TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Files-382.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Files-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Files-390.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Files-384.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Files-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
