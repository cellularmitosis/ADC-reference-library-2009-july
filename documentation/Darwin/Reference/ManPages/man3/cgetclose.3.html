<html><head><title>Mac OS X
 Manual Page For cgetclose(3)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3/cgetclose" title="Mac OS X
 Manual Page for cgetclose(3)"><!-- headerDoc=man; indexgroup=Section 3; uid="//apple_ref/doc/man/3/cgetclose"; name=cgetclose(3) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
GETCAP(3)                BSD Library Functions Manual                <!-- a -->GETCAP(3)<!-- /a -->

<b>NAME</b>
     <b>cgetent</b>, <b>cgetset</b>, <b>cgetmatch</b>, <b>cgetcap</b>, <b>cgetnum</b>, <b>cgetstr</b>, <b>cgetustr</b>, <b>cgetfirst</b>, <b>cgetnext</b>, <b>cgetclose</b> --<font color="#ffffff" class="whiteout">capability&nbsp;-capability</font>
     capability database access routines

<b>LIBRARY</b>
     Standard C Library (libc, -lc)

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;stdlib.h&gt;</b>

     <u>int</u>
     <b>cgetent</b>(<u>char</u> <u>**buf</u>, <u>char</u> <u>**db</u><b>_</b><u>array</u>, <u>char</u> <u>*name</u>);

     <u>int</u>
     <b>cgetset</b>(<u>char</u> <u>*ent</u>);

     <u>int</u>
     <b>cgetmatch</b>(<u>char</u> <u>*buf</u>, <u>char</u> <u>*name</u>);

     <u>char</u> <u>*</u>
     <b>cgetcap</b>(<u>char</u> <u>*buf</u>, <u>char</u> <u>*cap</u>, <u>int</u> <u>type</u>);

     <u>int</u>
     <b>cgetnum</b>(<u>char</u> <u>*buf</u>, <u>char</u> <u>*cap</u>, <u>long</u> <u>*num</u>);

     <u>int</u>
     <b>cgetstr</b>(<u>char</u> <u>*buf</u>, <u>char</u> <u>*cap</u>, <u>char</u> <u>**str</u>);

     <u>int</u>
     <b>cgetustr</b>(<u>char</u> <u>*buf</u>, <u>char</u> <u>*cap</u>, <u>char</u> <u>**str</u>);

     <u>int</u>
     <b>cgetfirst</b>(<u>char</u> <u>**buf</u>, <u>char</u> <u>**db</u><b>_</b><u>array</u>);

     <u>int</u>
     <b>cgetnext</b>(<u>char</u> <u>**buf</u>, <u>char</u> <u>**db</u><b>_</b><u>array</u>);

     <u>int</u>
     <b>cgetclose</b>(<u>void</u>);

<b>DESCRIPTION</b>
     The <b>cgetent</b>() function extracts the capability <u>name</u> from the database specified by the NULL terminated
     file array <u>db</u><b>_</b><u>array</u> and returns a pointer to a <a href="malloc.3.html#//apple_ref/doc/man/3/malloc">malloc(3)</a>'d copy of it in <u>buf</u>.  The <b>cgetent</b>() function
     will first look for files ending in <u>.db</u> (see <a href="../man1/cap_mkdb.1.html#//apple_ref/doc/man/1/cap_mkdb">cap_mkdb(1)</a>) before accessing the ASCII file.  The <u>buf</u>
     argument must be retained through all subsequent calls to <b>cgetmatch</b>(), <b>cgetcap</b>(), <b>cgetnum</b>(), <b>cgetstr</b>(),
     and <b>cgetustr</b>(), but may then be <a href="free.3.html#//apple_ref/doc/man/3/free">free(3)</a>'d.  On success 0 is returned, 1 if the returned record contains
     an unresolved <b>tc</b> expansion, -1 if the requested record couldn't be found, -2 if a system error was
     encountered (couldn't open/read a file, etc.) also setting <u>errno</u>, and -3 if a potential reference loop
     is detected (see <b>tc=</b> comments below).

     The <b>cgetset</b>() function enables the addition of a character buffer containing a single capability record
     entry to the capability database.  Conceptually, the entry is added as the first ``file'' in the data-<font color="#ffffff" class="whiteout">base,&nbsp;database,</font>
     base, and is therefore searched first on the call to <b>cgetent</b>().  The entry is passed in <u>ent</u>.  If <u>ent</u> is
     NULL, the current entry is removed from the database.  A call to <b>cgetset</b>() must precede the database
     traversal.  It must be called before the <b>cgetent</b>() call.  If a sequential access is being performed
     (see below), it must be called before the first sequential access call (<b>cgetfirst</b>() or <b>cgetnext</b>()), or
     be directly preceded by a <b>cgetclose</b>() call.  On success 0 is returned and -1 on failure.

     The <b>cgetmatch</b>() function will return 0 if <u>name</u> is one of the names of the capability record <u>buf</u>, -1 if
     not.

     The <b>cgetcap</b>() function searches the capability record <u>buf</u> for the capability <u>cap</u> with type <u>type</u>.  A
     <u>type</u> is specified using any single character.  If a colon (`:') is used, an untyped capability will be
     searched for (see below for explanation of types).  A pointer to the value of <u>cap</u> in <u>buf</u> is returned on
     success, NULL if the requested capability couldn't be found.  The end of the capability value is sig-<font color="#ffffff" class="whiteout">naled&nbsp;signaled</font>
     naled by a `:' or ASCII NUL (see below for capability database syntax).

     The <b>cgetnum</b>() function retrieves the value of the numeric capability <u>cap</u> from the capability record
     pointed to by <u>buf</u>.  The numeric value is returned in the <u>long</u> pointed to by <u>num</u>.  0 is returned on suc-<font color="#ffffff" class="whiteout">cess,&nbsp;success,</font>
     cess, -1 if the requested numeric capability couldn't be found.

     The <b>cgetstr</b>() function retrieves the value of the string capability <u>cap</u> from the capability record
     pointed to by <u>buf</u>.  A pointer to a decoded, NUL terminated, <a href="malloc.3.html#//apple_ref/doc/man/3/malloc">malloc(3)</a>'d copy of the string is returned
     in the <u>char</u> <u>*</u> pointed to by <u>str</u>.  The number of characters in the decoded string not including the
     trailing NUL is returned on success, -1 if the requested string capability couldn't be found, -2 if a
     system error was encountered (storage allocation failure).

     The <b>cgetustr</b>() function is identical to <b>cgetstr</b>() except that it does not expand special characters,
     but rather returns each character of the capability string literally.

     The <b>cgetfirst</b>() and <b>cgetnext</b>() functions comprise a function group that provides for sequential access
     of the NULL pointer terminated array of file names, <u>db</u><b>_</b><u>array</u>.  The <b>cgetfirst</b>() function returns the
     first record in the database and resets the access to the first record.  The <b>cgetnext</b>() function
     returns the next record in the database with respect to the record returned by the previous <b>cgetfirst</b>()
     or <b>cgetnext</b>() call.  If there is no such previous call, the first record in the database is returned.
     Each record is returned in a <a href="malloc.3.html#//apple_ref/doc/man/3/malloc">malloc(3)</a>'d copy pointed to by <u>buf</u>.  <b>Tc</b> expansion is done (see <b>tc=</b> com-<font color="#ffffff" class="whiteout">ments&nbsp;comments</font>
     ments below).  Upon completion of the database 0 is returned, 1 is returned upon successful return of
     record with possibly more remaining (we haven't reached the end of the database yet), 2 is returned if
     the record contains an unresolved <b>tc</b> expansion, -1 is returned if a system error occurred, and -2 is
     returned if a potential reference loop is detected (see <b>tc=</b> comments below).  Upon completion of data-<font color="#ffffff" class="whiteout">base&nbsp;database</font>
     base (0 return) the database is closed.

     The <b>cgetclose</b>() function closes the sequential access and frees any memory and file descriptors being
     used.  Note that it does not erase the buffer pushed by a call to <b>cgetset</b>().

<b>CAPABILITY</b> <b>DATABASE</b> <b>SYNTAX</b>
     Capability databases are normally ASCII and may be edited with standard text editors.  Blank lines and
     lines beginning with a `#' are comments and are ignored.  Lines ending with a `\' indicate that the
     next line is a continuation of the current line; the `\' and following newline are ignored.  Long lines
     are usually continued onto several physical lines by ending each line except the last with a `\'.

     Capability databases consist of a series of records, one per logical line.  Each record contains a
     variable number of `:'-separated fields (capabilities).  Empty fields consisting entirely of white
     space characters (spaces and tabs) are ignored.

     The first capability of each record specifies its names, separated by `|' characters.  These names are
     used to reference records in the database.  By convention, the last name is usually a comment and is
     not intended as a lookup tag.  For example, the <u>vt100</u> record from the <!-- a -->termcap(5)<!-- /a --> database begins:

           d0|vt100|vt100-am|vt100am|dec vt100:

     giving four names that can be used to access the record.

     The remaining non-empty capabilities describe a set of (name, value) bindings, consisting of a names
     optionally followed by a typed value:

     name          typeless [boolean] capability <u>name</u> is present [true]
     name<u>T</u>value    capability (<u>name</u>, <u>T</u>) has value <u>value</u>
     name@         no capability <u>name</u> exists
     name<u>T</u>@        capability (<u>name</u>, <u>T</u>) does not exist

     Names consist of one or more characters.  Names may contain any character except `:', but it's usually
     best to restrict them to the printable characters and avoid use of graphics like `#', `=', `%', `@',
     etc.  Types are single characters used to separate capability names from their associated typed values.
     Types may be any character except a `:'.  Typically, graphics like `#', `=', `%', etc. are used.  Val-<font color="#ffffff" class="whiteout">ues&nbsp;Values</font>
     ues may be any number of characters and may contain any character except `:'.

<b>CAPABILITY</b> <b>DATABASE</b> <b>SEMANTICS</b>
     Capability records describe a set of (name, value) bindings.  Names may have multiple values bound to
     them.  Different values for a name are distinguished by their <u>types</u>.  The <b>cgetcap</b>() function will
     return a pointer to a value of a name given the capability name and the type of the value.

     The types `#' and `=' are conventionally used to denote numeric and string typed values, but no
     restriction on those types is enforced.  The functions <b>cgetnum</b>() and <b>cgetstr</b>() can be used to implement
     the traditional syntax and semantics of `#' and `='.  Typeless capabilities are typically used to
     denote boolean objects with presence or absence indicating truth and false values respectively.  This
     interpretation is conveniently represented by:

           (getcap(buf, name, ':') != NULL)

     A special capability, <b>tc=</b> <b>name</b>, is used to indicate that the record specified by <u>name</u> should be substi-<font color="#ffffff" class="whiteout">tuted&nbsp;substituted</font>
     tuted for the <b>tc</b> capability.  <b>Tc</b> capabilities may interpolate records which also contain <b>tc</b> capabili-<font color="#ffffff" class="whiteout">ties&nbsp;capabilities</font>
     ties and more than one <b>tc</b> capability may be used in a record.  A <b>tc</b> expansion scope (i.e., where the
     argument is searched for) contains the file in which the <b>tc</b> is declared and all subsequent files in the
     file array.

     When a database is searched for a capability record, the first matching record in the search is
     returned.  When a record is scanned for a capability, the first matching capability is returned; the
     capability <b>:nameT@:</b> will hide any following definition of a value of type <u>T</u> for <u>name</u>; and the capabil-<font color="#ffffff" class="whiteout">ity&nbsp;capability</font>
     ity <b>:name@:</b> will prevent any following values of <u>name</u> from being seen.

     These features combined with <b>tc</b> capabilities can be used to generate variations of other databases and
     records by either adding new capabilities, overriding definitions with new definitions, or hiding fol-<font color="#ffffff" class="whiteout">lowing&nbsp;following</font>
     lowing definitions via `@' capabilities.

<b>EXAMPLES</b>
           example|an example of binding multiple values to names:\
                :foo%bar:foo^blah:foo@:\
                :abc%xyz:abc^frap:abc$@:\
                :tc=more:

     The capability foo has two values bound to it (bar of type `%' and blah of type `^') and any other
     value bindings are hidden.  The capability abc also has two values bound but only a value of type `$'
     is prevented from being defined in the capability record more.

           file1:
                new|new_record|a modification of "old":\
                     :fript=bar:who-cares@:tc=old:blah:tc=extensions:
           file2:
                old|old_record|an old database record:\
                     :fript=foo:who-cares:glork#200:

     The records are extracted by calling <b>cgetent</b>() with file1 preceding file2.  In the capability record
     new in file1, fript=bar overrides the definition of fript=foo interpolated from the capability record
     old in file2, who-cares@ prevents the definition of any who-cares definitions in old from being seen,
     glork#200 is inherited from old, and blah and anything defined by the record extensions is added to
     those definitions in old.  Note that the position of the fript=bar and who-cares@ definitions before
     tc=old is important here.  If they were after, the definitions in old would take precedence.

<b>CGETNUM</b> <b>AND</b> <b>CGETSTR</b> <b>SYNTAX</b> <b>AND</b> <b>SEMANTICS</b>
     Two types are predefined by <b>cgetnum</b>() and <b>cgetstr</b>():

     <u>name</u>#<u>number</u>    numeric capability <u>name</u> has value <u>number</u>
     <u>name</u>=<u>string</u>    string capability <u>name</u> has value <u>string</u>
     <u>name</u>#@         the numeric capability <u>name</u> does not exist
     <u>name</u>=@         the string capability <u>name</u> does not exist

     Numeric capability values may be given in one of three numeric bases.  If the number starts with either
     `0x' or `0X' it is interpreted as a hexadecimal number (both upper and lower case a-f may be used to
     denote the extended hexadecimal digits).  Otherwise, if the number starts with a `0' it is interpreted
     as an octal number.  Otherwise the number is interpreted as a decimal number.

     String capability values may contain any character.  Non-printable ASCII codes, new lines, and colons
     may be conveniently represented by the use of escape sequences:

     ^X        ('X' &amp; 037)          control-X
     \b, \B    (ASCII 010)          backspace
     \t, \T    (ASCII 011)          tab
     \n, \N    (ASCII 012)          line feed (newline)
     \f, \F    (ASCII 014)          form feed
     \r, \R    (ASCII 015)          carriage return
     \e, \E    (ASCII 027)          escape
     \c, \C    (:)                  colon
     \\        (\)                  back slash
     \^        (^)                  caret
     \nnn      (ASCII octal nnn)

     A `\' may be followed by up to three octal digits directly specifies the numeric code for a character.
     The use of ASCII NULs, while easily encoded, causes all sorts of problems and must be used with care
     since NULs are typically used to denote the end of strings; many applications use `\200' to represent a
     NUL.

<b>DIAGNOSTICS</b>
     The <b>cgetent</b>(), <b>cgetset</b>(), <b>cgetmatch</b>(), <b>cgetnum</b>(), <b>cgetstr</b>(), <b>cgetustr</b>(), <b>cgetfirst</b>(), and <b>cgetnext</b>()
     functions return a value greater than or equal to 0 on success and a value less than 0 on failure.  The
     <b>cgetcap</b>() function returns a character pointer on success and a NULL on failure.

     The <b>cgetent</b>(), and <b>cgetseq</b>() functions may fail and set <u>errno</u> for any of the errors specified for the
     library functions: <a href="fopen.3.html#//apple_ref/doc/man/3/fopen">fopen(3)</a>, <a href="fclose.3.html#//apple_ref/doc/man/3/fclose">fclose(3)</a>, <a href="../man2/open.2.html#//apple_ref/doc/man/2/open">open(2)</a>, and <a href="../man2/close.2.html#//apple_ref/doc/man/2/close">close(2)</a>.

     The <b>cgetent</b>(), <b>cgetset</b>(), <b>cgetstr</b>(), and <b>cgetustr</b>() functions may fail and set <u>errno</u> as follows:

     [ENOMEM]           No memory to allocate.

<b>SEE</b> <b>ALSO</b>
     <a href="../man1/cap_mkdb.1.html#//apple_ref/doc/man/1/cap_mkdb">cap_mkdb(1)</a>, <a href="malloc.3.html#//apple_ref/doc/man/3/malloc">malloc(3)</a>

<b>BUGS</b>
     Colons (`:') can't be used in names, types, or values.

     There are no checks for <b>tc</b>=<b>name</b> loops in <b>cgetent</b>().

     The buffer added to the database by a call to <b>cgetset</b>() is not unique to the database but is rather
     prepended to any database used.

BSD                              May 13, 1994                              BSD
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/cgetclose.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/cgetclose.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/cgetclose.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
