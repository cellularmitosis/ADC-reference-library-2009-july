<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>CMCloseProfile(IM: ACI Ref)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING221></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="ACIReference-220.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACIReference-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACIReference-371.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACIReference-222.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="ACIReference-2.html"><B>Advanced Color Imaging Reference</B></A> / <BR><DD><A HREF="ACIReference-154.html"><B>Chapter 3 - ColorSync Manager Reference for Applications and Device Drivers</B></A> / <A HREF="ACIReference-218.html"><B>ColorSync Manager Functions</B></A><BR><DL><DD><A HREF="ACIReference-219.html"><B>Accessing Profiles</B></A> / <A HREF="ACIReference-204.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING221-0></A>
<H3><A NAME=MARKER-11-322></A><A NAME=MARKER-9-323></A>CMCloseProfile</H3>
 Decrements the reference count for the specified profile reference and, if the reference count reaches 0, frees all private memory and other resources associated with the profile.<P>
<PRE>
pascal CMError CMCloseProfile (CMProfileRef prof);
</PRE>
<DL>
<DT><CODE>prof</CODE>
<DD> A profile reference <A HREF=ACIReference-210.html#MARKER-9-299>(page 3-63)</A> to the profile that may need to be closed.
<DT><I>function result</I>
<DD> A result code of type CMError. See <A HREF=ACIReference-313.html#MARKER-9-479>"Result Codes" (page 3-174)</A> for a list of ColorSync-specific result codes.
</DL>
<A NAME=HEADING221-5></A>
<H5>DISCUSSION</H5>
 The ColorSync Manager keeps an internal reference count for each profile reference returned from a call to the <CODE>CMOpenProfile</CODE>, <CODE>CMNewProfile</CODE>, <CODE>CMCopyProfile</CODE>, or <CODE>CWNewLinkProfile</CODE> functions. Calling the CMCloneProfileRef function <A HREF=ACIReference-226.html#MARKER-9-334>(page 3-78)</A> increments the count; calling the <CODE>CMCloseProfile</CODE> function decrements it.<B> </B>The profile remains open as long as the reference count is greater than 0, indicating there is at least one remaining reference to the profile. When the count reaches 0, the ColorSync Manager releases all private memory, files, or resources allocated in association with that profile.<P>
 When the ColorSync Manager releases all private memory and resources associated with a profile, any temporary changes your application made to the profile are not saved unless you first call the <CODE>CMUpdateProfile</CODE> function to update the profile.<P>
 When your application passes a copy of a profile reference to an independent task, whether synchronous or asynchronous, it should call CMCloneProfileRef <A HREF=ACIReference-226.html#MARKER-9-334>(page 3-78)</A> to increment the reference count. Both the called task and the caller should call <CODE>CMCloseProfile</CODE> when finished with the profile reference.<P>
<DL>
<DT><B>Note</B>
<DD>You call CMCloneProfileRef after copying a <I>profile reference</I>, but not after duplicating an <I>entire profile</I> (as with the CMCopyProfile function).<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 When your application passes a copy of a profile reference internally, it may not need to call CMCloneProfileRef, as long as the application calls <CODE>CMCloseProfile</CODE> once for the profile.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>In your application, make sure that <CODE>CMCloseProfile</CODE> is called once for each time a profile reference is created or cloned. Otherwise, the private memory and resources associated with the profile reference may not be properly freed, or an application may attempt to use a profile reference that is no longer valid.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 If you create a new profile by calling the <CODE>CMNewProfile</CODE> function, the profile is saved to disk when you call the <CODE>CMCloseProfile</CODE> function unless you specified <CODE>NULL</CODE> as the profile location when you created the profile.<P>
<A NAME=HEADING221-13></A>
<H5>SEE ALSO</H5>
 To save changes to a profile before closing it, use the <CODE>CMUpdateProfile</CODE> function <A HREF=ACIReference-223.html#MARKER-9-326>(page 3-73)</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="ACIReference-220.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACIReference-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACIReference-371.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACIReference-222.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="ACIReference-3.html">&copy; Apple Computer, Inc.</A><br>11 NOV 1996<P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML> 
