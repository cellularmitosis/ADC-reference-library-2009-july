<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime 7 for Windows Update Guide: What&amp;#8217;s New in QuickTime 7 for Windows</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="What&amp;#8217;s New in QuickTime 7 for Windows"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40002476-CH313" title="What&amp;#8217;s New in QuickTime 7 for Windows"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../Chapter01/Introduction.html#//apple_ref/doc/uid/TP40002476-CH240-DontLinkElementID_139">QuickTime 7 for Windows Update Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Chapter01/Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Chapter03/03QT7_Update_Guide.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_140" title="What&amp;#8217;s New in QuickTime 7 for Windows"></a><h1><a name="//apple_ref/doc/uid/TP40002476-CH313-TPXREF101" title="What&amp;#8217;s New in QuickTime 7 for Windows "></a>What&#8217;s New in QuickTime 7 for Windows </h1><p>This chapter describes in detail the many new
and enhanced features available in QuickTime 7 for Windows. It is
intended to provide developers with a conceptual overview, in addition
code samples and illustrations of usage, so that developers can
take advantage of many of these new features in QuickTime 7 for
Windows in their applications. </p>
<p>The new functions discussed in this chapter are cross-referenced,
with links, to their complete descriptions in Chapter 3, <span class="content_text"><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH314-TPXREF101">“New Functions, Data Types, and Constants in QuickTime 7 for Windows.”</a></span> </p>
<p>If you are a QuickTime API-level developer, content author,
multimedia producer, or Webmaster who is currently working with
QuickTime, you should read this chapter in order to understand the
fundamental changes that have taken place in the QuickTime software
architecture.</p>


<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-353285">Installing QuickTime 7</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-TPXREF116">QuickTime in Perspective</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-BBCCCHCE">Changes to QuickTime Player and QuickTime Pro</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-BCICDHIC">New COM/ActiveX Control</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-BBCIAFAI">Audio Enhancements</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-BBCGDBDF">Video Enhancements</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-BBCJJGHE">Replacing NewMovieFrom... Functions</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-BBCBDDGA">QuickTime Metadata Enhancements and API</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-BBCDCDGC">QuickTime Sample Table API</a>
				
			<br/>
			
        
			
			
				<a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-BAJFHABC">Other Changes and Enhancements</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40002476-CH313-353285" title="Installing QuickTime 7"></a><h2>Installing
QuickTime 7</h2>
<p>Both QuickTime 7 Player and QuickTime 7 Pro for Windows are
available for download and purchase from Apple, in the case of the
Pro version, and will install on Windows computers that meet the
hardware and software requirements specified below.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-353321" title="Hardware and Software Requirements"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-TPXREF117" title="Hardware and Software Requirements"></a><h3>Hardware and Software
Requirements</h3>
<p>QuickTime 7 for Windows requires the following minimum configuration:</p>
<ul class="spaceabove"><li class="li"><p>Windows 2000 or Windows XP</p></li>
<li class="li"><p>Pentium processor or other processor equivalent</p></li>
<li class="li"><p>At least 128 MB of RAM</p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-374857" title="New Pro Key Required"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-TPXREF118" title="New Pro Key Required"></a><h3>New Pro Key Required</h3>
<p>QuickTime 7 for Windows replaces existing point releases of
QuickTime 6 for Windows. A new Pro key is required; QuickTime 6
Pro keys will not unlock the Pro features of QuickTime 7 for Windows.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-652196" title="QuickTime in Perspective"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-TPXREF116" title="QuickTime in Perspective"></a><h2>QuickTime in
Perspective</h2>
<p>The QuickTime API is dedicated to extending the reach of application
developers by letting them invoke the full range of multimedia&#8217;s
capabilities. It supports a wide range of standards-based formats,
in addition to proprietary formats from Apple and others. The QuickTime
API is not static, however, and has evolved over the course of the
last decade to adopt new idioms, new data structures, and new ways
of doing things. </p>
<p>The C/C++ portion of the QuickTime API comprises more than
2500 functions that provide services to applications. These services
include audio and video playback; movie editing, composition, and
streaming; still image import, export, and display; audio-visual interactivity,
and more. </p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-787360" title="New Features of QuickTime 7 for Windows"></a><h3>New
Features of QuickTime 7 for Windows</h3>
<p>This release of QuickTime includes a number of major new features
for users, developers, and content creators, including improvements
in the QuickTime architecture, file format, user interface, and
API. There are significant improvements in the audio, video, and metadata
capabilities, as well as a new APIs, and numerous other enhancements.</p>
<ul class="spaceabove"><li class="li"><p><span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-798512">“Changes to QuickTime Player and QuickTime Pro”</a></span> describes the
new user interface for QuickTime Player and QuickTime Pro and some
of the changes from previous versions of the Player.</p></li>
<li class="li"><p><span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-798875">“New COM/ActiveX Control”</a></span> describes the new COM Control
and how you can take advantage of the control using the tools available
in Visual Basic .NET, C# and Visual Basic 6.</p></li>
<li class="li"><p><span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-799346">“Audio Enhancements”</a></span> describes the many new audio features
of QuickTime 7 for Windows, including support for multichannel sound,
playback, compression, and export of high-resolution audio, a new
sound description, and new functions for movie audio control, audio
conversion configuration, audio extraction, movie export, and level
and frequency metering. </p></li>
<li class="li"><p><span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-796330">“Video Enhancements”</a></span> describes QuickTime&#8217;s new support for
frame reordering video compression and the H.264 codec. Frame reordering
support is a major advance that involves new sample tables for video,
allowing video frames to have independent decode and display times.
This allows improved display, editing, and compression of H.264
and other advanced video codecs. A new set of functions and structures
are introduced to allow developers to work with samples that have
independent decode and display times. </p></li>
<li class="li"><p><span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-556033">“Replacing NewMovieFrom... Functions”</a></span> describes the <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/NewMovieFromProperties">NewMovieFromProperties</a></code> function,
which allows you to set up properties before creating a movie. This
function also allows you to create movies that are not necessarily
associated with a graphics world, movies that can render their output
to a visual context, such as an OpenGL texture buffer, and movies
that play to a particular audio device.</p></li>
<li class="li"><p><span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-674504">“QuickTime Metadata Enhancements and API”</a></span> describes the new QuickTime extensible
metadata format, allowing developers to efficiently reference text,
audio, video, or other material that describes a movie, a track,
or a media. Support is also added for including metadata from other
file types in native format; the QuickTime 7 for Windows release
includes native support for iTunes metadata.</p></li>
<li class="li"><p><span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-678597">“QuickTime Sample Table API”</a></span> describes the new API for working
with QT Sample Tables, a logical replacement for arrays of media
sample references. The new API greatly extends the functionality
of media sample references, and the new API supports frame reordering
compressed media.</p></li>
<li class="li"> <p><span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-788325">“Other Changes and Enhancements”</a></span> discusses QuickTime 7&#8217;s
new  default install location for QuickTime, which has been moved
from the directory <code>\Windows\System32\QuickTime</code> to
 <code>\Program Files\QuickTime</code>.
A number of new APIs have been created to allow developers to locate
the various directories created by the QuickTime installer. New
updates and fixes to QuickTime for Java are also discussed in this
section.</p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-798264" title="New Directions in QuickTime 7 for Windows"></a><h3>New
Directions in QuickTime 7 for Windows</h3>
<p>The QuickTime software architecture has been revised to expose
platform-native interfaces on Windows to application developers.
On Windows, this includes exposing QuickTime framework APIs via
COM interfaces (ActiveX).</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_141" title="Important:"></a><p><strong>Important:</strong>&nbsp;

For developers to take advantage of this revised architecture,
QuickTime 7 for Windows has been rewritten from a cross-platform
API (QTML) to a Windows-native implementation. This new implementation
takes full advantage of the QuickTime COM ActiveX control. Ultimately, QuickTime
7 for Windows replaces the cross-platform application and framework
that shipped as QuickTime 6.5 and its predecessors.</p><p></p></div>
<p>Key areas of change in QuickTime 7 for Windows include:</p>
<ul class="spaceabove"><li class="li"><p>A shift of emphasis away from the Sound Manager
approach throughout QuickTime.</p></li>
<li class="li"><p>A shift of emphasis toward configuring components using component
properties and an abstraction layer, or context, and away from the
exclusive use of standard dialogs supplemented by direct access
to low-level components. </p></li>
<li class="li"><p>A shift of emphasis toward a more object-oriented organization,
with more high-level functionality in QuickTime itself supporting
lighter-weight applications.</p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-786598" title="What Developers Need To Do"></a><h4>What
Developers Need To Do</h4>
<p>If you work with audio at a relatively low level, you should
become familiar with the structures available in <code>CoreAudioTypes.h</code> and
learn how they differ from the older Sound Manager. The use of Core
Audio concepts and data structures is becoming ubiquitous in QuickTime. </p>
<p>For details, see Apple&#8217;s <span class="content_text"><a href="http://developer.apple.com/documentation/MusicAudio/Reference/CoreAudio/index.html" target="_top">Core Audio</a></span> documentation, specifically the in-line comments and
documentation in the header file <code>CoreAudioTypes.h</code>.
In particular, developers should look closely at the following structures
for audio in <code>CoreAudioTypes.h</code>: </p>
<ul class="spaceabove"><li class="li"><p><code>AudioStreamBasicDescription</code>.
This structure encapsulates all the information for describing the
basic format properties of a stream of audio data.</p></li>
<li class="li"> <p><code>AudioChannelLayout</code>.
This structure is used to specify channel layouts in files and hardware.</p></li>
<li class="li"><p><code>AudioBufferList</code>.
A variable length array of AudioBuffer structures.</p></li></ul>
<p>If you work directly with components, you should become familiar
with the API for discovering, getting, and setting component properties.
While standard dialogs for configuration are still common, there
are often times when either no dialog or an application-specific
dialog is preferable, as well as cases where low-level control or device-specific
configuration is needed that a standard dialog cannot supply. </p>
<p>For example, the component property API allows configuration
at any level of detail without requiring a user interface dialog
or direct communication with low-level components. In many cases,
an abstraction layer, or <strong>context</strong>&#8211;&#8211;either
visual or audio&#8211;&#8211;can be created, allowing transparent connection
to different kinds of low-level components, devices, or rendering
engines. </p>
<p>The new extensible QuickTime metadata format, discussed in
the section <span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-674504">“QuickTime Metadata Enhancements and API,”</a></span> uses a similar method of configuration
through an abstract set of properties, as a means of &#8220;future-proofing&#8221;
the architecture. The same is true of the new API for working with
QuickTime sample tables, described in the section <span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-678597">“QuickTime Sample Table API.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-752312" title="Object Model Evolution"></a><h4>Object
Model Evolution</h4>
<p>A substantial reorganization of the QuickTime engine has been
taking place &#8220;under the hood&#8221; in this software release. This
reorganization is intended to allow increased access to QuickTime
functionality from QuickTime framework APIs via COM interfaces (ActiveX). </p>
<p>As the QuickTime document object model continues to evolve,
the goal is to provide developers with easier access to the more
powerful parts of the QuickTime engine using relatively lightweight
object-oriented applications or even scripts&#8211;&#8211;without having
to delve into the large and sometimes complex procedural C/C++ QuickTime
API. </p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-652402" title="In Summary QuickTime 6 through QuickTime 7"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-TPXREF120" title="In Summary QuickTime 6 through QuickTime 7"></a><h3>In Summary QuickTime
6 through QuickTime 7</h3>
<p>The following table summarizes the point releases of QuickTime
6 and the features of QuickTime 7.</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>QuickTime version </p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Mac OS X</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Windows</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Mac OS 9</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Features</p></th>
</tr>


<tr>
<td  scope="row"><p>6</p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p>MPEG-4 and lots more. </p></td>
</tr>
<tr>
<td  scope="row"><p>6.01</p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p>Bug fix for QuickTime 6. Last version for all three platforms. </p></td>
</tr>
<tr>
<td  scope="row"><p>6.03</p></td>
<td ><p></p></td>
<td ><p></p></td>
<td ><p>     x</p></td>
<td ><p>Bug fixes to address security issues. Mac OS 9 only.</p></td>
</tr>
<tr>
<td  scope="row"><p>6.1</p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p></p></td>
<td ><p>Improved MPEG-4 video, full-screen modes, wired actions. </p></td>
</tr>
<tr>
<td  scope="row"><p>6.2</p></td>
<td ><p>     x</p></td>
<td ><p></p></td>
<td ><p></p></td>
<td ><p>Support for iTunes 4, enhanced AAC codec, limited DRM.</p></td>
</tr>
<tr>
<td  scope="row"><p>6.3</p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p></p></td>
<td ><p>Improved AAC codec, 3GPP support, which includes AMR codec. </p></td>
</tr>
<tr>
<td  scope="row"><p>6.4 for
Mac OS X</p></td>
<td ><p>     x</p></td>
<td ><p></p></td>
<td ><p></p></td>
<td ><p>New data reference functions, multithreading, new graphics functions,
component and movie property access, other API additions.</p></td>
</tr>
<tr>
<td  scope="row"><p>6.5</p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p></p></td>
<td ><p>3GPP, 3GPP2, and AMC support for mobile multimedia, Unicode
text support.</p></td>
</tr>
<tr>
<td  scope="row"><p>6.5.1</p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p></p></td>
<td ><p>Apple Lossless codec for audio.</p></td>
</tr>
<tr>
<td  scope="row"><p>7 </p></td>
<td ><p>     x</p></td>
<td ><p>     x</p></td>
<td ><p></p></td>
<td ><p>High-resolution, multichannel audio support, frame reordering
video and H.264 support, new metadata format, QuickTime sample table
API, changes to QuickTime Player and Pro UI.</p></td>
</tr>

</table></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-798512" title="Changes to QuickTime Player and QuickTime Pro"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BBCCCHCE" title="Changes to QuickTime Player and QuickTime Pro"></a><h2>Changes to QuickTime
Player and QuickTime Pro</h2>
<p>QuickTime 7 for Windows introduces a number of new features
and changes to the user interface of QuickTime Player and QuickTime
Pro. These are briefly described in this section. New versions of
both Player and Pro are available for download from Apple.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-828493" title="New in QuickTime Player"></a><h3>New
in QuickTime Player</h3>
<p>The new QuickTime Player is a native Windows application.
The intent of this new design is to better integrate QuickTime Player
in general with the Windows user experience. </p>
<p>The following are some of the new user-level features available
in QuickTime Player:</p>
<ul class="spaceabove"><li class="li"><p><strong>H.264 video support</strong>. This
state-of-the-art, standards-based codec delivers exceptional-quality
video at the lowest data rate possible, across the entire bandwidth spectrum.</p></li>
<li class="li"><p><strong>New audio and playback controls</strong>. Users
can use the new A/V Controls window to adjust settings for the best
audio and playback experience. Users can now easily change settings,
including playback speed, volume, bass, treble, and balance. You
can also use the jog shuttle control to easily navigate to a particular
movie frame.</p></li>
<li class="li"><p><strong>Zero-configuration streaming</strong>. You no longer
need to set your Internet connection speed in QuickTime Preferences.
QuickTime automatically determines the best connection speed for
your computer. If a connection is lost during streaming, QuickTime
automatically reconnects to the server. Users can also select a
preset connection speed.</p></li>
<li class="li"><p><strong>Live resize</strong>. Playback continues smoothly
as you change the size of the QuickTime Player window.</p></li>
<li class="li"><p><strong>Multichannel audio</strong>. QuickTime Player can
now play 24 audio channels&#8211;&#8211;and beyond. With external speakers,
you can enjoy the full sound effects of movies and games. </p><p>By
accessing the Window &gt; Show Movie Properties window, selecting
an audio track, and then selecting Audio Settings, you can set the
volume, balance, bass, and treble for a QuickTime movie. In addition,
if you select the sound track property in the window, you can set
the speaker for each audio channel in that track, specifying the
speaker through which the audio can be heard.</p></li>
<li class="li"><p><strong>All-new content guide</strong>. The completely redesigned
QuickTime Content Guide provides the latest in news, education,
and entertainment on the Internet.</p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-828670" title="New in QuickTime Pro"></a><h3>New
in QuickTime Pro</h3>
<p>The following are some of the new user-level features available
in the Pro version of QuickTime Player:</p>
<ul class="spaceabove"><li class="li"><p><strong>Creating H.264 video.</strong> Users
can take advantage of this codec for a variety of video needs, ranging
from HD (high definition) to 3G (for mobile devices). This new codec provides
better quality at lower bandwidth, enabling users to deliver high-quality video
over the Internet. </p></li>
<li class="li"><p><strong>Creating multichannel audio</strong>. Users can
create a rich multimedia experience by labeling each audio channel
(for example, Left, Right, Left Surround, LFE, and so on). QuickTime
automatically mixes the audio to work with the speaker setup of
each user.</p></li>
<li class="li"><p><strong>Recording audio</strong>. With a digital audio device
that supports USB and line-in microphones connected to your computer,
you can capture and record audio. This new feature enables users
to create, with a minimum of effort, podcasts for posting and publication
on the Internet.</p></li>
<li class="li"><p><strong>Full screen playback enhancements</strong>. Full
screen mode now provides floating controls. These include pause,
play, stop, fast forward, and rewind, as well as volume for audio
control. Users move the pointer to display the controller; after
a few seconds, the controller fades away. Note that the controller
does not appear with interactive movies when the mouse is moved,
so that it does not interfere with movie content. Users can press
the keyboard control-C to make it appear or disappear immediately.</p><p>Users
can access full screen mode by choosing the View &gt; Full Screen
or using its keyboard equivalent, Control-F. To display the DVD-style
full screen controls, users choose QuickTime Player &gt; Preferences
&gt; Player Preferences &gt; Full Screen.</p></li>
<li class="li"><p><strong>Enhanced and redesigned interface for movie settings</strong>.
The Movie Properties window has been redesigned to facilitate movie
authoring.</p></li>
<li class="li"><p><strong>New options for image manipulation</strong> in the
Visual Settings pane of the Movie Properties dialog of a video track. </p><p>In
addition, users are provided with other options to manipulate and
control image transparency in QuickTime movies and image files.</p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-830105" title="Other Changes and Enhancements"></a><h3>Other
Changes and Enhancements</h3>
<p>The following are some additional changes and enhancements
in QuickTime 7 for Windows:</p>
<ul class="spaceabove"><li class="li"><p>QuickTime Preferences now has the option &#8220;Use
high quality video setting when available.&#8221; Users can set this
as the default for displaying high-quality video tracks, such as
DV. </p></li>
<li class="li"><p>The Open File command enables users to open any of a number
of digital media types that QuickTime supports, including movies,
still images, VR panoramas, Flash, and so on. </p></li>
<li class="li"><p>Choosing the File &gt; New Audio Recording menu item enables
you to record audio from an external or internal audio device. Once
recording begins, a new QuickTime Player window specifically for
recording appears.</p></li>
<li class="li"><p>To change the audio source for your recording, or to specify
the quality of recording you want, you choose QuickTime Player &gt;
Preferences &gt; Recording.</p></li>
<li class="li"><p>The Save dialog that the Save As command opens now has &#8220;Make
movie as a self-contained&#8221; selected by default, which is a change
from previous versions of QuickTime Player.</p></li>
<li class="li"><p>Choosing the Help &gt; Update Existing Software menu item
lets you update the version to the latest version of QuickTime.</p></li>
<li class="li"><p>The menu items in previous versions&#8211;&#8211;Enable, Extract,
and Delete&#8211;&#8211;are now available in the Movie Properties window. </p></li>
<li class="li"><p>There is a new command&#8211;&#8211;Trim to Selection&#8211;&#8211;which replaces
the previous command Trim. The Replace command has been removed,
which means that users can no longer perform a delete-and-paste
operation as a single operation.</p></li>
<li class="li"><p>The Movie menu has been renamed and is now the View menu.
The Show Movie Properties command has been moved to the Windows
menu. </p></li>
<li class="li"><p>Choosing the Window &gt; Show Movie Properties menu item and
selecting a track enables you to specify certain properties of that
track. For example, if you select Annotations and want to add a
field, you have multiple choices, including Album, Artist, Author,
and so on. </p></li>
<li class="li"><p>Choosing the Window &gt; Show Movie Properties menu item and
selecting a track with Other Settings selected enables you to specify
certain properties of that track, including language, preloading
of the track, caching, and so on. </p></li>
<li class="li"><p>When the user moves the mouse over a selection of the movie,
ticks appear that indicate you can make a selection over that area.
When you move the mouse over the playbar, the movie will appear
or disappear. Users can also set in and out points now by placing
the current time marker and typing I or O. </p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-798875" title="New COM/ActiveX Control"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCICDHIC" title="New COM/ActiveX Control"></a><h2>New COM/ActiveX
Control</h2>
<p>QuickTime 7 for Windows includes a new QuickTime COM/ActiveX
control. This new control is fully scriptable from Visual Basic,
C#, JavaScript, C++, and other applications that can host COM objects. </p>
<p>This allows you to build stand-alone Windows applications
that use QuickTime without needing to master QuickTime&#8217;s C/C++
API.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_142" title="Important:"></a><p><strong>Important:</strong>&nbsp;
This new COM control is included in addition to the
QuickTime ActiveX browser plug-in. They are not the same thing.</p><p></p></div>
<p>The new QuickTime COM control has an API that will be familiar
to Visual Basic programmers and others used to working with COM
objects. It is intended to make it easy to create stand-alone Windows
applications that use QuickTime. The new COM control is not a browser
plug-in, and will not run in a browser or other Web-based application.</p>
<p>For Web-based applications, use the QuickTime ActiveX browser
plug-in; it is scriptable using JavaScript from most browsers using
the same platform-independent API as the QuickTime browser plug-ins
for Netscape and Safari. The QuickTime browser plug-in is the cross-platform
solution for writing Web pages that interact with QuickTime.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_143" title="Note"></a><p><strong>Note:</strong>&nbsp;The API for controlling
the QuickTime ActiveX browser plug-in using JavaScript can be found
at: <span class="content_text"><a href="http://developer.apple.com/documentation/quicktime/Conceptual/QTScripting_JavaScript/index.html" target="_top">http://developer.apple.com/documentation/quicktime/Conceptual/QTScripting_JavaScript/index.html</a></span>.</p></div>
<p>The remainder of this section is intended for programmers
who want to provide high-level QuickTime movie playback and control,
including some import, export, and editing capabilities, to Windows
applications written in Visual Basic and other languages.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-820669" title="Advantages For Developers"></a><h3>Advantages
For Developers</h3>
<p>If you are a Visual Basic programmer or enterprise software
developer doing in-house development, the COM control implementation
offers a number of important advantages:</p>
<ul class="spaceabove"><li class="li"><p>You can build Windows desktop applications more
easily with Visual Basic or C#, combining QuickTime with the rich
and powerful .NET Framework.</p></li>
<li class="li"><p> You can write useful utility scripts for working with QuickTime
in either JavaScript or VBScript. These scripts can be run within
the Windows Scripting Host environment by simply double-clicking
the .js or .vbs script files, or from the command line using <code>cscript</code>.</p></li>
<li class="li"><p>You don&#8217;t have to access the low-level functionality provided
by the full QuickTime API in order to use QuickTime in your application
development.</p></li></ul>
<p>For example, if your Windows server can run a Visual Basic,
C#, or .js application that uses QuickTime, you have the possibility
to create custom QuickTime content interactively, delivering that
content over the Web. As long as your clients have QuickTime installed,
your content will work with Windows and non-Windows clients, Internet
Explorer and non-Internet Explorer browsers.</p>
<p>QuickTime Player itself uses the new QuickTime COM control
for virtually all of its access to QuickTime. </p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_144" title="Important:"></a><p><strong>Important:</strong>&nbsp;
The QuickTime 7 ActiveX browser plug-in is <em>not</em> scriptable
via Visual Basic. It <em>is</em> scriptable, however,
in JavaScript using the same syntax as the Netscape-style plug-in,
and works the same on all browsers for Windows or Macintosh.</p><p></p></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-803122" title="How It Works"></a><h3>How
It Works</h3>
<p>The new COM control is comprised of two separate DLLs: </p>
<ul class="spaceabove"><li class="li"><p>An COM/ActiveX control (<code>QTOControl.dll</code>)
that &#8220;knows&#8221; how to open a movie and manage the interaction
with the operating system and the host application.</p></li>
<li class="li"><p>A COM library (<code>QTOLibrary.dll</code>)
which provides a COM interface to a movie and to QuickTime itself. </p></li></ul>
<p>The COM library is a very thin layer that sits on top of the
low level QuickTime APIs and provides a COM wrapper object for each
logical QuickTime object. Each COM object exposes the properties,
methods, and notifications of the QuickTime object it wraps.</p>
<p>The object hierarchy is illustrated in <span class="content_text">Figure 2-1</span>.
 </p>
<br/><div><a name="//apple_ref/doc/uid/TP40002476-CH313-804442" title="Figure 2-1The COM/ActiveX control object hierarchy"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIDJGDC" title="Figure 2-1The COM/ActiveX control object hierarchy"></a><p><strong>Figure 2-1&nbsp;&nbsp;</strong>The COM/ActiveX control object hierarchy</p>
<img src = "../art/qt7_win_obj_diag.jpg" alt = "" ></div><br/>
<p>Note that the <code>QTMovieEqualizer</code> object
illustrated in <span class="content_text">Figure 2-1</span> should be <code>QTFrequencyMeter</code>.</p>
<p>If you are a Windows developer, you know that the Component
Object Model (COM) specification defines how a host application
accesses the component, how the component notifies the host application
of events, standard data types for data exchange with the OS or
other components. A COM control is a type of COM component that
has a visual display of some kind, restricting its placement to
visual containers such as a form or dialog box. COM controls typically
manage their own window.</p>
<p>In the .NET environment, the new QuickTime COM control is
accessed via the .NET Framework&#8217;s COM Interop layer. Primary Interop
Assemblies (.NET wrappers for COM objects) will be provided with
the QuickTime 7 SDK.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_145" title="Note"></a><p><strong>Note:</strong>&nbsp;The COM control
does not provide a native managed code interface to QuickTime.</p></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-828157" title="Visual Basic .NET and C#"></a><h4>Visual
Basic .NET and C#</h4>
<p>The QuickTime COM control has a property page&#8211;&#8211;that is,
a dialog box that allows you to set some QuickTime control properties.
You access the property page by clicking the Property Pages button
in the toolbar on the Properties window.</p>
<p>To use the constants and enumerations associated with the
QuickTime COM control, you must either explicitly precede them with
the <code>QTOControlLib</code> namespace
identifier, or else include an import for the <code>QTOControlLib</code>.</p>
<p>In Visual Basic, you do this with an Imports directive at
the beginning of your module.</p>
<p>An example of using an explicit namespace identifier is, as
follows:</p>
<div class="codesample"><table><tr><td scope="row"><pre>AxQTControl1.Sizing = QTOControlLib.QTSizingModeEnum.qtControlFitsMovie<span></span></pre></td></tr></table></div>
<div class="codesample"><table><tr><td scope="row"><pre>AxQTControl1.SetScale(2)<span></span></pre></td></tr></table></div>
<div class="codesample"><table><tr><td scope="row"><pre>AxQTControl1.Sizing = QTOControlLib.QTSizingModeEnum.qtMovieFitsControl<span></span></pre></td></tr></table></div>
<p>The same example with imported namespace:</p>
<div class="codesample"><table><tr><td scope="row"><pre>Imports QTOControlLib<span></span></pre></td></tr><tr><td scope="row"><pre>AxQTControl1.Sizing = QTSizingModeEnum.qtControlFitsMovie<span></span></pre></td></tr></table></div>
<div class="codesample"><table><tr><td scope="row"><pre>AxQTControl1.SetScale(2)<span></span></pre></td></tr></table></div>
<div class="codesample"><table><tr><td scope="row"><pre>AxQTControl1.Sizing = QTSizingModeEnum.qtMovieFitsControl<span></span></pre></td></tr></table></div>
<p>In C#, the namespace can be imported with the <code>using</code> directive:</p>
<div class="codesample"><table><tr><td scope="row"><pre>using QTOControlLib;<span></span></pre></td></tr></table></div>
<p>To use the constants and enumerations associated with the
QT COM library, you must either explicitly precede them with the <code>QTOLibrary</code> namespace
identifier, or else include an import (C#: <code>using</code> directive)
for the <code>QTOLibrary</code>.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_146" title="Important:"></a><p><strong>Important:</strong>&nbsp;
If you are working with QuickTime audio, when you open
a movie using the COM/ActiveX control, you will get the pitch-preserving varispeed
by default. This is not the case when you open a movie using legacy
interfaces, nor when using <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/NewMovieFromProperties">NewMovieFromProperties</a></code> without having
set the <code><a href="../../../Reference/QT7-1_Update_Reference/Constants/Constants.html#//apple_ref/doc/c_ref/kQTAudioPropertyID_RateChangesPreservePitch" target="_top">kQTAudioPropertyID_RateChangesPreservePitch</a></code> property
to <code>TRUE</code>.</p><p></p></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-801116" title="Getting Started With QuickTime COM Control"></a><h3>Getting
Started With QuickTime COM Control</h3>
<p>Once you instantiate the QuickTime COM control and load a
movie into it, you can then get at the <code>QTOLibrary</code> object
model via the control&#8217;s Movie property, which returns a QTMovie
COM object.</p>
<p>To get started with the new COM control, in VB.NET or C#:</p>
<ol class="ol"><li class="li"><p>Create a new Windows Application project.</p></li>
<li class="li"><p>Right-click on the Windows Forms toolbox, choose Add/Remove
Items... and select the COM Components tab.</p></li>
<li class="li"><p>Scroll down until you find Apple QuickTime Control 2.0. </p></li>
<li class="li"><p>Click this control and click OK to add the QuickTime control
to your toolbox. You should now see a QuickTime icon.</p></li>
<li class="li"><p>Place the control on Form1.</p></li>
<li class="li"><p>Place two buttons on the form and code as follows:</p></li></ol>
<div class="codesample"><table><tr><td scope="row"><pre> Private Sub Button1_Click(...) Handles Button1.Click<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>     AxQTControl1.URL = &quot;d:\movies\sample.mov&quot;  'Change to your own movie!<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>     End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>     Private Sub Button2_Click(...) Handles Button2.Click<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>         AxQTControl1.Movie.Play()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>     End Sub<span></span></pre></td></tr></table></div>
<p>After you have completed these steps, you can:</p>
<ol class="ol"><li class="li"><p>Build and run the application.</p></li>
<li class="li"><p>Click Button1 to load a movie; then click Button2 to play
the movie.</p></li></ol>
<p>In Visual Basic 6, you need to follow these steps:</p>
<ol class="ol"><li class="li"><p>Create a new Standard EXE project.</p></li>
<li class="li"><p>Choose Project | Components and scroll down to the Apple QuickTime
Control 2.0. Click this component and click OK to add to the Visual
Basic 6 toolbox.</p></li>
<li class="li"><p>Add the QuickTime control to Form1.</p></li>
<li class="li"><p>Create two buttons and code as follows:</p></li></ol>
<div class="codesample"><table><tr><td scope="row"><pre>Private Sub Command1_Click()<span></span></pre></td></tr><tr><td scope="row"><pre>          QTControl1.URL = &quot;d:\movies\sample.mov&quot; 'Change to your own movie!<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>      End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>      Private Sub Command2_Click()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>          QTControl1.Movie.Play<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>      End Sub<span></span></pre></td></tr></table></div>
<p>Now you can run the application. Click Command1 to load the
movie and Command2 to play the movie.</p>
<p>Once you have loaded a movie and have the QTMovie object from
the control&#8217;s Movie property, you can proceed to delve down into
the object model. For example:</p>
<div class="codesample"><table><tr><td scope="row"><pre> 'Iterate movie tracks (VB6)<span></span></pre></td></tr><tr><td scope="row"><pre>     Dim myMovie As QTMovie<span></span></pre></td></tr><tr><td scope="row"><pre>     Dim t As String<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>     Set myMovie = QTControl1.Movie<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>     Dim trk As QTTrack<span></span></pre></td></tr><tr><td scope="row"><pre>     Dim qtu As New QTUtils<span></span></pre></td></tr><tr><td scope="row"><pre>     For Each trk In myMovie.Tracks<span></span></pre></td></tr><tr><td scope="row"><pre>         t = t + &quot;Track : &quot; + CStr(i) + vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>         t = t + vbTab + &quot;Type : &quot; + qtu.FourCharCodeToString(trk.Type)<span></span></pre></td></tr><tr><td scope="row"><pre>                                   + vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>         t = t + vbTab + &quot;Format : &quot; + trk.Format + vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>         t = t + vbTab + &quot;Duration : &quot; + CStr(trk.Duration) + vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>     Next trk<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>     txtResults = t$<span></span></pre></td></tr></table></div>
<p>In order to use the QuickTime COM object types in your Visual
Basic 6 application you will need to add the QuickTime COM library
to your project. Choose Project | References and add the Apple QuickTime
Library 2.0.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-805462" title="Example Code To Create a Simple COM/ActiveX Control Application in Visual Basic 6"></a><h3>Example
Code To Create a Simple COM/ActiveX Control Application in Visual
Basic 6</h3>
<p>This section includes two code samples, one bare bones, letting
you simply open and edit a QuickTime movie, and the other more fully
featured. Using this example code you can create a simple COM/ActiveX
control application in Visual Basic 6. The code is provided here
with some comments and discussion.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_147" title="Important:"></a><p><strong>Important:</strong>&nbsp;
A good learning tutorial on how to script the COM/ActiveX
control is available at <span class="content_text"><a href="http://developer.apple.com/quicktime/activexcontrol.html" target="_top">http://developer.apple.com/quicktime/activexcontrol.html</a></span> and
the sample code that lets you build a simple movie player application in
Visual Basic 6 is available at <span class="content_text"><a href="http://developer.apple.com/samplecode/MoviePlayer/MoviePlayer.html" target="_top">http://developer.apple.com/samplecode/MoviePlayer/MoviePlayer.html</a></span>.
The sample demonstrates the following capabilities: movie playback
with a movie controller, opening and closing movies, opening and
closing movies from URLs, simple editing with cut, copy, and paste commands
implemented; undo, export, export with a dialog, QuickTime event
handling, Form resizing, error handling, fullscreen playback, as well
as movie information display, such as duration, track types, track
formats, and so on. If you are a Windows developer working with
the new COM/ActiveX control, you are encouraged to explore both
the tutorial and the sample code available, which extends the code
examples #1 and #2 described in the next section, adding, in particular,
export and QuickTime event notification functionality.</p><p></p></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-839998" title="Code Example #1"></a><h4>Code
Example #1</h4>
<p>The sample COM/ActiveX control application has a Form, with
File and Edit menus. The File menu includes the following menu items:</p>
<ul class="spaceabove"><li class="li"><p>Open</p></li>
<li class="li"><p>Close</p></li>
<li class="li"><p>Full Screen</p></li>
<li class="li"><p>Exit</p></li></ul>
<p>The Edit menu includes these menu items:</p>
<ul class="spaceabove"><li class="li"><p>Undo</p></li>
<li class="li"><p>Cut</p></li>
<li class="li"><p>Copy</p></li>
<li class="li"><p>Paste</p></li></ul>
<p>If you want to edit any of these menus, you bring up the Form,
go to Tools, then open the Menu Editor. The name of the menu determines
the name of the handler that gets called.</p>
<p>In Example #1, Menu File_click is the handler that is called
and passed the index. None of the menu items, as shown in <span class="content_text">Listing 2-1</span>,
are hooked up yet; when you click an item, it will exit the application. </p>
<p>If you look at the Form, you see there is an instance of the
QuickTime Control. When you click an object in Visual Basic, it
brings up the Property Inspector.</p>
<p>By default, when you create a new object, it takes the name
of the class and appends a number to it. Unless you change it, it
is called <code>QTControl1</code>.
When it launches, there is an instance of this <code>QTControl1</code> created.</p>
<p><span class="content_text">Listing 2-1</span> shows you how to show an open a file and
display a common dialog for the QuickTime control. The code in <span class="content_text">Listing 2-2</span> adds
menu items to the File and Edit menu. The remaining code listings
in Example #2 deal with sizing the movie, when you want to change
the size of the movie to fit the size of the control, or display
the movie at full screen. Example #2 also shows how to add an information
window to the control, in addition to minimal error checking, and
demonstrates how to respond to events.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_148" title="Important:"></a><p><strong>Important:</strong>&nbsp;
Using Visual Basic, if you run a project, it may keep
the control open, even when you quit the project. For any dll that
QuickTime loads, Visual Basic keeps everything in your project loaded,
so you can get into a state where you have to quit QuickTime and
relaunch. After doing this, everything will work as expected.</p><p></p></div>
<p>Remember, you need to add the Apple QuickTime Control 2.0
 and Microsoft Common Dialog Control 6.0 components to the project.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-827303" title="Listing 2-1The GetFileName function to display a dialog for the QuickTime control"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIDHGEI" title="Listing 2-1The GetFileName function to display a dialog for the QuickTime control"></a><p class="codesample"><strong>Listing 2-1&nbsp;&nbsp;</strong>The <code><!--a-->GetFileName<!--/a--></code> function
to display a dialog for the QuickTime control</p>
<div class="codesample"><table><tr><td scope="row"><pre>Function GetFileName()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Form1.CommonDialog1.ShowOpen<span></span></pre></td></tr><tr><td scope="row"><pre>    GetFileName = Form1.CommonDialog1.FileName<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>End Function<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-827355" title="Listing 2-2Adding menu items"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIGCABF" title="Listing 2-2Adding menu items"></a><p class="codesample"><strong>Listing 2-2&nbsp;&nbsp;</strong>Adding
menu items</p>
<div class="codesample"><table><tr><td scope="row"><pre>Private Sub mnuEdit_Click(Index As Integer)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Select Case Index<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 0  'Undo<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 2  'Cut<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 3  'Copy<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 4  'Paste<span></span></pre></td></tr><tr><td scope="row"><pre>    End Select<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub mnuFile_Click(Index As Integer)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Select Case Index<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 0  'Open<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.URL = GetFileName()<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 1  'Close<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 3  'Full Screen<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 5  'Exit<span></span></pre></td></tr><tr><td scope="row"><pre>            Unload Me<span></span></pre></td></tr><tr><td scope="row"><pre>            End<span></span></pre></td></tr><tr><td scope="row"><pre>    End Select<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-825338" title="Code Example #2"></a><h4>Code
Example #2</h4>
<p>The following code (Example #2) provides a more fully featured
QuickTime control. In this example, you add an information window,
minimal error checking, and the capability of responding to events.</p>
<p>Follow these steps:</p>
<ol class="ol"><li class="li"><p>Create a new VB6 Standard EXE project.</p></li>
<li class="li"><p>Add the Apple QuickTime Control 2.0 and Microsoft Common Dialog
Control 6.0 components to the project.</p></li>
<li class="li"><p>Add the Apple QuickTime Library 2.0 reference to the project.</p></li>
<li class="li"><p>Add two forms: <code>Form1</code> and <code>frmInfo</code>. </p></li>
<li class="li"><p>To <code>Form1</code> add:</p><ol class="ol">
<li class="ol ol"><p>File menu (<code>mnuFile</code>)
with Open&#8230;, Open URL&#8230;, Close, Get Info, Full Screen and Exit
menu items.</p></li>
<li class="ol ol"><p>Edit menu (<code>mnuEdit</code>)
with Undo, Cut, Copy, Paste. </p></li>
<li class="ol ol"><p>A Common Dialog control (<code>CommonDialog1</code>). </p></li>
<li class="ol ol"><p>A QuickTime control (<code>QTControl1</code>). </p></li></ol></li>
<li class="li"><p>Set the menu items index values to match the corresponding
index values in <code>mnuFile_Click</code> and <code>mnuEdit_Click</code>.</p></li>
<li class="li"><p>To <code>frmInfo</code> add:</p><ol class="ol">
<li class="ol ol"><p>4 Label controls: <code>lblName</code>, <code>lblInfo</code>, <code>lblCaptions</code> and <code>lblData</code> with <code>AutoSize</code> = <code>True</code></p></li></ol></li>
<li class="li"><p>Paste <span class="content_text">Listing 2-3</span> and <span class="content_text">Listing 2-4</span> into the code
window of <code>Form1</code> and <span class="content_text">Listing 2-5</span> into
the code window of <code>frmInfo</code>.</p></li></ol>
<a name="//apple_ref/doc/uid/TP40002476-CH313-825806" title="Listing 2-3The VB 6 code for the QuickTime control sample movie form"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIGJADG" title="Listing 2-3The VB 6 code for the QuickTime control sample movie form"></a><p class="codesample"><strong>Listing 2-3&nbsp;&nbsp;</strong>The
VB 6 code for the QuickTime control sample movie form</p>
<div class="codesample"><table><tr><td scope="row"><pre>Object = &quot;{7B92F833-027D-402B-BFF9-A67697366F4E}#1.0#0&quot;; &quot;QTOControl.dll&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>Object = &quot;{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0&quot;; &quot;comdlg32.ocx&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>Begin VB.Form MovieForm<span></span></pre></td></tr><tr><td scope="row"><pre>   Caption         =   &quot;Movie&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>   ClientHeight    =   4260<span></span></pre></td></tr><tr><td scope="row"><pre>   ClientLeft      =   132<span></span></pre></td></tr><tr><td scope="row"><pre>   ClientTop       =   816<span></span></pre></td></tr><tr><td scope="row"><pre>   ClientWidth     =   4080<span></span></pre></td></tr><tr><td scope="row"><pre>   LinkTopic       =   &quot;MovieForm&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>   ScaleHeight     =   4260<span></span></pre></td></tr><tr><td scope="row"><pre>   ScaleWidth      =   4080<span></span></pre></td></tr><tr><td scope="row"><pre>   StartUpPosition =   3  'Windows Default<span></span></pre></td></tr><tr><td scope="row"><pre>   Begin MSComDlg.CommonDialog CommonDialog1<span></span></pre></td></tr><tr><td scope="row"><pre>      Left            =   3240<span></span></pre></td></tr><tr><td scope="row"><pre>      Top             =   600<span></span></pre></td></tr><tr><td scope="row"><pre>      _ExtentX        =   847<span></span></pre></td></tr><tr><td scope="row"><pre>      _ExtentY        =   847<span></span></pre></td></tr><tr><td scope="row"><pre>      _Version        =   393216<span></span></pre></td></tr><tr><td scope="row"><pre>   End<span></span></pre></td></tr><tr><td scope="row"><pre>   Begin QTOControlLibCtl.QTControl QTControl1<span></span></pre></td></tr><tr><td scope="row"><pre>      Height          =   4332<span></span></pre></td></tr><tr><td scope="row"><pre>      Left            =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      TabIndex        =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      Top             =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      Width           =   4056<span></span></pre></td></tr><tr><td scope="row"><pre>      _cx             =   7154<span></span></pre></td></tr><tr><td scope="row"><pre>      _cy             =   7641<span></span></pre></td></tr><tr><td scope="row"><pre>      BackColor       =   -2147483644<span></span></pre></td></tr><tr><td scope="row"><pre>      BorderColor     =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      BorderStyle     =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      MovieControllerVisible=   -1  'True<span></span></pre></td></tr><tr><td scope="row"><pre>      Sizing          =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      URL             =   &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>      BaseURL         =   &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>      AutoPlay        =   &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>   End<span></span></pre></td></tr><tr><td scope="row"><pre>   Begin VB.Menu mnuBar<span></span></pre></td></tr><tr><td scope="row"><pre>      Caption         =   &quot;&amp;File&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>      Index           =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuFile<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;&amp;Open...&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   0<span></span></pre></td></tr><tr><td scope="row"><pre>         Shortcut        =   ^O<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuFile<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;Open &amp;URL...&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   1<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuFile<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;&amp;Close&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   2<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuFile<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;-&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   3<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuFile<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;&amp;Full Screen&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   4<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuFile<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;Get Info&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   5<span></span></pre></td></tr><tr><td scope="row"><pre>         Shortcut        =   ^I<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuFile<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;-&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   6<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuFile<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;Exit&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   7<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>   End<span></span></pre></td></tr><tr><td scope="row"><pre>   Begin VB.Menu mnuBar<span></span></pre></td></tr><tr><td scope="row"><pre>      Caption         =   &quot;Edit&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>      Index           =   1<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuEdit<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;Undo&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuEdit<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;Cut&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   2<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuEdit<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;Copy&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   3<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Menu mnuEdit<span></span></pre></td></tr><tr><td scope="row"><pre>         Caption         =   &quot;Paste&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Index           =   4<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>   End<span></span></pre></td></tr><tr><td scope="row"><pre>End<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_Name = &quot;MovieForm&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_GlobalNameSpace = False<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_Creatable = False<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_PredeclaredId = True<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_Exposed = False<span></span></pre></td></tr><tr><td scope="row"><pre>Option Explicit<span></span></pre></td></tr><tr><td scope="row"><pre>Dim gManualFormResize As Boolean<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Declare Function GetSystemMetrics Lib &quot;user32&quot; (ByVal nIndex As Long) As  Long<span></span></pre></td></tr><tr><td scope="row"><pre>Private Const SM_CYCAPTION = 4<span></span></pre></td></tr><tr><td scope="row"><pre>Private Const SM_CYFRAME = 33<span></span></pre></td></tr><tr><td scope="row"><pre>Private Const SM_CYMENU = 15<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Function GetFileName()<span></span></pre></td></tr><tr><td scope="row"><pre>    MovieForm.CommonDialog1.InitDir = &quot;d:\QuickTime\Movies&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>    MovieForm.CommonDialog1.ShowOpen<span></span></pre></td></tr><tr><td scope="row"><pre>    GetFileName = MovieForm.CommonDialog1.FileName<span></span></pre></td></tr><tr><td scope="row"><pre>End Function<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Function GetFormBorderWidth()<span></span></pre></td></tr><tr><td scope="row"><pre>    GetFormBorderWidth = GetSystemMetrics(SM_CYFRAME) * 2<span></span></pre></td></tr><tr><td scope="row"><pre>End Function<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Function GetFormBorderHeight()<span></span></pre></td></tr><tr><td scope="row"><pre>    GetFormBorderHeight = GetSystemMetrics(SM_CYCAPTION) +  GetSystemMetrics(SM_CYMENU) + (GetSystemMetrics(SM_CYFRAME) * 2)<span></span></pre></td></tr><tr><td scope="row"><pre>End Function<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub Form_Load()<span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.ErrorHandling = qtErrorHandlingRaiseException<span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.Sizing = qtControlFitsMovie<span></span></pre></td></tr><tr><td scope="row"><pre>    Load MovieInfo<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub Form_Resize()<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim oldSizingMode As QTSizingModeEnum<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    gManualFormResize = True  ' global flag so _SizeChanged won't respond<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    ' change sizing mode so the movie tracks the control's size<span></span></pre></td></tr><tr><td scope="row"><pre>    oldSizingMode = QTControl1.Sizing<span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.Sizing = qtMovieFitsControl<span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.Move 0, 0, Me.Width - (GetFormBorderWidth() *  Screen.TwipsPerPixelX), Me.Height - (GetFormBorderHeight() *  Screen.TwipsPerPixelY)<span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.Sizing = oldSizingMode<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    gManualFormResize = False<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub Form_Unload(Cancel As Integer)<span></span></pre></td></tr><tr><td scope="row"><pre>    MovieInfo.SetInfoMovie Nothing<span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.URL = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>    DoEvents<span></span></pre></td></tr><tr><td scope="row"><pre>    End<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub mnuEdit_Click(Index As Integer)<span></span></pre></td></tr><tr><td scope="row"><pre>    If QTControl1.Movie Is Nothing Then Exit Sub<span></span></pre></td></tr><tr><td scope="row"><pre>    Select Case Index<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 0 ' Undo<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.Movie.Undo<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 2 ' Cut<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.Movie.Cut<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 3 ' Copy<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.Movie.Copy<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 4 ' Paste<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.Movie.Paste<span></span></pre></td></tr><tr><td scope="row"><pre>    End Select<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub mnuFile_Click(Index As Integer)<span></span></pre></td></tr><tr><td scope="row"><pre>    On Error GoTo ErrorHandler<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim filePath<span></span></pre></td></tr><tr><td scope="row"><pre>    Select Case Index<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 0  ' Open<span></span></pre></td></tr><tr><td scope="row"><pre>            filePath = GetFileName()<span></span></pre></td></tr><tr><td scope="row"><pre>            If filePath &lt;&gt; &quot;&quot; Then<span></span></pre></td></tr><tr><td scope="row"><pre>                QTControl1.URL = filePath<span></span></pre></td></tr><tr><td scope="row"><pre>                MovieInfo.SetInfoMovie QTControl1.Movie<span></span></pre></td></tr><tr><td scope="row"><pre>            End If<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 1  ' Open URL<span></span></pre></td></tr><tr><td scope="row"><pre>            Dim movieURL As String<span></span></pre></td></tr><tr><td scope="row"><pre>            movieURL = InputBox(&quot;Enter a URL:&quot;, &quot;URL&quot;, &quot;http://www.server.com/ movies/sample.mov&quot;)<span></span></pre></td></tr><tr><td scope="row"><pre>            If movieURL &lt;&gt; &quot;&quot; Then<span></span></pre></td></tr><tr><td scope="row"><pre>                QTControl1.URL = movieURL<span></span></pre></td></tr><tr><td scope="row"><pre>                MovieInfo.SetInfoMovie QTControl1.Movie<span></span></pre></td></tr><tr><td scope="row"><pre>            End If<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 2  ' Close<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.URL = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>            MovieInfo.SetInfoMovie Nothing<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 4  'Full Screen<span></span></pre></td></tr><tr><td scope="row"><pre>            If QTControl1.URL &lt;&gt; &quot;&quot; Then QTControl1.FullScreen = True<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 5  ' Get Info<span></span></pre></td></tr><tr><td scope="row"><pre>            MovieInfo.SetInfoMovie QTControl1.Movie<span></span></pre></td></tr><tr><td scope="row"><pre>            MovieInfo.Move Me.Left + Me.Width + 200, Me.Top<span></span></pre></td></tr><tr><td scope="row"><pre>            MovieInfo.Show<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 7  ' Exit<span></span></pre></td></tr><tr><td scope="row"><pre>            Unload Me<span></span></pre></td></tr><tr><td scope="row"><pre>            End<span></span></pre></td></tr><tr><td scope="row"><pre>    End Select<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Exit Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>ErrorHandler:<span></span></pre></td></tr><tr><td scope="row"><pre>    Beep<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim errStr As String<span></span></pre></td></tr><tr><td scope="row"><pre>    errStr = &quot;Failed with error #&quot; &amp; Hex(Err.Number) &amp; &quot;, &quot; &amp; Err.Description<span></span></pre></td></tr><tr><td scope="row"><pre>    MsgBox errStr, vbCritical<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub QTControl1_SizeChanged(ByVal Width As Long, ByVal Height As Long)<span></span></pre></td></tr><tr><td scope="row"><pre>    ' ignore event if control was resized as a result of form being resized.<span></span></pre></td></tr><tr><td scope="row"><pre>    If gManualFormResize Then Exit Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>   ' resize window to accomodate control<span></span></pre></td></tr><tr><td scope="row"><pre>    Me.Move Me.Left, Me.Top, (Width + GetFormBorderWidth()) *  Screen.TwipsPerPixelX, (Height + GetFormBorderHeight()) * Screen.TwipsPerPixelY<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub QTControl1_StatusUpdate(ByVal statusCodeType As Long, ByVal statusCode  As Long, ByVal statusMessage As String)<span></span></pre></td></tr><tr><td scope="row"><pre>     Select Case statusCodeType<span></span></pre></td></tr><tr><td scope="row"><pre>        Case qtStatusCodeTypeControl<span></span></pre></td></tr><tr><td scope="row"><pre>            Select Case statusCode<span></span></pre></td></tr><tr><td scope="row"><pre>                Case qtStatusFullScreenBegin<span></span></pre></td></tr><tr><td scope="row"><pre>                    Me.Hide  ' hide movie window<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                Case qtStatusFullScreenEnd<span></span></pre></td></tr><tr><td scope="row"><pre>                    QTControl1.SetScale 1  ' set back to a reasonable size<span></span></pre></td></tr><tr><td scope="row"><pre>                    Me.Show<span></span></pre></td></tr><tr><td scope="row"><pre>        End Select<span></span></pre></td></tr><tr><td scope="row"><pre>    End Select<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-826009" title="Listing 2-4The VB 6 code for the movie information form"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCICBDIC" title="Listing 2-4The VB 6 code for the movie information form"></a><p class="codesample"><strong>Listing 2-4&nbsp;&nbsp;</strong>The
VB 6 code for the movie information form</p>
<div class="codesample"><table><tr><td scope="row"><pre>Begin VB.Form MovieInfo<span></span></pre></td></tr><tr><td scope="row"><pre>   BorderStyle     =   4  'Fixed ToolWindow<span></span></pre></td></tr><tr><td scope="row"><pre>   Caption         =   &quot;Movie Info&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>   ClientHeight    =   5148<span></span></pre></td></tr><tr><td scope="row"><pre>   ClientLeft      =   48<span></span></pre></td></tr><tr><td scope="row"><pre>   ClientTop       =   288<span></span></pre></td></tr><tr><td scope="row"><pre>   ClientWidth     =   5880<span></span></pre></td></tr><tr><td scope="row"><pre>   LinkTopic       =   &quot;Form2&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>   MaxButton       =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>   MinButton       =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>   ScaleHeight     =   5148<span></span></pre></td></tr><tr><td scope="row"><pre>   ScaleWidth      =   5880<span></span></pre></td></tr><tr><td scope="row"><pre>   ShowInTaskbar   =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>   StartUpPosition =   3  'Windows Default<span></span></pre></td></tr><tr><td scope="row"><pre>   Begin VB.Frame Frame1<span></span></pre></td></tr><tr><td scope="row"><pre>      Height          =   3495<span></span></pre></td></tr><tr><td scope="row"><pre>      Left            =   120<span></span></pre></td></tr><tr><td scope="row"><pre>      TabIndex        =   2<span></span></pre></td></tr><tr><td scope="row"><pre>      Top             =   1560<span></span></pre></td></tr><tr><td scope="row"><pre>      Width           =   5655<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Label lblData<span></span></pre></td></tr><tr><td scope="row"><pre>         Height          =   3135<span></span></pre></td></tr><tr><td scope="row"><pre>         Left            =   1560<span></span></pre></td></tr><tr><td scope="row"><pre>         TabIndex        =   4<span></span></pre></td></tr><tr><td scope="row"><pre>         Top             =   240<span></span></pre></td></tr><tr><td scope="row"><pre>         Width           =   3975<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>      Begin VB.Label lblCaptions<span></span></pre></td></tr><tr><td scope="row"><pre>         Alignment       =   1  'Right Justify<span></span></pre></td></tr><tr><td scope="row"><pre>         BeginProperty Font<span></span></pre></td></tr><tr><td scope="row"><pre>            Name            =   &quot;MS Sans Serif&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>            Size            =   7.8<span></span></pre></td></tr><tr><td scope="row"><pre>            Charset         =   0<span></span></pre></td></tr><tr><td scope="row"><pre>            Weight          =   700<span></span></pre></td></tr><tr><td scope="row"><pre>            Underline       =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>            Italic          =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>            Strikethrough   =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>         EndProperty<span></span></pre></td></tr><tr><td scope="row"><pre>         Height          =   3135<span></span></pre></td></tr><tr><td scope="row"><pre>         Left            =   120<span></span></pre></td></tr><tr><td scope="row"><pre>         TabIndex        =   3<span></span></pre></td></tr><tr><td scope="row"><pre>         Top             =   240<span></span></pre></td></tr><tr><td scope="row"><pre>         Width           =   1335<span></span></pre></td></tr><tr><td scope="row"><pre>      End<span></span></pre></td></tr><tr><td scope="row"><pre>   End<span></span></pre></td></tr><tr><td scope="row"><pre>   Begin VB.Label lblInfo<span></span></pre></td></tr><tr><td scope="row"><pre>      Alignment       =   2  'Center<span></span></pre></td></tr><tr><td scope="row"><pre>      BeginProperty Font<span></span></pre></td></tr><tr><td scope="row"><pre>         Name            =   &quot;MS Sans Serif&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Size            =   7.8<span></span></pre></td></tr><tr><td scope="row"><pre>         Charset         =   0<span></span></pre></td></tr><tr><td scope="row"><pre>         Weight          =   700<span></span></pre></td></tr><tr><td scope="row"><pre>         Underline       =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>         Italic          =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>         Strikethrough   =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>      EndProperty<span></span></pre></td></tr><tr><td scope="row"><pre>      Height          =   975<span></span></pre></td></tr><tr><td scope="row"><pre>      Left            =   120<span></span></pre></td></tr><tr><td scope="row"><pre>      TabIndex        =   1<span></span></pre></td></tr><tr><td scope="row"><pre>      Top             =   480<span></span></pre></td></tr><tr><td scope="row"><pre>      Width           =   5535<span></span></pre></td></tr><tr><td scope="row"><pre>   End<span></span></pre></td></tr><tr><td scope="row"><pre>   Begin VB.Label lblName<span></span></pre></td></tr><tr><td scope="row"><pre>      Alignment       =   2  'Center<span></span></pre></td></tr><tr><td scope="row"><pre>      BeginProperty Font<span></span></pre></td></tr><tr><td scope="row"><pre>         Name            =   &quot;MS Sans Serif&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>         Size            =   9.6<span></span></pre></td></tr><tr><td scope="row"><pre>         Charset         =   0<span></span></pre></td></tr><tr><td scope="row"><pre>         Weight          =   700<span></span></pre></td></tr><tr><td scope="row"><pre>         Underline       =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>         Italic          =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>         Strikethrough   =   0   'False<span></span></pre></td></tr><tr><td scope="row"><pre>      EndProperty<span></span></pre></td></tr><tr><td scope="row"><pre>      Height          =   255<span></span></pre></td></tr><tr><td scope="row"><pre>      Left            =   120<span></span></pre></td></tr><tr><td scope="row"><pre>      TabIndex        =   0<span></span></pre></td></tr><tr><td scope="row"><pre>      Top             =   120<span></span></pre></td></tr><tr><td scope="row"><pre>      Width           =   5535<span></span></pre></td></tr><tr><td scope="row"><pre>   End<span></span></pre></td></tr><tr><td scope="row"><pre>End<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_Name = &quot;MovieInfo&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_GlobalNameSpace = False<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_Creatable = False<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_PredeclaredId = True<span></span></pre></td></tr><tr><td scope="row"><pre>Attribute VB_Exposed = False<span></span></pre></td></tr><tr><td scope="row"><pre>Option Explicit<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Dim gMovie As QTMovie<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub Form_Load()<span></span></pre></td></tr><tr><td scope="row"><pre>    DisplayMovieData<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Sub SetInfoMovie(myMovie As QTMovie)<span></span></pre></td></tr><tr><td scope="row"><pre>    Set gMovie = myMovie<span></span></pre></td></tr><tr><td scope="row"><pre>    DisplayMovieData<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Function MovieAnnotation(annoID As Long, mov As QTMovie) As String<span></span></pre></td></tr><tr><td scope="row"><pre>    ' Annotation returns an error if asked for an annotation that<span></span></pre></td></tr><tr><td scope="row"><pre>    '  does not exist (so you can tell the difference between an<span></span></pre></td></tr><tr><td scope="row"><pre>    '  annotation that is missing and one that is set to an empty<span></span></pre></td></tr><tr><td scope="row"><pre>    '  string), so we need to be prepared for an exception<span></span></pre></td></tr><tr><td scope="row"><pre>    On Error Resume Next<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim anno As String<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    anno$ = &quot;&quot;   ' value will remain if getting value throws exception<span></span></pre></td></tr><tr><td scope="row"><pre>    If Not (mov Is Nothing) Then anno$ = mov.Annotation(annoID)<span></span></pre></td></tr><tr><td scope="row"><pre>    MovieAnnotation = anno<span></span></pre></td></tr><tr><td scope="row"><pre>End Function<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Sub DisplayMovieData()<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim dataStr As String<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim captionsStr As String<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim annoStr As String<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Dim track As QTTrack<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    lblName = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>    lblInfo = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>    lblCaptions = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>    lblData = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    If gMovie Is Nothing Then Exit Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    On Error GoTo ErrorHandler<span></span></pre></td></tr><tr><td scope="row"><pre>    lblName = MovieAnnotation(qtAnnotationFullName, gMovie)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    ' get some annotations<span></span></pre></td></tr><tr><td scope="row"><pre>    lblInfo = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>    annoStr = MovieAnnotation(qtAnnotationCopyright, gMovie)<span></span></pre></td></tr><tr><td scope="row"><pre>    If Trim(annoStr) &lt;&gt; &quot;&quot; Then lblInfo = lblInfo &amp; annoStr &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>    annoStr = MovieAnnotation(qtAnnotationAuthor, gMovie)<span></span></pre></td></tr><tr><td scope="row"><pre>    If Trim(annoStr) &lt;&gt; &quot;&quot; Then lblInfo = lblInfo &amp; annoStr &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>    annoStr = MovieAnnotation(qtAnnotationComments, gMovie)<span></span></pre></td></tr><tr><td scope="row"><pre>    If Trim(annoStr) &lt;&gt; &quot;&quot; Then lblInfo = lblInfo &amp; annoStr &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>    annoStr = MovieAnnotation(qtAnnotationDescription, gMovie)<span></span></pre></td></tr><tr><td scope="row"><pre>    If Trim(annoStr) &lt;&gt; &quot;&quot; Then lblInfo = lblInfo &amp; annoStr &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    captionsStr = &quot;Source:&quot; &amp; vbCrLf &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>    dataStr = Trim(gMovie.URL) &amp; vbCrLf &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    captionsStr = captionsStr &amp; &quot;Size:&quot; &amp; vbCrLf &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>    dataStr = dataStr &amp; gMovie.Width &amp; &quot; x &quot; &amp; gMovie.Height &amp; vbCrLf &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    captionsStr = captionsStr &amp; &quot;Duration:&quot; &amp; vbCrLf &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>    dataStr = dataStr &amp; gMovie.Duration &amp; vbCrLf &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    For Each track In gMovie.Tracks<span></span></pre></td></tr><tr><td scope="row"><pre>        captionsStr = captionsStr &amp; track.DisplayName &amp; &quot;:&quot; &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>        dataStr = dataStr &amp; track.Format<span></span></pre></td></tr><tr><td scope="row"><pre>        If track.Height &gt; 0 Then<span></span></pre></td></tr><tr><td scope="row"><pre>            dataStr = dataStr &amp; &quot;, &quot; &amp; track.Width &amp; &quot; x &quot; &amp; track.Height &amp; vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>        End If<span></span></pre></td></tr><tr><td scope="row"><pre>    Next track<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    lblCaptions = captionsStr<span></span></pre></td></tr><tr><td scope="row"><pre>    lblData = dataStr<span></span></pre></td></tr><tr><td scope="row"><pre>    Exit Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>ErrorHandler:<span></span></pre></td></tr><tr><td scope="row"><pre>    dataStr = dataStr &amp; &quot;Error #&quot; &amp; Hex(Err.Number) &amp; &quot;, &quot; &amp; Err.Description &amp;  vbCrLf<span></span></pre></td></tr><tr><td scope="row"><pre>    Resume Next<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-826517" title="Listing 2-5Code for handling the sizing of the QuickTime movie "></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIFDIHJ" title="Listing 2-5Code for handling the sizing of the QuickTime movie "></a><p class="codesample"><strong>Listing 2-5&nbsp;&nbsp;</strong>Code
for handling the sizing of the QuickTime movie </p>
<div class="codesample"><table><tr><td scope="row"><pre>Option Explicit<span></span></pre></td></tr><tr><td scope="row"><pre>Dim bFormResized As Boolean<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub Form_Load()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.ErrorHandling = qtErrorHandlingRaiseException<span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.sizing = qtControlFitsMovie<span></span></pre></td></tr><tr><td scope="row"><pre>    Load frmInfo<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub Form_Resize()<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim sizingMode As QTSizingModeEnum<span></span></pre></td></tr><tr><td scope="row"><pre>    Dim resetSizing As Boolean<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    bFormResized = True<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    ' set the sizing mode to &quot;movie fits control&quot; so the movie will adjust<span></span></pre></td></tr><tr><td scope="row"><pre>    '  itself as to the new control size<span></span></pre></td></tr><tr><td scope="row"><pre>    sizingMode = QTControl1.sizing<span></span></pre></td></tr><tr><td scope="row"><pre>    If sizingMode = qtControlFitsMovie Then<span></span></pre></td></tr><tr><td scope="row"><pre>        QTControl1.sizing = qtMovieFitsControl<span></span></pre></td></tr><tr><td scope="row"><pre>        resetSizing = True<span></span></pre></td></tr><tr><td scope="row"><pre>    Else<span></span></pre></td></tr><tr><td scope="row"><pre>        resetSizing = False<span></span></pre></td></tr><tr><td scope="row"><pre>    End If<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.Move 0, 0, Me.Width - (GetFormBorderWidth() *  Screen.TwipsPerPixelX), Me.Height - (GetFormBorderHeight() *  Screen.TwipsPerPixelY)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    If resetSizing Then QTControl1.sizing = sizingMode<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    bFormResized = False<span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub Form_Unload(Cancel As Integer)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    frmInfo.SetInfoMovie Nothing<span></span></pre></td></tr><tr><td scope="row"><pre>    QTControl1.URL = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>    DoEvents<span></span></pre></td></tr><tr><td scope="row"><pre>    End<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub mnuEdit_Click(Index As Integer)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Select Case Index<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 0  'Undo<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.Movie.Undo<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 2  'Cut<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.Movie.Cut<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 3  'Copy<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.Movie.Copy<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 4  'Paste<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.Movie.Paste<span></span></pre></td></tr><tr><td scope="row"><pre>    End Select<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub mnuFile_Click(Index As Integer)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Dim FileName<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Select Case Index<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        Case 0  'Open<span></span></pre></td></tr><tr><td scope="row"><pre>            ' make the control automatically resize itself whenever the movie<span></span></pre></td></tr><tr><td scope="row"><pre>            ' size changes<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.sizing = qtControlFitsMovie<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            FileName = GetFileName()<span></span></pre></td></tr><tr><td scope="row"><pre>            If FileName &lt;&gt; &quot;&quot; Then<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                QTControl1.URL = FileName<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                If frmInfo.Visible Then<span></span></pre></td></tr><tr><td scope="row"><pre>                    frmInfo.SetInfoMovie QTControl1.Movie<span></span></pre></td></tr><tr><td scope="row"><pre>                End If<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            End If<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        Case 1  'Open URL<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.sizing = qtControlFitsMovie<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            Dim URL$<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            URL$ = InputBox(&quot;Enter a URL:&quot;, &quot;URL&quot;, &quot;http://www.server.com/movies/ sample.mov&quot;)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            If URL$ &lt;&gt; &quot;&quot; Then<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                QTControl1.URL = URL$<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                If frmInfo.Visible Then<span></span></pre></td></tr><tr><td scope="row"><pre>                    frmInfo.SetInfoMovie QTControl1.Movie<span></span></pre></td></tr><tr><td scope="row"><pre>                End If<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            End If<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        Case 2  'Close<span></span></pre></td></tr><tr><td scope="row"><pre>            frmInfo.SetInfoMovie Nothing<span></span></pre></td></tr><tr><td scope="row"><pre>            QTControl1.URL = &quot;&quot;<span></span></pre></td></tr><tr><td scope="row"><pre>            frmInfo.Hide<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 4  'Full Screen<span></span></pre></td></tr><tr><td scope="row"><pre>            If QTControl1.URL &lt;&gt; &quot;&quot; Then QTControl1.FullScreen = True<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 5  'Get Info<span></span></pre></td></tr><tr><td scope="row"><pre>            If QTControl1.URL &lt;&gt; &quot;&quot; Then<span></span></pre></td></tr><tr><td scope="row"><pre>                frmInfo.SetInfoMovie QTControl1.Movie<span></span></pre></td></tr><tr><td scope="row"><pre>                frmInfo.Move Me.Left + Me.Width + 200, Me.Top<span></span></pre></td></tr><tr><td scope="row"><pre>                frmInfo.Show<span></span></pre></td></tr><tr><td scope="row"><pre>            End If<span></span></pre></td></tr><tr><td scope="row"><pre>        Case 7  'Exit<span></span></pre></td></tr><tr><td scope="row"><pre>            Unload Me<span></span></pre></td></tr><tr><td scope="row"><pre>            End<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    End Select<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Private Sub QTControl1_SizeChanged(ByVal Width As Long, ByVal Height As Long)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    ' Ignore event if control was resized as a result of form being resized.<span></span></pre></td></tr><tr><td scope="row"><pre>    '  avoids race condition<span></span></pre></td></tr><tr><td scope="row"><pre>    If bFormResized Then Exit Sub<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    'Resize window to accomodate control<span></span></pre></td></tr><tr><td scope="row"><pre>    Me.Move Me.Left, Me.Top, (Width + GetFormBorderWidth()) *  Screen.TwipsPerPixelX, (Height + GetFormBorderHeight()) * Screen.TwipsPerPixelY<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>End Sub<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-799346" title="Audio Enhancements"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BBCIAFAI" title="Audio Enhancements"></a><h2>Audio Enhancements</h2>
<p>QuickTime 7 for Windows breaks free of the limitations of
the Sound Manager, adding many new features and capabilities that
developers can take advantage of in their audio playback and authoring
applications.</p>
<p>Notably, QuickTime 7 for Windows now supports <strong>high-resolution
audio</strong>, that is, audio sampled at sample rates higher than
64 kHz and up to 192 kHz, with up to 24 channels and support for
surround sound. This is in stark contrast to the implementation
of the Sound Manager, which only supported mono and stereo. </p>
<p>The result of these new audio enhancements is as follows:</p>
<ul class="ul"><li class="li"><p>A much richer approach to sound in QuickTime,
with support for higher sampling rates, such as 96 kHz and 192 kHz,
multiple channels and multiple channel layouts, including 5.1 surround
sound and up to 24 discrete channels, meaning channels without any
layout imposed on them. Support is also provided for a variety of
more accurate audio representations, such as 24-bit uncompressed
audio, playback, and export. Synchronization and access to uncompressed
audio on a per-sample basis is also greatly improved, including
access to raw PCM audio samples from VBR-compressed audio sources.</p></li>
<li class="li"><p>The introduction of a new abstraction layer: the audio context.
An audio context represents a connection to a particular audio device.
Using an audio context allows you to easily connect a movie to an
audio device.</p></li>
<li class="li"><p>Conversion of audio from one format to another on the fly,
performing channel mix-down or remapping, upsampling or downsampling,
and sample conversion as needed. This conversion can be performed
during export, or as part of the output chain to a device with different
playback characteristics than the stored audio. </p></li></ul>
<p>Most components&#8211;&#8211;with a few exceptions such as streaming
and MPEG-4 exporting&#8211;&#8211;will be able to make use of these new
capabilities immediately. This release of QuickTime updates a number
of components so that it is possible to play  back, edit, and export
a broad variety of enhanced audio right away. </p>
<p>In brief, QuickTime 7 for Windows includes the following enhancements,
discussed in this section:</p>
<ul class="ul"><li class="li"><p>A new abstraction layer for audio</p></li>
<li class="li"><p>A new sound description</p></li>
<li class="li"><p>A suite of sound description functions</p></li>
<li class="li"><p>New movie property to prevent pitch-shifting</p></li>
<li class="li"><p>New functions for gain, balance, and mute</p></li>
<li class="li"><p>New level and frequency metering API</p></li>
<li class="li"><p>New audio extraction and conversion API</p></li>
<li class="li"><p>New audio compression configuration component</p></li>
<li class="li"><p>New movie export properties to support high-resolution audio</p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-794460" title="New Abstraction Layer For Audio"></a><h3>New
Abstraction Layer For Audio</h3>
<p>QuickTime 7 for Windows introduces the <strong>audio context</strong>&#8211;&#8211;a
new abstraction that represents playing to an audio device. </p>
<p>As defined, a QuickTime audio context is an abstraction for
a connection to an audio device. This allows you to work more easily
and efficiently with either single or multiple audio devices in
your application. </p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-801504" title="Creating an Audio Context"></a><h4>Creating
an Audio Context</h4>
<p>To create an audio context, you call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/QTAudioContextCreateForAudioDevice">QTAudioContextCreateForAudioDevice</a></code> and
pass in the UID of the device, which is a <code>CFStringRef</code>.
An audio context is then returned. You can then pass that audio
content either into <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/NewMovieFromProperties">NewMovieFromProperties</a></code>,
or you can open your movie however you would normally open it and
call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/SetMovieAudioContext">SetMovieAudioContext</a></code>. What that does
is route all the sound tracks of the movie to that particular device. </p>
<p>If you want to create an audio context and assign a device
to it on Windows, use the following call:</p>
<div class="codesample"><table><tr><td scope="row"><pre>extern OSStatus<span></span></pre></td></tr><tr><td scope="row"><pre>QTAudioContextCreateForAudioDevice(<span></span></pre></td></tr><tr><td scope="row"><pre>  CFAllocatorRef       allocator,<span></span></pre></td></tr><tr><td scope="row"><pre>  CFStringRef          audioDeviceUID,<span></span></pre></td></tr><tr><td scope="row"><pre>  CFDictionaryRef      options,<span></span></pre></td></tr><tr><td scope="row"><pre>  QTAudioContextRef *  newAudioContextOut);<span></span></pre></td></tr></table></div>
<p>Then use the <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/SetMovieAudioContext">SetMovieAudioContext</a></code> call
on your movie, and it will play to that device.</p>
<p>To get a list of devices on Windows&#8211;&#8211;so you can pass an <code>audioDeviceUID</code> CFString
to <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/QTAudioContextCreateForAudioDevice">QTAudioContextCreateForAudioDevice</a></code>&#8211;&#8211;use
the native Windows DirectSound APIs (specifically, the <code><!--a-->DirectSoundEnumerate<!--/a--></code> function,
from <code>dsound.h</code>). Iterating
through the list of DirectSound devices, you get a callback for
each one that gives you the device&#8217;s GUID (<code>LPGUID</code>),
description (<code>LPCSTR</code>),
and module (<code>LPCSTR</code>).
The most important one is the description, which is the device&#8217;s
name. QuickTime uses this as its device UID on Windows. So once
you find the device you want, you create a <code>CFStringRef</code> for
it, and pass this to <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/QTAudioContextCreateForAudioDevice">QTAudioContextCreateForAudioDevice</a></code>.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_149" title="Important:"></a><p><strong>Important:</strong>&nbsp;
On Windows, the <code>audioDeviceUID</code> is
the GUID of a DirectSound device, stringified using such Win32 functions
as <code><!--a-->StringFromCLSID<!--/a--></code> or <code><!--a-->StringFromGUID2<!--/a--></code>,
then wrapped in a CFStringRef using <code><a href="../../../../CoreFoundation/Reference/CFStringRef/Reference/reference.html#//apple_ref/doc/c_ref/CFStringCreateWithCharacters" target="_top">CFStringCreateWithCharacters</a></code>.
After passing the <code>audioDeviceUID</code> <code>CFStringRef</code> to <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/QTAudioContextCreateForAudioDevice">QTAudioContextCreateForAudioDevice</a></code>, remember
to <code><a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFRelease" target="_top">CFRelease</a></code> the <code>CFStringRef</code> you created.</p><p></p></div>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_150" title="Note"></a><p><strong>Note:</strong>&nbsp;If you want to
route two different movies to the same device, you cannot use the
same audio context because the audio context is a single connection
to that device. What you do is call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/QTAudioContextCreateForAudioDevice">QTAudioContextCreateForAudioDevice</a></code> again
and pass in the same device UID to get another <code>AudioContext</code> for
the same device, and pass that to your second movie.</p></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-794517" title="High-Resolution Audio Support"></a><h3>High-Resolution
Audio Support</h3>
<p>High-resolution audio makes use of an enhanced sound description
with the ability to describe high sampling rates, multiple channels,
and more accurate audio representation and reproduction. </p>
<p>Significantly, the new sound description has larger fields
to describe the sampling rate and number of channels, so that the
sound description is no longer the limiting factor for these characteristics. </p>
<p>The sound description has built-in support for variable-bit-rate
(VBR) audio encoding with variable-duration compressed frames. Extensions
to the sound description allow you to describe the spatial layout
of the channels, such as quadraphonic and 5.1 surround sound, or
to label channels as <strong>discrete</strong>&#8211;&#8211;that is, not
tied to a particular geometry. For more information, see <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/tag/SoundDescriptionV2">&#8220;SoundDescriptionV2&#8221;</a></code>.</p>
<p>New movie audio properties include a summary channel layout
property, providing a nonredundant listing of all the channel types
used in the movie&#8212;such as L/R for stereo, or L/R/Ls/Rs/C for 5-channel
surround sound&#8212;and a device channel layout, listing all the channel
types used by the movie&#8217;s output device. </p>
<p><span class="content_text">Figure 2-2</span> shows the layout of surround speakers. The
terminology is defined in <span class="content_text">Table 2-1</span>. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40002476-CH313-794562" title="Figure 2-2Layout of surround speakers"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BBCFEACC" title="Figure 2-2Layout of surround speakers"></a><p><strong>Figure 2-2&nbsp;&nbsp;</strong>Layout of surround speakers</p>
<img src = "../art/surround_speakers.jpg" alt = "" ></div><br/><a name="//apple_ref/doc/uid/TP40002476-CH313-794573" title="Table 2-1Surround sound definitions"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIGEFFF" title="Table 2-1Surround sound definitions"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 2-1&nbsp;&nbsp;</strong>Surround sound definitions</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Speaker</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Definition</p></th>
</tr>


<tr>
<td  scope="row"><p>L</p></td>
<td ><p>Left speaker</p></td>
</tr>
<tr>
<td  scope="row"><p>R</p></td>
<td ><p>Right speaker</p></td>
</tr>
<tr>
<td  scope="row"><p>C</p></td>
<td ><p>Center speaker</p></td>
</tr>
<tr>
<td  scope="row"><p>Ls</p></td>
<td ><p>Left surround speaker</p></td>
</tr>
<tr>
<td  scope="row"><p>Rs</p></td>
<td ><p>Right surround speaker</p></td>
</tr>
<tr>
<td  scope="row"><p>LFE</p></td>
<td ><p>Sub-woofer (Note that LFE is an abbreviation for low-frequency effects) </p></td>
</tr>

</table></div>
<p>The new sound description is supported by the data types and
structures found in <code>CoreAudioTypes.h</code>.
While the Core Audio API itself is not available to Windows programmers,
QuickTime for Windows does include the relevant data structures,
such as audio buffers, stream descriptions, and channel layouts
defined in <code>CoreAudioTypes.h</code>.</p>
<p>A suite of functions has been included to support the handling
of sound descriptions opaquely. </p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-794647" title="Playback"></a><h4>Playback</h4>
<p>Playback at the high level is automatic and transparent; if
you play a movie that contains 96 kHz or 192 kHz sound, it should
just work. You should not have to modify your code. The same is
true for cut-and-paste editing. If the chosen output device does
not support the channel layout, sampling rate, or sample size of
the movie audio, mix-down and resampling are performed automatically.</p>
<p>Import of high-resolution audio is automatic, provided the
import component has been updated to support high-resolution audio.</p>
<p>QuickTime will play to any device that has a DirectSound driver.
If it appears in the list of devices when you call <code><!--a-->DirectSoundEnumerate<!--/a--></code>,
QuickTime will play to it.</p>
<p>There are some caveats, however. If it is a device that only
accepts a compressed stream (that is, an AC-3 stream), you will
only hear silence. QuickTime does not provide  CoreAudio HAL or
AudioUnit or AudioConverter interfaces on Windows, so you cannot use
these to query devices. You may use the facilities that DirectSound
provides. QuickTime provides an audio panel in the QuickTime Preferences
on Windows that lets users to specify the channel layout, sample
rate, and bit depth of their playback device.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-819610" title="QuickTime Settings Dialogs"></a><h4>QuickTime
Settings Dialogs</h4>
<p>QuickTime 7 for Windows introduces a new series of settings
dialogs for improved control over audio playback.</p>
<p>QuickTime does not manage a list of devices that is separate
from the list available in Windows. If you want to set your input
and output devices, you click in the appropriate settings field.
In the Sound Out area of the Audio tab in the QuickTime Settings
dialog (<span class="content_text">Figure 2-3</span>), the sound characteristics of the playback
device are not changed. If the user specifies 48 kHz, for example,
QuickTime will not go to the output device and flip a switch to
that setting. </p>
<p><span class="content_text">Figure 2-3</span> illustrates the QuickTime Settings dialog
with the Audio tab selected. Thisdialog lets users configure QuickTime
to use the proper settings for their audio device. Users can select
the output format supported by aparticular audio device, including
sample rate, sample size, and number of channels.(You cannot use
this dialog to change the settings of the actual output device,
only the format that QuickTime sends to the device.) </p>
<br/><div><a name="//apple_ref/doc/uid/TP40002476-CH313-819640" title="Figure 2-3The QuickTime Settings dialog with the Audio tab selected"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIFICJA" title="Figure 2-3The QuickTime Settings dialog with the Audio tab selected"></a><p><strong>Figure 2-3&nbsp;&nbsp;</strong>The QuickTime Settings dialog with
the Audio tab selected</p><img src = "../art/qt7_audio_control_panel.gif" alt = "" width="446" height="518"></div><br/>
<p><span class="content_text">Figure 2-4</span> illustrates the various settings that are
available for audio, including channel assignment. This information
panel in QuickTime Player lets users modify some aspects of a movie&#8217;s
audio, such as volume, balance, bass, and treble.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40002476-CH313-819658" title="Figure 2-4Audio settings dialog, including channel assignment"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIDEHEC" title="Figure 2-4Audio settings dialog, including channel assignment"></a><p><strong>Figure 2-4&nbsp;&nbsp;</strong>Audio settings dialog, including channel
assignment</p><img src = "../art/qt7_soundtrack_properties.gif" alt = "" width="650" height="616"></div><br/>
<p><span class="content_text">Figure 2-5</span> illustrates the Sound Settings dialog in
QuickTime 7 for Windows. This audio compression settings dialog
comes up during an export. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40002476-CH313-819676" title="Figure 2-5Sound settings dialog that includes user-definable choices for format, channels, and rate of audio playback "></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BCIHHGAA" title="Figure 2-5Sound settings dialog that includes user-definable choices for format, channels, and rate of audio playback "></a><p><strong>Figure 2-5&nbsp;&nbsp;</strong>Sound settings dialog that includes
user-definable choices for format, channels, and rate of audio playback </p>
<img src = "../art/qt7_sound_export_dialog.gif" alt = "" width="345" height="434"></div><br/>
<a name="//apple_ref/doc/uid/TP40002476-CH313-802694" title="Export"></a><h4>Export</h4>
<p>Export of high-resolution audio is likewise transparent at
the high level. Export at the lower levels requires some additional
code. Your application must &#8220;opt in&#8221; to the new audio features
explicitly if it &#8220;talks&#8221; directly to an export component instance.
You do this by calling <code><a href="../../../WhatsNewQT6_4/Chap1/QT6WhatsNew.html#//apple_ref/doc/c_ref/QTSetComponentProperty" target="_top">QTSetComponentProperty</a></code> on
the exporter component instance and passing in the <code><!--a  -->kQTMovieExporterPropertyID_EnableHighResolutionAudioFeatures<!--/a--></code> property.
This is illustrated in the code sample <span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-795529">Listing 2-6</a></span>.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-794712" title="Sound Description Creation and Accessor Functions"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BBCGAFIC" title="Sound Description Creation and Accessor Functions"></a><h3>Sound Description
Creation and Accessor Functions</h3>
<p>QuickTime 7 for Windows provides new functions that let you
create, access, and convert sound descriptions.</p>
<p>Sound descriptions can take three basic inputs: an <code>AudioStreamBasicDescription</code>,
a channel layout, and a magic cookie. Sound descriptions are now
treated as if they are opaque. In QuickTime 7, when you are handed
a sound description, for example, you don&#8217;t have to go in and
look at the version field. </p>
<p>If you want to create a sound description, you can simply
hand it an <code>AudioStreamBasicDescription</code>,
an optional channel layout if you have one, and an optional magic
cookie if you need one for the described audio format. Note that
it is the format (codec) of the audio that determines whether it
needs a magic cookie, not the format of the sound description. </p>
<p>By calling <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSoundDescriptionCreate">QTSoundDescriptionCreate</a></code>,
you can make a sound description of any version you choose&#8211;&#8211;for
example, one that is of the lowest possible version, given that it
is stereo and 16-bit, or one of any particular version you want
or request.</p>
<p>The main point about the new API is the capability provided
to create a sound description and the usage of new property getters
and setters. To accomplish this, follow these steps:</p>
<ol class="ol"><li class="li"><p>Get an <code>AudioStreamBasicDescription</code> from
a sound description. </p></li>
<li class="li"><p>Get a channel layout from a sound description (if there is
one). </p></li>
<li class="li"><p>Get the magic cookie from magic cookie (if there is one). </p></li></ol>
<p>You can also:</p>
<ol class="ol"><li class="li"><p>Get a user-readable textual description of the
format described by the <code>SoundDescription</code>.</p></li>
<li class="li"><p>Add or replace a channel layout to an existing sound description.
For example, this is what QuickTime Player does in the properties
panel where the user can change the channel assignments.</p></li>
<li class="li"><p>Add a magic cookie to a sound description. (This is not needed
very often unless you are writing a movie importer, for example.)</p></li></ol>
<p>To convert an existing QuickTime sound description into the
new V2 sound description, you call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSoundDescriptionConvert">QTSoundDescriptionConvert</a></code>.
This lets you convert sound descriptions from one version to another. </p>
<p>For a description of versions 0 and 1 of the <code><!--a  -->SoundDescription<!--/a--></code> record,
see the documentation for the <span class="content_text"><a href="../../../../../referencelibrary/QuickTime/idxFileFormatSpecification-date.html#//apple_ref/doc/uid/TP30000943-TP30000433-TP30000509" target="_top">QuickTime File Format</a></span>.</p>
<p>For a description of version 2 of the <code><!--a  -->SoundDescription<!--/a--></code> record,
see <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/tag/SoundDescriptionV2">&#8220;SoundDescriptionV2&#8221;</a></code>.
For details of the sound description functions, see <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSoundDescriptionCreate">QTSoundDescriptionCreate</a></code> and <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSoundDescriptionConvert">QTSoundDescriptionConvert</a></code>.</p>
<p>For details on getting and setting sound description properties,
see <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSoundDescriptionGetProperty">QTSoundDescriptionGetProperty</a></code> and<code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSoundDescriptionSetProperty">QTSoundDescriptionSetProperty</a></code> </p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-794852" title="Audio Playback Enhancements"></a><h3>Audio
Playback Enhancements</h3>
<p>In addition to playing back high-resolution audio, QuickTime
7 for Windows introduces the following audio playback enhancements:</p>
<ul class="spaceabove"><li class="li"><p>The ability to play movies at a nonstandard rate
without pitch-shifting the audio.</p></li>
<li class="li"><p>Getting and setting the gain, balance, and mute values for
a movie, or the gain and mute values for a track.</p></li>
<li class="li"><p>Providing audio level and frequency metering during playback. </p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-794884" title="Preventing Pitch-Shifting"></a><h4>Preventing
Pitch-Shifting</h4>
<p>A new property is available for use with the <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/NewMovieFromProperties">NewMovieFromProperties</a></code> function: <code><a href="../../../Reference/QT7-1_Update_Reference/Constants/Constants.html#//apple_ref/doc/c_ref/kQTAudioPropertyID_RateChangesPreservePitch" target="_top">kQTAudioPropertyID_RateChangesPreservePitch</a></code>.
When this property is set, changing the movie playback rate will
not result in pitch-shifting of the audio. This allows you to fast-forward
through a movie without hearing chipmunks.</p>
<p>Setting this property also affects playback of scaled edits,
making it possible to change the tempo of a sound segment or scale
it to line up with a video segment, for example, without changing
the pitch of the sound. </p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-794911" title="Gain, Mute, and Balance"></a><h4>Gain,
Mute, and Balance</h4>
<p>New functions are available to set the left-right balance
for a movie, set the gain for a movie or track, or to mute and unmute
a movie or track without changing the gain or balance settings. </p>
<p>The gain and mute functions duplicate existing functions for
setting track and movie volume, but the new functions present a
simpler and more consistant programmer interface. </p>
<p>For example, to mute the movie using the old <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/SetMovieVolume" target="_top">SetMovieVolume</a></code> function,
you would pass in a negative volume value; to preserve the current
volume over a mute and unmute operation, you had to first read the
volume, then negate it and set it for muting, then negate it and
set it again to unmute. By comparison, the new <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/SetMovieAudioMute">SetMovieAudioMute</a></code> function
simply mutes or unmutes the movie without changing the gain value.</p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_151" title="Note"></a><p><strong>Note:</strong>&nbsp;The values set
using these functions are not persistent; that is, they are not
saved with the movie.</p></div>
<p>For details, see </p>
<ul class="spaceabove"><li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetTrackAudioGain">GetTrackAudioGain</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/SetTrackAudioGain">SetTrackAudioGain</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetTrackAudioMute">GetTrackAudioMute</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/SetTrackAudioMute">SetTrackAudioMute</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMovieAudioGain">GetMovieAudioGain</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/SetMovieAudioGain">SetMovieAudioGain</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMovieAudioMute">GetMovieAudioMute</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/SetMovieAudioMute">SetMovieAudioMute</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMovieAudioBalance">GetMovieAudioBalance</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/SetMovieAudioBalance">SetMovieAudioBalance</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-795050" title="Level and Frequency Metering"></a><h4>Level
and Frequency Metering</h4>
<p>It is now easy to obtain real-time measurements of the average
audio output power level in one or more frequency bands.</p>
<p>The only mix supported for volume metering is <code>DeviceMix</code>:</p>
<ul class="spaceabove"><li class="li"><p><code>kQTAudioMeter_DeviceMix</code>:
Meter the movie&#8217;s mix to the device channel layout. To determine
the channel layout of this mix, call <code>QTGetMovieProperty</code>(..., <code>kQTAudioPropertyID_DeviceChannelLayout</code>,
...).</p></li>
<li class="li"><p><code>kQTAudioMeter_StereoMix</code>:
Meter a stereo (two-channel) mix of the enabled sound tracks in
the movie. This option is offered only for <code>MovieAudioFrequencyMetering</code>.</p></li>
<li class="li"><p><code>kQTAudioMeter_MonoMix</code>:
Meter a monaural (one-channel) mix of the enabled sound tracks in
the movie. This option is offered only for <code>MovieAudioFrequencyMetering</code>.</p></li></ul>
<p>You can specify the number of frequency bands to meter. QuickTime
divides the possible frequency spectrum (approximately half the
audio sampling rate) into that many bands. You can ask QuickTime
for the center frequency of each resulting band for display in your user
interface. The <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/GetMovieAudioFrequencyMeteringBandFrequencies">GetMovieAudioFrequencyMeteringBandFrequencies</a></code> function
returns an array containing the center frequencies of each band.</p>
<p>When using <code><!--a  -->kQTAudioMeter_DeviceMix<!--/a--></code> (which
is the only option currently offered for Volume Metering), levels
are computed for each audio channel as it is presented to the output
device. In order to obtain accurate frequency metering information
for N-channel devices without requiring that N compute-intensive
spectral analyses be performed, the <code><!--a  -->kQTAudioMeter_MonoMix<!--/a--></code> and <code><!--a  -->kQTAudioMeter_StereoMix<!--/a--></code> options
direct QuickTime to perform an audio mix-down before computing the
frequency levels. </p>
<p>For example, if you are playing movies to a 5.1 output device,
you might want to meter the frequency levels of all six output channels.However,
if you are playing stereo content, the levels for four of the outputs
would always be zero, so you might prefer to meter just what would
be played on a stereo device.</p>
<p>To use the frequency metering API, follow these steps:</p>
<ol class="ol"><li class="li"><p>Set the number of frequency bands to meter using <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/SetMovieAudioFrequencyMeteringNumBands">SetMovieAudioFrequencyMeteringNumBands</a></code>. </p></li>
<li class="li"><p>Call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/GetMovieAudioFrequencyMeteringBandFrequencies">GetMovieAudioFrequencyMeteringBandFrequencies</a></code> if
you need to know the frequencies of the resulting bands.</p></li>
<li class="li"><p>Finally, make periodic calls to <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/GetMovieAudioFrequencyLevels">GetMovieAudioFrequencyLevels</a></code> to
obtain measurements in all specified bands. You can obtain either
the average values, the peak hold values, or both.</p></li></ol>
<p>For details, see</p>
<ul class="spaceabove"><li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMovieAudioVolumeMeteringEnabled">GetMovieAudioVolumeMeteringEnabled</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/SetMovieAudioVolumeMeteringEnabled">SetMovieAudioVolumeMeteringEnabled</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMovieAudioVolumeLevels">GetMovieAudioVolumeLevels</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMovieAudioFrequencyMeteringNumBands">GetMovieAudioFrequencyMeteringNumBands</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/SetMovieAudioFrequencyMeteringNumBands">SetMovieAudioFrequencyMeteringNumBands</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMovieAudioFrequencyMeteringBandFrequencies">GetMovieAudioFrequencyMeteringBandFrequencies</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMovieAudioFrequencyLevels">GetMovieAudioFrequencyLevels</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-795183" title="Audio Conversion, Export, and Extraction "></a><h3>Audio
Conversion, Export, and Extraction </h3>
<p>The new audio extraction API lets you retrieve mixed, uncompressed
audio from a movie. </p>
<p>Note that the audio extraction API currently <em>only</em> mixes
audio from sound tracks. Other media types, such as muxed MPEG-1
audio inside a program stream, are not currently supported.</p>
<p>To use the audio extraction API, follow these steps:</p>
<ol class="ol"><li class="li"><p>Begin by calling <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionBegin">MovieAudioExtractionBegin</a></code>.
This returns an opaque session object that you pass to subsequent
extraction routines.</p></li>
<li class="li"><p>You can then get the <code><a href="../../../../MusicAudio/Reference/CoreAudio/core_audio_types/core_audio_types.html#//apple_ref/doc/c_ref/AudioStreamBasicDescription" target="_top">AudioStreamBasicDescription</a></code> for
the audio or layout. Note that some properties are of variable size,
such as the channel layout, depending on the audio format, so getting
the information involves a two-step process. </p><ol class="ol"><li class="ol ol"><p>First,
you call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionGetPropertyInfo">MovieAudioExtractionGetPropertyInfo</a></code> to
find out how much space to allocate.</p></li>
<li class="ol ol"><p>Next, call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionGetProperty">MovieAudioExtractionGetProperty</a></code> to
obtain the actual value of the property.</p></li></ol></li>
<li class="li"><p>You can use the <code><a href="../../../../MusicAudio/Reference/CoreAudio/core_audio_types/core_audio_types.html#//apple_ref/doc/c_ref/AudioStreamBasicDescription" target="_top">AudioStreamBasicDescription</a></code> to
specify a different uncompressed format than Float 32. This causes
the extraction API to automatically convert from the stored audio
format into your specified format. </p></li>
<li class="li"><p>Use the <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionSetProperty">MovieAudioExtractionSetProperty</a></code> function
to specify channel remapping&#8211;&#8211;that is, a different layout&#8211;&#8211;sample
rate conversion, and preferred sample size. You can also use this
function to specify interleaved samples (default is non-interleaved)
or to set the movie time to an arbitrary point. </p></li></ol>
<p>Note that there are basically two things you set here: an
audio stream basic description (ASBD) and a channel layout. (ASBD
sets the format, sample, number of channels, interleavings, and
so on.)</p>
<p>Setup is now complete. You can now make a series of calls
to <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/MovieAudioExtractionFillBuffer">MovieAudioExtractionFillBuffer</a></code> to
receive uncompressed PCM audio in your chosen format. </p>
<ol class="ol"><li class="li"><p>The default is for the first call to begin extracting
audio at the start of the movie, and for subsequent calls to begin
where the last call left off, but you can set the extraction point
anywhere in the movie timeline by calling <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/MovieAudioExtractionSetProperty">MovieAudioExtractionSetProperty</a></code> and
setting the movie time.</p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/MovieAudioExtractionFillBuffer">MovieAudioExtractionFillBuffer</a></code> will
set <code><!--a  -->kMovieAudioExtractionComplete<!--/a--></code> in <em>outFlags</em> when
you reach the end of the movie audio.</p></li>
<li class="li"><p>You must call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/MovieAudioExtractionEnd">MovieAudioExtractionEnd</a></code> when
you are done. This deallocates internal buffers and data structures
that would otherwise continue to use memory and resources.</p></li></ol>
<p><em>A caveat: </em>Ideally, the uncompressed samples
would be bitwise identical whether you obtained the samples by starting
at the beginning of the movie and iterating through it, or by randomly
setting the movie time and extracting audio samples. This is typically
the case, but for some compression schemes the output of the decompressor
depends not only on the compressed sample, but the seed value in
the decompressor that remains after previous operations.</p>
<p>The current release of QuickTime does not perform the necessary
work to determine what the seed value would be when the movie time
is changed prior to extracting audio; while the extracted audio
is generally indistinguishable by ear, it may not always be bitwise identical.</p>
<p>For details about audio conversion, export, and extraction,
refer to the information about the following functions:</p>
<ul class="spaceabove"><li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionBegin">MovieAudioExtractionBegin</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionGetPropertyInfo">MovieAudioExtractionGetPropertyInfo</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionGetProperty">MovieAudioExtractionGetProperty</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionSetProperty">MovieAudioExtractionSetProperty</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionFillBuffer">MovieAudioExtractionFillBuffer</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MovieAudioExtractionEnd">MovieAudioExtractionEnd</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-795403" title="Standard Audio Compression Enhancements"></a><h3>Standard
Audio Compression Enhancements</h3>
<p>QuickTime 7 for Windows introduces a new standard compressor
component, <code>StandardCompressionSubTypeAudio</code>,
that adds the ability to configure high-resolution audio output
formats. It has a full set of component properties to make configuration easier,
especially when the developer wishes to bring up an application-specific
dialog, or no dialog, rather than the typical compression dialog.</p>
<p>This component essentially replaces the <code>StandardCompressionSubTypeSound</code> component, which
is limited to 1 or 2 channel sound with sampling rates of 65 kHz
or less. That component is retained for backward compatability with
existing code, but its use is no longer recommended.</p>
<p>The <code>StandardCompressionSubTypeAudio</code> component
is configured by getting and setting component properties, instead
of using GetInfo and SetInfo calls. These properties have a class
and ID, instead of just a single selector.</p>
<p>The component property API allows configuration at any level
of detail without requiring a user interface dialog or direct communication
with low-level components. </p>
<p>For details, refer to the section <span class="content_text"><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH314-549599">“Audio Property Selectors.”</a></span></p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_152" title="Note"></a><p><strong>Note:</strong>&nbsp;You can also
configure the new standard audio compression component by calling <code><a href="../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/doc/c_ref/SCSetSettingsFromAtomContainer" target="_top">SCSetSettingsFromAtomContainer</a></code>.
You can pass the new standard audio compression component either
a new atom container obtained from <code><a href="../../../Reference/QTRef_MovieComponents/Reference/reference.html#//apple_ref/doc/c_ref/SCGetSettingsAsAtomContainer" target="_top">SCGetSettingsAsAtomContainer</a></code> or
an old atom container returned by calling the same function (<code><!--a-->SCGetSettingsAsAtomContainer)<!--/a--></code> on
the old <code>SubTypeSound</code> component.</p></div>
<p>If you use <code><!--a-->MovieExportToDataRefFromProcedures<!--/a--></code>,
your getProperty proc will need to support some of these property
IDs as new selectors. Note that the Movie Exporter getProperty proc
API is not changing to add a class (the class is implied). </p>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_153" title="Note"></a><p><strong>Note:</strong>&nbsp;Not all properties
can be implemented by getProperty procs; the properties that getProperty
procs can implement are marked with the word &quot;DataProc&quot;.
See the inline documentation in <code>QuickTimeComponents.h</code> for
more information. </p></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-795502" title="Audio Export Enhancements"></a><h3>Audio
Export Enhancements</h3>
<p>Some movie export components now support high-resolution audio. </p>
<p>Export of high-resolution audio is transparent at the high
level. If you export from a movie containing high-resolution audio
to a format whose export component supports it, the transfer of
data is automatic; if the export component does not support high-resolution audio,
mix-down, resampling, and sound description conversion are automatic.</p>
<p>Export at the lower levels requires some additional code.
Your application must &#8220;opt in&#8221; to the new audio features explicitly
if it talks directly to an export component instance. (This is to
prevent applications that have inadvisedly chosen to &#8220;walk&#8221;
the opaque atom settings structure from crashing when they encounter
the new and radically different structure.) The following code snippet
(<span class="content_text">Listing 2-6</span>) illustrates the opt-in process.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-795529" title="Listing 2-6Opting in for high-resolution audio export"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-CJBJFDBC" title="Listing 2-6Opting in for high-resolution audio export"></a><p class="codesample"><strong>Listing 2-6&nbsp;&nbsp;</strong>Opting
in for high-resolution audio export</p>
<div class="codesample"><table><tr><td scope="row"><pre>ComponentInstance exporterCI;<span></span></pre></td></tr><tr><td scope="row"><pre>ComponentDescription search = { &#8217;spit&#8217;, &#8217;MooV&#8217;, &#8217;appl&#8217;, 0, 0 };<span></span></pre></td></tr><tr><td scope="row"><pre>Boolean useHighResolutionAudio = true, canceled;<span></span></pre></td></tr><tr><td scope="row"><pre>OSStatus err = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>Component c = FindNextComponent(NULL, &amp;search);<span></span></pre></td></tr><tr><td scope="row"><pre>exporterCI = OpenComponent(c);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Hey exporter, I understand high-resolution audio!!<span></span></pre></td></tr><tr><td scope="row"><pre>(void) QTSetComponentProperty(// disregard error<span></span></pre></td></tr><tr><td scope="row"><pre>        exporterCI,<span></span></pre></td></tr><tr><td scope="row"><pre>        kQTPropertyClass_MovieExporter,<span></span></pre></td></tr><tr><td scope="row"><pre>        kQTMovieExporterPropertyID_EnableHighResolutionAudioFeatures,<span></span></pre></td></tr><tr><td scope="row"><pre>        sizeof(Boolean),<span></span></pre></td></tr><tr><td scope="row"><pre>        &amp;useHighResolutionAudio);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>err = MovieExportDoUserDialog(exporterCI, myMovie, NULL, 0, 0, &amp;canceled);<span></span></pre></td></tr></table></div>
<p>For additional details, see <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH314-550563">&#8220;Movie Exporter Properties&#8221;</a></code>.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-796330" title="Video Enhancements"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BBCGDBDF" title="Video Enhancements"></a><h2>Video Enhancements</h2>
<p>QuickTime 7 for Windows introduces a number of important video
enhancements, discussed in this section. These include</p>
<ul class="ul"><li class="li"><p>Support for compressed video using frame reordering.
Support is added for compression, playback, streaming, and low-level
access to stored samples.</p></li>
<li class="li"><p>Support for H.264 video compression, including QuickTime components
for export, playback, and live streaming. </p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-662714" title="Frame Reordering Video"></a><h3>Frame
Reordering Video</h3>
<p>QuickTime 7 for Windows adds support for <strong>frame reordering</strong> video
compression. This is a major advance that involves new sample tables
for video to allow video frames to have independent decode and display
times. </p>
<p>The result of using frame reordering for video compression
is improved display and editing in H.264 and other advanced video
codec formats. Enhancements include a new API for working with media
sample times, adding and finding samples, and a new Image Compression
Manager (ICM) API.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-662727" title="Understanding Frame Reordering Video Compression"></a><h4>Understanding
Frame Reordering Video Compression</h4>
<p>QuickTime supports many types of video compression, including
spatial compression algorithms, such as photo-JPEG, and temporal
compression algorithms, in which some video frames are described
completely, while other frames are described in terms of their differences
from other video frames.</p>
<p>Up until the introduction of H.264 in QuickTime 7 for Windows,
video frames could be of three kinds:</p>
<ul class="spaceabove"><li class="li"><p>I-frames (independently decodable)</p></li>
<li class="li"><p>P-frames (predicted from a previous I- or P-frame)</p></li>
<li class="li"><p>B-frames (predicted from one past and one future I- or P-frame)</p></li></ul>
<div class="notebox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_154" title="Note"></a><p><strong>Note:</strong>&nbsp;B-frame, I-frame,
and P-frame are all video compression methods used by the MPEG standard. <strong>B-frame</strong> is
an abbreviation for <em>bi-directional</em> frame, or
bi-directional predictive frame. B-frames rely on the frames preceding
and following them and only contain data that has changed from the
preceding frame or is different from data in the next frame.</p><strong>P-frame</strong> is
an abbreviation for <em>predictive</em> frame, or predicted
frame. P-frames follow I-frames and contain only the data that has
changed from the preceding I-frame. P-frames rely on I-frames to
fill in most of its data.</p><strong>I-frame</strong>,
also known as keyframes, is an abbreviation for <em>intraframe</em>.
An I-frame stores all the data required to display the frame. In
common usage, I-frames are interspersed with P-frames and B-frames
in a compressed video. </p></div>
<p>Because B-frames predict from a future frame, that frame has
to be decoded before the B-frame, yet displayed after it; this is
why frame reordering is needed.The decoded order is no longer the
same as the displayed order.The QuickTime support for frame reordering is
quite general.In the H.264 codec, the concepts of the direction
of prediction, and the numbers of referenced frames, and the kind
of frame that is referenced, are all decoupled. In H.264, an encoder
may choose to make a stream in which P-frames refer to a future frame,
or a B-frame which refers to two past or future frames, for example.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_155" title="Important:"></a><p><strong>Important:</strong>&nbsp;
Prior to this release, QuickTime supported self-contained
video frames (keyframes, also called sync-frames or I-frames) and
frames that depended on previous frames (P-frames). Many modern
compressors also make use of frame reordering, in which frames can
depend on future frames.Those future frames have to be decoded before
the frame in question, but displayed after it&#8211;&#8211;hence the reordering. Traditional
B-frames are one example: they depend on a past and a future I-
or P-frame.That future I- or P-frame has to be given to the decoder before
the B-frame, but is displayed after the B-frame itself. This means
that the frames are stored or streamed in decode order, rather than in
display order.</p><p></p></div>
<p>For decompressors that don&#8217;t use frame reorderings, the
decode order and the display order are the same, and QuickTime sample
tables are traditionally organized to reflect this. Samples are
stored in decode order, which is presumed to be the display order,
and the sample tables specify the duration of each sample&#8217;s display;
the display time is the time when the track begins plus the duration
of all previous samples. </p>
<p>The addition of frame reordering support means that QuickTime
now has an optional sample table for video that specifies the offset
between the decode time and the display time. This allows frames
to be stored in decode order but displayed in a different order. The
decode time is still the beginning of the track plus the decode
duration of all previous samples, but it is now necessary to examine
the offset table to determine which samples precede others and calculate
the correct display time. </p>
<p>For high-level programmers, this all happens transparently.
Developers who work directly with sample numbers and sample times,
however, must be aware of this new feature. A new, expanded API
is available to support this.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-662770" title="Finding and Adding Samples"></a><h4>Finding
and Adding Samples</h4>
<p>Developers who need to work with specific samples based on
the samples&#8217; display times, or who are adding samples to a media
directly, need to use a different API when working with media that
uses frame reorderings.</p>
<p>For example, programmers who use the function <code><a href="../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/doc/c_ref/MediaTimeToSampleNum" target="_top">MediaTimeToSampleNum</a></code> must
instead use the two functions <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/MediaDecodeTimeToSampleNum">MediaDecodeTimeToSampleNum</a></code> and <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/MediaDisplayTimeToSampleNum">MediaDisplayTimeToSampleNum</a></code> when
working with frame reordering compressed video, as each sample now
has a decode time and a display time instead of a single media time
(combined decode/display time). </p>
<p>Similarly, when adding samples to a media that permits display
offsets, it is necessary to use the new <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/AddMediaSample2">AddMediaSample2</a></code> instead
of <code><a href="../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/doc/c_ref/AddMediaSample" target="_top">AddMediaSample</a></code>, as the new function
permits the user to pass a display offset and specify properties
that are unique to media with display offsets, such as whether subsequent
samples are allowed to have earlier display times than the current
sample.</p>
<p>Calling one of the old functions that use a single media time
value on new-format media that contains display offsets will return
the error code <code><!--a  -->kQTErrMediaHasDisplayOffsets<!--/a--></code>.</p>
<p>The new API elements all use 64-bit time values, whereas the
older API elements use 32-bit values. Calling one of the old functions
with a 64-bit time value returns the error code <code><!--a  -->kQTErrTimeValueTooBig<!--/a--></code>.</p>
<p>When creating a media for frame reordering compressed video
track, pass in the new flag <code><!--a  -->kCharacteristicSupportsDisplayOffsets<!--/a--></code>.</p>
<p>For details, see:</p>
<ul class="spaceabove"><li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/AddMediaSample2">AddMediaSample2</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ExtendMediaDecodeDurationToDisplayEndTime">ExtendMediaDecodeDurationToDisplayEndTime</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaAdvanceDecodeTime">GetMediaAdvanceDecodeTime</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaDataSizeTime64">GetMediaDataSizeTime64</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaDecodeDuration">GetMediaDecodeDuration</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaDisplayDuration">GetMediaDisplayDuration</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaDisplayEndTime">GetMediaDisplayEndTime</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaDisplayStartTime">GetMediaDisplayStartTime</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaNextInterestingDecodeTime">GetMediaNextInterestingDecodeTime</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaNextInterestingDisplayTime">GetMediaNextInterestingDisplayTime</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetMediaSample2">GetMediaSample2</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MediaContainsDisplayOffsets">MediaContainsDisplayOffsets</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MediaDecodeTimeToSampleNum">MediaDecodeTimeToSampleNum</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/MediaDisplayTimeToSampleNum">MediaDisplayTimeToSampleNum</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/TrackTimeToMediaDisplayTime">TrackTimeToMediaDisplayTime</a></code></p></li></ul>
<p>There is additional support for programmers who work directly
with arrays of media sample references. Although these new functions
work with frame reordering video or other media with independent
decode and display times, they can also be used with ordinary media
types. See <span class="content_text"><a href="02QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH313-678597">“QuickTime Sample Table API.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-662994" title="Compressing Video Using Frame Reordering"></a><h4>Compressing
Video Using Frame Reordering</h4>
<p>When compressing video that uses frame reordering, there is
no longer a one-to-one correspondence between submitting a frame
for compression and getting back a compressed sample. The Image
Compression Manager (ICM) and the compressor component may buffer
multiple images before determining that a series of frames should be
B-frames and a subsequent image should be decompressed out of order
so that the B-frames can refer to it. The new ICM functions do not
require a strict correlation between input frames and output frames.
Frames may be rearranged by compression and decompression modules. </p>
<p>The new functions allow groups of multiple pixel buffers to
be in use at various processing points in order to avoid unnecessary
copying of data, using <code>CVPixelBuffers</code> and <code>CVPixelBufferPool</code>s.
These new types are Core Foundation based. They follow Core Foundation&#8217;s
protocols for reference counting (create/copy/retain/release). Each
type has its own retain and release functions which are type-safe
and NULL-safe, but otherwise equivalent to <code><a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFRetain" target="_top">CFRetain</a></code> and <code><a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFRelease" target="_top">CFRelease</a></code>.
Note that the CVPixelBuffer functions generally provide their output
data through callbacks, rather than as return values or function parameters.</p>
<p>In general, the new functions return <code><a href="../../../Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/OSStatus" target="_top">OSStatus</a></code>,
with the exception of some simple Get functions that return single
values.</p>
<p>Clients create compression sessions using <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionCreate">ICMCompressionSessionCreate</a></code>. They
then feed pixel buffers in display order to <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionEncodeFrame">ICMCompressionSessionEncodeFrame</a></code>.
Encoded frames may not be output immediately, and may not be returned
in the same order as they are input&#8212;encoded frames will be returned
in decode order, which will sometimes differ from display order.
One of the parameters to <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/ICMCompressionSessionCreate">ICMCompressionSessionCreate</a></code> specifies
a callback routine that QuickTime will call when each encoded frame
is ready. Frames should be stored in the order they are output (decode order).</p>
<p>To force frames up to a certain display time to be encoded
and output, call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionCompleteFrames">ICMCompressionSessionCompleteFrames</a></code>.</p>
<p>To obtain a pixel buffer pool that satisfies the requirements
of both your pixel buffer producer and the compressor, pass the
pixel buffer producer&#8217;s pixel buffer options into <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/ICMCompressionSessionCreate">ICMCompressionSessionCreate</a></code>,
and then call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionGetPixelBufferPool">ICMCompressionSessionGetPixelBufferPool</a></code>. The compression session constructs an appropriate pixel
buffer pool. </p>
<p>Alternatively, you can create your own pixel buffer pool by
obtaining the compressor&#8217;s pixel buffer attributes, choosing a
format compatible with your pixel buffer producer, and setting that
compressor&#8217;s input format using the component properties API.
The process of obtaining the pixel buffer attributes is illustrated
in the following code snippet.</p>
<div class="codesample"><table><tr><td scope="row"><pre>CFDictionaryRef attributesDictionary = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>err = ICMCompressionSessionGetProperty(<span></span></pre></td></tr><tr><td scope="row"><pre>    session,<span></span></pre></td></tr><tr><td scope="row"><pre>    kQTPropertyClass_ICMCompressionSession,<span></span></pre></td></tr><tr><td scope="row"><pre>    kICMCompressionSessionPropertyID_CompressorPixelBufferAttributes,<span></span></pre></td></tr><tr><td scope="row"><pre>    sizeof(CFDictionaryRef),<span></span></pre></td></tr><tr><td scope="row"><pre>    &amp;attributesDictionary,<span></span></pre></td></tr><tr><td scope="row"><pre>    NULL);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>if (attributesDictionary) {<span></span></pre></td></tr><tr><td scope="row"><pre>    // ...use...<span></span></pre></td></tr><tr><td scope="row"><pre>    CFRelease(attributesDictionary);<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div>
<p>You can also pass arbitrary pixel buffers to <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/ICMCompressionSessionEncodeFrame">ICMCompressionSessionEncodeFrame</a></code>;
if they&#8217;re incompatible with the compressor&#8217;s requirements,
then the compression session will make compatible copies and pass
those to the compressor. This requires less setup but can result in
significantly slower operation.</p>
<p>When the compressor no longer needs a source pixel buffer,
it will release it. You may also pass <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/ICMCompressionSessionEncodeFrame">ICMCompressionSessionEncodeFrame</a></code> a
callback to be called when the source pixel buffer is released.</p>
<p>Clients may call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionGetImageDescription">ICMCompressionSessionGetImageDescription</a></code> to get the image description for the encoded frames.
Where possible, the ICM will allow this to be called before the
first frame is encoded.</p>
<p>For additional details, see:</p>
<ul class="spaceabove"><li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionCreate">ICMCompressionSessionCreate</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionGetProperty">ICMCompressionSessionGetProperty</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionGetPixelBufferPool">ICMCompressionSessionGetPixelBufferPool</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionEncodeFrame">ICMCompressionSessionEncodeFrame</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionGetImageDescription">ICMCompressionSessionGetImageDescription</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/ICMCompressionSessionCompleteFrames">ICMCompressionSessionCompleteFrames</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-663251" title="H.264 Codec"></a><h3>H.264
Codec</h3>
<p>The H.264 codec is the latest standards-based video codec.
Published jointly by the ITU as H.264&#8211;&#8211;Advanced Video Coding,
and by ISO as MPEG-4 Part 10&#8211;&#8211;Advanced Video Coding, the H.264
codec promises better image quality at lower bit rates than the
current MPEG-4 video codec, and also better live streaming characteristics
than the current H.263 codec.</p>
<p>This represents a significant increase in quality and performance,
while operating in a standards-based framework.</p>
<p>QuickTime 7 for Windows includes a QuickTime decompressor
component and an exporter component for creating and playing H.264-encoded
video in QuickTime.</p>
<p>The H.264 codec makes use of QuickTime 7&#8217;s new support for
frame reordering video compression.</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-556033" title="Replacing NewMovieFrom... Functions"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BBCJJGHE" title="Replacing NewMovieFrom... Functions"></a><h2>Replacing NewMovieFrom...
Functions</h2>
<p>QuickTime 7 for Windows introduces a replacement&#8211;&#8211;<code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/NewMovieFromProperties">NewMovieFromProperties</a></code>&#8211;&#8211;
for <code><a href="../../../Reference/QTRef_MovieManager/Reference/reference.html#//apple_ref/doc/c_ref/NewMovie" target="_top">NewMovie</a></code>, <code><a href="../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/doc/c_ref/NewMovieFromDataRef" target="_top">NewMovieFromDataRef</a></code>,
and all other <code>NewMovieFrom...</code> functions. </p>
<p>In previous versions of QuickTime, you could use other functions
that create new movies, including <code><a href="../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/doc/c_ref/NewMovieFromFile" target="_top">NewMovieFromFile</a></code> and <code><a href="../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/doc/c_ref/NewMovieFromDataRef" target="_top">NewMovieFromDataRef</a></code>.
These functions accept flags that allow you to set some movie characteristics
at creation time, but other movie characteristics are always set
by default. For example, there must be a valid graphics port associated
with a movie created by these functions, even if the movie does
not output video.</p>
<p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/NewMovieFromProperties">NewMovieFromProperties</a></code> allows
you to configure an extensible set of properties before creating
a movie. This has a number of advantages. </p>
<ul class="ul"><li class="li"><p>You can open a movie with exactly the properties
you want, preventing QuickTime from taking undesired default actions. </p></li>
<li class="li"><p>You can also specify properties that the older functions do
not know about, such as a visual context for the movie. </p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-738759" title="Using NewMovieFromProperties"></a><h3>Using
NewMovieFromProperties</h3>
<p>To instantiate a movie using <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/NewMovieFromProperties">NewMovieFromProperties</a></code>,
follow these steps:</p>
<ol class="ol"><li class="li"><p>Pass in a CFString file path, a URL, or set up
a data reference, just as you would for <code><a href="../../../Reference/QTRef_MovieToolkit/Reference/reference.html#//apple_ref/doc/c_ref/NewMovieFromDataRef" target="_top">NewMovieFromDataRef</a></code> or
one of the other <code>NewMovieFrom_</code> functions.</p></li>
<li class="li"><p>Next, set up a visual context for the movie to use by calling
a function that creates a context of a the desired type, such as <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/QTOpenGLTextureContextCreate">QTOpenGLTextureContextCreate</a></code>.
Similarly, you can set up an audio context if you want a device
other than the default device.</p></li>
<li class="li"><p>Call <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/NewMovieFromProperties">NewMovieFromProperties</a></code>, passing
in the data reference for the movie and the <code>QTVisualContextRef</code> for
the visual context, plus any appropriate properties listed in the <code>QTNewMoviePropertyArray</code>. </p></li></ol>
<p>Properties are passed in using a <code>QTNewMoviePropertyElement</code> struct,
which specifies the property class and property ID of each property.</p>
<p>The movie will automatically retain the visual context, so
if your application does not need to work with the context directly,
you may release it now.</p>
<p>For additional details, see:</p>
<ul class="spaceabove"><li class="li"><p><code><!--a-->QTNewMoviePropertyArray<!--/a--></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/QTNewMoviePropertyElement">QTNewMoviePropertyElement</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/NewMovieFromProperties">NewMovieFromProperties</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-674504" title="QuickTime Metadata Enhancements and API"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BBCBDDGA" title="QuickTime Metadata Enhancements and API"></a><h2>QuickTime Metadata
Enhancements and API</h2>
<p>QuickTime 7 for Windows introduces a new extensible metadata
storage format that allows more flexible and efficient storage of
metadata, including encapsulated storage of metadata in native format
(without translating to and from a defined QuickTime format). For
developers, this means that you can now write cleaner, more generic
code that enables you to look at, for example, all the metadata
in a QuickTime or iTunes music track using just a single function
call.</p>
<p>Metadata, of course, is information about a file, track, or
media, such as the white balance used to create a photographic image
or the artist, album, and title of an MP3 track. Traditionally,
metadata information is stored in QuickTime user data items or in
ancilliary tracks in a movie. For example, copyright information
is normally stored in a <code>&#8217;@cpy&#8217;</code> user data
item, while cover art for an AAC audio track is normally stored
in a track that is not displayed by all applications. </p>
<p>The new metadata enhancements in QuickTime 7 for Windows allow
you to access both old (QuickTime) and new (iTunes) formats. The
new metadata storage format is intended as a replacement for QuickTime
user data, which was limited in features and robustness. Specifically,
the metadata enhancements introduced in QuickTime 7 for Windows
provide the following capabilities:</p>
<ul class="ul"><li class="li"><p>The ability to assign data types to any metadata
that you place into the new storage format.</p></li>
<li class="li"><p>The ability to assign locale information&#8211;&#8211;for example,
a particular language or country&#8211;&#8211;to the format.</p></li>
<li class="li"><p>The ability to use a more descriptive key in the storage format&#8211;&#8211;for
example, a reverse DNS format, such as com.apple.quicktime.mov.</p></li></ul>
<p>The new metadata format allows storage of data that is not
possible in user data items, without extending the list of item
types exhaustively, and allows labeling of metadata unambiguously,
rather than as data in an undisplayed media track. It also permits inclusion
of metadata that is always stored external to the movie, even when
the movie is flattened (saved as self-contained).</p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-736459" title="How It Works"></a><h3>How
It Works</h3>
<p>Metadata is encapsulated in an opaque container and accessed
using a <code>QTMetDataRef</code>.
A <code><!--a  -->QTMetaDataRef<!--/a--></code> represents a metadata
repository consisting of one or more native metadata containers.
The QuickTime metadata API supports unified access to and management
of these containers.</p>
<p>Each container consists of some number of metadata items.
Metadata items correspond to individually labeled values with characteristics
such as keys, data types, locale information, and so on. Note that
what QuickTime calls <em>items</em> are sometimes referred
to as <em>attributes</em> or <em>properties</em> in
other metadata systems.</p>
<p>You address each container by its storage format (<code><!--a  -->kQTMetaDataStorageFormat<!--/a--></code>).
Initially, there is support for classic QuickTime user data items,
iTunes metadata, and a richer QuickTime metadata container format.
A <code><!--a  -->QTMetaDataRef<!--/a--></code> may have one or all
of these. No direct access to the native storage containers is provided.</p>
<p><code><!--a  -->QTMetaDataRefs<!--/a--></code> may be associated
with a movie, track or media. This parallels user data atoms usage
but provides access to other kinds of metadata storage at those
levels.</p>
<p>A metadata item is assigned a runtime identifier (<code><!--a  -->QTMetaDataItem<!--/a--></code>)
that along with the <code><!--a  -->QTMetaDataRef<!--/a--></code> identifies
the particular item (and value) across all native containers managed
by the <code><!--a  -->QTMetaDataRef<!--/a--></code>.</p>
<p>Each item is addressed by a key, or label. The key is not
necessarily unique within its container, as it is possible to have
multiple items with the same key (for example, multiple author items).
Functions exist to enumerate all items or only items with a particular
key.</p>
<p>Because a <code><!--a  -->QTMetaDataRef<!--/a--></code> may
provide access to different native metadata containers with differing
key structures&#8212;a four-char-code for one, a string for another,
and so on&#8212;the key structure is also specified. A <code><!--a  -->QTMetaDataKeyFormat<!--/a--></code> indicates
the key structure to functions that take keys. This also supports
container formats that allow multiple key structures or multiple
versions of key structures.</p>
<p>To allow unified access across disparate containers, you can
specify a wildcard storage format. This can be used for operations
such as searches across container formats. A special key format
called <code><!--a  -->kQTMetaDataKeyFormatCommon<!--/a--></code> indicates
one of a set of common keys that can be handled by multiple native
containers (for example, copyright). </p>
<p>Both modes of operation are illustrated in <span class="content_text">Figure 2-6</span>. </p>
<br/><div><a name="//apple_ref/doc/uid/TP40002476-CH313-736572" title="Figure 2-6Metadata modes of operations "></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BABIEJGG" title="Figure 2-6Metadata modes of operations "></a><p><strong>Figure 2-6&nbsp;&nbsp;</strong>Metadata modes of operations </p>
<img src = "../art/MetaDataDiagram.jpg" alt = "" ></div><br/>
<a name="//apple_ref/doc/uid/TP40002476-CH313-736619" title="Advantages of the New Metadata Format"></a><h3>Advantages
of the New Metadata Format</h3>
<p>The QuickTime metadata format is inherently extensible. Instead
of a set of structures and enumerated parameters, the metadata API
uses a set of properties that can be enumerated, and whose characteristics
can be discovered, dynamically at runtime. This is analogous to the
QuickTime component property function in that you first get the
property info, such as its size and format, and then you allocate
the appropriate container or structure to get or set the actual
property.</p>
<p>The new QuickTime metadata format and API consist of the following
structures, enumerations, and functions, grouped in sections followed
by the specific functions:</p>
<ul class="spaceabove"><li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH314-553195">&#8220;Metadata Format Constants&#8221;</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH314-553378">&#8220;Metadata Property IDs&#8221;</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH314-553720">&#8220;Metadata Key Constants&#8221;</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/uid/TP40002476-CH314-625909">&#8220;Metadata Error Codes&#8221;</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTCopyMovieMetaData">QTCopyMovieMetaData</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTCopyTrackMetaData">QTCopyTrackMetaData</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTCopyMediaMetaData">QTCopyMediaMetaData</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataAddItem">QTMetaDataAddItem</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataGetItemCountWithKey">QTMetaDataGetItemCountWithKey</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataGetItemProperty">QTMetaDataGetItemProperty</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataGetItemPropertyInfo">QTMetaDataGetItemPropertyInfo</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataGetItemValue">QTMetaDataGetItemValue</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataGetNextItem">QTMetaDataGetNextItem</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataGetProperty">QTMetaDataGetProperty</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataGetPropertyInfo">QTMetaDataGetPropertyInfo</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataRetain">QTMetaDataRetain</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataRelease">QTMetaDataRelease</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataRemoveItem">QTMetaDataRemoveItem</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataRemoveItemsWithKey">QTMetaDataRemoveItemsWithKey</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataSetItem">QTMetaDataSetItem</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataSetItemProperty">QTMetaDataSetItemProperty</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTMetaDataSetProperty">QTMetaDataSetProperty</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-678597" title="QuickTime Sample Table API"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BBCDCDGC" title="QuickTime Sample Table API"></a><h2>QuickTime Sample
Table API</h2>
<p>The new QuickTime sample table API in QuickTime 7 for Windows
is used when you need to obtain information about samples&#8212;such
as their size, location, and sample descriptions&#8212;or to set this
kind of information (for example, when adding samples or blocks
of samples to a media directly, without using the services of an
importer).</p>
<p>This new API introduces <code>QTSampleTable</code> as
a logical replacement for the arrays of sample reference records
used with the older functions <code><a href="../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/doc/c_ref/AddMediaSampleReferences" target="_top">AddMediaSampleReferences</a></code> and <code><a href="../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/doc/c_ref/AddMediaSampleReferences64" target="_top">AddMediaSampleReferences64</a></code>.
New functions allow you to operate on whole tables of data simultaneously.</p>
<p>Like many new QuickTime APIs, the QuickTime sample table API
uses opaque data types whose properties can be discovered dynamically
at runtime. This is analogous to the component properties API for
configuring components. You use a <code><a href="../../../../MusicAudio/Reference/CoreAudio/audiocodec/audiocodec.html#//apple_ref/doc/c_ref/GetPropertyInfo" target="_top">GetPropertyInfo</a></code> function
to discover the size and format of a property, then allocate the
necessary container or structure to get or set the actual property.</p>
<p>This API works with both simple media types that have a single
media time for each sample and new media types such as frame reordering
video that have independent decode and display times for samples.</p>
<div class="warningbox"><img src="../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_156" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;
When using the QuickTime sample table API to work with
constant-bit-rate (CBR) compressed audio, the audio is represented
in a new way.</p><p></p><div class="clear"></div></div>
<p>In the QuickTime sample table API, sample numbers for audio
always refer to packets. This is simpler and more consistant, but
it means that a new function may not return the same value as an
older, analogous function when called with reference to compressed
CBR sound. For example, <code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/doc/c_ref/QTSampleTableGetNumberOfSamples">QTSampleTableGetNumberOfSamples</a></code> may
return a different sample count than <code><a href="../../../Reference/QTRef_TrackAndMedia/Reference/reference.html#//apple_ref/doc/c_ref/GetMediaSampleCount" target="_top">GetMediaSampleCount</a></code>.</p>
<p>All compressed audio is quantized into packets, and each packet
can be decompressed into multiple PCM samples. With previous APIs,
media sample numbers for CBR sound refer to PCM samples, rather
than the compressed packets. When the same APIs are applied to variable-bit-rate
(VBR) sound, however, the sample numbers refer to packets. This
inconsistency means that code using these older APIs must handle
CBR and VBR differently. In this API, by contrast, sample numbers
always refer to packets.</p>
<p>This applies only to <em>compressed</em> CBR sound,
however. In uncompressed sound tracks, each packet is simply an
uncompressed PCM frame, so the value is the same whether the sample
number refers to packets or PCM samples.</p>
<p>For full details of the QuickTime sample table API, see:</p>
<ul class="ul"><li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableCreateMutable">QTSampleTableCreateMutable</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableCreateMutableCopy">QTSampleTableCreateMutableCopy</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableAddSampleDescription">QTSampleTableAddSampleDescription</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableCopySampleDescription">QTSampleTableCopySampleDescription</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableAddSampleReferences">QTSampleTableAddSampleReferences</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/AddSampleTableToMedia">AddSampleTableToMedia</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/CopyMediaMutableSampleTable">CopyMediaMutableSampleTable</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableReplaceRange">QTSampleTableReplaceRange</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetProperty">QTSampleTableGetProperty</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableSetProperty">QTSampleTableSetProperty</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetPropertyInfo">QTSampleTableGetPropertyInfo</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetNumberOfSamples">QTSampleTableGetNumberOfSamples</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetSampleDescriptionID">QTSampleTableGetSampleDescriptionID</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetDataSizePerSample">QTSampleTableGetDataSizePerSample</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetSampleFlags">QTSampleTableGetSampleFlags</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetDataOffset">QTSampleTableGetDataOffset</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetDisplayOffset">QTSampleTableGetDisplayOffset</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetTypeID">QTSampleTableGetTypeID</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetDecodeDuration">QTSampleTableGetDecodeDuration</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetNextAttributeChange">QTSampleTableGetNextAttributeChange</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableGetTimeScale">QTSampleTableGetTimeScale</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableRelease">QTSampleTableRelease</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableReplaceRange">QTSampleTableReplaceRange</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableRetain">QTSampleTableRetain</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTSampleTableSetTimeScale">QTSampleTableSetTimeScale</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-788325" title="Other Changes and Enhancements"></a><a name="//apple_ref/doc/uid/TP40002476-CH313-BAJFHABC" title="Other Changes and Enhancements"></a><h2>Other Changes
and Enhancements</h2>
<p>This section discusses the following changes and enhancements
that are available in QuickTime 7 for Windows. </p>
<a name="//apple_ref/doc/uid/TP40002476-CH313-829626" title="New Install Location"></a><h3>New
Install Location</h3>
<p>Beginning with QuickTime 7 for Windows, the default install
location for QuickTime has been moved from the directory:</p>
<p><code>\Windows\System32\QuickTime</code></p>
<p>to</p>
<p><code>\Program Files\QuickTime</code></p>
<p>Optionally, the user may specify a custom install location
when performing the installation.</p>
<p>The QuickTime installer will also create a number of subdirectories
within the QuickTime directory where the various QuickTime files
are stored. For example, a QuickTime System directory <code>QTSystem</code> is
created as follows:</p>
<p><code>\QuickTime\QTSystem</code></p>
<p>to store the various QuickTime system files.</p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_157" title="Important:"></a><p><strong>Important:</strong>&nbsp;
Developers should use the QuickTime APIs and registry
locations to determine at runtime where QuickTime is installed.</p><p></p></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-829751" title="New QuickTime DLL"></a><h4>New
QuickTime DLL</h4>
<p>To allow for compatability with applications which rely on
the presence of QuickTime in the old</p>
<p><code>\Windows\System32\QuickTime</code></p>
<p>directory, QuickTime 7 will install a DLL file for purposes
of backward compatibility named<code> QuickTime.qts</code> to
this same directory. This file will do the work of finding the new QuickTime
file locations forapplications that explicitly look in the old location
or that use an SDK older than the QuickTime 6 SDK. </p>
<div class="importantbox"><a name="//apple_ref/doc/uid/TP40002476-CH313-DontLinkElementID_158" title="Important:"></a><p><strong>Important:</strong>&nbsp;
Developers updating their applications should not rely
on the presence of this file and should update any code which expects
QuickTime in the old location. Instead, use the new QuickTime directories
APIs to locate installed QuickTime files. In the end, developers
are strongly advised to update their applications. Apple cannot guarantee
that the DLL file for backward compatibility will be available beyond
this release. </p><p></p></div>
<a name="//apple_ref/doc/uid/TP40002476-CH313-829847" title="New QuickTime Directories APIs"></a><h4>New
QuickTime Directories APIs</h4>
<p>A number of new APIs have been created to allow developers
to locate the various directories created by the QuickTime installer.
These APIs are similar in style to the <code><!--a-->Win32 GetSystemDirectory<!--/a--></code> function.
All of these APIs are non-dispatched and work without having to
call <code><!--a-->InitializeQTML<!--/a--></code> beforehand. </p>
<p>For full details of the new QuickTime directories APIs, see:</p>
<ul class="spaceabove"><li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetQTApplicationDirectory">GetQTApplicationDirectory</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetQTComponentDirectory">GetQTComponentDirectory</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetQTExtensionDirectory">GetQTExtensionDirectory</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/GetQTSystemDirectory">GetQTSystemDirectory</a></code></p></li>
<li class="li"><p><code><a href="../Chapter03/03QT7_Update_Guide.html#//apple_ref/c/func/QTLoadLibrary">QTLoadLibrary</a></code></p></li></ul>
<a name="//apple_ref/doc/uid/TP40002476-CH313-788402" title="Updates to QuickTime for Java"></a><h3>Updates
to QuickTime for Java</h3>
<p>QuickTime for Java (QTJ) is now fully supported in QuickTime
7 for Windows. QTJ is now installed by default in QuickTime 7. </p>
<p>This release includes a number of important bug fixes requested
by QuickTime for Java developers. These are as follows:</p>
<ul class="spaceabove"><li class="li"><p>Major fixes for issues related to drawing and
correct QTComponent rendering</p></li>
<li class="li"><p>Compatibility with headless applications</p></li>
<li class="li"><p>Fixes for issues related to movie progress procedures and
movie exporting</p></li>
<li class="li"><p>Fixes for Applet issues, including support for MPEG video
playback in an applet </p></li>
<li class="li"><p>Support for 2-byte character file names</p></li>
<li class="li"><p>Security fixes</p></li></ul>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Chapter01/Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Chapter03/03QT7_Update_Guide.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-11-09<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/Conceptual/QT7Win_Update_Guide/Chapter02/02QT7_Update_Guide.html%3Fid%3DTP40002476-1.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/Conceptual/QT7Win_Update_Guide/Chapter02/02QT7_Update_Guide.html%3Fid%3DTP40002476-1.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/Conceptual/QT7Win_Update_Guide/Chapter02/02QT7_Update_Guide.html%3Fid%3DTP40002476-1.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>