<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Sound Files (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING61></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-60.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-62.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-44.html"><B>Chapter 2 - Sound Manager</B></A> / <A HREF="Sound-59.html"><B>Sound Storage Formats</B></A></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="../../../referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING61-0></A>
<H2><A NAME=MARKER-9-424></A>Sound Files<A NAME=MARKER-2-425></A></H2>
 <A NAME=MARKER-2-426></A>This section describes in detail the structure of AIFF and AIFF-C files. Both of these types of sound files are collections of <B>chunks</B> that define characteristics of the sampled sound or other relevant data about the sound.<A NAME=MARKER-2-427></A><P>
<DL>
<DT><B>Note</B>
<DD>Most applications only need to read AIFF and AIFF-C files or to record sampled-sound data directly to them. You can both play and record AIFF and AIFF-C files without knowing the details of the AIFF and AIFF-C file formats, as explained in the chapter <A HREF=Sound-13.html#MARKER-9-6>"Introduction to Sound on the Macintosh"</A> in this book. Thus, the information in this section is for advanced programmers only.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 Currently, the AIFF and AIFF-C specifications include the following chunk types.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Chunk type<A NAME=MARKER-9-130></A><TH>Description<TR>
<TD>Form Chunk<TD>Contains information about the format of an AIFF or AIFF-C file and contains all the other chunks of such a file.<A NAME=MARKER-2-17></A><TR>
<TD>Format Version Chunk<TD>Contains an indication of the version of the AIFF-C specification according to which this file is structured (AIFF-C only).<A NAME=MARKER-9-168></A><TR>
<TD>Common Chunk<TD>Contains information about the sampled sound such as the sampling rate and sample size.<A NAME=MARKER-2-90></A><TR>
<TD>Sound Data Chunk<TD>Contains the sample frames that comprise the sampled sound.<A NAME=MARKER-2-5></A><TR>
<TD>Marker Chunk<TD>Contains markers that point to positions in the sound data<A NAME=MARKER-2-6></A>.<TR>
<TD>Comments Chunk<TD>Contains comments about markers in the file<A NAME=MARKER-2-7></A>.<TR>
<TD>Sound Accelerator Chunk<TD>Contains information intended to allow applications to accelerate the decompression of compressed audio data<A NAME=MARKER-2-8></A>.<TR>
<TD>Instrument Chunk<TD>Defines basic parameters that an instrument (such as a sampling keyboard) can use to play back the sound data<A NAME=MARKER-2-9></A>.<TR>
<TD>MIDI Data Chunk<TD>Contains MIDI data.<A NAME=MARKER-2-10></A><TR>
<TD>Audio Recording Chunk<TD>Contains information pertaining to audio recording devices.<A NAME=MARKER-2-11></A><TR>
<TD>Application Specific Chunk<TD>Contains application-specific information.<A NAME=MARKER-2-12></A><TR>
<TD>Name Chunk<TD>Contains the name of the sampled sound.<A NAME=MARKER-2-13></A><TR>
<TD>Author Chunk<TD>Contains one or more names of the authors (or creators) of the sampled sound.<A NAME=MARKER-9-151></A><TR>
<TD>Copyright Chunk<TD>Contains a copyright notice for the sampled sound.<A NAME=MARKER-2-15></A><TR>
<TD>Annotation Chunk<TD>Contains a comment.<A NAME=MARKER-2-16></A><A NAME=MARKER-2-17></A></TABLE>
<P>
 The following sections document the four principal kinds of chunks that can occur in AIFF and AIFF-C files.<A NAME=MARKER-2-155></A><P>
<A NAME=HEADING61-5></A>
<H3>Chunk Organization and Data Types<A NAME=MARKER-2-116></A></H3>
 An AIFF or AIFF-C file contains several different types of chunks. For example, there is a Common Chunk that specifies important parameters of the sampled sound, such as its size and sample rate. There is also a Sound Data Chunk that contains the actual audio samples. A chunk consists of some header information followed by some data. The header information consists of a chunk ID number and a number that indicates the size of the chunk data. In general, therefore, a chunk has the structure shown in <A HREF=#MARKER-9-432>Figure 2-6</A>.<A NAME=MARKER-2-430></A><A NAME=MARKER-9-471></A><P>
<B>Figure 2-6  <A NAME=MARKER-9-432></A>The general structure of a chunk</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SM-L-05.jpg"><P>
 The header information of a chunk has this structure:<P>
<PRE>
TYPE ChunkHeader =
RECORD
   ckID:    ID;         {chunk type ID}
   ckSize:  LongInt;    {number of bytes of data}
END;
</PRE>
 The <CODE>ckID</CODE> field specifies the chunk type. An ID is a 32-bit concatenation of any four printable ASCII characters in the range <CODE>' '</CODE> (space character, ASCII value $20) through <CODE>'~'</CODE> (ASCII value $7E). Spaces cannot precede printing characters, but trailing spaces are allowed. Control characters are not allowed. You can specify values for the four types of chunks described later by using these constants:<P>
<PRE>
CONST
   FormID            = 'FORM';   {ID for Form Chunk}
   FormatVersionID   = 'FVER';   {ID for Format Version Chunk}
   CommonID          = 'COMM';   {ID for Common Chunk}
   SoundDataID       = 'SSND';   {ID for Sound Data Chunk}
</PRE>
 The <CODE>ckSize</CODE> field specifies the size of the data portion of a chunk and does not include the length of the chunk header information.<A NAME=MARKER-2-443></A><P>
<A NAME=HEADING61-14></A>
<H3>The Form Chunk<A NAME=MARKER-2-434></A><A NAME=MARKER-2-534></A></H3>
 The chunks that define the characteristics of a sampled sound and that contain the actual sound data are grouped together into a container chunk, known as the Form Chunk. The Form Chunk defines the type and size of the file and holds all remaining chunks in the file. The chunk ID for this container chunk is <CODE>'FORM'</CODE>. <P>
 A chunk of type <CODE>'FORM'</CODE> has this structure:<P>
<PRE>
TYPE ContainerChunk =
RECORD
   ckID:       ID;         {'FORM'}
   ckSize:     LongInt;    {number of bytes of data}
   formType:   ID;         {type of file}
END;
</PRE>
 For a Form Chunk, the <CODE>ckSize</CODE> field contains the size of the data portion of this chunk. Note that the data portion of a Form Chunk is divided into two parts, <CODE>formType</CODE> and the rest of the chunks of the file, which follow the <CODE>formType</CODE> field. These chunks are called <I>local chunks</I> because their chunk IDs are local to the Form Chunk.<P>
 The local chunks can occur in any order in a sound file. As a result, your application should be designed to get a local chunk, identify it, and then process it without making any assumptions about what kind of chunk it is based on its order in the Form Chunk.<A NAME=MARKER-2-436></A><P>
 The <CODE>formType</CODE> field of the Form Chunk specifies the format of the file. For AIFF files, <CODE>formType</CODE> is <CODE>'AIFF'</CODE>. For AIFF-C files, <CODE>formType</CODE> is <CODE>'AIFC'</CODE>. Note that this type might not be the same as the operating-system type with which the File Manager identifies the file. In particular, a file of operating-system type <CODE>'AIFC'</CODE> might be formatted as an AIFF file.<P>
<A NAME=HEADING61-21></A>
<H3>The Format Version Chunk</H3>
 One difference between the AIFF and AIFF-C file formats is that files of type AIFF-C contain a Format Version Chunk and files of type AIFF do not. The Format Version Chunk contains a <CODE>timestamp</CODE> field that indicates when the format version of this AIFF-C file was defined. This in turn indicates what format rules this file conforms to and allows you to ensure that your application can handle a particular AIFF-C file. Every AIFF-C file must contain one and only one Format Version Chunk.<P>
 In AIFF-C files, a Format Version Chunk has this structure:<P>
<PRE>
TYPE FormatVersionChunk =
RECORD
   ckID:       ID;         {'FVER'}
   ckSize:     LongInt;    {4}
   timestamp:  LongInt;    {date of format version}
END;
</PRE>
<DL>
<DT><B>Note</B>
<DD>In AIFF files, there is no Format Version Chunk.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The <CODE>timestamp</CODE> field indicates when the format version for this kind of file was created. The value indicates the number of seconds since January 1, 1904, following the normal time conventions used by the Macintosh Operating System. (See the chapter on date and time utilities in <I><A HREF="../OSUtilities/OSUtilities-2.html">Inside Macintosh: Operating System Utilities</A></I> for several routines that allow you to manipulate time stamps.)<P>
 You should not confuse the format version time stamp with the creation date of the file. The format version time stamp indicates the time of creation of the version of the format according to which this file is structured. Because Apple defines the formats of AIFF-C files, only Apple can change this value. The current version is defined by a constant:<P>
<PRE>
CONST
   AIFCVersion1   = $A2805140;   {May 23, 1990, 2:40 p.m.}
</PRE>
<A NAME=HEADING61-29></A>
<H3>The Common Chunk</H3>
 Every AIFF and AIFF-C file must contain a Common Chunk that defines some fundamental characteristics of the sampled sound contained in the file. Note that the format of the Common Chunk is different for AIFF and AIFF-C files. As a result, you need to determine the type of file format (by inspecting the <CODE>formType</CODE> field of the Form Chunk) before reading the Common Chunk.<P>
 For AIFF files, the Common Chunk has this structure:<P>
<PRE>
TYPE CommonChunk =
RECORD
   ckID:             ID;         {'COMM'}
   ckSize:           LongInt;    {size of chunk data}
   numChannels:      Integer;    {number of channels}
   numSampleFrames:  LongInt;    {number of sample frames}
   sampleSize:       Integer;    {number of bits per sample}
   sampleRate:       Extended;   {number of frames per second}
END;
</PRE>
 For AIFF-C files, the Common Chunk has this structure:<A NAME=MARKER-2-443></A><P>
<PRE>
TYPE ExtCommonChunk =
RECORD
   ckID:             ID;         {'COMM'}
   ckSize:           LongInt;    {size of chunk data}
   numChannels:      Integer;    {number of channels}
   numSampleFrames:  LongInt;    {number of sample frames}
   sampleSize:       Integer;    {number of bits per sample}
   sampleRate:       Extended;   {number of frames per second}
   compressionType:  ID;         {compression type ID}
   compressionName:  PACKED ARRAY[0..0] OF Byte;
                                 {compression type name}
END;
</PRE>
 The fields that exist in both types of Common Chunk have the following meanings:<P>
 The <CODE>numChannels</CODE> field of both types of Common Chunk indicate the number of audio channels contained in the sampled sound. A value of 1 indicates monophonic sound, a value of 2 indicates stereo sound, a value of 4 indicates four-channel sound, and so forth. Any number of audio channels may be specified. The actual sound data is stored elsewhere, in the Sound Data Chunk.<P>
 The <CODE>numSampleFrames</CODE> field indicates the number of sample frames in the Sound Data Chunk. Note that this field contains the number of sample frames, not the number of bytes of data and not the number of sample points. For noncompressed sound data, the total number of sample points in the file is <CODE>numChannels</CODE> * <CODE>numSampleFrames</CODE>. (For more information on sample points, see <A HREF=Sound-288.html#MARKER-9-237>"Sampled-Sound Data" on page 2-9</A>.)<P>
 The <CODE>sampleSize</CODE> field indicates the number of bits in each sample point of noncompressed sound. Although the field can contain any integer from 1 to 32, the Sound Manager currently supports only 8- and 16-bit sound. For compressed sound data, this field indicates the number of bits per sample in the original sound data, before compression.<P>
 The <CODE>sampleRate</CODE> field contains the sample rate at which the sound is to be played back, in sample frames per second. For a list of common sample rates, see <A HREF=Sound-49.html#MARKER-9-1>Table 2-1 on page 2-16</A>.<P>
 <A NAME=MARKER-2-444></A>An AIFF-C Common Chunk includes two fields that describe the type of compression (if any) used on the audio data. The <CODE>compressionType</CODE> field contains the type of the compression algorithm, if any, used on the sound data. Here are the currently available compression types and their associated compression names:<P>
<PRE>
CONST
   {compression types}
   NoneType                = 'NONE';
   ACE2Type                = 'ACE2';
   ACE8Type                = 'ACE8';
   MACE3Type               = 'MAC3';
   MACE6Type               = 'MAC6';
</PRE>
 You can define your own compression types, but you should register them with Apple.<A NAME=MARKER-2-296></A><P>
 Finally, the <CODE>compressionName</CODE> field contains a human-readable name for the compression algorithm ID specified in the <CODE>compressionType</CODE> field. Compression names for Apple-supplied codecs are defined by constants:<P>
<PRE>
CONST
   {compression names}
   NoneName                = 'not compressed';
   ACE2to1Name             = 'ACE 2-to-1';
   ACE8to3Name             = 'ACE 8-to-3';
   MACE3to1Name            = 'MACE 3-to-1';
   MACE6to1Name            = 'MACE 6-to-1';
</PRE>
 This string is useful when putting up alert boxes (perhaps because a necessary decompression routine is missing). Pad the end of this array with a byte having the value 0 if the length of this array is not an even number (but do not include the pad byte in the count).<A NAME=MARKER-2-585></A><A NAME=MARKER-2-293></A><P>
<A NAME=HEADING61-46></A>
<H3>The Sound Data Chunk</H3>
 The Sound Data Chunk contains the actual sample frames that make up the sampled sound. The Sound Data Chunk has this structure:<P>
<PRE>
TYPE SoundDataChunk =
RECORD
   ckID:       ID;         {'SSND'}
   ckSize:     LongInt;    {size of chunk data}
   offset:     LongInt;    {offset to sound data}
   blockSize:  LongInt;    {size of alignment blocks}
END;
</PRE>
 The <CODE>offset</CODE> field indicates an offset (in bytes) to the beginning of the first sample frame in the chunk data. Most applications do not need to use the <CODE>offset</CODE> field and should set it to 0.<P>
 The <CODE>blockSize</CODE> field contains the size (in bytes) of the blocks to which the sound data is aligned. This field is used in conjunction with the <CODE>offset</CODE> field for aligning sound data to blocks. As with the <CODE>offset</CODE> field, most applications do not need to use the <CODE>blockSize</CODE> field and should set it to 0.<P>
 The sampled-sound data follows the <CODE>blockSize</CODE> field. For information on the format of sampled-sound data, see <A HREF=Sound-288.html#MARKER-9-237>"Sampled-Sound Data" on page 2-9</A>.<P>
<DL>
<DT><B>Note</B>
<DD>The Sound Data Chunk is required unless the <CODE>numSampleFrames</CODE> field in the Common Chunk is 0. A maximum of one Sound Data Chunk can appear in an AIFF or AIFF-C file.<EM></EM>   <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING61-53></A>
<H3>Format of Entire Sound Files<A NAME=MARKER-2-452></A></H3>
 <A NAME=MARKER-2-453></A><A HREF=#MARKER-9-457>Figure 2-7</A> illustrates an AIFF-C file that contains approximately 4.476 seconds of 8-bit monophonic sound data sampled at 22 kHz. The sound data is not compressed. Note that the number of sample frames in this example is odd, forcing a pad byte to be inserted after the sound data. This pad byte is not reflected in the <CODE>ckSize</CODE> field of the Sound Data Chunk, which means that special processing is required to correctly determine the actual chunk size.<A NAME=MARKER-2-454></A><P>
 On a Macintosh computer, the Form Chunk (and hence all the other chunks in an AIFF or AIFF-C file) is stored in the data fork of the file. The file type of an AIFF format file is <CODE>'AIFF'</CODE>, and the file type of an AIFF-C format file is <CODE>'AIFC'</CODE>. Macintosh applications should not store any information in the resource fork of an AIFF or AIFF-C file because that information might not be preserved by other applications that edit sound files.<A NAME=MARKER-2-455></A><A NAME=MARKER-2-456></A><P>
<B>Figure 2-7  <A NAME=MARKER-9-457></A>A sample AIFF-C file<A NAME=MARKER-2-458></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SM-L-06.jpg"><P>
 Every Form Chunk must contain a Common Chunk, and every AIFF-C file must contain a Format Version Chunk. In addition, if the sampled sound has a length greater than 0, there must be a Sound Data Chunk in the Form Chunk. All other chunk types are optional. Your application should be able to read all the required chunks if it uses AIFF or AIFF-C files, but it can choose to ignore any of the optional chunks.<P>
 When reading AIFF or AIFF-C files, you should keep the following points in mind:<P>
<UL>
<LI>Remember that the local chunks in an AIFF or AIFF-C file can occur in any order. An application that reads these types of files should be designed to get a chunk, identify it, and then process it without making any assumptions about what kind of chunk it is based on its order.<A NAME=MARKER-2-459></A>
<LI>If your application allows modification of a chunk, then it must also update other chunks that might be based on the modified chunk. However, if there are chunks in the file that your application does not recognize, you must discard those unrecognized chunks. Of course, if your application is simply copying the AIFF or AIFF-C file without any modification, you should copy the unrecognized chunks, too.<A NAME=MARKER-2-460></A>
<LI>You can get the clearest indication of the number of sample frames contained in an AIFF or AIFF-C file from the <CODE>numSampleFrames</CODE> parameter in the Common Chunk, not from the <CODE>ckSize</CODE> parameter in the Sound Data Chunk. The <CODE>ckSize</CODE> parameter is padded to include the fields that follow it, but it does not include the byte with a value of 0 at the end if the total number of sound data bytes is odd.<A NAME=MARKER-2-461></A>
<LI>Remember that each chunk must contain an even number of bytes. Chunks whose total contents would yield an odd number of bytes must have a pad byte with a value of 0 added at the end of the chunk. This pad byte is not included in the <CODE>ckSize</CODE> field.
<LI>Remember that the <CODE>ckSize</CODE> field of any chunk does not include the first 8 bytes of the chunk (which specify the chunk type).<A NAME=MARKER-2-462></A><A NAME=MARKER-2-463></A><A NAME=MARKER-2-464></A><A NAME=MARKER-2-465></A><A NAME=MARKER-2-466></A><A NAME=MARKER-2-465></A><P>
</UL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-60.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-62.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
