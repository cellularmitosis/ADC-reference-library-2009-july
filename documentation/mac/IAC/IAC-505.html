<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>DBGetConnInfo(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING505></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-504.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-506.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A> / <A HREF="IAC-487.html"><B>Data Access Manager Reference</B></A><BR><DL><DD><A HREF="IAC-492.html"><B>Data Access Manager Routines</B></A> / <A HREF="IAC-502.html"><B>Low-Level Interface: Controlling the Session</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING505-0></A>
<H3><A NAME=MARKER-9-334></A>DBGetConnInfo</H3>
 <A NAME=MARKER-2-335></A>The <CODE>DBGetConnInfo</CODE> function returns information about the specified session, including <A NAME=MARKER-2-336></A><P>
<UL>
<LI>the version of the database extension
<LI>the name of the host system on which the session is running
<LI>the user name
<LI>the connection string that was used to initiate communication
<LI>the name of the network
<LI>the time at which the session started, in ticks (sixtieths of a second)
<LI>the status of the session<P>
</UL>
<PRE>
FUNCTION DBGetConnInfo (sessID: LongInt; sessNum: Integer; 
                        VAR returnedID: LongInt;
                        VAR version: LongInt; 
                        VAR ddevName: Str63; 
                        VAR host: Str255; VAR user: Str255;
                        VAR network: Str255; VAR connStr: Str255; 
                        VAR start: LongInt; VAR state: OSErr; 
                        asyncPB: DBAsyncParmBlkPtr): OSErr;
</PRE>
<DL>
<DT><CODE>sessID</CODE>
<DD> The session ID that was returned by the <CODE>DBInit</CODE> function. If you include a nonzero value for the <CODE>sessID</CODE> parameter when you call the <CODE>DBGetConnInfo</CODE> function, the function returns the name of the database extension in the <CODE>ddevName</CODE> parameter. If you use 0 for the <CODE>sessID</CODE> parameter and specify the database extension and session number instead (in the <CODE>ddevName</CODE> and <CODE>sessNum</CODE> parameters), the function returns the session ID in the <CODE>returnedID</CODE> parameter.
<DT><CODE>sessNum</CODE>
<DD> The session number of the session about which you want information. If you specify a nonzero session number, you must also provide the database extension in the <CODE>ddevName</CODE> parameter.
<DT><CODE>returnedID</CODE>
<DD> Returns the session ID if you specify the session number and the database extension.
<DT><CODE>version</CODE>
<DD> Returns the version number of the database extension that is currently in use.
<DT><CODE>ddevName</CODE>
<DD> A string of no more than 63 characters that specifies the name of the database extension. If you specify 0 for the session ID, you must include the name of the database extension as well as a session number. If you specify a valid session ID, then the <CODE>DBGetConnInfo</CODE> function returns the name of the database extension in the <CODE>ddevName</CODE> parameter. The name of the database extension is contained in the database extension file in a resource of type <CODE>'STR '</CODE> with a resource ID of 128. For the Data Access Language database extension provided by Apple, for example, this string is "<CODE>DAL</CODE>".
<DT><CODE>host</CODE>
<DD> Returns the host string used to initiate communication with the data server.
<DT><CODE>user</CODE>
<DD> Returns the user string used to initiate communication with the data server.
<DT><CODE>network</CODE>
<DD> Returns the name of the network through which the database extension is communicating with the data server. This parameter is an empty string if you are not communicating through a network.
<DT><CODE>connStr</CODE>
<DD> Returns the connection string used to initiate communication with the data server.
<DT><CODE>start</CODE>
<DD> Returns the time, in ticks (sixtieths of a second), at which this session was initiated.
<DT><CODE>state</CODE>
<DD> Returns one of the following values to provide information about the status of the session:
<pre>   CONST  noErr    =    0;   {no error--ready for more }<BR>            { text}<BR>     rcDBValue    = -801;   {output data available}<BR>     rcDBError    = -802;   {execution ended in an }<BR>            { error}<BR>     rcDBExec    = -805;   {busy--currently executing }<BR>            { query}</pre><P>
<DT><CODE>asynchPB</CODE>
<DD> A pointer to an asynchronous parameter block. If you do not want to call the function asynchronously, set this parameter to <CODE>NIL</CODE>.
</DL>
<A NAME=HEADING505-23></A>
<H5>DESCRIPTION</H5>
 You can use the <CODE>DBGetConnInfo</CODE> function to get information about a particular session, or you can call the function repeatedly, incrementing the session number each time, to get information about all of the sessions associated with a particular database extension.<P>
 The <CODE>sessID</CODE> parameter is the session ID that was returned by the <CODE>DBInit</CODE> function. The <CODE>sessNum</CODE> parameter is the session number of the session about which you want information. You can specify either the session ID or the session number when you call the <CODE>DBGetConnInfo</CODE> function. If you specify the <CODE>sessID</CODE> parameter, use 0 for the <CODE>sessNum</CODE> parameter. If you specify the <CODE>sessNum</CODE> parameter, then use 0 for the <CODE>sessID</CODE> parameter. If you specify the <CODE>sessNum</CODE> parameter, you must specify a value for the <CODE>ddevName</CODE> parameter as well. If you specify the session number and the database extension, then the <CODE>DBGetConnInfo</CODE> function returns the session ID in the <CODE>returnedID</CODE> parameter.<P>
<A NAME=HEADING505-26></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>DBGetConnInfo</CODE> function may move or purge memory. You should not call this routine from within an interrupt, such as in a completion routine or a VBL task.<P>
<A NAME=HEADING505-28></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>DBGetConnInfo</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_DBGetConnInfo<TD>$1704</TABLE>
<P>
<A NAME=HEADING505-30></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>rcDBBadSessID<TD>-806<TD>Session ID is invalid or database extension name is invalid<TR>
<TD>rcDBBadSessNum<TD>-807<TD>Invalid session number<TR>
<TD>rcDBBadDDev<TD>-808<TD>Couldn't find the specified database extension, or error occurred in opening database extension<TR>
<TD>rcDBAsyncNotSupp<TD>-809<TD>The database extension does not support asynchronous calls<TR>
<TD>rcDBPackNotInited<TD>-813<TD>The <CODE>InitDBPack</CODE> function has not yet been called</TABLE>
</H5>
<A NAME=HEADING505-31></A>
<H5>SEE ALSO</H5>
 For a description of the asynchronous parameter block, see <A HREF=IAC-489.html#MARKER-9-246>page 12-56</A>. For more information on the use of the <CODE>DBGetConnInfo</CODE> function, see <A HREF=IAC-480.html#MARKER-9-161>"Getting Information About Sessions in Progress" on page 12-36</A>. <A NAME=MARKER-2-337></A><A NAME=MARKER-2-338></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-504.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-506.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
