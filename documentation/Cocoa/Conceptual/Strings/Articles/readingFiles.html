<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>String Programming Guide for Cocoa: Reading Strings From and Writing Strings To Files and URLs</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Reading Strings From and Writing Strings To Files and URLs"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40003459" title="Reading Strings From and Writing Strings To Files and URLs"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DataManagement-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000445" target="_top">Data Management</a> &gt; <a href="../index.html" target="_top">String Programming Guide for Cocoa</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="formatSpecifiers.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="SearchingStrings.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40003459-SW1" title="Reading Strings From and Writing Strings To Files and URLs"></a><hr /><H1>Reading Strings From and Writing Strings To Files and URLs</H1><p>Reading files or URLs using <code>NSString</code> is straightforward provided that you know what encoding the resource uses—if you don't know the encoding, reading a resource is more challenging. When you write to a file or URL, you must specify the encoding to use.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="readingFiles.html#//apple_ref/doc/uid/TP40003459-SW2">Reading From Files and URLs</a>
				
			<br/>
			
        
			
			
				<a href="readingFiles.html#//apple_ref/doc/uid/TP40003459-SW5">Writing to Files and URLs</a>
				
			<br/>
			
        
			
			
				<a href="readingFiles.html#//apple_ref/doc/uid/TP40003459-SW6">Summary</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40003459-SW2" title="Reading From Files and URLs"></a><h2>Reading From Files and URLs</h2><p><code>NSString</code> provides a variety of methods to read data from files and URLs. In general, it is much easier to read data if you know its encoding. If you have plain text and no knowledge of the encoding, you are already in a difficult position. You should avoid placing yourself in this position if at all possible—anything that calls for the use of plain text files should specify the encoding (preferably UTF-8 or UTF-16+BOM).</p><a name="//apple_ref/doc/uid/TP40003459-SW3" title="Reading data with a known encoding"></a><h3>Reading data with a known encoding</h3><p>To read from a file or URL for which you know the encoding, you use <code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithContentsOfFile:encoding:error:" target="_top">stringWithContentsOfFile:encoding:error:</a></code> or <code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithContentsOfURL:encoding:error:" target="_top">stringWithContentsOfURL:encoding:error:</a></code>, or the corresponding <code>init...</code> method, as illustrated in the following example.</p><div class="codesample"><table><tr><td scope="row"><pre>NSString *path = ...;<span></span></pre></td></tr><tr><td scope="row"><pre>NSError *error;<span></span></pre></td></tr><tr><td scope="row"><pre>NSString *stringFromFileAtPath = [[NSString alloc]<span></span></pre></td></tr><tr><td scope="row"><pre>                                      initWithContentsOfFile:path<span></span></pre></td></tr><tr><td scope="row"><pre>                                      encoding:NSUTF8StringEncoding<span></span></pre></td></tr><tr><td scope="row"><pre>                                      error:&amp;error];<span></span></pre></td></tr><tr><td scope="row"><pre>if (stringFromFileAtPath == nil) {<span></span></pre></td></tr><tr><td scope="row"><pre>    // an error occurred<span></span></pre></td></tr><tr><td scope="row"><pre>    NSLog(@"Error reading file at %@\n%@",<span></span></pre></td></tr><tr><td scope="row"><pre>              path, [error localizedFailureReason]);<span></span></pre></td></tr><tr><td scope="row"><pre>    // implementation continues ...<span></span></pre></td></tr></table></div><p>You can also initialize a string using a data object, as illustrated in the following examples. Again, you must specify the correct encoding.</p><div class="codesample"><table><tr><td scope="row"><pre>NSString *path = ...;<span></span></pre></td></tr><tr><td scope="row"><pre>NSData *data = [NSData dataWithContentsOfFile:path];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// assuming data is in UTF8<span></span></pre></td></tr><tr><td scope="row"><pre>NSString *string = [NSString stringWithUTF8String:[data bytes]];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// if data is in another encoding, for example ISO-8859-1<span></span></pre></td></tr><tr><td scope="row"><pre>NSString *string = [[NSString alloc]<span></span></pre></td></tr><tr><td scope="row"><pre>            initWithData:data encoding: NSISOLatin1StringEncoding];<span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/TP40003459-DontLinkElementID_5" title="Important:"></a><p><strong>Important:</strong>&nbsp;<code>NSString</code> provides methods (such as <code>stringWithContentsOfFile:</code> and <code>initWithContentsOfURL:</code>) to read a file or URL without specifying an encoding . Since these methods do not specify an encoding, you may lose information or corrupt data using them. You are strongly discouraged from using these methods as they will be deprecated.</p><p></p></div><a name="//apple_ref/doc/uid/TP40003459-SW4" title="Reading data with an unknown encoding"></a><h3>Reading data with an unknown encoding</h3><p>If you find yourself with text of unknown encoding, it is best to make sure that there is a mechanism for correcting the inevitable errors. For example, Apple's Mail and Safari applications have encoding menus, and TextEdit allows the user to reopen the file with an explicitly specified encoding. </p><p>If you are forced to guess the encoding (and note that in the absence of explicit information, it is a <em>guess</em>):</p><ol class="ol"><li class="li"><p>Try <code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithContentsOfFile:usedEncoding:error:" target="_top">stringWithContentsOfFile:usedEncoding:error:</a></code> or <code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/initWithContentsOfFile:usedEncoding:error:" target="_top">initWithContentsOfFile:usedEncoding:error:</a></code> (or the URL-based equivalents).</p><p>These methods try to determine the encoding of the resource, and if successful return by reference the encoding used.</p></li><li class="li"><p>If (1) fails, try to read the resource by specifying UTF-8 as the encoding.</p></li><li class="li"><p>If (2) fails, try an appropriate legacy encoding.</p><p>"Appropriate" here depends a bit on circumstances; it might be the default C string encoding, it might be ISO or Windows Latin 1, or something else, depending on where your data are coming from.</p></li><li class="li"><p>Finally, you can try <code>NSAttributedString</code>'s loading methods from the Application Kit (such as <code><a href="../../../Reference/ApplicationKit/Classes/NSAttributedString_AppKitAdditions/Reference/Reference.html#//apple_ref/occ/instm/NSAttributedString/initWithURL:options:documentAttributes:error:" target="_top">initWithURL:options:documentAttributes:error:</a></code>).</p><p>These methods attempt to load plain text files, and return the encoding used. They can be used on more-or-less arbitrary text documents, and are worth considering if your application has no special expertise in text. They might not be as appropriate for Foundation-level tools or documents that are not natural-language text.</p></li></ol><a name="//apple_ref/doc/uid/TP40003459-SW5" title="Writing to Files and URLs"></a><h2>Writing to Files and URLs</h2><p>Compared with reading data from a file or URL, writing is straightforward—<code>NSString</code> provides two convenient methods, <code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/writeToFile:atomically:encoding:error:" target="_top">writeToFile:atomically:encoding:error:</a></code> and <code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/writeToURL:atomically:encoding:error:" target="_top">writeToURL:atomically:encoding:error:</a></code>. You must specify the encoding that should be used, and choose whether to write the resource atomically or not. If you do not choose to write atomically, the string is written directly to the path you specify, otherwise it is written first to an auxiliary file, and then the auxiliary file is renamed to the path. option guarantees that the file, if it exists at all, won’t be corrupted even if the system should crash during writing. If you write to an URL, the atomicity option is ignored if the destination is not of a type that can be accessed atomically.</p><div class="codesample"><table><tr><td scope="row"><pre>NSString *path = ...;<span></span></pre></td></tr><tr><td scope="row"><pre>NSString *string = ...;<span></span></pre></td></tr><tr><td scope="row"><pre>NSError *error;<span></span></pre></td></tr><tr><td scope="row"><pre>BOOL ok = [string writeToFile:path atomically:YES<span></span></pre></td></tr><tr><td scope="row"><pre>                  encoding:NSUnicodeStringEncoding error:&amp;error];<span></span></pre></td></tr><tr><td scope="row"><pre>if (!ok) {<span></span></pre></td></tr><tr><td scope="row"><pre>    // an error occurred<span></span></pre></td></tr><tr><td scope="row"><pre>    NSLog(@"Error writing file at %@\n%@",<span></span></pre></td></tr><tr><td scope="row"><pre>              path, [error localizedFailureReason]);<span></span></pre></td></tr><tr><td scope="row"><pre>    // implementation continues ...<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40003459-SW6" title="Summary"></a><h2>Summary</h2><p>This table summarizes the most common means of reading and writing string objects to and from files and URLs:</p><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Source</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Creation method</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Extraction method</p></th></tr><tr><td  scope="row"><p>File contents</p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithContentsOfFile:encoding:error:" target="_top">stringWithContentsOfFile:encoding:error:</a></code><a name="//apple_ref/doc/uid/TP40003459-DontLinkElementID_144"></a></p><p><code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithContentsOfFile:usedEncoding:error:" target="_top">stringWithContentsOfFile:usedEncoding:error:</a></code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/writeToFile:atomically:encoding:error:" target="_top">writeToFile:atomically:encoding:error:</a></code><a name="//apple_ref/doc/uid/TP40003459-DontLinkElementID_145"></a></p></td></tr><tr><td  scope="row"><p>URL contents</p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithContentsOfURL:encoding:error:" target="_top">stringWithContentsOfURL:encoding:error:</a></code><a name="//apple_ref/doc/uid/TP40003459-DontLinkElementID_146"></a></p><p><code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/clm/NSString/stringWithContentsOfURL:usedEncoding:error:" target="_top">stringWithContentsOfURL:usedEncoding:error:</a></code></p></td><td ><p><code><a href="../../../Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/writeToURL:atomically:encoding:error:" target="_top">writeToURL:atomically:encoding:error:</a></code></p></td></tr></table></div>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="formatSpecifiers.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="SearchingStrings.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 1997, 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-10-15<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/Strings/Articles/readingFiles.html%3Fid%3D10000035i-4.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/Strings/Articles/readingFiles.html%3Fid%3D10000035i-4.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/Strings/Articles/readingFiles.html%3Fid%3D10000035i-4.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
