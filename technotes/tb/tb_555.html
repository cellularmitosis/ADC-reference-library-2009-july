<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TB555: Resource Manager Q&amp;As</title>                                      <meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Oct 1, 1990 - Oct 5, 1990"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002804" title="Resource Manager Q&As"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxHumanInterfaceToolbox-date.html" target="_blank">Carbon > Human Interface Toolbox</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TB555</div>
<div id="pageheadsub">Resource Manager Q&amp;As</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technical Note contains a collection of archived Q&amp;As relating to a specifictopic--questions sent the Developer Support Center (DSC) along withanswers from the DSC engineers. Current Q&amp;A's can be found on the <a href="../../qa/index.html">Macintosh Technical Q&amp;A's web site</a>.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Sep 01 1993]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Order of resources retrieved by GetIndResource</h2><p>When <code>GetIndResource</code> is called, does the Resource Manager return the resourcewith the lowest ID? Is it possible to predict the order of resources returnedby <code>GetIndResource</code> call?</p><p><code>GetIndResource</code> returns resources in the order that they were added to theresource file, not by ID number. If you want to retrieve resources in aspecific order by ID number, use <code>GetIndResource</code> and <code>GetResInfo</code> <i>(InsideMacintosh</i> Volume I, page 121) to build a list of resources and ID numbers,and then sort the list and start retrieving based on your criteria.</p><p>Theoretically, if you add resources in a certain order, <code>GetIndResource</code> willgive them back to you in the same order. However, this is subject to change,which is why we recommend the above approach.</p><P><A HREF="#top">Back to top</A></p><h2>Macintosh resource ID numbering</h2><P>Date Written:  7/26/90</p><P>Last reviewed:  6/14/93</p><p>Does the warning about using Macintosh resource IDs 0 through 127 apply toresource types of my own design?</p><p>When numbering resources, you can use any number you like on resource types ofyour own creation (that is, not of a type reserved by Apple.)</p><p>In numbering resources you create of a type reserved by Apple, stick to thefollowing guidelines:</p><ul type="disc">	<li>Negative numbers are reserved for various owned and otherwise "encoded" resources.</li>	<li>The numbers 0-127 are reserved for Apple's use.</li>	<li>Positive numbers &gt;127 are available for your use.</li>	<li>DTS no longer registers <code>'FOND'</code> IDs. <code>'FOND'</code>s should be referenced by name and not by number because the numbers change. Choose any <code>'FOND'</code> ID within your font's script range. For details, see the Macintosh Technical Note <A HREF = "../te/te_02.html">"Font Family Numbers."</a></li></ul><p><A HREF="#top">Back to top</A></p><h2>Locate Macintosh folder first with FindFolder before OpenRFPerm</h2><P>Date Written:  12/4/90</p><P>Last reviewed:  12/19/90</p><p><code>OpenRFPerm</code> gets result code -43 (file not found) when opening a file that wasput in the Macintosh System 7 Control Panel folder, but when the file is movedoutside the Control Panel folder and within the System Folder, <code>OpenRFPerm</code> worksfine.</p><p>It sounds like you are calling <code>OpenRFPerm</code> and it is accessing the System Folderrather than the Control Panel Folder. System 7.0 doesn't automatically searchall of the subfolders in the System Folder; therefore, it is necessary to usethe toolbox call <code>FindFolder</code> to locate the Control Panel folder before you call<code>OpenRFPerm</code>.</p><p>The <code>FindFolder</code> call is documented in <i>Inside Macintosh</i> Volume VI, Chapter8: "You can call the FindFolder function to get the path information so thatyou can access special folders. You pass FindFolder a target volume and aconstant that tells it which special folder you are interested in. FindFolderreturns a volume reference number and a directory ID. If the specified folderdoes not exist, FindFolder can create it and return the new directory ID. (Seetable 8-2 for the folder types [in System 7.0], resource types andconstants.)"</p><P><A HREF="#top">Back to top</A></p><h2>HOpenResFile with fsRdPerm permission returns unique path</h2><P>Date Written:  1/21/91</p><P>Last reviewed:  2/13/91</p><p>According to the Macintosh Technical Note <A HREF = "tb_19.html">"OpenRFPerm: What your mother nevertold you,"</a> "OpenRFPerm will create multiple, unique, read-only access paths toa resource file." Is this same behavior present in <code>HOpenResFile</code>? A cdev I havewritten must look within certain types of files for specific resources. If thefile is already open, will a call to <code>HOpenResFile</code> with <code>fsRdPerm</code> permissionreturn a unique path? Using <code>OpenRFPerm</code> seems to have no problems, but theoverhead of creating working directories seems rather untidy.</p><p><code>HOpenResFile</code> is simply a friendly face on top of <code>OpenRFPerm</code>, so the uniqueaccess paths that are created by <code>OpenRFPerm</code> will indeed percolate upwardthrough <code>HOpenResFile</code>.</p><P><A HREF="#top">Back to top</A></p><h2>Changing a Macintosh resource</h2><P>Date Written:  4/15/91</p><P>Last reviewed:  6/14/93</p><p>What's the recommended way to update a Macintosh resource?</p><p>As you may have guessed, there is no standard way to update a resource in aresource file. The general rule of thumb is, if the resource exists, simplyload it in, modify it, mark it changed, and then cause it to be written out. Itis also best at this point to write the resource if you know you are donechanging it (<code>ChangedResource</code> simply schedules the resource to be written thenext time the resource file is updated). (Read the caveat about changingpurgeable resource on page I-123 of <i>Inside Macintosh</i> Volume I.)</p><p>You should, as a general rule, never remove and replace the resource. Thiscauses undue accounting problems for yourself and the Resource Manager, andcauses quite a bit more writing to the file than is absolutely needed.</p><p>If the write of a resource has failed for any reason and you would like to havethe memory version of the resource contain what the disk version does, simplydetach the current handle from the resource using detach, dispose of the handleif you don't want the data anymore, and reload the resource as normal.</p><P><A HREF="#top">Back to top</A></p><h2>System 7.0 Resource Manager resource decompression</h2><P>Date Written:  4/26/91</p><P>Last reviewed:  6/14/93</p><p>Is the resource compression technique used in System 7.0 documented anywhere?</p><p>Documentation describing the compression algorithm used on resources is notavailable. The System 7.0 Resource Manager automatically decompresses for you.You can force a resource to be permanently decompressed by modifying it withResEdit. Under System 6.0.7 or earlier systems, there's no easy method toaccess compressed resources.</p><P><A HREF="#top">Back to top</A></p><h2>HOpenResFile versus OpenResFile</h2><P>Date Written:  5/1/91</p><P>Last reviewed:  6/7/91</p><p>Why would using <code>OpenResFile</code>(fileName) cause a crash when I try to open aMacintosh font file that's already open?</p><p>The problem stems from the fact that <code>OpenResFile</code> doesn't deal effectively withcases where the resource file is already open. Luckily, there are somerelatively new Resource Manager calls that you can and should use instead.They're all documented in the Resource Manager chapter of <i>InsideMacintosh</i> Volume VI and in the Macintosh Technical Note <A HREF = "tb_16.html">"New ResourceManager Calls."</a></p><P>The call of interest in your case is <code>HOpenResFile</code>. To use it, break down the<code>vRefNum</code> (actually <code>WDRefNum</code>) returned by Standard File into a real <code>vRefNum</code> and<code>dirID</code> by calling <code>PBGetWDInfo</code>, and pass those to <code>HOpenResFile</code> along with thefile name. The important part, however, is the permissions byte. If you expectto modify the file, pass <code>fsRdWrPerm</code> in that field. If there's an error of anykind, expect <code>HOpenResFile</code> to return -1, which should serve as a signal that youneed to call <code>ResError</code> to find out what went wrong.</p><P><A HREF="#top">Back to top</A></p><h2>Partial resources and compressed resource format</h2><P>Date Written:  8/9/91</p><P>Last reviewed:  9/24/91</p><p>The partial resource calls <code>ReadPartialResource</code> and <code>WritePartialResource</code> do notdecompress Apple's compressed resource format. In fact, these two calls are theonly way possible to read resources without decompressing them. It is notreally possible to decompress part of a resource, since the decompressionmethod requires the entire resource to be in memory for the conversion tooccur.</p><p>Details of Apple's compression scheme are not documented and Apple doesn'tcurrently license the algorithm to developers, but Macintosh compressedresources are contained only in the System file and other Apple-specific files.Because third-party products don't use Apple's compressed resources and allApple's compressed resources fit in memory without the partial calls, youneedn't worry about supporting partial resource calls with compressedresources. Just use the standard <code>GetResource</code> call to load theseApple-compressed resources. You can determine if a resource is compressed byexamining bit 0 of the resource's attributes. If this bit is set, the resourceis compressed, and partial resource calls will return the compressed data.</p><P><A HREF="#top">Back to top</A></p><h2>Getting Macintosh system strings</h2><P>Date Written:  1/18/92</p><P>Last reviewed:  2/6/92</p><p>Our application needs to know the Chooser Name and Machine Name, stored as <code>'STR'</code> resources in the System file. If I do a <code>GetResource</code> to read one of these(they are loaded into the system heap), should I do a <code>ReleaseResource</code> when I amdone? The resources are not purgeable so they won't go away by themselves. Onthe other hand, I'm worried about releasing them out from under something elsethat has the same resource handle (like the Chooser or the Finder).</p><p>The Chooser Name and Machine Name resources should be treated a littledifferently from normal resources under System 7. You really should use<code>GetString</code>, instead of <code>GetResource</code> to get the string (although <code>GetString</code> simplycalls <code>GetResource</code>). Once you have the string you should not release, dispose ormake purgeable the string. You will find that the string was already loadedwhen you asked for it, so it should remain when you are done. Also, you shouldnever change the contents of, or mark as changed, either of these strings sincethe Chooser could be open and would not recognize your changes, unless you giveyour users sufficient warning of the potentially confusing side effects ofhaving a different name in two places. Keep in mind that System 6 does notnecessarily have the Computer Name resource, so do error checking...</p><p>Bottom line: Get but don't release these special strings, and don't modify themunless absolutely needed.</p><P><A HREF="#top">Back to top</A></p><h2>Pre-load resources &amp; calling OpenResFile on another application</h2><P>Date Written:  2/27/92</p><P>Last reviewed:  6/12/92</p><p>My application wants to open other applications and play with the resourcestherein, like ResEdit, but when it calls OpenResFile on an application, theprogram gets lost in <code>GetNamedResource</code>. Is there something I'm missing?</p><p>Your problem stems from the fact that some resources in the application fileyou're opening with <code>OpenResFile</code> are marked to be preloaded, and so are loadedinto memory when the resource fork is opened.</p><p>Since most applications have CODE resources marked to be preloaded, this turnsinto a much bigger problem, because the Segment Loader will treat thesepreloaded CODE resources as your code resources if you make a between-segmentcall that triggers a call to <code>LoadSeg</code> while the opened resource file is first inthe resource chain. If this happens, you'll begin executing code out of theother application, which will cause your Macintosh to crash and burn.</p><p>The solution to this problem is to bracket <code>OpenResFile</code> calls with<code>SetResLoad(FALSE)</code> and <code>SetResLoad(TRUE)</code>, and to avoid making between-segmentcalls when you've got another resource file open that contains CODE resources.This will not only prevent your application's memory from being used bypreloaded resources that you don't want, but will also prevent the SegmentLoader from jumping into the other application's code. If you need to get CODEresources out of the opened resource file, you can still prevent the SegmentLoader problem by calling <code>UseResFile</code> on your application's resource referencenumber to put your application at the top of the resource chain.</p><P><A HREF="#top">Back to top</A></p><h2>Maximum number of items in a Macintosh resource file is 2727</h2><P>Date Written:  5/22/90</p><P>Last reviewed:  12/17/90</p><p>Is there a maximum number of items for Macintosh resources?</p><p>In a file, yes. It is 2727.</p><p>X-Ref:</p><P>Macintosh Technical Note <A HREF = "tb_18.html">"Maximum Number of Resources in a File"</a></p><P><A HREF="#top">Back to top</A></p><h2>Maximum Macintosh resource size is "maxlongint" bytes</h2><P>Date Written:  5/22/90</p><P>Last reviewed:  12/17/90</p><p>Is the maximum size of a Macintosh resource still 32K?</p><p>No. There used to be a bug in the 64K ROMs that didn't allow you to write evenmultiples of 32K, such as 32K-64K or 128K-192K. This bug was fixed in 128KROMs. As of 128K ROMs, the resource size is limited to <code>maxlongint</code> bytes.</p>         <a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (48K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tb_555.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tb/tb_555.html%3Fid%3DDTS10002804-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tb/tb_555.html%3Fid%3DDTS10002804-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tb/tb_555.html%3Fid%3DDTS10002804-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>