<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Dashboard Programming Topics: Using the Canvas</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Using the Canvas"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/30001236" title="Using the Canvas"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../index.html#//apple_ref/doc/uid/TP30000440-TP30000418" target="_top">Apple Applications</a> &gt; <a href="../../Dashboard-date.html#//apple_ref/doc/uid/TP30000440-TP30000418-TP40001366" target="_top">Dashboard</a> &gt; <a href="index.html" target="_top">Dashboard Programming Topics</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Articles/Resizing.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="CopyAndPaste.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/30001236-BAJGJJAH" title="Using the Canvas"></a><hr /><H1>Using the Canvas</H1><p>Safari, Dashboard, and WebKit-based applications support the JavaScript <em>canvas</em> object. The canvas allows you to easily draw arbitrary content within your HTML content.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="Canvas.html#//apple_ref/doc/uid/30001236-177749">Introduction to the Canvas</a>
				
			<br/>
			
        
			
			
				<a href="Canvas.html#//apple_ref/doc/uid/30001236-185532">Defining the Canvas</a>
				
			<br/>
			
        
			
			
				<a href="Canvas.html#//apple_ref/doc/uid/30001236-185620">Drawing on a Canvas</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/30001236-177749" title="Introduction to the Canvas"></a><h2>Introduction to the Canvas</h2><p>A canvas is an HTML tag that defines a custom drawing region within your web content. You can then access the canvas as a JavaScript object and draw upon it using features similar to Mac OS X’s Quartz drawing system. The World Clock Dashboard widget (available on all Apple machines running Mac OS X version 10.4 or later) shows a good example , though using a canvas is by no means exclusive to Dashboard.</p><p>There are two steps to using a canvas in your web page: defining a content area, and drawing to the canvas object in the script section of your HTML. </p><a name="//apple_ref/doc/uid/30001236-185532" title="Defining the Canvas"></a><h2>Defining the Canvas</h2><p>To use a canvas in your web page you first set up the drawing region. The World Clock Dashboard widget designates this region with the following code:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;canvas id="myCanvas" width='172' height='172'/><span></span></pre></td></tr></table></div><p>In this context, the attributes of <code>&lt;canvas></code> worth noting are <code>id</code>, <code>width</code>, and <code>height</code>.</p><p>The <code>id</code> attribute is a custom identifier used to target a particular canvas object when drawing. The <code>width</code> and <code>height</code> attributes specify the size of the canvas region.</p><p>Within the World Clock widget, this area is defined to be the canvas:</p><br/><div><a name="//apple_ref/doc/uid/30001236-185601" title="Figure 1The World Clock canvas region"></a><p><strong>Figure 1&nbsp;&nbsp;</strong>The World Clock canvas region</p><img src = "Art/worldclock_gray.jpg" alt = "The World Clock canvas region" ></div><br/><p>Now that the canvas region has been defined, it is ready to be filled.</p><a name="//apple_ref/doc/uid/30001236-185620" title="Drawing on a Canvas"></a><h2>Drawing on a Canvas</h2><p>Once you have defined the canvas area, you can write code to draw your content. Before you can do this, you need to obtain the canvas and its drawing context. The context handles the actual rendering of your content. The World Clock widget does this in its <code>drawHands()</code> function:</p><div class="codesample"><table><tr><td scope="row"><pre>function drawHands (hoursAngle, minutesAngle, secondsAngle)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    var canvas = document.getElementById("myCanvas");<span></span></pre></td></tr><tr><td scope="row"><pre>    var context = canvas.getContext("2d");<span></span></pre></td></tr></table></div><p>This function draws the hour, minute, and second hands on the face of the World Clock. As parameters, it takes the angles at which the three hands should be rotated as passed in by its caller.</p><p>You first query the JavaScript environment for the previously defined canvas, using its unique identifier: the <code>id</code> attribute in the <code>&lt;canvas></code> tag.</p><p>Once your script has acquired the canvas, you need to obtain its context. Using the <code>getContext("2d")</code> method, assign the canvas’ draw context it to the <code>context</code> variable. From this point on, you call all operations intended for the canvas on <code>context</code>. </p><p>The first operation you perform empties the canvas. As the <code>drawHands()</code> function is called every second, it is important to empty it each time, so that the previously drawn configuration doesn’t simply draw on top of the new configuration. The entire region, as defined by standard coordinates in the <code>&lt;canvas></code> tag, is cleared:</p><div class="codesample"><table><tr><td scope="row"><pre>    context.clearRect(0, 0, 172, 172);<span></span></pre></td></tr></table></div><p>Next, you save the state of the original context space so that you can restore later. In the original context, the origin (the 0,0 coordinate) of the canvas is in the top left corner. Upon completion of the upcoming drawing code, you want to return to this context. Use the context’s save method to do so:</p><div class="codesample"><table><tr><td scope="row"><pre>    context.save();<span></span></pre></td></tr></table></div><p>Since you want the hands of the clock to rotate around the center of the clock, translate the origin of the context space to the center of the canvas:</p><div class="codesample"><table><tr><td scope="row"><pre>    context.translate(172/2, 172/2);<span></span></pre></td></tr></table></div><p>Then draw the hour hand on the face of the clock. You copy the current context (with the origin at the center of the clock face), so that it can restored later. Then, you rotate the entire context, so that the y-axis aligns itself with the angle that the hour hand should point towards. Next, you draw the hour hand image (created in the code as a JavaScript <code>Image</code> object). The method <code>drawImage()</code> has five parameters: the image to be drawn, the x and y coordinate for the bottom left hand corner of the image, and the width and height of the image. Remember that while you draw the image as going straight up within the graphics context, you rotated the context to be at the correct angle for the hour hand:</p><div class="codesample"><table><tr><td scope="row"><pre>    context.save();<span></span></pre></td></tr><tr><td scope="row"><pre>    context.rotate(hoursAngle);<span></span></pre></td></tr><tr><td scope="row"><pre>    context.drawImage(hourhand, -4, -28, 9, 25);<span></span></pre></td></tr><tr><td scope="row"><pre>    context.restore();<span></span></pre></td></tr></table></div><p>Once you draw the hand, you restore the last saved context. This means that the context that you saved four lines prior, with its origin at the center of the canvas but not yet rotated, will be the active context again.</p><p>Use a similar procedure to draw the minute hand on the face of the clock. The differences this time are in the angle you rotate the context to and the size of the minute hand. Note that you save and rotate the context again, and then you restore it to its previous state, so that you can draw the next element independent of the rotation needed for the minute hand:</p><div class="codesample"><table><tr><td scope="row"><pre>    context.save();<span></span></pre></td></tr><tr><td scope="row"><pre>    context.rotate (minutesAngle);<span></span></pre></td></tr><tr><td scope="row"><pre>    context.drawImage (minhand, -8, -44, 18, 53);<span></span></pre></td></tr><tr><td scope="row"><pre>    context.restore();<span></span></pre></td></tr></table></div><p>Finally, draw the second hand. Note that this time, the context should not be saved and restored. Since this is the last time anything will be drawn in this particular context (with the origin at the center of the canvas), it is not necessary for you to save and restore again:</p><div class="codesample"><table><tr><td scope="row"><pre>    context.rotate (secondsAngle);<span></span></pre></td></tr><tr><td scope="row"><pre>    context.drawImage (sechand, -4, -52, 8, 57);<span></span></pre></td></tr><tr><td scope="row"><pre>    context.restore();<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Now that the clock face has been drawn, you should restore the context to its original state, as saved before any drawing occurred. This prepares the canvas for any future drawing that will occur, and gives you a consistent origin (the top-left corner of the canvas) to work from.</p><p>Remember, all of these techniques can be applied to a canvas object within any WebKit-based application. For more information on the canvas see <code><!--a target="_top" -->Canvas<!--/a--></code>. </p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Articles/Resizing.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="CopyAndPaste.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-02-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleApplications/Conceptual/Dashboard_ProgTopics/Canvas.html%3Fid%3DTP40002837-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleApplications/Conceptual/Dashboard_ProgTopics/Canvas.html%3Fid%3DTP40002837-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleApplications/Conceptual/Dashboard_ProgTopics/Canvas.html%3Fid%3DTP40002837-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
