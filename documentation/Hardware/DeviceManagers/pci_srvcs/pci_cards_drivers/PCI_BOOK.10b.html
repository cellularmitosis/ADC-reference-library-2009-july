<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Using Iterate Routines</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.10a.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.10a.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.10c.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H3.Heading3"><A NAME="pgfId=3435"> </A><A NAME="23923"> </A>Using Iterate Routines</H1><P CLASS="T1.Text1"><A NAME="pgfId=3436"> </A>Writing code to interate through a set of names consists of a call to begin the iteration, the iteration loop, and a call to end the iteration. The call to end the iteration should be made even in the case of an error, so that allocated data structures can be freed. Here is the basic code structure for traversing names in the Name Registry:</P><CODE CLASS="Cv.Code"><A NAME="pgfId=17429"> </A>Create(...)<BR>Set(...) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// optional<BR>do {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iterate(...);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// or Search(...);<BR>} while (!done);<BR>Dispose(...);</CODE><P CLASS="T1.Text1"><A NAME="pgfId=3438"> </A>Two different name entry iterations are provided, direction oriented and search oriented. The type of iteration is indicated by the call used to retrieve the next name entry. All the Mac&nbsp;OS routines used are described in <A HREF="PCI_BOOK.116.html#11935" CLASS="XRef">Name Iteration and Searching</A>. Rules for direction iteration are given below; rules for search iteration are given in the next section.</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=3445"> </A><A HREF="PCI_BOOK.119.html#22278" CLASS="XRef"><TT CLASS="cv">RegistryEntryIterate</TT></A> is used to traverse and explore the Name Registry. An iteration operation begins at a starting entry and moves in a direction defined by the <TT CLASS="cv">relationship</TT> parameter. The relationship determines which entries relative to the starting entry are to be included in the search--children, parents, siblings, or descendants. Each iterate call returns the next entry encountered along the designated path. You can change the direction at any time by specifying a new <TT CLASS="cv">relationship</TT> parameter in your next iterate call. You can continue in the current direction by specifying <TT CLASS="cv">kRegIterContinue</TT> for the <TT CLASS="cv">relationship</TT> parameter. Remember that the direction is relative to the last entry returned from the previous iterate call.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3446"> </A>When an entry iterator is created via <TT CLASS="cv">RegistryEntryIterateCreate</TT>, it is initialized to the default starting entry root and with a relationship of <TT CLASS="cv">kRegIterDescendants</TT>. This lets you iterate over the entire Name Registry.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3447"> </A>You can use <TT CLASS="cv">RegistryEntryIterateSet</TT> to set the iterator to some name entry other than the root, limiting the iteration to some subset of the Name Registry. To change the default relationship, specify a new relationship as a parameter to your first iterate call.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3448"> </A>An iteration sequence is complete when either it finds what it is looking for or the <TT CLASS="cv">done</TT> parameter returns <TT CLASS="cv">true</TT>, indicating that there are no more entries in the specified direction. When <TT CLASS="cv">done</TT> is <TT CLASS="cv">true</TT> no error code is returned and the contents of <TT CLASS="cv">foundEntry</TT> are indeterminate. The iterator must be reset, using <TT CLASS="cv">RegistryEntryIterateSet</TT>, before it can be used again for a subsequent search  or iterate operation.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3449"> </A>Each iterate call should describe the next relationship of interest.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3450"> </A>Don't mix iterators for iterate and search routines without reinitializing the iterator value by means of <TT CLASS="cv">RegistryEntryIterateSet</TT>.</LI></UL><P CLASS="T1.Text1"><A NAME="pgfId=3451"> </A>Here are some hints for using relationships while iterating:</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=3452"> </A>To iterate through all the descendants of an entry, specify <TT CLASS="cv">kRegIterDescendants</TT> on the first iterate call and then specify <TT CLASS="cv">kRegIterContinue</TT> until <TT CLASS="cv">done</TT> is <TT CLASS="cv">true</TT>. </LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3453"> </A>To iterate through the children of an entry, specify <TT CLASS="cv">kRegIterChildren</TT> on the first iterate call and then specify <TT CLASS="cv">kRegIterContinue</TT> until <TT CLASS="cv">done</TT> is <TT CLASS="cv">true</TT>.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3454"> </A>To iterate through the siblings of an entry, specify <TT CLASS="cv">kRegIterSiblings</TT> on the first iterate call and then specify <TT CLASS="cv">kRegIterContinue</TT> until <TT CLASS="cv">done</TT> is <TT CLASS="cv">true</TT>. Siblings do not include the current entry.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3455"> </A>To iterate through the parents of an entry, specify <TT CLASS="cv">kRegIterParents</TT> on the first iterate call and then specify <TT CLASS="cv">kRegIterContinue</TT> until <TT CLASS="cv">done</TT> is <TT CLASS="cv">true</TT>. Note that there is only one parent in the current implementation of the Name Registry.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3456"> </A>To navigate down the registry hierarchy, specify <TT CLASS="cv">kRegIterChildren</TT> until you find the level you are looking for or until <TT CLASS="cv">done</TT> is <TT CLASS="cv">true</TT> (which indicates that you have reached the bottom). The latter case is useful when deleting a subtree, because you must delete the children before you can delete a parent.</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=3457"> </A>To navigate up the Name Registry hierarchy, specify <TT CLASS="cv">kRegIterParents</TT> until you find the level you are looking for or until <TT CLASS="cv">done</TT> is <TT CLASS="cv">true</TT> (which indicates that you have reached the root). </LI></UL><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.10a.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.10a.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.10c.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>