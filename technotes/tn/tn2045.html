<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="Stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TN2045: AEBuild*, AEPrint* and Friends</title><meta name="keywords" content="AppleScript Application Apple event events script scripting"><meta name="Description" content="Technical Note TN2045: This technical note discusses variousmethods of using AppleScripts inside of applications."><meta name="categories" content="Processes, Interapplication Communication and AppleScript"><meta name="week-posted" content="Mar 18, 2002 - Mar 22, 2002"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10003078" title="AEBuild*, AEPrint* and Friends"></a><A NAME="topofdocument"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/Carbon/index.html">Carbon</a> &gt; <a href="../../technicalnotes/Carbon/idxInterapplicationCommunication-date.html">Interapplication Communication</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN2045</div>
<div id="pageheadsub">AEBuild*, AEPrint* and Friends</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left">         <!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                        <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc --><p id="menutext"><A HREF="#mainintroduction">Introduction</A><BR><A HREF="#buildingdescs">AEBuilding Descriptor Records</A><BR></p><p id="menutext2"><A HREF="#AEBuildDesc"><A HREF="#AEBuildDesc">AEBuildDesc</A></A><BR><A HREF="#AEBuildError"><A HREF="#AEBuildError">AEBuildError</A></A><BR><A HREF="#vAEBuildDesc"><A HREF="#vAEBuildDesc">vAEBuildDesc</A></A><BR></p><p id="menutext"><A HREF="#bldngevtrcrds">AEBuilding Apple Event Records</A><BR></p><p id="menutext2"><A HREF="#AEBuildAppleEvent"><A HREF="#AEBuildAppleEvent">AEBuildAppleEvent</A></A><BR><A HREF="#AEBuildParameters"><A HREF="#AEBuildParameters">AEBuildParameters</A></A><BR><A HREF="#AEPrintDescToHandle"><A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A></A><BR></p><p id="menutext"><A HREF="#dssyntax">Descriptor-String Syntax</A><BR></p><p id="menutext2"><A HREF="#dssyntaxdt">Data Types</A><BR><A HREF="#dssyntaxtc">Type Coercion</A><BR></p><p id="menutext"><A HREF="#dssyntaxcdt">Complex Data Types</A><BR></p><p id="menutext2"><A HREF="#dssyntaxcli">Lists</A><BR><A HREF="#dssyntaxcrec">Records</A><BR></p><p id="menutext"><A HREF="#dssyntaxcparam">Parameter Substitution</A><BR><A HREF="#dssyntaxcprgdb">Using AEPrint* with gdb</A><BR><A HREF="#dsgrammar">Descriptor-String Grammar</A><BR><A HREF="#doenloeads">Downloads</A><BR>                                 </P>                   <!-- end_toc -->                  </td>                </tr>                 <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left>           <!-- begin_intro_text --><p id="introtext">This Technote describes the <CODE>AEBuild</CODE>* suite of routinesand the simple Apple event description language they accept.  Also discussedis the <CODE>AEPrint</CODE> routine along with how it can be used inside of gdb.</P><P id="introtext">The <CODE>AEBuild</CODE>* suite of routines provide simple to use and easyto maintain facilities for constructing complex Apple event structures in memoryfor sending information to other applications.  <CODE>AEPrint</CODE> provides a symmetricalpretty printer routine for viewing complex Apple event structures asstrings formatted using the same syntax as the strings <CODE>AEBuild</CODE>* isable to read.</P><p id="introtext">This Note is directed at application developers who make extensive use ofsophisticated Apple event structures in their applications.</P><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Mar 21 2002]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content -->                <A NAME="mainintroduction" x-level=1 x-title="Introduction"></A><H2>Introduction</H2><P>The <CODE>AEBuild</CODE>* routines provide a very simple translation service for convertingspecially formatted strings into complex Apple event descriptors.  Normally,creating complex Apple event descriptor records requires a large number ofcalls to the Apple event Manager routines to build up the descriptor piece bypiece.  The <CODE>AEBuild</CODE>* routines allow you to consolidate all of the calls requiredto construct a complex Apple event descriptor into a single system call thatcreates the desired structure as directed by a format string that you provide.</P><P><CODE>AEPrint</CODE> provides a symmetrical pretty printer routine for displaying thecontents of Apple event descriptor records.  Strings created by <CODE>AEPrint</CODE> are ofthe same format as strings accepted by <CODE>AEBuild</CODE>.  <CODE>AEPrint</CODE> can be very usefulfor viewing the contents of Apple event descriptor records when you aredebugging your Apple event routines.</P><P>In many ways, the <CODE>AEBuild</CODE>* routines are very much like the standard C library's*<CODE>printf</CODE> suite of routines.  The syntax for the 'format' string that you provideis very simple and allows for the substitution of data items into the Apple eventdescriptors being created.  The remainder of this document describes the <CODE>AEBuild</CODE>* suite ofroutines and descriptor-string syntax that can be used with them.</P><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="buildingdescs" x-level=1 x-title="AEBuilding Descriptor Records"></A><H2>AEBuilding Descriptor Records</H2><A NAME="AEBuildDesc" x-level=2 x-title="AEBuildDesc"></A><H3>AEBuildDesc</H3><P><CODE>AEBuildDesc</CODE> provides a facility for compiling <CODE>AEBuild</CODE> descriptor-strings intoApple event descriptor records (<CODE>AEDescs</CODE>).  Parameters are described below:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>OSStatus AEBuildDesc(    <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A>* dst,    AEBuildError* error,  /* can be NULL */    const char* src,    ...);</pre><P><B>Parameters:</B></P><UL><LI><CODE>dst</CODE> - A pointer to an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> record where the resulting descriptorshould be stored.<BR><BR></LI><LI><CODE>error</CODE> - A pointer to a <CODE>AEBuildError</CODE> structure where additionalinformation about any errors that occur will be saved.  This is an optionalparameter and the value <CODE>NULL</CODE> may be provided in its place if this informationis not required.<BR><BR></LI><LI><CODE>src</CODE> - An <CODE>AEBuild</CODE> format string describing the <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> recordto be created.<BR><BR></LI><LI><CODE>...</CODE> - A variable number of parameters as required by theformat string provided in the <CODE>src</CODE> parameter.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success ofthe <CODE><A HREF="#AEBuildDesc">AEBuildDesc</A></CODE> call.  A value of <CODE>AEBuildSyntaxNoErr</CODE> (zero) means the callsucceeded.  The <CODE>error</CODE> parameter can be used to discover informationabout other errors.</P></TD></TR></TABLE></CENTER>                    <P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="AEBuildError" x-level=2 x-title="AEBuildError"></A><H3>AEBuildError</H3><P><CODE>AEBuildError</CODE> defines a structure that can be passed to the <CODE>AEBuild</CODE>* routinesto discover additional error information.  The <CODE>AEBuild</CODE>* routines accept a pointerto this structure in an optional error parameter.  While debugging a descriptorstring you may wish to use this parameter to get more complete information abouterrors found in your descriptor-strings.  The <CODE>AEBuildError</CODE> structure is declaredas follows:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>typedef UInt32 AEBuildErrorCode;struct AEBuildError {    AEBuildErrorCode fError;    UInt32 fErrorPos;};typedef struct AEBuildError AEBuildError;</pre></TD></TR></TABLE></CENTER><BR><BR>                    <P>The purpose of this structure is to provide additional information about errorsthat occur during parsing of a descriptor-string.  The <CODE>fError</CODE> field will containone of the values shown in <A HREF="#errstable">Table 1</A>, and the <CODE>fErrorPos</CODE> field willcontain the characterposition in the string where the error was noticed by the parser.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="errstable" kind = "Table">Table 1</A>.</B> Extended <CODE>AEBuild</CODE> error codes.</P><TABLE border="1" width="550"><TR> <td align="left">   <P><B>Constant Name</B></P> </TD> <td align="left">   <P><B>Value</B></P> </TD> <td align="left">   <P><B>Description</B></P> </TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoErr</CODE></P></TD><td align="left"><P>0</P></TD><td align="left"><P>(No error)</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxBadToken</CODE></P></TD><td align="left"><P>1</P></TD><td align="left"><P>Illegal character</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxBadEOF</CODE></P></TD><td align="left"><P>2</P></TD><td align="left"><P>Unexpected end of format string</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoEOF</CODE></P></TD><td align="left"><P>3</P></TD><td align="left"><P>Unexpected extra stuff past end</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxBadNegative</CODE></P></TD><td align="left"><P>4</P></TD><td align="left"><P>"-" not followed by digits</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxMissingQuote</CODE></P></TD><td align="left"><P>5</P></TD><td align="left"><P>Missing close "'"</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxBadHex</CODE></P></TD><td align="left"><P>6</P></TD><td align="left"><P>Non-digit in hex string</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxOddHex</CODE></P></TD><td align="left"><P>7</P></TD><td align="left"><P>Odd # of hex digits</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoCloseHex</CODE></P></TD><td align="left"><P>8</P></TD><td align="left"><P>Missing $ or "&raquo;"</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxUncoercedHex</CODE></P></TD><td align="left"><P>9</P></TD><td align="left"><P>Hex string must be coerced to a type</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoCloseString</CODE></P></TD><td align="left"><P>10</P></TD><td align="left"><P>Missing closing quote</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxBadDesc</CODE></P></TD><td align="left"><P>11</P></TD><td align="left"><P>Illegal descriptor</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxBadData</CODE></P></TD><td align="left"><P>12</P></TD><td align="left"><P>Bad data value inside (...)</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoCloseParen</CODE></P></TD><td align="left"><P>13</P></TD><td align="left"><P>Missing ")" after data value</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoCloseBracket</CODE></P></TD><td align="left"><P>14</P></TD><td align="left"><P>Expected "," or "]"</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoCloseBrace</CODE></P></TD><td align="left"><P>15</P></TD><td align="left"><P>Expected "," or "}"</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoKey</CODE></P></TD><td align="left"><P>16</P></TD><td align="left"><P>Missing keyword in record</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxNoColon</CODE></P></TD><td align="left"><P>17</P></TD><td align="left"><P>Missing ":" after keyword in record</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxCoercedList</CODE></P></TD><td align="left"><P>18</P></TD><td align="left"><P>Cannot coerce a list</P></TD></TR><TR><td align="left"><P><CODE>AEBuildSyntaxUncoercedDoubleAt</CODE></P></TD><td align="left"><P>19</P></TD><td align="left"><P>"@@" substitution must be coerced</P></TD></TR></TABLE></TD></TR></TABLE></CENTER><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="vAEBuildDesc" x-level=2 x-title="vAEBuildDesc"></A><H3>vAEBuildDesc (varargs version)</H3><P>The vAEBuildDesc routine allows you to encapsulate calls to <CODE><A HREF="#AEBuildDesc">AEBuildDesc</A></CODE> in your ownwrapper routines. You pass <CODE>vAEBuildDesc</CODE> a <CODE>va_list</CODE> reference to a previously defined, variable argument parameter list to use with the descriptor-string. The file <CODE>&lt;stdarg.h&gt;</CODE>  defines macros for declaring and using the <CODE>va_list</CODE> data type. <CODE>vAEBuildDesc</CODE>  provides the same functionality as <CODE><A HREF="#AEBuildDesc">AEBuildDesc</A></CODE>.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>OSStatus vAEBuildDesc(    <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A>* dst,    <A HREF="#AEBuildError">AEBuildError</A>* error,  /* can be NULL */    const char* src,    va_list args);</pre><P><B>Parameters:</B></P><UL><LI><CODE>dst</CODE> - A pointer to an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> record where the resulting descriptorshould be stored.<BR><BR></LI><LI><CODE>error</CODE> - A pointer to a <CODE><A HREF="#AEBuildError">AEBuildError</A></CODE> structure where additionalinformation about any errors that occur will be saved.  This is an optionalparameter and the value <CODE>NULL</CODE> may be provided in its place if this informationis not required.<BR><BR></LI><LI><CODE>src</CODE> - An <CODE>AEBuild</CODE> format string describing the <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> recordto be created.<BR><BR></LI><LI><CODE>args</CODE> - A <CODE>va_list</CODE> value referencing the variable length argumentlist to be used by <CODE><A HREF="#vAEBuildDesc">vAEBuildDesc</A></CODE>.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success ofthe <CODE><A HREF="#AEBuildDesc">AEBuildDesc</A></CODE> call.  A value of <CODE>AEBuildSyntaxNoErr</CODE> (zero) means the callsucceeded.  The <CODE>error</CODE> parameter can be used to discover informationabout other errors.</P></TD></TR></TABLE></CENTER><BR><BR><P>All of the other <CODE>AEBuild</CODE>* routines that accept a variable length parameter listalso include a include a varargs version with '<CODE>va_list args</CODE>' in place of thevariable length parameter list ('<CODE>...</CODE>').   For simplicity, we only mention these routinesin following sections rather than providing complete definitions and descriptions,as they are the same as their corresponding variable argument equivalents.</P><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="bldngevtrcrds" x-level=1 x-title="AEBuilding Apple Event Records"></A><H2>AEBuilding Apple Event Records</H2><P>The syntax of the formatting string for an entire Apple event (as passed to<CODE>AEBuildAppleEvent</CODE>) is almost identical to that used to represent the contentsof an Apple event record, without the curly braces.  The event is defined as asequence of name-value pairs, with optional parameters preceded with atilde (<CODE>~</CODE>) character.  The routine <CODE>AEBuildAppleEvent</CODE> can be used to build anentire Apple event record, and the routine <CODE><A HREF="#AEBuildParameters">AEBuildParameters</A></CODE> can be usedto add additional parameters to an existing Apple event record.  These tworoutines are described in this section.</P><A NAME="AEBuildAppleEvent" x-level=2 x-title="AEBuildAppleEvent"></A><H3>AEBuildAppleEvent</H3><P>You can use the <CODE>AEBuildAppleEvent</CODE> routine to construct an entire Apple event record in a single call. It is very similar in function to the <CODE>AECreateAppleEvent</CODE> routine, except in addition to creating the <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> record, it also constructs the parameters for the event from the last three arguments. For more information about the <CODE>AECreateAppleEvent</CODE> routine, see the Apple Event Manager documentation.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>OSStatus AEBuildAppleEvent(    <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEEventClass.html">AEEventClass</A> theClass,    <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEEventID.html">AEEventID</A> theID,    <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/DescType.html">DescType</A> addressType,    const void* addressData,    long addressLength,    short returnID,    long transactionID,    <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A>* result,    <A HREF="#AEBuildError">AEBuildError</A>* error,    /* can be NULL */    const char* paramsFmt,    ...);NOTE: AEBuildAppleEvent has a varargs equivalent      named vAEBuildAppleEvent.</pre><P><B>Parameters:</B></P><UL><LI><CODE>theClass</CODE> - The event class for the resulting Apple event.<BR><BR></LI><LI><CODE>theID</CODE> - The event id for the resulting Apple event.<BR><BR></LI><LI><CODE>addressType</CODE> - The address type for the addressing information describedin the next two parameters: usually one of <CODE>typeApplSignature</CODE>, <CODE>typeProcessSerialNumber</CODE>,or <CODE>typeKernelProcessID</CODE>.<BR><BR></LI><LI><CODE>addressData</CODE> - A pointer to the address information.<BR><BR></LI><LI><CODE>addressLength</CODE> - The number of bytes pointed to by the <CODE>addressData</CODE>parameter.<BR><BR></LI><LI><CODE>returnID</CODE> - Usually, set to the value <CODE>kAutoGenerateReturnID</CODE>.  See theApple Event Manager documentation for more information.<BR><BR></LI><LI><CODE>transactionID</CODE> - Usually, set to the value <CODE>kAnyTransactionID</CODE>.  See theApple Event Manager documentation for more information.<BR><BR></LI><LI><CODE>result</CODE> - A pointer to an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> record where the resulting descriptorshould be stored.<BR><BR></LI><LI><CODE>error</CODE> - A pointer to a <CODE><A HREF="#AEBuildError">AEBuildError</A></CODE> structure where additionalinformation about any errors that occur will be saved.  This is an optionalparameter and the value <CODE>NULL</CODE> may be provided in its place if this informationis not required.<BR><BR></LI><LI><CODE>paramsFmt</CODE> - An <CODE>AEBuild</CODE> format string describing the <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> recordto be created.<BR><BR></LI><LI><CODE>...</CODE> - A variable number of parameters as required by theformat string provided in the <CODE>paramsFmt</CODE> parameter.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success ofthe <A HREF="#AEBuildDesc">AEBuildDesc</A> call.  A value of <CODE>AEBuildSyntaxNoErr</CODE> (zero) means the callsucceeded.  The <CODE>error</CODE> parameter can be used to discover informationabout other errors.</P></TD></TR></TABLE></CENTER><BR><BR>   <BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>IMPORTANT:</B><BR>The identifier for the direct parameter in an Apple event record isfour minus signs <CODE>'----'</CODE>.  The minus sign has special meaning in <CODE>AEBuild</CODE>strings, and it should always be enclosed in single quotes when it is usedto identify the direct parameter for an Apple event in a descriptorstring.</P></TD></TR></TABLE></CENTER><BR><BR>                    <P><A HREF="#buildeventex">Listing 1</A> provides an example of how you can usethe <CODE><A HREF="#AEBuildAppleEvent">AEBuildAppleEvent</A></CODE> routine to create an Open Documents Apple event.  The event createdin the sample targets the Finder application, using its creator code (<CODE>'MACS'</CODE>).</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="buildeventex" kind = "Listing">Listing 1</A>.</B> An example of how to create an OpenDocuments Apple event using the <CODE><A HREF="#AEBuildAppleEvent">AEBuildAppleEvent</A></CODE> routine.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre><A href="../../documentation/mac/Files/Files-341.html">AliasHandle</A> first_file, second_file;const OSType finderSignature = 'MACS';<A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A> event;OSErr err;<A href="../../documentation/Carbon/Files/FileManager/File_Manager/DataTypes/FSRef.html">FSRef</A> file1ref;<A href="../../documentation/Carbon/Files/FileManager/File_Manager/DataTypes/FSSpec.html">FSSpec</A> file2spec;    /* Construct the aliases...*/err = <A href="../../documentation/Carbon/Files/AliasManager/Alias_Manager/Functions/Miscellaneou10456789101112.html#//apple_ref/C/func/FSNewAlias">FSNewAlias</A>(NULL, &amp;file1ref, &first_file);if (err == noErr) {  err = <A href="../../documentation/Carbon/Files/AliasManager/Alias_Manager/Functions/Creating_and_lias_Records.html#//apple_ref/C/func/NewAlias">NewAlias</A>(NULL, &amp;file2spec, &amp;second_file);  if (err == noErr) {    err = <A HREF="#AEBuildAppleEvent">AEBuildAppleEvent</A>(        kCoreEventClass, kAEOpenDocuments,        typeApplSignature, &amp;finderSignagure, sizeof(finderSignature),        kAutoGenerateReturnID, kAnyTransactionID,        &amp;event,   /* event to be created */        NULL,   /* no error information required */        "'----':[alis(@@), alis(@@)]", /* format string */        first_file, /* param for 1st @@ */        second_file); /* param for 2nd @@ */</pre></TD></TR></TABLE></CENTER><BR><BR><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="AEBuildParameters" x-level=2 x-title="AEBuildParameters"></A><H3>AEBuildParameters</H3><P><CODE>AEBuildParameters</CODE> can be called one or more times to add additional parametersor attributes to an existing Apple event record.  The Apple event record shouldalready have been created through either a call to <CODE>AECreateAppleEvent</CODE> or <CODE><A HREF="#AEBuildAppleEvent">AEBuildAppleEvent</A></CODE>.  For more information about the <CODE>AECreateAppleEvent</CODE> routine,see the Apple Event Manager documentation.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>OSStatus AEBuildParameters(    <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A>* event,    <A HREF="#AEBuildError">AEBuildError</A>* error, /* can be NULL */    const char* format,    ...);NOTE: AEBuildParameters has a varargs equivalent      named vAEBuildParameters.</pre><P><B>Parameters:</B></P><UL><LI><CODE>event</CODE> - A pointer to an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> record where the new parametersshould be added.<BR><BR></LI><LI><CODE>error</CODE> - A pointer to a <CODE><A HREF="#AEBuildError">AEBuildError</A></CODE> structure where additionalinformation about any errors that occur will be saved.  This is an optionalparameter and the value <CODE>NULL</CODE> may be provided in its place if this informationis not required.<BR><BR></LI><LI><CODE>format</CODE> - An <CODE>AEBuild</CODE> format string describing the <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> parameters to be added.<BR><BR></LI><LI><CODE>...</CODE> - A variable number of parameters as required by theformat string provided in the <CODE>format</CODE> parameter.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success ofthe <CODE><A HREF="#AEBuildParameters">AEBuildParameters</A></CODE> call.  A value of <CODE>AEBuildSyntaxNoErr</CODE> (zero) means the callsucceeded.  The <CODE>error</CODE> parameter can be used to discover informationabout other errors.</P></TD></TR></TABLE></CENTER><BR><BR>                    <P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="AEPrintDescToHandle" x-level=2 x-title="AEPrintDescToHandle"></A><H2>AEPrintDescToHandle</H2><P><CODE>AEPrintDescToHandle</CODE> provides a pretty printer facility for Apple event descriptorrecords.  Information describing an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> record is returned formatted in thespecial <CODE>AEBuild</CODE>* syntax.  This facility is especially useful for looking atthe contents of Apple event records sent by other applications and fordebugging the Apple event descriptors created by your own application.Here is the definition for <CODE>AEPrintDescToHandle</CODE>:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>OSStatus AEPrintDescToHandle(    const <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A>* desc,    Handle* result);</pre><P><B>Parameters:</B></P><UL><LI><CODE>desc</CODE> - A pointer to the Apple event descriptor record thatshould be printed out.<BR><BR></LI><LI><CODE>result</CODE> - A pointer to a location where a newly createdMemory Manager '<CODE>Handle</CODE>' containing the descriptor-string should be stored.<BR><BR></LI></UL><P><B>Result:</B><BR>A numeric result code indicating the success ofthe <CODE><A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A></CODE> call.  A value of <CODE>AEBuildSyntaxNoErr</CODE> (zero) means the callsucceeded.</P></TD></TR></TABLE></CENTER><BR><BR>                    <P>When <CODE><A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A></CODE> is asked to print an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE>, an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE>,or an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE>,then the format of the printed output will match the input expected by <CODE><A HREF="#AEBuildDesc">AEBuildDesc</A></CODE>.When printing, <CODE><A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A></CODE> tries to identify <CODE>AERecords</CODE> that have been coercedto different types and prints them as coerced records.  Other structures that cannotbe identified are dumped as hexadecimal data.  For example, here is the <CODE><A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A></CODE>output for a list of three items:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>[ "Mac OS X", 'null'(), 44]</pre></TD></TR></TABLE></CENTER><BR><BR><P><CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> records, though, are printed in a slightly different format.  Here, theevent class and event ID are printed at the beginning of a string, the parameterlist is printed as a record in curly braces, and attributes are printed with theiridentifiers preceded by ampersand characters.  For example, here is<CODE><A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A></CODE> output for an Open Documents Apple Event:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>aevt\odoc{ ----:"Mac OS X",           &amp;addr:psn ($0000000000040001$),           &amp;subj:'null'(),           &amp;csig:magn($00010000$) }</pre></TD></TR></TABLE></CENTER><BR><BR>                    <P>The printed output produced for <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> records is different than theysyntax accepted by the <CODE>AEBuild</CODE>* suite of routines and this output cannotbe used as input to <CODE><A HREF="#AEBuildAppleEvent">AEBuildAppleEvent</A></CODE>.  </P><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="dssyntax" x-level=1 x-title="Descriptor-String Syntax"></A><H2>Descriptor-String Syntax</H2><P>Descriptor-strings are provided as null terminated c-stylestrings.  Older instantiations of this library used some specialMacRoman characters for some language symbols.  These are stillsupported but new 7-bit ASCII alternatives have been added in additionto these older characters.  Forward moving code should use the newpreferred 7-bit ASCII characters.</P><BR><BR><A NAME="dssyntaxdt" x-level=2 x-title="Data Types"></A><H3>Data Types</H3><P>Four basic data types are provided in the descriptor-string syntax:  integer,four-letter type codes, text strings, and hexadecimal data.  <A HREF="#typestable">Table 2</A>shows some examples of these types as expressed in the language.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="typestable" kind = "Table">Table 2</A>.</B> Basic <CODE>AEBuild</CODE> data types.</P><TABLE border="1"><TR> <td align="left">   <P><B>Type</B></P> </TD> <td align="left">   <P><B>Examples</B></P> </TD> <td align="left">   <P><B>Type code of <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> created</B></P> </TD> <td align="left">   <P><B>Description</B></P> </TD></TR><TR> <td align="left">   <P>Integer</P> </TD> <td align="left">   <P>1234<BR>-5678</P> </TD> <td align="left">   <P><CODE>'shor'</CODE> or <CODE>'long'</CODE></P> </TD> <td align="left">   <P>A sequence of decimal digits optionally preceded by a minus sign.      Integers that are between <CODE>-32768</CODE> and <CODE>32767</CODE> are converted   to descriptors of type <CODE>typeShortInteger</CODE>.  Values outside of that   range are converted to <CODE>typeLongInteger</CODE>.  If your implementation   requires specific numeric types, you should always specify coercion.   </P>    </TD></TR><TR> <td align="left">   <P>Type Codes</P> </TD> <td align="left">   <P><CODE>whos</CODE><BR>   <CODE>longint</CODE><BR>   <CODE>'long'</CODE><BR>   <CODE>m</CODE></P> </TD> <td align="left">   <P><CODE>'enum'</CODE> (use coercion to change to <CODE>'type'</CODE>)</P> </TD> <td align="left">   <P>A type code must begin with a letter and is followed by any   number of non-AEBuild-syntax characters.  Only the first four characters   are used: the type code will be truncated or padded with spaces to create   a four character code.<BR><BR>      If enclosed in single quotes, then it may contain special AEBuild-syntax characters.<BR><BR>      Definitions for many of the type codes used by applications and system software   can be found in the system header files:  &lt;AEDataModel.h&gt;, &lt;AERegistry.h&gt;,   and &lt;AppleEvents.h&gt;.   </P> </TD></TR><TR> <td align="left">   <P>String</P> </TD> <td align="left">   <P>"A String"<BR>   "Multiple lines<BR>   are okay."</P> </TD> <td align="left">   <P><CODE>'TEXT'</CODE></P> </TD> <td align="left">   <P>Any sequence of characters between double quotes.  The created <CODE>'TEXT'</CODE>   descriptor record will not include a terminating null character.</P> </TD></TR><TR> <td align="left">   <P>Hex Data</P> </TD> <td align="left">   <P><CODE>$4170706C65$</CODE><BR>   <CODE>$ 0102 03ff<BR>   e b 6 c $</CODE></P> </TD> <td align="left">   <P>?? (must be coerced to some type)</P> </TD> <td align="left">   <P>An even number of hex digits between dollar signs.  Whitespace is ignored.   Hex data has no inherent type.  As a result, it must be coerced to some type   whenever it is used.</P> </TD></TR></TABLE></TD></TR></TABLE></CENTER><BR><BR>                    <BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>IMPORTANT:</B><BR>Watch out for type codes that contain special characterslike commas, parentheses, braces, or non-trailing spaces, or that begin witha special character like <CODE>'-'</CODE>.  These characters are used by <CODE>AEBuild</CODE> aspart of its syntax.  If you need to use any of these special characters ina type code, then enclose the type code in single quotes.</P></TD></TR></TABLE></CENTER><BR><BR><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="dssyntaxtc" x-level=2 x-title="Type Coercion"></A><H3>Type Coercion</H3><P>Any of the basic data types shown in <A HREF="#typestable">Table 2</A> (except for hex data)has its own inherent data type associated with it that defines the type of the descriptorrecord that is created. If you would like a descriptor of a differenttype containing the same data, you can direct <CODE>AEBuild</CODE>* to create it by usingthe coercion syntax.  The componentsof a coercion are the desired type code and the basic data type you would liketo use.  These items are provided in the following format (the desired typecode followed by the basic data type enclosed in parentheses):</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><pre>        &lt;desired type code&gt; <B>(</B> &lt;data of any type&gt; <B>)</B></pre></TD></TR></TABLE></CENTER><BR><BR>                    <P>Directing <CODE>AEBuild</CODE> to perform a type coercion of this kind does not call anyinstalled coercion handlers (the exception being the numericcoercions).  Rather, it directs <CODE>AEBuild</CODE> to create a descriptor record containingexactly the same data but with a different type.  Here are some examples:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>  sing(123)  type(line)  hexd("a string")  'blob'($4170706C65$)  'utxt'($0048 0045 004C  004C 004F$)</pre></TD></TR></TABLE></CENTER><BR><BR>     <P>Installed Apple event coercion handlers are only called for numeric types (thisis the only case where an <CODE>errAECoercionFail</CODE> error can be returned ).  All other<CODE>AEBuild</CODE> coercions do nothing more than set the descriptor type field in theresulting descriptor record.</P><P>You can use coercion to create empty (or <CODE>'null'</CODE>) descriptor records by using one of the following syntax forms. All of these create empty descriptor records with zero length data. </P> <BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>  null()  'null'()  ()</pre></TD></TR></TABLE></CENTER><BR><BR>                    <P>The last form, <CODE>()</CODE>, though less explicit, can be used to create anempty or null descriptor.</P><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="dssyntaxcdt" x-level=1 x-title="Complex Data Types"></A><H2>Complex Data Types</H2><P>Apple event descriptors may contain two types of complex data structures containing,potentially, many other Apple event descriptor records.  Lists, as the name suggests,contain a list of descriptor records.  Records, contain a group of name-value pairswhere the names are four letter type codes and the values are descriptor records.Both of these complex types are enclosed in Apple event descriptor records and sothey may be used in a recursive fashion.  That is to say, lists may contain listsor records and records may contain records or lists.  The next two sections describeAEBuild declarations for these types in greater detail.</P><A NAME="dssyntaxcli" x-level=2 x-title="Lists"></A><H3>Lists</H3><P>Apple event list descriptors contain zero or more Apple event descriptors.  Thereis no requirement that they all be of the same type or even of the same format.  In <CODE>AEBuild</CODE> descriptor-strings, a list of descriptors is specified by providinga, possibly empty, list of comma separated descriptor records enclosed in squarebrackets.  </P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><pre>        <B>[</B> &lt;descriptor&gt;<B>,</B> &lt;descriptor&gt;... <B>]</B></pre></TD></TR></TABLE></CENTER><BR><BR><P>This syntax will create a <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A></CODE> descriptor record (an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> record with thetype <CODE>'list'</CODE>).  Here are some examples of valid <CODE>AEBuild</CODE> descriptor-strings defininglists:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>[123, -456, "et cetera"][sing(1234), long(CODE)][["wheels", "within wheels"]][sing(1234), long(CODE), [[123, -456, "et cetera"], "within wheels"]][]</pre></TD></TR></TABLE></CENTER><BR><BR><P>It is not possible to coerce a list to any other type - the descriptor typeof a list is always set to <CODE>'list'</CODE>.  <CODE>AEBuild</CODE> descriptor-strings that includeattempts to coerce a list to another type will not work.</P>                   <P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="dssyntaxcrec" x-level=2 x-title="Records"></A><H3>Records</H3><P>A descriptor record is a group of name-value pairs in no particular order.In each name-value pair, the name is represented as a four letter type codeand the value can be any valid descriptor.  In <CODE>AEBuild</CODE> descriptor-stringsyntax an <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> is declared as a comma separated list of name-value pairsenclosed in curly brackets:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><pre>        <B>{</B> &lt;name&gt; <B>:</B> &lt;value&gt;,<B></B> &lt;name&gt; <B>:</B> &lt;value&gt;... <B>}</B></pre></TD></TR></TABLE></CENTER><BR><BR><P>Names and associated values are separated by <CODE>':'</CODE> colon characters.  By default,a record's type is set to <CODE>'reco'</CODE>, but a record can be coerced to any type bypreceding it's definition with the type code that should be used for therecord:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><pre>        &lt;type code&gt;<B> {</B> &lt;name&gt; <B>:</B> &lt;value&gt;<B>,</B> &lt;name&gt; <B>:</B> &lt;value&gt;... <B>}</B></pre></TD></TR></TABLE></CENTER><BR><BR><P>Here are some examples of <CODE>AEBuild</CODE>descriptor-strings containing valid <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A></CODE> declarations:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>{x: 100, y:-100}{'origin': {x: 100, y:-100}, extent: {x: 500, y:500},   cont: [1, 5, 25]}{}rang{ star: 5, stop: 6}</pre></TD></TR></TABLE></CENTER><BR><BR>                    <P>The default type of a record is <CODE>'reco'</CODE>.    You can coerce a record structure to anytype by preceding it with a type code.  For example:</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre> rang{ star: 5, stop: 6}</pre></TD></TR></TABLE></CENTER><BR><BR>                    <P>It is common for <CODE>AERecords</CODE> to be coerced to another type such as <CODE>'indx'</CODE> or<CODE>'whos'</CODE>, but you should avoid coercing <CODE>AERecords</CODE> to common data types such as<CODE>'long'</CODE> or <CODE>'TEXT'</CODE> as that will confuse other applicationsand even facilities like <CODE>AEPrint</CODE>.  </P><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="dssyntaxcparam" x-level=1 x-title="Parameter Substitution"></A><H2>Parameter Substitution</H2><P>The <CODE>AEBuild</CODE>* suite of routines provides a powerful set of two substitutionoperators that can be used to read optional arguments provided to the<CODE>AEBuild</CODE>* routines.  Using a method very similar to the facility providedby the standard-C library's <CODE>printf</CODE> routine,  all of the <CODE>AEBuild</CODE>* routinesaccept an <CODE>AEBuild</CODE> descriptor-string together with a variable length parameterlist.  Arguments in the variable length parameter list are incorporated intothe resulting descriptor record according to the placement of substitutionoperators in the <CODE>AEBuild</CODE> descriptor-string.</P> <P>Substitution operators may be placed in an <CODE>AEBuild</CODE> descriptor-string in anyplace where a descriptor could be defined.  The type of value created (andthe type of parameter expected) depends on the context of the substitutionoperator in the <CODE>AEBuild</CODE> descriptor-string.  Normally, the coercion operatorapplied to the substitution operator will determine the type of the descriptorcreated and the type of data expected as a command line parameter.</P><P>The special substitution operators are <CODE>'@'</CODE> and <CODE>'@@'</CODE>.<A HREF="#cotable">Table 3</A>details how these operators are interpreted by <CODE>AEBuild</CODE>.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="cotable" kind = "Table">Table 3</A>.</B> Coercions and argument type requirements.</P><TABLE border="1"><TR> <td align="left">    <P><B>Type Coercion Specified</B></P> </TD> <td align="left">   <P><B>Type of parameter expected</B></P> </TD> <td align="left">    <P><B>Example</B></P> </TD> <td align="left">   <P><B>Comments</B></P> </TD></TR><TR> <td align="left">   <P>No coercion</P> </TD> <td align="left">   <P><CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A>*</CODE></P> </TD> <td align="left"> <pre><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A> mydesc;AEBuild(..., "@",    &amp;mydesc); </pre> </TD> <td align="left">   <P>A plain <CODE>'@'</CODE> will be replaced with a descriptor parameter.  <CODE>'@@'</CODE> cannot   be specified in this case.</P> </TD></TR><TR> <td align="left">   <P>Numeric (bool, shor, long, sing, doub, exte)</P> </TD> <td align="left">   <P>short, short, long, float, short double, double</P> </TD> <td align="left"> <pre>AEBuild([....]    "long(@)",    44); </pre> </TD> <td align="left">   <P>numeric types are provided 'as is' on the command line.</P> </TD></TR><TR> <td align="left">   <P>TEXT</P> </TD> <td align="left">   <P><CODE>char*</CODE></P> </TD> <td align="left"> <pre>AEBuild([....]    "TEXT(@)",    "hello world"); </pre> </TD> <td align="left">   <P>A pointer to a null-terminated C string.  The '<CODE>TEXT(@)</CODE>' will be replaced   with a descriptor of type <CODE>'TEXT'</CODE> containing all of the text (except for the   terminating zero byte) from the C-string.  <CODE>'@@'</CODE> cannot be specified in this case. </P> </TD></TR><TR> <td align="left">   <P>Any other type</P> </TD> <td align="left">   <P>either a (length, pointer) pair or a <CODE>Handle</CODE>.</P> </TD> <td align="left"> <pre>MyType myVar;AEBuild([....]    "myst(@)",    sizeof(myVar),    &amp;myVar); </pre> </TD> <td align="left">   <P>Data for <CODE>'@'</CODE> will be read from two parameters: a long integer value specifying   the number of bytes followed by a pointer to the bytes.  If <CODE>'@@'</CODE> is provided,   the data will be read from a Carbon Memory Manager 'Handle' value provided   as a parameter. </P> </TD></TR></TABLE></TD></TR></TABLE></CENTER><BR><BR><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR><A NAME="dssyntaxcprgdb" x-level=1 x-title="Using AEPrint* with gdb"></A><H2>Using AEPrint* with gdb</H2><P>When you are writing event handlers and AppleScript scripts, it is often useful to know the format of the Apple events that are sent between applications. This section shows how you can use the <CODE><A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A></CODE> routine in <CODE>gdb</CODE> to view the format of the events sent from a Mac OS X application.</P><P><CODE>gdb</CODE> provides a <CODE>'call'</CODE> facility that allows you to call a routine.  In thisexample, the script shown in <A HREF="#adescscript">Listing 2</A> is used tocall <CODE><A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A></CODE> to prettyprint <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AppleEvent.html">AppleEvent</A></CODE> records to <CODE>gdb</CODE>'s terminal.  The example presented hereinassumes that this script is saved in a file named 'gdb-aedesc'; but, if you would like to havethis script loaded automatically every time you start <CODE>gdb</CODE>, then you can save it in your<CODE>~/.gdbinit</CODE> file.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="adescscript" kind = "Listing">Listing 2</A>.</B> A gdb script for pretty printing <CODE><A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A></CODE> records.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre>define aedesc  call (void *) malloc(4)  set $aed_malloc=$  call (long) <A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A>($arg0, $aed_malloc)  if $ == 0    printf "desc @ %p = {\n    type = '%.4s'\n    storage (%p) = %s\n}\n", \      $arg0, $arg0, ((long *) $arg0)[1], **(char ***) $aed_malloc    call (void) <A href="../../documentation/mac/Memory/Memory-73.html">DisposeHandle</A>(*(char ***) $aed_malloc)  else    printf "aedesc failed: error %d.\n", $  end  call (void) free($aed_malloc)end</pre></TD></TR></TABLE></CENTER><BR><BR> <P>Let's assume we are running the Script Editor in Mac OS X and we have typedthe script shown in <A HREF="#theexamplescript">Listing 3</A> into one of its windows,checked the syntax a few times, andrun it a few times to verify that it is working correctly.  And, after runningit a few times we would like to find out more information about the Apple eventsthat are being sent when this script runs.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="theexamplescript" kind = "Listing">Listing 3</A>.</B> A simple script.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre>tell application "Finder"    activate    open "Mac OS X"end tell</pre></TD></TR></TABLE></CENTER><BR><BR>                    <P>The log of a terminal session shown in <A HREF="#gdbloglisting">Listing 4</A> illustrateshow we can use the aedesc <CODE>gdb</CODE> script to find out more information about theApple events that the ScriptEditor is sending when we run the script.  Comments that have been added tothe script are preceded with <CODE>'##'</CODE> characters.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td align="left"><P><B><A NAME="gdbloglisting" kind = "Listing">Listing 4</A>.</B> gdb session log.</P></TD></TR><TR><td bgcolor="#E6E6E6" align=left><pre>    ## in a terminal window, start up gdb[neithermac:/] apple% gdbGNU gdb 5.0-20001113 (Apple version gdb-203) ([....] GMT 2001) (UI_OUT)Copyright 2000 Free Software Foundation, Inc.GDB is free software, covered by the GNU General Public License, and youare welcome to change it and/or distribute copies of it under certainconditions.Type "show copying" to see the conditions.There is absolutely no warranty for GDB.  Type "show warranty" for details.This GDB was configured as "powerpc-apple-macos10".    ## read in our aedesc script.  I usually type 'source ' then drag    ## and drop the file icon for the script into the terminal window,    ## but you can also add the script to your gdb configuration    ## (see 'man gdb').  the script defines the command 'aedesc' that    ## we can use to call <A HREF="#AEPrintDescToHandle">AEPrintDescToHandle</A> to pretty print descriptors.(gdb) source /Users/apple/gdb-aedesc    ## next we attach to the Script Editor's process.  It has process    ## id 1312 that we established before our gdb session.  you can    ## look up the process id for running process using 'top -l'    ## or 'ps -aux'(gdb) attach 1312Reading symbols for shared libraries . doneReading symbols for shared libraries ...................................................... done[Switching to process 1312 thread 0x1603]    ## then, set a breakpoint on AESend so we can trap outgoing events(gdb) break AESendBreakpoint 1 at 0x731ddbec    ## and tell gdb to allow the Script Editor to continue running.(gdb) continueContinuing.    ## now, with the Script Editor we switch back and click on the    ## 'run' button to run the script.    ## we break on the the activate eventBreakpoint 1, 0x731ddbec in AESend ()    ## ask the script to pretty print our descriptor (in $r3)(gdb) aedesc $r3$1 = (void *) 0x1bb8310$2 = 0desc @ 0xbfffe398 = {    type = 'aevt'    storage (0x150d858) = misc\actv{ &amp;addr:psn ($0000000000040001$),                  &amp;subj:'null'(), &amp;csig:magn($00010000$) }}    ## and tell gdb to allow the Script Editor to continue running.(gdb) continueContinuing.    ## we break on the the open document eventBreakpoint 1, 0x731ddbec in AESend ()    ## ask the script to pretty print our descriptor (in $r3)(gdb) aedesc $r3$3 = (void *) 0x16ea1c0$4 = 0desc @ 0xbfffe2c8 = {    type = 'aevt'    storage (0x150d858) = aevt\odoc{ ----:"Mac OS X",                  &amp;addr:psn ($0000000000040001$), &amp;subj:'null'(),                  &amp;csig:magn($00010000$) }}    ## and tell gdb to allow the Script Editor to continue running.(gdb) continueContinuing.</pre></TD></TR></TABLE></CENTER><BR><BR>                    <P>This same technique can be used to look at Apple events being sent by anyMac OS X application.  </P><P><A HREF="#topofdocument">Back to top</A></P>                          <BR><BR><A NAME="dsgrammar" x-level=1 x-title="Descriptor-String Grammar"></A><H2>Descriptor-String Grammar</H2><P>What follows is a<A HREF="http://cui.unige.ch/db-research/Enseignement/analyseinfo/AboutBNF.html">Backus Naur Form (BNF)</A>grammar definition for <CODE>AEBuild</CODE> descriptor-strings.</P><BR><BR><CENTER><TABLE BORDER=0 CELLPADDING=4 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre># NOTE: comments inserted amongst rules are preceded by '#' characters.# They are not part of the BNF.# syntax rules for <A HREF="#AEBuildAppleEvent">AEBuildAppleEvent</A>AEBuild-apple-event-expression ::= &lt;event-keyword-list&gt;# event-keyword-list - list of zero or more event-keyword-pairs# separated by commasevent-keyword-list ::= &lt;event-keyword-pair&gt; , &lt;event-keyword-list&gt;event-keyword-list ::= &lt;event-keyword-list&gt;event-keyword-list ::=# event-keyword-pair an identifier object pair - preceded# by a tilde ~ to indicate an optional parameterevent-keyword-pair ::= ~ &lt;identifier&gt; : &lt;object&gt;event-keyword-pair ::= &lt;identifier&gt; : &lt;object&gt;#syntax rules for <A HREF="#AEBuildDesc">AEBuildDesc</A>AEBuild-expression ::= &lt;object&gt;object ::= &lt;data&gt;                    # Single <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A>; shortcut for (data)object ::= &lt;structure&gt;               # un-coerced structureobject ::= &lt;identifier&gt; &lt;structure&gt;  # coerced to some other typestructure ::= ( &lt;data&gt; )             # Single <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDesc.html">AEDesc</A>structure ::= [ &lt;object-list&gt; ]      # <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AEDescList.html">AEDescList</A> typestructure ::= { &lt;keyword-list&gt; }     # <A href="../../documentation/Carbon/interapplicationcomm/AppleEventManager/Apple_Event_Manager/DataTypes/AERecord.html">AERecord</A> type# comma separated list of zero or more objectsobject-list ::= &lt;object-list&gt; , object&gt;object-list ::= &lt;object&gt;object-list ::=# comma separated list of zero or more keyword/value pairskeyword-list ::= &lt;keyword-list&gt; , &lt;keyword-pair&gt;keyword-list ::= &lt;keyword-pair&gt;keyword-list ::=keyword-pair ::= &lt;identifier&gt; : &lt;object&gt;  # keyword/value pair# @ and @@ are special tokens used for reading AEBuild# parameters in to descriptors as they are constructeddata ::= @             # read data from AEBuild parameterdata ::= @@            # read data from AEBuild Handle parameterdata ::= &lt;integer&gt;     # 'shor' or 'long' unless coerceddata ::= &lt;identifier&gt;  # a 4-char type code ('type') unless coerceddata ::= &lt;string&gt;      # unterminated text: 'TEXT' type unless coerceddata ::= &lt;hex-string&gt;  # raw hex data; must be coerced to some type!data ::=               # empty null data, useful for 'null()' coercionsinteger ::= - &lt;number&gt;integer ::= &lt;number&gt;number ::= &lt;number&gt; &lt;digit&gt;number ::= &lt;digit&gt;digit ::= 0 .. 9# no spaces allowed inside of identifers unless they# are enclosed in single quotes.  identifiers# are always padded (with spaces) or truncated to# exactly 4 characters by AEBuild and friends.identifier ::= &lt;first-ident-letter&gt; &lt;ident-letter-list&gt;identifier ::= ' &lt;any-letter letter-list&gt; '   # straight quotes (preferred)identifier ::= &#145; &lt;any-letter letter-list&gt; &#145;   # curly quotesident-letter-list ::= &lt;ident-letter-list&gt; &lt;ident-letter&gt;ident-letter-list ::= &lt;ident-letter&gt;ident-letter-list ::=first-ident-letter ::= alphabetic characters# special AEBuild language characters cannot be included inside# of identifiers.  To use identifiers containing them, enclose# the identifer in single quotes.ident-letter ::= any printable character excluding spaces                 and special AEBuild charactersstring ::= " &lt;letter-list&gt; "     # straight double quotes (preferred)string ::= &#147; &lt;letter-list&gt; &#148;     # curly double quotesletter-list ::= &lt;letter-list&gt; &lt;any-letter&gt;letter-list ::= &lt;any-letter&gt;letter-list ::=any-letter ::= any printable character including spaces               and special AEBuild characters.# hex-strings may contain white space between digits# so feel free to add them for formattinghex-string ::= $ &lt;hex-digit-list&gt; $   # dollarsign quotes (preferred)hex-string ::= &laquo; &lt;hex-digit-list&gt; &raquo;   # french quoteshex-digit-list ::= &lt;hex-digit-list&gt; &lt;hex-digit-pair&gt;hex-digit-list ::= &lt;hex-digit-pair&gt;hex-digit-list ::=hex-digit-pair ::= &lt;hex-digit&gt; &lt;hex-digit&gt;hex-digit ::= digits 0 .. 9 or letters A .. F (case insensitive)</pre></TD></TR></TABLE></CENTER><BR><BR><P><A HREF="#topofdocument">Back to top</A></P>         <BR><BR>                      <A NAME="doenloeads" x-level=1 x-title="Downloads"></A>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (64K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tn2045.pdf">Download</A></P>               </TD>            </TR>         </TABLE>         <BR>                  <P><A HREF="#topofdocument">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn2045.html%3Fid%3DDTS10003078-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn2045.html%3Fid%3DDTS10003078-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn2045.html%3Fid%3DDTS10003078-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>