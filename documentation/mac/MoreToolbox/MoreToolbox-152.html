<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Providing Help Balloons for Dynamic Windows (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING152></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-151.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-153.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-138.html"><B>Chapter 3 - Help Manager</B></A> / <A HREF="MoreToolbox-143.html"><B>Using the Help Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING152-0></A>
<H2><A NAME=MARKER-9-323></A><A NAME=MARKER-21-324></A>Providing Help Balloons for Dynamic Windows</H2>
 <A NAME=MARKER-2-325></A>To create help balloons for objects whose location in the content area of windows may vary, your application needs to use Help Manager routines to display and remove balloons as the user moves the cursor.<P>
<DL>
<DT><B>Note</B>
<DD>Nonprogrammers can use the BalloonWriter tool to provide you with delimited ASCII text that you can then use in conjunction with Help Manager routines to display balloons for dynamic windows. However, BalloonWriter does not create the resources or routines necessary to automatically display help balloons for these types of windows.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 You should display or remove help balloons for dynamic windows at the same time that you normally check the mouse location to display or change the cursor. For example, <BR>if you provide your own <CODE>DoIdle</CODE> procedure (as described in the chapter "Event Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>), you can also check the mouse location and, if the cursor is located in a hot rectangle, you should display the associated help balloon.<P>
 To create help balloons for the content area of a dynamic window, you need to<P>
<UL>
<LI>identify the hot rectangles for each area or object
<LI>create data structures to store the locations of the hot rectangles
<LI>determine how to calculate their changing locations
<LI>track and update the hot rectangles
<LI>use the <CODE>HMShowBalloon</CODE> function to display a help balloon when the cursor is located in a hot rectangle<A NAME=MARKER-9-180></A><P>
</UL>
 After defining all the hot rectangles within your content region, create separate <CODE>'STR '</CODE>, <CODE>'STR#'</CODE>, <CODE>'PICT'</CODE>, or <CODE>'TEXT'</CODE> and <CODE>'styl'</CODE> resources for the help balloons' messages. You don't have to store the help messages in these resources when using <CODE>HMShowBalloon</CODE>, but doing so makes your application easier to localize.<A NAME=MARKER-2-157></A><P>
 When you use the <CODE>HMShowBalloon</CODE> function, your application is responsible for tracking the cursor and determining when to display the help balloon. If you use the <CODE>HMShowBalloon</CODE> function, you can let the Help Manager track the cursor and determine when to remove the help balloon, or your application can remove the balloon when necessary by calling the <CODE>HMRemoveBalloon</CODE> function. If you display your own help balloons using the <CODE>HMShowBalloon</CODE> function, you should use the <CODE>HMGetBalloons</CODE> function to determine whether help is enabled before displaying a help balloon. If help is not enabled, you don't need to call any Help Manager routines that display balloons, because they won't do anything unless <CODE>HMGetBalloons</CODE> returns <CODE>TRUE</CODE>.<A NAME=MARKER-2-183></A><A NAME=MARKER-2-40></A><A NAME=MARKER-9-278></A><P>
 The <CODE>HMShowBalloon</CODE> function is useful for<P>
<UL>
<LI>windows whose content changes
<LI>windows that can be resized
<LI>windows that contain hot rectangles with variable locations
<LI>situations in which you want your application to have more control over the display and removal of the help balloon<P>
</UL>
 For example, windows with scrolling icons (such as the Users &amp; Groups dynamic window shown in <A HREF=MoreToolbox-149.html#MARKER-9-274>Figure 3-18 on page 3-59</A>) require you to use <CODE>HMShowBalloon</CODE> to display help balloons for the icons. Likewise, if you have tools--such as rulers that users configure for tab stops in a word-processing document--that scroll with a document, you'll need to use <CODE>HMShowBalloon</CODE> to display help balloons for the scrolling tools.<P>
 <A NAME=MARKER-2-187></A>When using <CODE>HMShowBalloon</CODE>, you specify the help message, the balloon tip's coordinates, an alternate rectangle to use if the Help Manager needs to move the tip, an optional pointer to a function that can modify the tip and alternate rectangle coordinates, the balloon definition function, and the variation code. In the final parameter to the <CODE>HMShowBalloon</CODE> function, provide a constant that tells the Help Manager whether to save the bits behind the balloon.<P>
<PRE>
myErr := HMShowBalloon(aHelpMsg, tip, alternateRect, tipProc, 
                       theProc, variant, method);
</PRE>
 Specify the help message in a help message record, which you pass in the <CODE>aHelpMsg</CODE> parameter to the <CODE>HMShowBalloon</CODE> function. You can specify the help message for each hot rectangle using text strings, <CODE>'STR '</CODE> resources, <CODE>'STR#'</CODE> resources, styled text resources, <CODE>'PICT'</CODE> resources, handles to styled text records, or handles to pictures.<P>
 The <CODE>HMMessageRecord</CODE> data type defines the help message record.<A NAME=MARKER-2-220></A><P>
<PRE>
TYPE HMMessageRecord = 
RECORD
   hmmHelpType:         Integer;             {type of next field}
   CASE Integer OF
      khmmString:       (hmmString: Str255); {Pascal string}
      khmmPict:         (hmmPict: Integer);  {'PICT' resource ID}
      khmmStringRes:    (hmmStringRes: HMStringResType); 
                                             {'STR#' resource }
                                             { ID and index}
      khmmTEHandle:     (hmmTEHandle: TEHandle);
                                             {TextEdit handle}
      khmmPictHandle:   (hmmPictHandle: PicHandle); 
                                             {picture handle}
      khmmTERes:        (hmmTERes: Integer); {'TEXT'/'styl' }
                                             { resource ID}
      khmmSTRRes:       (hmmSTRRes: Integer);{'STR ' resource ID}
END;
</PRE>
 The <CODE>hmmHelpType</CODE> field specifies the data type of the second field of the help message record. You specify one of these constants for the <CODE>hmmHelpType</CODE> field.<P>
<PRE>
CONST khmmString        = 1;     {Pascal string}
      khmmPict          = 2;     {'PICT' resource ID}
      khmmStringRes     = 3;     {'STR#' resource ID and index}
      khmmTEHandle      = 4;     {TextEdit handle}
      khmmPictHandle    = 5;     {picture handle}
      khmmTERes         = 6;     {'TEXT' and 'styl' resource ID}
      khmmSTRRes        = 7;     {'STR ' resource ID}
</PRE>
 You specify the help message itself in the second field of the help message record. <P>
 You can specify the help message by using a text string, a text string stored in a resource of type <CODE>'STR '</CODE>, or a text string stored as an <CODE>'STR#'</CODE> resource. You can also provide the information using styled text resources, or you can provide a handle to a styled text record. If you want to provide a picture for the help message, you can use a resource of type <CODE>'PICT'</CODE> or provide a handle to a picture.<P>
 <A HREF=#MARKER-9-333>Listing 3-11</A> illustrates how to specify a Pascal string using the <CODE>khmmString</CODE> constant in the help message record. (Although you can specify a string from within your code, storing the strings in resources and then accessing them through the Resource Manager makes localization easier.)<P>
<B>Listing 3-11  <A NAME=MARKER-9-333></A>Using a string resource as the help message for <CODE>HMShowBalloon</CODE></B><P>
<PRE>
PROCEDURE DoTextStringBalloon;
VAR
   aHelpMsg:         HMMessageRecord;
   tip:              Point;
   alternateRect:    RectPtr;
   err:              OSErr;
BEGIN
   aHelpMsg.hmmHelpType := khmmString;
   aHelpMsg.hmmString := 'To turn the page, click here.';
   MySetTipAndAltRect(tip, alternateRect); {initialize values}
   err := HMShowBalloon(aHelpMsg, tip, alternateRect,
                        NIL, 0, 0, kHMRegularWindow);
END;
</PRE>
 To use a picture, you can either store the picture as a <CODE>'PICT'</CODE> resource or create the <CODE>'PICT'</CODE> graphic from within your application and provide a handle to it. Because the Help Manager uses the resource itself or the actual handle that you pass to <CODE>HMShowBalloon</CODE>, your <CODE>'PICT'</CODE> resource should be purgeable, or, when using a handle to a <CODE>'PICT'</CODE> resource, you should release the handle or dispose of it when you are finished with it.<P>
 <A HREF=#MARKER-9-334>Listing 3-12</A> illustrates how to use the <CODE>khmmPict</CODE> constant for specifying a <CODE>'PICT'</CODE> resource ID in a help message record. The help message record is then passed in the <CODE>aHelpMsg</CODE> parameter of the <CODE>HMShowBalloon</CODE> function.<P>
<B>Listing 3-12  <A NAME=MARKER-9-334></A>Using a picture resource as the help message for <CODE>HMShowBalloon</CODE></B><P>
<PRE>
PROCEDURE DoPictBalloon;
VAR
   aHelpMsg:         HMMessageRecord;
   tip:              Point;
   alternateRect:    RectPtr;
   err:              OSErr;
BEGIN
   aHelpMsg.hmmHelpType := khmmPict;
   aHelpMsg.hmmPict := 128;      {resource ID of 'PICT' resource}
   MySetTipAndAltRect(tip, alternateRect); {initialize values}
   err := HMShowBalloon(aHelpMsg, tip, alternateRect,
                        NIL, 0, 0, kHMRegularWindow);
END;
</PRE>
 <A HREF=#MARKER-9-335>Listing 3-13</A> illustrates how to specify a handle to a <CODE>'PICT'</CODE> resource using the <CODE>khmmPictHandle</CODE> constant in the help message record. The help message record is then passed to the <CODE>HMShowBalloon</CODE> function in the <CODE>aHelpMsg</CODE> parameter.<P>
<B>Listing 3-13  <A NAME=MARKER-9-335></A>Using a handle to a picture resource as the help message for <CODE>HMShowBalloon</CODE></B><P>
<PRE>
PROCEDURE DoPictBalloon2;
VAR
   pict:          PicHandle;
   aHelpMsg:      HMMessageRecord;
   tip:           Point;
   pictFrame:     Rect;
   alternateRect: RectPtr;
   err:           OSErr;
BEGIN
   MySetPictFrame(pictFrame); {initialize pictFrame}
   pict := OpenPicture(pictFrame);
   DrawString('Test Balloon');
   ClosePicture;
   aHelpMsg.hmmHelpType := khmmPictHandle;
   aHelpMsg.hmmPictHandle := pict;
   MySetTipAndAltRect(tip, alternateRect); {initialize values}
   err := HMShowBalloon(aHelpMsg, tip, alternateRect,
                        NIL, 0, 0, kHMRegularWindow);
   KillPicture(pict);
END;
</PRE>
 To specify a help message stored in a string list (<CODE>'STR#'</CODE> resource) in a help message record, you must first create a Help Manager string list record. The <CODE>HMStringResType</CODE> data type defines a Help Manager string list record.<A NAME=MARKER-2-222></A><P>
<PRE>
TYPE HMStringResType = 
RECORD
   hmmResID:   Integer;    {resource ID of 'STR#' resource}
   hmmIndex:   Integer;    {index of string}
END;
</PRE>
 The <CODE>hmmResID</CODE> field specifies the resource ID of the <CODE>'STR#'</CODE> resource, and the <CODE>hmmIndex</CODE> field specifies the index of a string within that resource.<A NAME=MARKER-9-196></A><P>
 To use a string stored in an <CODE>'STR#'</CODE> resource with the <CODE>HMShowBalloon</CODE> function, use the <CODE>khmmStringRes</CODE> constant in the <CODE>hmmHelpType</CODE> field of the help message record, and supply the <CODE>hmmStringRes</CODE> field with a Help Manager string list record, as shown in <A HREF=#MARKER-9-339>Listing 3-14</A>. <A NAME=MARKER-2-114></A><P>
<B>Listing 3-14  <A NAME=MARKER-9-339></A>Using a string list resource as the help message for <CODE>HMShowBalloon</CODE></B><P>
<PRE>
PROCEDURE DoStringListBalloon;
VAR
   aHelpMsg:         HMMessageRecord;
   tip:              Point;
   alternateRect:    RectPtr;
   khmmStringRes:    HMStringResType;
   err:              OSErr;
BEGIN
   aHelpMsg.hmmHelpType := khmmStringRes;
   aHelpMsg.hmmStringRes.hmmResID := 1000;
   aHelpMsg.hmmStringRes.hmmIndex := 1;
   MySetTipAndAltRect(tip, alternateRect); {initialize values}
   err := HMShowBalloon(aHelpMsg, tip, alternateRect,
                        NIL, 0, 0, kHMRegularWindow);
END;
</PRE>
 To use styled text resources with the <CODE>HMShowBalloon</CODE> function, use the <CODE>khmmTERes</CODE> constant in the <CODE>hmmHelpType</CODE> field of the help message record. In the next field, supply a resource ID that is common to both a <CODE>'TEXT'</CODE> resource and a style scrap (<CODE>'styl'</CODE>) resource. For example, you might create a <CODE>'TEXT'</CODE> resource that contains the words "Displays your text in boldface print." You would also create a <CODE>'styl'</CODE> resource (with the same resource ID as the <CODE>'TEXT'</CODE> resource) that applies boldface style to the word "boldface." When you specify the <CODE>HMTEResItem</CODE> constant and the resource ID number of the <CODE>'TEXT'</CODE> and <CODE>'styl'</CODE> resources, the Help Manager employs TextEdit routines to display your text with your prescribed styles.<A NAME=MARKER-9-209></A><P>
 To use a handle to a styled text record, supply the <CODE>khmmTEHandle</CODE> constant in the <CODE>hmmHelpType</CODE> field, as illustrated in <A HREF=#MARKER-9-342>Listing 3-15</A>.<A NAME=MARKER-9-137></A><P>
<B>Listing 3-15  <A NAME=MARKER-9-342></A>Using styled text resources as the help message for <CODE>HMShowBalloon</CODE></B><P>
<PRE>
PROCEDURE DoStyledTextBalloon;
VAR
   aHelpMsg:         HMMessageRecord;
   tip:              Point;
   alternateRect:    RectPtr;
   hTE:              TEHandle;
   err:              OSErr;
BEGIN
   hTE := TEStyleNew(destRect, viewRect);    {or, use TENew}
   {be sure to fill in data in handle here}
   aHelpMsg.hmmHelpType := khmmTEHandle;
   aHelpMsg.hmmTEHandle := hTE;
   MySetTipAndAltRect(tip, alternateRect); {initialize values}
   err := HMShowBalloon(aHelpMsg, tip, alternateRect,
                        NIL, 0, 0, kHMRegularWindow);
END;
</PRE>
 <A NAME=MARKER-9-227></A><A NAME=MARKER-2-18></A><A NAME=MARKER-2-19></A>When using the <CODE>HMShowBalloon</CODE> function, you specify the tip in the <CODE>tip</CODE> parameter and the rectangle pointed to in the <CODE>alternateRect</CODE> parameter in global coordinates. The Help Manager calculates the location and size of the help balloon. If the help balloon fits onscreen, the Help Manager displays the help balloon using the specified tip.<P>
 If you use the previously described help resources to define help balloons, the Help Manager uses the hot rectangles you specify in the help resources for two purposes: first, to associate areas of the screen with help balloons and, second, to move the tip if the help balloon doesn't fit onscreen.<P>
 However, if you use the <CODE>HMShowBalloon</CODE> function to display help balloons, you must identify hot rectangles, create your own data structures to store their locations, track the cursor yourself, and call <CODE>HMShowBalloon</CODE> when the cursor moves to your hot rectangles. The Help Manager does not know the locations of your hot rectangles, so it cannot use them for moving the tip if the help balloon is placed offscreen. Instead, the Help Manager uses the alternate rectangle that you point to with the <CODE>alternateRect</CODE> parameter. Often, you specify the same coordinates for the alternate rectangle that you specify for your hot rectangle. However, you may choose to make your alternate rectangle smaller or larger than your hot rectangle. If you make your alternate rectangle smaller than your hot rectangle, you have greater assurance that the Help Manager will be able to fit the help balloon onscreen; if you specify an alternate rectangle that is larger than your hot rectangle, you have greater assurance that the help balloon will not obscure some object explained by the balloon.<A NAME=MARKER-2-20></A><P>
 By specifying a rectangle in the <CODE>alternateRect</CODE> parameter, you tell the Help Manager to call <CODE>HMRemoveBalloon</CODE> to automatically remove the balloon when the cursor leaves the area bounded by the rectangle. However, if you specify <CODE>NIL</CODE> for the <CODE>alternateRect</CODE> parameter, your application is responsible for tracking the cursor and determining when to remove the help balloon. When you specify <CODE>NIL</CODE>, the Help Manager also does not attempt to calculate a new tip position if the help balloon is offscreen.<A NAME=MARKER-2-62></A><A NAME=MARKER-2-59></A><P>
 Use the <CODE>tipProc</CODE> parameter (the fourth parameter to <CODE>HMShowBalloon</CODE>) to specify the tip function called by the Help Manager before displaying the balloon. Specify <CODE>NIL</CODE> to use the Help Manager's default tip function, or supply your own tip function and point to it in this parameter. Writing your own tip function is described in <A HREF=MoreToolbox-191.html#MARKER-9-509>"Application-Defined Routines" beginning on page 3-120</A>.<P>
<DL>
<DT><B>Note</B>
<DD>When you call the <CODE>HMShowBalloon</CODE> function, the Help Manager does not display the help balloon or attempt to move the tip under either of these conditions:  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
<DD>The help balloon's tip is offscreen or in the menu bar, and you don't specify an alternate rectangle.  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
<DD>Both the help balloon's tip and the alternate rectangle are offscreen.<EM></EM><A NAME=MARKER-2-43></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 Use the parameter <CODE>theProc</CODE> (the fifth parameter) to specify a balloon definition function. To use the standard balloon definition function, specify 0 in this parameter. To use your own balloon definition function, specify the resource ID of the <CODE>'WDEF'</CODE> resource containing your balloon definition function. Writing your own balloon definition function is described in <A HREF=MoreToolbox-156.html#MARKER-9-412>"Writing Your Own Balloon Definition Function" on page 3-86</A>.<P>
 Supply a variation code for the balloon definition function in the <CODE>variant</CODE> parameter (the sixth parameter to <CODE>HMShowBalloon</CODE>). Specify 0 in the <CODE>variant</CODE> parameter to use the default help balloon shape, specify a code from 1 to 7 to use one of the other positions provided by the standard balloon definition function, or specify a code to use one of the positions provided by your own balloon definition function. <P>
 Use the <CODE>method</CODE> parameter (the last parameter to <CODE>HMShowBalloon</CODE>) to specify how the Help Manager should draw and remove the balloon. Use the following constants for the parameter.<P>
<PRE>
CONST kHMRegularWindow     = 0;  {don't save bits; just update}
      kHMSaveBitsNoWindow  = 1;  {save bits; don't do update}
      kHMSaveBitsWindow    = 2;  {save bits; do update event}
</PRE>
 If you specify <CODE>kHMRegularWindow</CODE>, the Help Manager draws and removes the help balloon as if it were a window. That is, when drawing the balloon, the Help Manager does not save bits behind the balloon, and when removing the balloon, the Help Manager generates an update event. This is the standard behavior of help balloons; it is the behavior you should normally use<A NAME=MARKER-2-46></A>.<P>
 If you specify <CODE>kHMSaveBitsNoWindow</CODE> in the <CODE>method</CODE> parameter, the Help Manager does not create a window for displaying the balloon. Instead, the Help Manager creates a help balloon that is more like a menu than a window. The Help Manager saves the bits behind the balloon when it creates the balloon. When it removes the balloon, the Help Manager restores the bits without generating an update event. You should use this technique only in a modal environment where the bits behind the balloon cannot change from the time the balloon is drawn to the time it is removed. For example, you might specify the <CODE>kHMSaveBitsNoWindow</CODE> constant when providing help balloons for pop-up menus that overlay complex graphics, which might take a long time to redraw with an update event.<P>
 If you specify <CODE>kHMSaveBitsWindow</CODE>, the Help Manager treats the help balloon as a hybrid having properties of both a menu and a window. That is, the Help Manager saves the bits behind the balloon when it creates the balloon, and when it removes the balloon, it both restores the bits and generates an update event. You'll rarely need this option. It is necessary only in a modal environment that might immediately change to a nonmodal environment--that is, where the bits behind the help balloon are static when the balloon is drawn, but can possibly change before the help balloon is removed.<A NAME=MARKER-9-292></A><P>
 <A HREF=#MARKER-9-352>Listing 3-16</A> shows a sample routine that displays help balloons for hot rectangles within the content area of a window.<P>
<B>Listing 3-16  <A NAME=MARKER-9-352></A><A NAME=MARKER-21-353></A>Using <CODE>HMShowBalloon</CODE> to display help balloons</B><P>
<PRE>
PROCEDURE FindAndShowBalloon (window: WindowPtr);
VAR
   i:          Integer;
   mouse:      Point;
   savePort:   GrafPtr;
   helpMsg:    HMMessageRecord;
   inRect:     Boolean;
   hotRect:    Rect;
   result:     OSErr;
BEGIN
   IF (window = FrontWindow) THEN      {only do frontmost windows}
   BEGIN
      GetPort(savePort);   {save the old port for later}
      SetPort(window);     {set the port to the front window}
      GetMouse(mouse);     {get the mouse location in local }
                           { coords}
      inRect := FALSE;     {clear flag saying mouse location }
                           { wasn't in any hot rectangle}
      IF PtInRect(mouse, window^.portRect) THEN 
         {if the cursor is in the window}

         FOR i := 1 TO 10 DO  {check all ten predefined hot }
                              { rectangles in the window}
            IF PtInRect(mouse, MyPredefinedRects[i]) THEN
            BEGIN             {the cursor is in a hot rectangle}
               IF (i &lt;&gt; gLastBalloon) THEN 
               {user moved cursor to a different hot rectangle}
               BEGIN
                  hotRect := MyPredefinedRects[i];
                  LocalToGlobal(hotRect.topLeft);
                  {converting rect to global}
                  LocalToGlobal(hotRect.botRight);
                  WITH hotRect DO   {put the tip in the middle}
                     SetPt(mouse, (right + left) div 2, 
                           (bottom + top) div 2);
                  helpMsg.hmmHelpType := khmmStringRes;
                  {get help message from an 'STR#' resource}
                  helpMsg.hmmStringRes.hmmResID := kHelpMsgsID;
                  helpMsg.hmmStringRes.hmmIndex := i;
                  result := HMShowBalloon
                              (helpMsg,   {use just-made help msg}
                               mouse,     {pointing to this tip}
                               @MyPredefinedRects[i], {use hot }
                                          { rect for alt rect}
                               NIL,       {no special tip proc}
                               0,0,       {using default balloon}
                        kHMRegularWindow);{don't save bits behind}
                  IF (result = noErr) THEN {then remember balloon}
                     gLastBalloon := i;
               END;
               inRect := TRUE;   {remember when the }
                                 { cursor is in any hot rect}
            END;
      IF not inRect THEN
         gLastBalloon := -1;     {clear last balloon global for }
                                 { no hit}
      SetPort(savePort);         {restore the port}
   END;
END;     {FindAndShowBalloon}
</PRE>
 The <CODE>FindAndShowBalloon</CODE> procedure in <A HREF=#MARKER-9-352>Listing 3-16</A> tracks the cursor, and, if the cursor is located in a predefined hot rectangle, it displays a help balloon for that rectangle. In this example there are ten predefined rectangles (in the <CODE>MyPredefinedRects</CODE> array) and ten corresponding help messages in an <CODE>'STR#'</CODE> resource (of ID <CODE>kHelpMsgsID</CODE>)--one message for each hot rectangle. Other supporting routines can update the coordinates of the hot rectangles as their locations change.<P>
 You can also use the <CODE>HMShowBalloon</CODE> function from the event filter function of a modal dialog box or an alert box. See the chapter "Dialog Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for information on event filter functions.<A NAME=MARKER-2-65></A><A NAME=MARKER-2-29></A><A NAME=MARKER-2-29></A><A NAME=MARKER-2-115></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-151.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-153.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
