<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>64-Bit Transition Guide for Cocoa: Converting an Existing Application to 64-Bit</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Converting an Existing Application to 64-Bit"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40004247-CH5" title="Converting an Existing Application to 64-Bit"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../DesignGuidelines-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000556" target="_top">Design Guidelines</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP40004247-CH1-SW1">64-Bit Transition Guide for Cocoa</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../64BitChangesCocoa/64BitChangesCocoa.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../OptimizingMemoryPerformance/OptimizingMemoryPerformance.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40004247-CH5-SW1" title="Converting an Existing Application to 64-Bit"></a><h1>Converting an Existing Application to 64-Bit</h1><p>To assist you in converting an existing application project to 64-bit, Apple provides a script that does most of the work. The script performs in-place substitutions on source-code files according to a set of rules. However, after you run the script you still need to look at everything that changed or was flagged and fix it if necessary. This procedure described below works as well for existing framework projects, plug-in projects, or other projects.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="ConvertingExistingApp.html#//apple_ref/doc/uid/TP40004247-CH5-SW5">The Conversion Procedure</a>
				
			<br/>
			
        
			
			
				<a href="ConvertingExistingApp.html#//apple_ref/doc/uid/TP40004247-CH5-SW2">Things to Look For During Conversion</a>
				
			<br/>
			
        
			
			
				<a href="ConvertingExistingApp.html#//apple_ref/doc/uid/TP40004247-CH5-SW4">Encoding Verification</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40004247-CH5-SW5" title="The Conversion Procedure"></a><h2>The Conversion Procedure</h2><p>Start by eliminating the build warnings that your project currently generates; this will make it easier to focus on warnings that are specific to 64-bit conversion problems. Also save a copy of the project in case something goes wrong in the conversion process and you need to start over.  Then in a Terminal shell run the conversion script <code>ConvertCocoa64</code> located in <code>/Developer/Extras/64BitConversion/</code>. You can run the script on specific source and header files, as in this example: </p><div class="codesample"><table><tr><td scope="row"><pre>/Developer/Extras/64BitConversion/ConvertCocoa64 Controller.h Controller.m CustomView.h CustomView.h<span></span></pre></td></tr></table></div><p>Or you can run it on all <code>.h</code> and <code>.m</code> files in your project, as in this example:</p><div class="codesample"><table><tr><td scope="row"><pre>/Developer/Extras/64BitConversion/ConvertCocoa64 `find . -name '*.[hm]' | xargs`<span></span></pre></td></tr></table></div><p>As the script runs, it does the following things: </p><ul class="ul"><li class="li"><p>It converts most instances of <code>int</code> and <code>unsigned int</code> to <code>NSInteger</code> and <code>NSUInteger</code>, respectively. It doesn't convert <code>int</code>s in bit-field declarations and other inappropriate cases. During processing, the script refers to a hardcoded list of exceptions. </p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40004247-CH5-DontLinkElementID_12" title="Important:"></a><p><strong>Important:</strong>&nbsp;The script converts instances of <code>int</code> and <code>unsigned int</code> that are properly the types of arguments and return values in POSIX calls. You must be aware of these instances and manually revert them (or leave them alone, if that is more appropriate).</p><p></p></div></li><li class="li"><p>It converts most instances of <code>float</code> to <code>CGFloat</code>, again leaving untouched those exceptions specified in a hardcoded list.</p></li><li class="li"><p>It does <em>not</em> convert <code>enum</code> declarations to types with guaranteed fixed sizes (as described in <span class="content_text"><a href="../64BitChangesCocoa/64BitChangesCocoa.html#//apple_ref/doc/uid/TP40004247-CH4-SW8">“Enumeration Constants”</a></span>). You need to fix these declarations by hand. </p></li><li class="li"><p>It flags (with inline warnings) cases that need to be fixed manually. See <span class="content_text"><a href="ConvertingExistingApp.html#//apple_ref/doc/uid/TP40004247-CH5-SW2">“Things to Look For During Conversion”</a></span> for details.</p></li></ul><p>After the script completes processing all files, run the FileMerge development application on each changed file and an unchanged version of the same file. FileMerge visually highlights each modified section of code. After reading <span class="content_text"><a href="ConvertingExistingApp.html#//apple_ref/doc/uid/TP40004247-CH5-SW2">“Things to Look For During Conversion,”</a></span> evaluate each of these sections plus the warnings generated by the script and make further changes if necessary.</p><p>Remember that any 64-bit change you make should help preserve binary compatibility of your project executable on 32-bit systems. You should use the constructs in <span class="content_text">Table 3-1</span> to mark off sections of code conditionally for each architecture: PowerPC versus Intel and 32-bit versus 64-bit.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW3" title="Table 3-1Macros for architecture conditional code"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-1&nbsp;&nbsp;</strong>Macros for architecture conditional code</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Macro</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Comment</p></th></tr><tr><td  scope="row"><p><code>#if __LP64__</code></p></td><td ><p>PowerPC or Intel 64-bit. You should use this for most 64-bit changes.</p></td></tr><tr><td  scope="row"><p><code>#ifdef __ppc__</code></p></td><td ><p>PowerPC 32-bit</p></td></tr><tr><td  scope="row"><p><code>#ifdef __ppc64__</code></p></td><td ><p>PowerPC 64-bit</p></td></tr><tr><td  scope="row"><p><code>#ifdef __i386__</code></p></td><td ><p>Intel 32-bit</p></td></tr><tr><td  scope="row"><p><code>#ifdef __x86_64__</code></p></td><td ><p>Intel 64-bit</p></td></tr><tr><td  scope="row"><p><code>#ifdef __BIG_ENDIAN__</code></p></td><td ><p>Big endian architectures</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP40004247-CH5-SW2" title="Things to Look For During Conversion"></a><h2>Things to Look For During Conversion</h2><p>When the conversion script processes a source or header file, it often inserts warnings in the code to alert you to changes that you might have to make or pitfalls that you should try to avoid. These warnings are explained in the following sections.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW6" title="Type Specifiers"></a><h3>Type Specifiers</h3><p><strong>Script action</strong>: Warns about potential problems; may generate false negatives.</p><p>Typically, in 32-bit code you use the <code>%d</code> specifier to format <code>int</code> values in functions such as <code>printf</code>, <code><a href="../../../../LegacyTechnologies/WebObjects/WebObjects_3.5/Reference/Frameworks/ObjC/Foundation/Functions/FoundationFunctions/Description.html#//apple_ref/c/func/NSAssert" target="_top">NSAssert</a></code>, and <code><a href="../../../Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html#//apple_ref/c/func/NSLog" target="_top">NSLog</a></code>, and in methods such as <code>stringWithFormat:</code>. But with <code>NSInteger</code>, which on 64-bit architectures is the same size as <code>long</code>, you need to use the <code>%ld</code> specifier. Unless you are building 32-bit like 64-bit, these specifiers generates compiler warnings in 32-bit mode. To avoid this problem, you can cast the values to <code>long</code> or <code>unsigned long</code>, as appropriate. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>NSInteger i = 34;<span></span></pre></td></tr><tr><td scope="row"><pre>printf("%ld\n", (long)i);<span></span></pre></td></tr></table></div><p><span class="content_text">Table 3-2</span> lists specifiers for formatting 64-bit types.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW7" title="Table 3-2Type specifiers for 64-bit types"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong>Table 3-2&nbsp;&nbsp;</strong>Type specifiers for 64-bit types</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Type</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Specifier</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Comments</p></th></tr><tr><td  scope="row"><p><code>NSInteger</code></p></td><td ><p><code>%ld</code> or <code>%lx</code></p></td><td ><p>Cast the value to <code>long</code>.</p></td></tr><tr><td  scope="row"><p><code>NSUInteger</code></p></td><td ><p><code>%lu</code> or <code>%lx</code></p></td><td ><p>Cast the value to <code>unsigned long</code>.</p></td></tr><tr><td  scope="row"><p><code>CGFloat</code></p></td><td ><p><code>%f</code> or <code>%g</code></p></td><td ><p><code>%f</code> works for floats and doubles when formatting (but not scanning).</p></td></tr><tr><td  scope="row"><p><code>CFIndex</code></p></td><td ><p><code>%ld</code> or <code>%lx</code></p></td><td ><p>Cast the value to <code>long</code>.</p></td></tr><tr><td  scope="row"><p><code>long long</code></p></td><td ><p><code>%lld</code> or <code>%llx</code></p></td><td ><p><code>long long</code> is 64-bit on both 32-bit and 64-bit architectures.</p></td></tr><tr><td  scope="row"><p><code>unsigned long long</code></p></td><td ><p><code>%llu</code> or <code>%llx</code></p></td><td ><p><code>unsigned long long</code> is 64-bit on both 32-bit and 64-bit architectures.</p></td></tr></table></div><p>The script also inserts warnings in the related case of scanning functions such as <code>scanf</code>, but these introduce an additional subtlety. You need to distinguish between <code>float</code> and <code>double</code> types, using <code>%f</code> for <code>float</code> and <code>%lf</code> for <code>double</code>. Don't use <code>CGFloat</code> parameter in <code>scanf</code>-type functions; instead use a <code>double</code> parameter and assign the <code>double</code> value to a <code>CGFloat</code> variable. For example, </p><div class="codesample"><table><tr><td scope="row"><pre>double tmp;<span></span></pre></td></tr><tr><td scope="row"><pre>sscanf(str, "%lf", &amp;tmp);<span></span></pre></td></tr><tr><td scope="row"><pre>CGFloat imageWidth = tmp;<span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/TP40004247-CH5-DontLinkElementID_13" title="Important:"></a><p><strong>Important:</strong>&nbsp;Unless you cast appropriately, the <code>%lf</code> specifier (unlike the <code>%ld</code> specifier and <code>long</code> values) does not correctly represent <code>CGFloat</code> values on both 32-bit and 64-bit architectures.</p><p></p></div><a name="//apple_ref/doc/uid/TP40004247-CH5-SW8" title="Unkeyed Archiving"></a><h3>Unkeyed Archiving</h3><p><strong>Script action</strong>: Warns of potential problems </p><p>The old style of Cocoa archiving relies on the sequence of encoded and decoded properties rather than keys as the means for identifying archived values; you must decode properties in the same order of their encoding. Developers are encouraged to move away from this old-style archiving to keyed archiving. However, applications may have to read old-style archives so they cannot abandon this key-less archiving altogether. And, from a 64-bit perspective, you cannot change these archives to accommodate larger values because that would make it impossible for older versions of the application to decode the archive.</p><p>When reading old-style archives, remember that integers encoded with the "i" and "l" (small L) type-encoding specifiers are 32-bit even on 64-bit architectures. To specify 64-bit integers you must use the "q" type-encoding specifier. But if you type an instance variable as an <code>NSInteger</code> value, the following decoding attempt won't work on 64-bit architectures: </p><div class="codesample"><table><tr><td scope="row"><pre>// Header file<span></span></pre></td></tr><tr><td scope="row"><pre>NSInteger bitsPerSample;  // instance variable<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Implementation file<span></span></pre></td></tr><tr><td scope="row"><pre>[coder decodeValuesOfObjCTypes:"i", &amp;bitsPerSample];<span></span></pre></td></tr></table></div><p>One way to get around this problem is to use a local variable for an intermediate value, then assign this value to the <code>NSInteger</code> instance variable after decoding.</p><div class="codesample"><table><tr><td scope="row"><pre>// Header file<span></span></pre></td></tr><tr><td scope="row"><pre>NSInteger bitsPerSample;<span></span></pre></td></tr><tr><td scope="row"><pre>// Implementation file<span></span></pre></td></tr><tr><td scope="row"><pre>int tmp;<span></span></pre></td></tr><tr><td scope="row"><pre>[coder decodeValuesOfObjCTypes:"i", &amp;tmp];<span></span></pre></td></tr><tr><td scope="row"><pre>bitsPerSample = tmp;<span></span></pre></td></tr></table></div><p>You can use the same intermediate-variable technique for encoding <code>NSInteger</code> values (as 32-bit) as well as decoding them. </p><p>Instance variables typed as <code>CGFloat</code> present a similar problem since the "f" type-encoding specifier refers to <code>float</code>, not <code>CGFloat</code>. the workaround for this is the same as for <code>NSInteger</code>: use a local <code>float</code> variable to store the intermediate value, which you then assign to the <code>CGFloat</code> instance variable.</p><p>Cocoa is changing most enumerations to be based on the <code>NSInteger</code> type, which you should probably do in your own code too. Nevertheless, for old-style archiving you need to archive <code>enum</code> constants based on what the explicit or underlying type is. </p><p>Avoid using the <code>@encode</code> compiler directive in old-style archiving. The <code>@encode</code> directive generates a character string with the user-defined type stripped away. For example, during an LP64 build <code>NSInteger</code> resolves to <code>long</code>, but during a 32-bit build <code>NSInteger</code> resolves to <code>int</code>. The <code>NSInteger</code> semantics have been lost, and this could lead to bugs. </p><p>See <span class="content_text"><a href="ConvertingExistingApp.html#//apple_ref/doc/uid/TP40004247-CH5-SW4">“Encoding Verification”</a></span> for information on a script that you can run to verify the consistency of old-style archiving code.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW9" title="Keyed Archiving"></a><h3>Keyed Archiving</h3><p><strong>Script action</strong>: Converts <code>encodeInt:forKey:</code> with <code>encodeInteger:forKey:</code> (<code>NSInteger</code>) and <code>encodeFloat:forKey:</code> with <code>encodeDouble:forKey:</code> (<code>CGFloat</code>).</p><p>You should examine the substitutions made by the script to see if any decoded values might be out of range. With keyed archiving it doesn't really matter if you encode integers with <code>encodeInt:forKey:</code>, <code>encodeInt32:forKey:</code>, or <code>encodeInt64:forKey:</code>. But, if on decoding, the archived value is larger than what 32-bit signed integers can hold, an <code>NSRangeException</code> is raised.</p><p>For most integral values, use of <code><a href="../../../Reference/Foundation/Classes/NSCoder_Class/Reference/NSCoder.html#//apple_ref/occ/instm/NSCoder/encodeInteger:forKey:" target="_top">encodeInteger:forKey:</a></code> and <code><a href="../../../Reference/Foundation/Classes/NSCoder_Class/Reference/NSCoder.html#//apple_ref/occ/instm/NSCoder/decodeIntegerForKey:" target="_top">decodeIntegerForKey:</a></code> are recommended. For values whose ranges are larger than what 32-bit signed integers can hold, <code><a href="../../../Reference/Foundation/Classes/NSKeyedArchiver_Class/Reference/Reference.html#//apple_ref/occ/instm/NSKeyedArchiver/encodeInt64:forKey:" target="_top">encodeInt64:forKey:</a></code> and <code><a href="../../../Reference/Foundation/Classes/NSKeyedUnarchiver_Class/Reference/Reference.html#//apple_ref/occ/instm/NSKeyedUnarchiver/decodeInt64ForKey:" target="_top">decodeInt64ForKey:</a></code> are the more appropriate choice, even on 32-bit systems.</p><p>In the rare case where an application wants to read 64-bit values in 32-bit processes, it can use <code>decodeInt64ForKey:</code> and be explicit about the type rather than using <code>decodeIntegerForKey:</code> (which reads back 32-bit on 32-bit systems).</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW10" title="Archiving Variables With NSNotFound Values"></a><h3>Archiving Variables With NSNotFound Values</h3><p><strong>Script action</strong>: None.</p><p><code><a href="../../../Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/c/econst/NSNotFound" target="_top">NSNotFound</a></code> is set to <code>LONG_MAX</code> in <code>NSObjCRuntime.h</code>, which has different values on 32-bit and 64-bit. Consequently, an variable archived with an <code>NSNotFound</code> value on a 32-bit system would have a different value if unarchived on a 64-bit system. In light of this, remove code that writes out <code>NSNotFound</code> to archives.  If it is already written out, then you should check the 32-bit value explicitly when you read it in, even in a 64-bit application.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW11" title="Instance Variables"></a><h3>Instance Variables</h3><p><strong>Script action</strong>: Converts instance variables declared as <code>int</code> and <code>unsigned int</code> to <code>NSInteger</code> and <code>NSUInteger</code>, respectively. If integers are declared smaller than <code>int</code> and <code>unsigned int</code> (<code>char</code> or <code>short</code>), the script leaves them alone. Also changes <code>float</code> instance variables to <code>CGFloat</code> if they correspond to programmatic interfaces that deal in <code>CGFloat</code> values.</p><p>You should go over modified instance variables and verify if each should be <code>NSInteger</code> or <code>NSUInteger</code>. In some cases it might not be necessary to grow the size of instance variables because, even if the programmatic interface is 64-bit capable, the storage doesn't have to be. If that is the case, change the type of the instance variable back to <code>int</code> or <code>unsigned int</code>. </p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW12" title="sizeof Operator and @encode Directive"></a><h3>sizeof Operator and @encode Directive</h3><p><strong>Script action</strong>: Converts instances of <code>sizeof</code> and <code>@encode</code> where the argument is <code>int</code>, <code>unsigned int</code>, and <code>float</code> (to <code>NSInteger</code>, <code>NSUInteger</code>, and <code>CGFloat</code>, respectively). For other cases, generates warnings (with possible false negatives). </p><p>Go over each warning and make sure that no conversion needs to made manually.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW13" title="Functions That Round Off Floating-Point Values"></a><h3>Functions That Round Off Floating-Point Values</h3><p><strong>Script action</strong>: Converts calls of functions such as <code>roundf</code> and <code>ceilf</code> to (non-existent) functions of the form <code>_CGFloatRound</code>. </p><p>Because these functions take <code>float</code> arguments, any calls to these with <code>CGFloat</code> arguments need to be updated to use the <code>float</code>- or <code>double</code>-taking parameter variant, as appropriate to the architecture. You should implement <code>_CGFloatRound</code> as a macro or inline function that calls, for example, <code>round</code> or <code>roundf</code> depending on the architecture.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40004247-CH5-SW18" title="Note"></a><p><strong>Note:</strong>&nbsp;You could also simply replace calls to <code>roundf</code> with calls to <code>round</code>, and so on. However, in 32-bit code there is a performance cost associated with promoting from <code>float</code> to <code>double</code> and back to <code>float</code>.</p></div><a name="//apple_ref/doc/uid/TP40004247-CH5-SW14" title="Arrays of Integers"></a><h3>Arrays of Integers</h3><p><strong>Script action</strong>: Converts instances of <code>int[]</code> and <code>unsigned int[]</code> to <code>NSInteger[]</code> and <code>NSUInteger[]</code>. respectively.</p><p>If you have <code>static</code> or <code>static const</code> arrays of <code>int</code> or <code>unsigned int</code>, and the arrays are not exposed in API, you might want to change the type back for the memory savings.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW15" title="Use of long and unsigned long"></a><h3>Use of long and unsigned long</h3><p><strong>Script action</strong>: Marks each occurrence with a warning; does not convert.</p><p>Often leaving the type untouched is appropriate, but in some cases you may want to change it to an <code>int</code> to remain 32-bit.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW16" title="Pointer Casts"></a><h3>Pointer Casts</h3><p><strong>Script action</strong>: Generates warnings for pointer casts that involve <code>int</code> or <code>float</code> values. </p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW17" title="Limit Constants"></a><h3>Limit Constants</h3><p><strong>Script action</strong>: Generates warnings for occurrences of <code>INT_MAX</code>, <code>INT_MIN</code>, <code>UINT_MAX</code>, <code>FLT_MAX</code>, and <code>FLT_MIN</code> since they might be involved in comparisons involving <code>long</code> or <code>float</code> values. </p><p>Switch (respectively) to the <code>NSIntegerMax</code>, <code>NSIntegerMin</code>, <code>NSUIntegerMax</code>, or the appropriate <code>LONG_</code> or <code>DBL_</code> variants.</p><a name="//apple_ref/doc/uid/TP40004247-CH5-SW4" title="Encoding Verification"></a><h2>Encoding Verification</h2><p>As a further step toward ensuring 64-bit capable code, you can run a script that verifies the consistency of old-style (unkeyed) archiving code. This script, named <code>CoderFormatVerifier</code>, is installed in <code>/Developer/Extras/64BitConversion/</code>.</p><p>The script replaces  <code><a href="../../../Reference/Foundation/Classes/NSCoder_Class/Reference/NSCoder.html#//apple_ref/occ/cl/NSCoder" target="_top">NSCoder</a></code> method invocations with type-checked function calls. On the command line, pass the script a directory—it should be copy of your source directory. The script recursively modifies all the <code>.m</code> and <code>.M</code> files in-place and then writes the function prototypes to standard output (<code>stdout</code>). You can then copy and paste the function prototypes into your prefix header, compile the code, and then inspect any compiler errors that you get. (Link errors are expected because the script only generates function prototypes.) Run the script without any arguments for usage information.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../64BitChangesCocoa/64BitChangesCocoa.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../OptimizingMemoryPerformance/OptimizingMemoryPerformance.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2009 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2009-03-03<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/Cocoa64BitGuide/ConvertingExistingApp/ConvertingExistingApp.html%3Fid%3DTP40004247-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/Cocoa64BitGuide/ConvertingExistingApp/ConvertingExistingApp.html%3Fid%3DTP40004247-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/Cocoa64BitGuide/ConvertingExistingApp/ConvertingExistingApp.html%3Fid%3DTP40004247-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>