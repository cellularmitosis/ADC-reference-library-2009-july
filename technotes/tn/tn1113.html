<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><!-- Template 01-05-01 --><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css">   <title>Technical Note TN1113: Customizing Desktop Printer Utility</title>       <meta name="keywords" content="Mac OS 8 DeskTop Printer utility DTP customizing CsDs resource">    <meta name="Description" content="Technical Note TN1113: This Technical Note describes howa developer might customize Desktop Printer Utility                                    for use with an application.Included is a discussion of the 'CsDs'(CustomDTPResource)Resource."><meta name="categories" content="Printing"><meta name="week-posted" content="Sep 1, 1997 - Sep 5, 1997"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002953" title="Customizing Desktop Printer Utility"></a><A NAME="top"></A><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxPrinting-date.html">Printing</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Printing/idxHardwareDrivers-date.html" target="_blank">Printing > Hardware & Drivers</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TN1113</div>
<div id="pageheadsub">Customizing Desktop Printer Utility</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><center><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left">          <!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                        <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left><!-- begin_toc --><p id="menutext"><A HREF = "#Section1">Transparent Mode</A><BR><BR><A HREF = "#Section2">MaskRgn Clipping</A><BR><BR><A HREF = "#Section3">Limitations</A><BR><BR><A HREF = "#Summary">Summary</A><br><BR><A HREF="#References">References</a><BR><BR><A HREF="#Downloads">Downloadables</A></p>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left>            			<!-- begin_intro_text --><p id="introtext">In the current LaserWriter 8 driver, the Chooser lists printers which are available on the AppleTalk network (either LocalTalk or AppleTalk) with an NBP type of "LaserWriter".  When the user selects one of these printers, LaserWriter 8 creates a desktop printer by sending an Apple Event to the Finder. In the past, this mechanism of setting up printers has served the needs of most users. However, with LaserWriter 8.5.1, Apple is responding to several requests for more flexible desktop printing functionality. To this end, Apple has introduced a new application called Desktop Printer Utility which enables users to create additional types of desktop printers. Users can now create desktop printers which use the Unix <I>lpr</I> protocol for printing, in addition to the regular AppleTalk PAP printers. There are also "hold" printers which represent local print queues and "virtual" printers which represent printers which are not available on the network.</P>         <p id="introtext">Along with the expanded capabilities, Desktop Printer Utility is also customizable. LaserWriter 8.5.1 and Desktop Printer Utility (together) support the creation and use of desktop printers known as Custom DTPs. When printed to, Custom DTPs cause the LaserWriter 8.5.1 driver to create a PostScript file and to launch an application that can post-process the PostScript. This post-processing application can do anything it likes with the PostScript file, such as converting the PostScript into another file format,  transferring the file to another location using a modem or a network connection, or displaying the PostScript file to the user.  This Technote describes how a developer might customize Desktop Printer Utility for use with an application.</P><!-- begin_date --><h3>&nbsp;Updated: [Feb 06 1998]</h3><!-- end_date -->        </td>    </tr></table> <!-- end_header_box --><BR><BR><hr width=500 align=center><BR><BR>          <!-- begin_content --><!-- end_intro_text -->         <A NAME="Section1"></A>         <H2>Customizing the DTP Utility</H2><P>In order to add a new custom DTP to the list of supported DTPs in Desktop Printer Utility, you must add resources to the utility's resource fork. Desktop Printer Utility contains templates to ease the creation of these resources.</P>  <BR><P><A HREF="#top">Back to top</A></P>  <P><A NAME="Section2"></A></P>   <H3>'<CODE>CsDs</CODE>'(<CODE>CustomDTPResource</CODE>) Resource</H3><P>In order to customize Desktop Printer Utility, a '<CODE>CsDs</CODE>' (<CODE>CustomDTPResource</CODE>) resource must be added to Desktop Printer Utility. The LaserWriter uses this information to find the appropriate application to launch and to customize your DTP interface.</P><P>The resource's format is defined by the structure '<CODE>CustomAppDesc</CODE>:'</P><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>#define kVariableLen 1struct CustomAppDesc{    OSType appSignature;    Str255 docType;    Str255 helpText;    Str255 usage;    Str255 appFileName;    short numOfHintsFollow;    HintRsrcSpec hintRsrc[kVariableLen];};typedef struct CustomAppDesc CustomAppDesc;</pre></TD></TR></TABLE></CENTER><BR><BR><UL TYPE=DISC>    <LI><CODE><B>appSignature</B></CODE>: The application signature of the application to launch.     The LaserWriter driver uses this information to find the application on all     mounted volumes which are available to the user.</li>    <LI><CODE><B>docType</B></CODE>: A string that describes the type of custom DTP.     This string appears     in the list of document types when "New" menu is selected.  This string is     highlighted in Figure 1.</li>    <LI><CODE><B>helpText</B></CODE>: This string appears when your custom DTP is selected.  This     string will appear in the "New" dialog field just below the DTP choices.      This string appears as 'Custom DTP Example Help Text' in Figure 1.</li>    <LI><CODE><B>usage</B></CODE>: A string that describes the usage of your custom DTP. This string     appears as "Custom DTP Example Usage string" in Figure 2.</li>    <LI><CODE><B>appFileName</B></CODE>: The name of the application to launch. The LaserWriter driver     uses this information to find the application on disks which are available to     the user as well as to provide error messages to the user (e.g. "SurfWriter     could not be launched due to insufficient memory").</li>    <LI><CODE><B>numOfHintsFollow</B></CODE>: The number of hints provided in the <CODE>hintRsrc</CODE> array. See     the "Hints Resources" section for more details.</li>    <LI><CODE><B>hintRsrc</B></CODE>: An array of hints that outlines the kind of     PostScript that should     be generated by the driver. See the "<A HREF = "#Section3">Hints Resources</A>" section for more details.</li></UL>       <BR><P ALIGN="center"><B>Figure 1</B></P><CENTER><img src="images/tn1113_001.gif" alt="Custom DTP" width=277 height=273 align="bottom"></CENTER><BR>       <P ALIGN="center"><B>Figure 2</B></p>        <center><img src="images/tn1113_002.gif" alt="Custom DTP Example String" width=389 height=274 align="bottom"></center>    <BR><P><A HREF="#top">Back to top</A></P>                 <P><A NAME="Section3"></A></P>                  <H3>Hints Resources (optional)</H3>                  <P>The <CODE>CustomDTPResource</CODE> can provide "hints" about the PostScript the          driver should generate. Each "<CODE>CustomDTPResource</CODE>" contains the field          "numOfHintsFollow" which represents the number of "hints" provided.           The "hints" data is placed in an array that contains "<CODE>numOfHintsFollow</CODE>"          number of copies of the structure: </P>         <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>struct HintRsrcSpec{       OSType rsrcType;       short rsrcID};typedef struct HintRsrcSpec HintRsrcSpec;</pre></TD></TR></TABLE></CENTER><BR><BR><BR><P>Each entry in the array points to a resource which is converted to a hint in the driver's preferences.  The hint resource types, which are currently supported, have the following formats:</P><H4>/* PostScript Level */</H4>The application that postprocesses the PostScript for a custom DTP may require or prefer a certain PostScript level.   The '<CODE>pslv</CODE>' hint specifies the desired  PostScript level.   <H4>Resource type '<CODE>PSlv</CODE>'</H4><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>typedef struct{    OSType hintType;        //'pslv' hint type    long hintId;            // set to 1    long psLevel;}PSlvResource;#define kHintLanguageLevelTag   'pslv'#define kHintLanguageLevelId    1</pre></TD></TR></TABLE></CENTER><BR><BR><P>The possible(current) values for psLevel which can be set are:</P><TABLE BORDER=0 width="500">   <TR>      <td width=25 align=left>          <P>-3</p>      </TD><td width=80 align=left>         <P>Level 2 and 3</p>         </TD><td width=55 align=left>         <P>&nbsp;</p>      </TD></TR><TR>      <td width=25 align=left>          <P>-2</p>      </TD><td width=80 align=left>         <P>Level 1 and 2</p>         </TD><td width=55 align=left>         <P>&nbsp;</p>      </TD></TR><TR>      <td width=25 align=left>          <P>-1</p>      </TD><td width=80 align=left>         <P>Unknown Level</p>         </TD><td width=55 align=left>         <P>&nbsp;</p>      </TD></TR><TR>      <td width=25 align=left>          <P>&nbsp;0</p>      </TD><td width=80 align=left>         <P>Other Level</p>         </TD><td width=55 align=left>         <P>//do not use</p>      </TD></TR><TR>      <td width=25 align=left>          <P>&nbsp;1</p>      </TD><td width=80 align=left>         <P>Level 1 </p>         </TD><td width=55 align=left>         <P>&nbsp;</p>      </TD></TR><TR>      <td width=25 align=left>          <P>&nbsp;2</p>      </TD><td width=80 align=left>         <P>Level 2 </p>         </TD><td width=55 align=left>         <P>&nbsp;</p>      </TD></TR><TR>      <td width=25 align=left>          <P>&nbsp;3</p>      </TD><td width=80 align=left>         <P>Level 3</p>         </TD><td width=55 align=left>         <P>&nbsp;</p>      </TD></TR>       </TABLE>     <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR> -3 will create PostScript that takes advantage of PostScript level 2 and level 3 printers, but the data may fail on a level 1 printer. -2 will create PostScript that will succeed on level 1, 2, and 3 printers.</P></TD></TR></TABLE></CENTER><BR><BR><h4>/* Binary OK - '<CODE>bnok</CODE>'  */</H4><P>This hint allows or disallows the use of binary data in the PostScript file. </P><h4>Resource type '<CODE>BNok</CODE>'</H4><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>typedef struct{    OSType hintType;        //'bnok' hint type    long hintId;            // set to 1    TriState binaryOK;}BNokResource;#define kHintADOIsBinaryOKTag   'bnok'#define kHintADOIsBinaryOKId    1</pre></TD></TR></TABLE></CENTER><BR><BR>There are three acceptable settings for binaryOK which answer the question, "Is binary data ok?":<TABLE BORDER=0 width="500">   <TR>      <td width=15 align=left>          <P>0</p>      </TD><td width=40 align=left>         <P>False</p>         </TD><td width=55 align=left>         <P>&nbsp;</p>      </TD></TR><TR>      <td width=15 align=left>          <P>1</p>      </TD><td width=40 align=left>         <P>True</p>         </TD><td width=55 align=left>         <P>&nbsp;</p>      </TD></TR><TR>      <td width=15 align=left>          <P>2</p>      </TD><td width=40 align=left>         <P>Unknown</p>         </TD><td width=55 align=left>         <P>//do not use</p>      </TD></TR>       </TABLE>       <BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><P><B>Note:</B><BR>This hint should not be created in the DTP with a value of unknown; however, it is available for future use.</P></TD></TR></TABLE></CENTER><BR><BR><h4>/* Job Type - '<CODE>jobt</CODE>'  */</H4><P>This hint specifies the type of PostScript to generate.  </P><h4>Resource type '<CODE>JObt</CODE>'</H4><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>typedef struct{    OSType hintType;        //'jobt' hint type    long hintId;            // set to 1    char jobType;}JObtResource;#define kHintJobTypeTag     'jobt'#define kHintJobTypeId      1</pre></TD></TR></TABLE></CENTER><BR><BR>Currently only two PostScript forms for <CODE>jobType</CODE> are available:<TABLE BORDER=0 width="500">   <TR>      <td width=15 align=left>          <P>&nbsp;0</p>      </TD><td width=60 align=left>         <P><CODE>psJobPostScript</CODE></p>         </TD></TR><TR>      <td width=15 align=left>          <P>&nbsp;1</p>      </TD><td width=60 align=left>         <P><CODE>psJobEPSNoPreview</CODE></p>         </TD></TR></TABLE>    <H4>/* Font Handling - '<CODE>font</CODE>'  */</H4><P>This hint specifies the font inclusion. The font handling hint consists of a four-byte  flag followed by a list of NULL terminated font names. </P><h4>Resource type '<CODE>FOnt</CODE>'</H4><BR><BR><CENTER><TABLE BORDER=0 WIDTH=550><TR><td bgcolor="#E6E6E6" align=left><pre>typedef struct{    OSType hintType;         //'font' hint type    long hintId;             //set to 1    long tag;    unsigned char name[1];}FOntResource;#define kHintIncludeFontsTag        'font'#define kHintIncludeFontsId         1</pre></TD></TR></TABLE></CENTER><BR><BR>The possible values for tag are:<TABLE BORDER=0 width="500">   <TR>      <td width=15 align=left>          <P>&nbsp;0</p>      </TD><td width=60 align=left>         <P><CODE>kIncludeNoFontsOtherThan</CODE></p>         </TD></TR><TR>      <td width=15 align=left>          <P>&nbsp;1</p>      </TD><td width=60 align=left>         <P><CODE>kIncludeAllFontsBut</CODE></p>         </TD></TR></TABLE>         <p>If the flag is '<CODE>kIncludeNoFontsOtherThan</CODE>', the utility will only include the font definitions of fonts that are listed after the flag. If there are no font names after the flag, no font resources are included in the output. If the flag is '<CODE>kIncludeAllFontsBut</CODE>', font resources are included in the output unless the font names are listed. To include all fonts, use the '<CODE>kIncludeAllFontsBut</CODE>' flag with no fonts listed afterwards.</P>  <BR><P><A HREF="#top">Back to top</A></P>         <P><A NAME="Section4"></A></P>                  <H2>Sample Custom DTP</H2>                  <P>Following is a sample of a custom DTP that excludes Courier and Helvetica          from the PostScript file via a '<CODE>CsDs</CODE>' and '<CODE>FOnt</CODE>' resource.          This sample is intended to give developers an idea of how easy it is to customize the DTP Utility.</P>         <P>The first step towards adding the Custom DTP is to create a hint resource          of the correct type. The example shown is the '<CODE>FOnt</CODE>' resource which          provides data about font inclusion.</P>                           <center><img src="images/tn1113_003.gif" alt="Hint tag: font" width=400 height=268 align="bottom"></center>         <p>The second step is to associate the hint with a particular DTP by          adding hint resource information to the '<CODE>CsDs</CODE>' resource for a          particular DTP.</P>                  <center><img src="images/tn1113_004.gif" alt="AppCreator DSTL" width=400 height=268 align="bottom"></center>         <P>And that's all that is required to get the DTP Utility to create a          custom DTP that produces a PostScript file without Courier and Helvetica.</P>           <h3>Limitations of the DTP Utility</H3>         <P>Due to the parallel development schedules of Mac OS 8.0 and LaserWriter 8.5.1,          DTP Utility 1.0 (which ships with LaserWriter 8.5.1) will not install on          Mac OS 8.0. It will, however, work with the upcoming Mac OS 8.1.</P>         <H3>Licensing the DTP Utility</H3>         <P>In order to ship a customized DTP Utility with your application,          you must license the DTP Utility from Apple. Please contact Apple's Software          Licensing group (<A HREF = "mailto:sw.license@apple.com">sw.license@apple.com</A> or          512-919-2645) for more information.</P>  <BR><P><A HREF="#top">Back to top</A></P>         <A NAME="Summary"></A>                  <H2>Summary</H2>                  <P>This Technote has described and demonstrated all that is necessary for          you to customize Desktop Printer Utility. We encourage all developers to          give this a try.</P>  <BR><P><A HREF="#top">Back to top</A></P>  <A NAME="References"></A><H2>References</H2><P><A HREF = "tn1112.html">TN 1112: Introducing the LaserWriter Driver Version 8.5.1</A></P>  <BR><P><A HREF="#top">Back to top</A></P>        <A NAME="Downloads"></A>         <br><h2>Downloadables</h2>        <center><TABLE BORDER=0 CELLPADDING=3 WIDTH="600">          <TR>             <td width=50 align=left>               <P ALIGN=center><img src="images/acrobatsmall.gif" align=middle alt="Acrobat" width=22 height=23></P>            </TD>            <td align="left">               <p>Acrobat version of this Note (300K).</P>            </TD>            <td width=60 align=left>               <p><A HREF="pdf/tn1113.pdf">Download</A></P>            </TD>          </TR>        </TABLE></center><BR><BR>        </td></tr></table></center><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tn/tn1113.html%3Fid%3DDTS10002953-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tn/tn1113.html%3Fid%3DDTS10002953-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tn/tn1113.html%3Fid%3DDTS10002953-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>