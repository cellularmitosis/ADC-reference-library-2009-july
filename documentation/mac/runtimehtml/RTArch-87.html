<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Creating Fat Binary Programs</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING87></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="RTArch-86.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="RTArch-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="RTArch-147.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="RTArch-88.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="RTArch-2.html"><B>Mac OS Runtime Architectures</B></A> / <BR><DD><A HREF="RTArch-86.html"><B>Chapter 7 - Fat Binary Programs</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING87-0></A>
<H1>Creating Fat Binary Programs</H1>
 There are two primary reasons for building fat programs:<P>
<UL>
<LI>You would like to build an application that runs on both PowerPC-based and 68K-based machines. Fat programs of this type contain PowerPC code and either CFM-68K or classic 68K code.
<LI>You are building a shared library, and you would like to have one library file that runs on both PowerPC and 68K-based machines. Fat programs of this type contain PowerPC code and CFM-68K code. <P>
</UL>
 <A NAME=MARKER-2-22></A>It is very easy to build a fat application to run PowerPC code and classic 68K code, because you can place the PowerPC code in the data fork of an application file, and the classic 68K code can be placed in <cv>'CODE'<Default \xE8 Font><CODE></CODE> resources in the resource fork of the same file. If the application is launched on a PowerPC-based Macintosh computer, the Process Manager recognizes the <CODE>'cfrg'0</CODE> resource and knows to execute the PowerPC fragment in the data fork of the file. The PowerPC Process Manager simply ignores the <cv>'CODE'<Default \xE8 Font><CODE></CODE> resources in the resource fork. If the application is launched on a 68K-based Macintosh computer, the Process Manager ignores the <CODE>'cfrg'0</CODE> resource and executes the <CODE>'CODE'</CODE> resources in the resource fork. <P>
 To create a fat application that contains both PowerPC code and CFM-68K code is slightly more complicated, because both PowerPC and CFM-68K runtime fragments require a <CODE>'cfrg'0</CODE> resource.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>If you want to run CFM-based code on both PowerPC-based and 68K-based Macintosh computers, you must build the fragment as a fat program.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 As described in <A HREF=RTArch-25.html#MARKER-9-74>"The Code Fragment Resource," beginning on page 1-20</A>, the <CODE>'cfrg'0</CODE> resource is an array that identifies, among other things, the instruction set, type, and name of the fragment. It also identifies the location of the PEF container for the fragment. As an array, the <CODE>'cfrg'0</CODE> resource can point to multiple containers.<P>
 <A NAME=MARKER-2-23></A>A fat application for both PowerPC and CFM-68K runtime architectures contains code for each instruction set and a <CODE>'cfrg'0</CODE> resource array that points to both containers. If you launch your application on a 68K Macintosh, the 68K Process Manager reads the <CODE>'cfrg'0</CODE> resource and launches the CFM-68K runtime version of the application. If you launch your application on a PowerPC-based Macintosh, the PowerPC Process Manager reads the <CODE>'cfrg'0</CODE> resource and launches the PowerPC version of the application. <A NAME=MARKER-2-24></A><P>
 <A NAME=MARKER-2-25></A>You can also create a fat shared library containing both a CFM-68K runtime library and a PowerPC runtime library. Both the PowerPC and CFM-68K fragments are stored in the data fork, with the <CODE>'cfrg'0</CODE> resource pointing to their locations. In this way, you can ship a single library file that supports both CFM-68K and PowerPC runtime applications.<A NAME=MARKER-2-26></A><P>
<HR>
<center>
<A HREF="RTArch-86.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="RTArch-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="RTArch-147.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="RTArch-88.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="RTArch-3.html">&copy; Apple Computer, Inc.</A><br>11 MARCH 1997<P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML> 
