<html><head><title>Mac OS X
 Manual Page For ber_flush(3)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3/ber_flush" title="Mac OS X
 Manual Page for ber_flush(3)"><!-- headerDoc=man; indexgroup=Section 3; uid="//apple_ref/doc/man/3/ber_flush"; name=ber_flush(3) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
LBER_ENCODE(3)                                                                                <!-- a -->LBER_ENCODE(3)<!-- /a -->



<b>NAME</b>
       ber_alloc_t,  ber_flush,  ber_printf,  ber_put_int,  ber_put_enum,  ber_put_ostring,  ber_put_string,
       ber_put_null,  ber_put_boolean,   ber_put_bitstring,   ber_start_seq,   ber_start_set,   ber_put_seq,
       ber_put_set - LBER simplified Basic Encoding Rules library routines for encoding

<b>LIBRARY</b>
       OpenLDAP LBER (liblber, -llber)

<b>SYNOPSIS</b>
       <b>#include</b> <b>&lt;lber.h&gt;</b>

       <b>BerElement</b> <b>*ber_alloc_t(int</b> <u>options</u><b>);</b>

       <b>int</b> <b>ber_flush(Sockbuf</b> <b>*</b><u>sb</u><b>,</b> <b>BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>int</b> <u>freeit</u><b>);</b>

       <b>int</b> <b>ber_printf(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>fmt</u><b>,</b> <b>...);</b>

       <b>int</b> <b>ber_put_int(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_int_t</b> <u>num</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_enum(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_int_t</b> <u>num</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_ostring(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>str</u><b>,</b> <b>ber_len_t</b> <u>len</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_string(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>str</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_null(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_boolean(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_int_t</b> <u>bool</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_bitstring(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>const</b> <b>char</b> <b>*</b><u>str</u><b>,</b> <b>ber_len_t</b> <u>blen</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_start_seq(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_start_set(BerElement</b> <b>*</b><u>ber</u><b>,</b> <b>ber_tag_t</b> <u>tag</u><b>);</b>

       <b>int</b> <b>ber_put_seq(BerElement</b> <b>*</b><u>ber</u><b>);</b>

       <b>int</b> <b>ber_put_set(BerElement</b> <b>*</b><u>ber</u><b>);</b>

<b>DESCRIPTION</b>
       These  routines  provide  a subroutine interface to a simplified implementation of the Basic Encoding
       Rules of ASN.1.  The version of BER these routines support is the one defined for the LDAP  protocol.
       The  encoding  rules  are  the same as BER, except that only definite form lengths are used, and bit-<font color="#ffffff" class="whiteout">strings&nbsp;bitstrings</font>
       strings and octet strings are always encoded in primitive form.  This man page describes the encoding
       routines in the lber library.  See <a href="lber-decode.3.html#//apple_ref/doc/man/3/lber-decode"><b>lber-decode</b>(3)</a> for details on the corresponding decoding routines.
       Consult <a href="lber-types.3.html#//apple_ref/doc/man/3/lber-types"><b>lber-types</b>(3)</a> for information about types, allocators, and deallocators.

       Normally, the only routines that need to be called by an application are <b>ber_alloc_t</b>() to allocate  a
       BER  element  for encoding, <b>ber_printf</b>() to do the actual encoding, and <b>ber_flush</b>() to actually write
       the element.  The other routines are provided for those applications  that  need  more  control  than
       <b>ber_printf</b>() provides.  In general, these routines return the length of the element encoded, or -1 if
       an error occurred.

       The <b>ber_alloc_t</b>() routine is used to allocate a new BER element.  It should be called with  an  argu-<font color="#ffffff" class="whiteout">ment&nbsp;argument</font>
       ment of LBER_USE_DER.

       The  <b>ber_flush</b>() routine is used to actually write the element to a socket (or file) descriptor, once
       it has been fully encoded (using <b>ber_printf</b>() and friends).  See <!-- a --><b>lber-sockbuf</b>(3)<!-- /a --> for more details  on
       the  Sockbuf  implementation  of the <u>sb</u> parameter.  If the <u>freeit</u> parameter is non-zero, the supplied
       <u>ber</u> will be freed after its contents have been flushed.

       The <b>ber_printf</b>() routine is used to encode a BER element in much the same way that <a href="sprintf.3.html#//apple_ref/doc/man/3/sprintf"><b>sprintf</b>(3)</a>  works.
       One  important  difference,  though, is that some state information is kept with the <u>ber</u> parameter so
       that multiple calls can be made to <b>ber_printf</b>() to append things to  the  end  of  the  BER  element.
       <b>Ber_printf</b>()  writes  to <u>ber</u>, a pointer to a BerElement such as returned by <b>ber_alloc_t</b>().  It inter-<font color="#ffffff" class="whiteout">prets&nbsp;interprets</font>
       prets and formats its arguments according to the format string <u>fmt</u>.  The format  string  can  contain
       the following characters:


              <b>b</b>  Boolean.  An ber_int_t parameter should be supplied.  A boolean element is output.

              <b>e</b>  Enumeration.  An ber_int_t parameter should be supplied.  An enumeration element is output.

              <b>i</b>  Integer.  An ber_int_t parameter should be supplied.  An integer element is output.

              <b>B</b>  Bitstring.  A char * pointer to the start of the bitstring is  supplied,  followed  by  the
                 number of bits in the bitstring.  A bitstring element is output.

              <b>n</b>  Null.  No parameter is required.  A null element is output.

              <b>o</b>  Octet  string.   A char * is supplied, followed by the length of the string pointed to.  An
                 octet string element is output.

              <b>O</b>  Octet string.  A struct berval * is supplied.  An octet string element is output.

              <b>s</b>  Octet string.  A null-terminated string is supplied.  An octet string  element  is  output,
                 not including the trailing NULL octet.

              <b>t</b>  Tag.   A  ber_tag_t  specifying  the  tag to give the next element is provided.  This works
                 across calls.

              <b>v</b>  Several octet strings.  A null-terminated array of char *'s is supplied.  Note that a  con-<font color="#ffffff" class="whiteout">struct&nbsp;construct</font>
                 struct like '{v}' is required to get an actual SEQUENCE OF octet strings.

              <b>V</b>  Several  octet  strings.   A  null-terminated array of struct berval *'s is supplied.  Note
                 that a construct like '{V}' is required to get an actual SEQUENCE OF octet strings.

              <b>W</b>  Several octet strings.  An array of struct berval's is supplied.  The array  is  terminated
                 by a struct berval with a NULL bv_val.  Note that a construct like '{W}' is required to get
                 an actual SEQUENCE OF octet strings.

              <b>{</b>  Begin sequence.  No parameter is required.

              <b>}</b>  End sequence.  No parameter is required.

              <b>[</b>  Begin set.  No parameter is required.

              <b>]</b>  End set.  No parameter is required.

       The <b>ber_put_int</b>() routine writes the integer element <u>num</u> to the BER element <u>ber</u>.

       The <b>ber_put_enum</b>() routine writes the enumeration element <u>num</u> to the BER element <u>ber</u>.

       The <b>ber_put_boolean</b>() routine writes the boolean value given by <u>bool</u> to the BER element.

       The <b>ber_put_bitstring</b>() routine writes <u>blen</u> bits starting at <u>str</u> as a bitstring value  to  the  given
       BER element.  Note that <u>blen</u> is the length <u>in</u> <u>bits</u> of the bitstring.

       The <b>ber_put_ostring</b>() routine writes <u>len</u> bytes starting at <u>str</u> to the BER element as an octet string.

       The <b>ber_put_string</b>() routine writes the null-terminated string (minus the terminating ' ') to the BER
       element as an octet string.

       The <b>ber_put_null</b>() routine writes a NULL element to the BER element.

       The <b>ber_start_seq</b>() routine is used to start a sequence in the BER element.  The <b>ber_start_set</b>() rou-<font color="#ffffff" class="whiteout">tine&nbsp;routine</font>
       tine works similarly.  The end of the sequence or set is marked  by  the  nearest  matching  call  to
       <b>ber_put_seq</b>() or <b>ber_put_set</b>(), respectively.

<b>EXAMPLES</b>
       Assuming  the  following  variable  declarations, and that the variables have been assigned appropri-<font color="#ffffff" class="whiteout">ately,&nbsp;appropriately,</font>
       ately, an lber encoding of the following ASN.1 object:

             AlmostASearchRequest := SEQUENCE {
                 baseObject      DistinguishedName,
                 scope           ENUMERATED {
                     baseObject    (0),
                     singleLevel   (1),
                     wholeSubtree  (2)
                 },
                 derefAliases    ENUMERATED {
                     neverDerefaliases   (0),
                     derefInSearching    (1),
                     derefFindingBaseObj (2),
                     alwaysDerefAliases  (3)
                 },
                 sizelimit       INTEGER (0 .. 65535),
                 timelimit       INTEGER (0 .. 65535),
                 attrsOnly       BOOLEAN,
                 attributes      SEQUENCE OF AttributeType
             }

       can be achieved like so:

             int rc;
             ber_int_t    scope, ali, size, time, attrsonly;
             char   *dn, **attrs;
             BerElement *ber;

             /* ... fill in values ... */

             ber = ber_alloc_t( LBER_USE_DER );

             if ( ber == NULL ) {
                     /* error */
             }

             rc = ber_printf( ber, "{siiiib{v}}", dn, scope, ali,
                 size, time, attrsonly, attrs );

             if( rc == -1 ) {
                     /* error */
             } else {
                     /* success */
             }

<b>ERRORS</b>
       If an error occurs during encoding, generally these routines return -1.


<b>NOTES</b>
       The return values for all of these functions are declared in the &lt;lber.h&gt; header file.

<b>SEE</b> <b>ALSO</b>
       <a href="lber-decode.3.html#//apple_ref/doc/man/3/lber-decode"><b>lber-decode</b>(3)</a>, <a href="lber-memory.3.html#//apple_ref/doc/man/3/lber-memory"><b>lber-memory</b>(3)</a>, <!-- a --><b>lber-sockbuf</b>(3)<!-- /a -->, <a href="lber-types.3.html#//apple_ref/doc/man/3/lber-types"><b>lber-types</b>(3)</a>

<b>ACKNOWLEDGEMENTS</b>
       <b>OpenLDAP</b> is developed and maintained by The OpenLDAP Project (<a href="http://www.openldap.org/)">http://www.openldap.org/)</a>  <b>OpenLDAP</b> is
       derived from University of Michigan LDAP 3.3 Release.



OpenLDAP 2.3.27                                  2006/08/19                                   <!-- a -->LBER_ENCODE(3)<!-- /a -->
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/ber_flush.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/ber_flush.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/ber_flush.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
