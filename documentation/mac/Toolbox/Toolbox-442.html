<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Summary of the Dialog Manager(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING442></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-441.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-443.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-370.html"><B>Chapter 6 - Dialog Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING442-0></A>
<H1>Summary of the Dialog Manager</H1>
<A NAME=HEADING442-1></A>
<H2><A NAME=MARKER-9-681></A>Pascal Summary</H2>
<A NAME=HEADING442-2></A>
<H3>Constants</H3>
<PRE>
CONST
{checking for AppendDITL, ShortenDITL, CountDITL using Gestalt function}
   gestaltDITLExtAttr = 'ditl';  {Gestalt selector for AppendDITL, etc.}
   gestaltDITLExtPresent = 0;    {if this bit's set, then AppendDITL, }
                                 { ShortenDITL, &amp; CountDITL are available}

{item types for GetDialogItem, SetDialogItem}
   ctrlItem       = 4;     {add this constant to the next four constants}
   btnCtrl        = 0;     {standard button control}
   chkCtrl        = 1;     {standard checkbox control}
   radCtrl        = 2;     {standard radio button}
   resCtrl        = 3;     {control defined in a control resource}
   helpItem       = 1;     {help balloons}
   statText       = 8;     {static text}
   editText       = 16;    {editable text}
   iconItem       = 32;    {icon}
   picItem        = 64;    {QuickDraw picture}
   userItem       = 0;     {application-defined item}
   itemDisable    = 128;   {add to any of the above to disable it}

{item numbers of OK and Cancel buttons in alert boxes}
   ok       = 1;  {first button is OK button}
   cancel   = 2;  {second button is Cancel button}

{resource IDs of alert box icons}
   stopIcon    = 0;
   noteIcon    = 1;
   cautionIcon = 2;

{constants used for theMethod parameter in AppendDITL}
   overlayDITL       = 0;  {overlay existing items}
   appendDITLRight   = 1;  {append at right}
   appendDITLBottom  = 2;  {append at bottom}
{constants for procID parameter of NewDialog, NewColorDialog}
   dBoxProc          = 1;  {modal dialog box}
   noGrowDocProc     = 4;  {modeless dialog box}
   movableDBoxProc   = 5;  {movable modal dialog box}
</PRE>
<A NAME=HEADING442-4></A>
<H3>Data Types</H3>
<PRE>
TYPE  DialogPtr      =  WindowPtr;
ResumeProcPtr        =  ProcPtr;
SoundProcPtr         =  ProcPtr;
ModalFilterProcPtr   =  ProcPtr;
DialogPeek           =  ^DialogRecord;
DialogRecord         =
RECORD
   window:     WindowRecord;  {dialog window}
   items:      Handle;        {item list resource}
   textH:      TEHandle;      {current editable text item}
   editField:  Integer;       {editable text item number minus 1}
   editOpen:   Integer;       {used internally}
   aDefItem:   Integer;       {default button item number}
END;

DITLMethod = Integer;
</PRE>
<A NAME=HEADING442-6></A>
<H3>Dialog Manager Routines</H3>
<A NAME=HEADING442-7></A>
<H4>Initializing the Dialog Manager</H4>
<PRE>
PROCEDURE InitDialogs(resumeProc: ResumeProcPtr);
PROCEDURE ErrorSound(soundProc: SoundProcPtr);
PROCEDURE SetDialogFont(fontNum: Integer); {also spelled SetDAFont}
</PRE>
<A NAME=HEADING442-11></A>
<H4>Creating Alerts</H4>
<PRE>
{some routines have 2 spellings--see Table 6-1 for the alternate spellings}
FUNCTION Alert(alertID: Integer; filterProc: 
ModalFilterProcPtr): Integer;
FUNCTION StopAlert(alertID: Integer; filterProc: 
ModalFilterProcPtr): Integer;
FUNCTION NoteAlert(alertID: Integer; filterProc: 
ModalFilterProcPtr): Integer;
FUNCTION CautionAlert(alertID: Integer; filterProc: 
ModalFilterProcPtr): Integer;
FUNCTION GetAlertStage: Integer;
PROCEDURE ResetAlertStage;
</PRE>
<A NAME=HEADING442-19></A>
<H4>Creating and Disposing of Dialog Boxes</H4>
<PRE>
{some routines have 2 spellings--see Table 6-1 for the alternate spellings}
FUNCTION GetNewDialog(dialogID: Integer; dStorage: Ptr; 
behind:  WindowPtr): DialogPtr;
FUNCTION NewColorDialog(dStorage: Ptr; boundsRect: Rect; title: 
Str255; visible: Boolean; procID: Integer; 
behind: WindowPtr; goAwayFlag: Boolean; 
refCon: LongInt; items: Handle): DialogPtr;
FUNCTION NewDialog(dStorage:  Ptr; boundsRect: Rect; title: 
Str255; visible: Boolean; procID: Integer; 
behind: WindowPtr; goAwayFlag: Boolean; 
refCon: LongInt; items: Handle):  DialogPtr;
PROCEDURE CloseDialog(theDialog: DialogPtr);
PROCEDURE DisposeDialog(theDialog: DialogPtr);
</PRE>
<A NAME=HEADING442-26></A>
<H4>Manipulating Items in Alert and Dialog Boxes</H4>
<PRE>
{some routines have 2 spellings--see Table 6-1 for the alternate spellings}
PROCEDURE GetDialogItem(theDialog: DialogPtr; itemNo: Integer; 
VAR itemType: Integer; VAR item: Handle; 
VAR box: Rect);
PROCEDURE SetDialogItem(theDialog: DialogPtr; itemNo: Integer; 
itemType: Integer; item: Handle; box: Rect);
PROCEDURE HideDialogItem (theDialog: DialogPtr; itemNo: Integer);
PROCEDURE ShowDialogItem(theDialog: DialogPtr; itemNo: Integer);
FUNCTION FindDialogItem(theDialog: DialogPtr; thePt: Point): Integer;
PROCEDURE AppendDITL(theDialog: DialogPtr; theDITL: Handle; 
theMethod: DITLMethod);
PROCEDURE ShortenDITL(theDialog: DialogPtr; numberItems: Integer);
FUNCTION CountDITL(theDialog: DialogPtr): Integer;
</PRE>
<A NAME=HEADING442-36></A>
<H4>Handling Text in Alert and Dialog Boxes</H4>
<PRE>
{some routines have 2 spellings--see Table 6-1 for the alternate spellings}
PROCEDURE ParamText(param0: Str255; param1: Str255; 
param2: Str255; param3: Str255);
PROCEDURE GetDialogItemText(item: Handle; VAR text: Str255);
PROCEDURE SetDialogItemText(item: Handle; text: Str255);
PROCEDURE SelectDialogItemText
   (theDialog: DialogPtr; itemNo: Integer; 
strtSel: Integer; endSel: Integer);
PROCEDURE DialogCut(theDialog: DialogPtr);
PROCEDURE DialogCopy(theDialog: DialogPtr);
PROCEDURE DialogPaste(theDialog: DialogPtr);
PROCEDURE DialogDelete(theDialog: DialogPtr);
</PRE>
<A NAME=HEADING442-47></A>
<H4>Handling Events in Dialog Boxes</H4>
<PRE>
{some routines have 2 spellings--see Table 6-1 for the alternate spellings}
PROCEDURE ModalDialog(filterProc: ModalFilterProcPtr; VAR itemHit: 
Integer);
FUNCTION IsDialogEvent(theEvent: EventRecord): Boolean;
FUNCTION DialogSelect(theEvent: EventRecord; VAR theDialog: 
DialogPtr; VAR itemHit: Integer): Boolean;
PROCEDURE DrawDialog(theDialog: DialogPtr);
PROCEDURE UpdateDialog(theDialog: DialogPtr; updateRgn: RgnHandle);
</PRE>
<A NAME=HEADING442-54></A>
<H3>Application-Defined Routines</H3>
<PRE>
PROCEDURE MyItem(theWindow: WindowPtr; itemNo: Integer);
PROCEDURE MyAlertSound(soundNo: Integer);
FUNCTION MyEventFilter(theDialog: DialogPtr; VAR theEvent: 
EventRecord; VAR itemHit: Integer): Boolean;
</PRE>
<A NAME=HEADING442-58></A>
<H2>C Summary</H2>
<A NAME=HEADING442-59></A>
<H3>Constants</H3>
<PRE>
enum {
/*checking for AppendDITL, ShortenDITL, CountDITL using Gestalt function*/
   #define gestaltDITLExtAttr 'ditl' /*Gestalt selector*/
   gestaltDITLExtPresent = 0     /*if this bit's set, then AppendDITL, */
                                 /* ShortenDITL, &amp; CountDITL are available*/
};

enum {
/*item types for GetDItem, SetDItem*/
   ctrlItem       = 4,  /*add this constant to the next four constants*/
   btnCtrl        = 0,  /*standard button control*/
   chkCtrl        = 1,  /*standard checkbox control*/
   radCtrl        = 2,  /*standard radio button*/
   resCtrl        = 3,  /*control defined in a control resource*/
   statText       = 8,  /*static text*/
   editText       = 16, /*editable text*/
   iconItem       = 32, /*icon*/
   picItem        = 64, /*QuickDraw picture*/
   userItem       = 0,  /*application-defined item*/
   helpItem       = 1,  /*help balloons*/
   itemDisable    = 128,/*add to any of the above to disable it*/

/*item numbers of OK and Cancel buttons in alert boxes*/
   ok       = 1,  /*first button is OK button*/
   cancel   = 2,  /*second button is Cancel button*/

/*resource IDs of alert box icons*/
   stopIcon    = 0,
   noteIcon    = 1,
   cautionIcon = 2
};

enum {
/*constants used for theMethod parameter in AppendDITL*/
   overlayDITL       = 0,  /*overlay existing items*/
   appendDITLRight   = 1,  /*append at right*/
   appendDITLBottom  = 2   /*append at bottom*/
}; 

enum {
/*constants for procID parameter of NewDialog, NewColorDialog*/
   dBoxProc          = 1,  /*modal dialog box*/
   noGrowDocProc     = 4,  /*modeless dialog box*/
   movableDBoxProc   = 5   /*movable modal dialog box*/
}; 
</PRE>
<A NAME=HEADING442-61></A>
<H3>Data Types</H3>
<PRE>
typedef WindowPtr DialogPtr;

typedef struct DialogRecord DialogRecord;
typedef struct DialogRecord *DialogPeek;

struct DialogRecord{
      WindowRecord   window;     /*dialog window*/
      Handle         items;      /*item list resource*/
      TEHandle       textH;      /*current editable text item*/
      short          editField;  /*editable text item number minus 1*/
      short          editOpen;   /*used internally*/
      short          aDefItem;   /*default button item number*/
};
typedef pascal void (*ResumeProcPtr)(void);
typedef pascal void (*SoundProcPtr)(void);
typedef pascal Boolean (*ModalFilterProcPtr)(DialogPtr theDialog, 
                                    EventRecord *theEvent, short *itemHit);
typedef short DITLMethod;
</PRE>
<A NAME=HEADING442-63></A>
<H3>Dialog Manager Routines</H3>
<A NAME=HEADING442-64></A>
<H4>Initializing the Dialog Manager</H4>
<PRE>
pascal void InitDialogs(ResumeProcPtr resumeProc);
pascal void ErrorSound(SoundProcPtr soundProc);
pascal void SetDialogFont(short fontNum); /*also spelled SetDAFont*/
</PRE>
<A NAME=HEADING442-68></A>
<H4>Creating Alerts</H4>
<PRE>
/*some routines have 2 spellings--see Table 6-1 for the alternate spellings*/
pascal short Alert(short alertID, ModalFilterProcPtr filterProc);
pascal short StopAlert(short alertID, ModalFilterProcPtr filterProc);
pascal short NoteAlert(short alertID, ModalFilterProcPtr filterProc);
pascal short CautionAlert(short alertID, ModalFilterProcPtr filterProc);
#define GetAlertStage() (* (short*) 0x0A9A);
pascal void ResetAlertStage(void);
</PRE>
<A NAME=HEADING442-76></A>
<H4>Creating and Disposing of Dialog Boxes</H4>
<PRE>
/*some routines have 2 spellings--see Table 6-1 for the alternate spellings*/
pascal DialogPtr GetNewDialog 
   (short dialogID, void *dStorage, 
WindowPtr behind);
pascal DialogPtr NewColorDialog 
   (void *dStorage, const Rect *boundsRect, 
ConstStr255Param title, Boolean visible,
short procID, WindowPtr behind, 
Boolean goAwayFlag, long refCon, Handle items);
pascal DialogPtr NewDialog
   (void *dStorage, const Rect *boundsRect, 
ConstStr255Param title, Boolean visible, 
short procID, WindowPtr behind, 
Boolean goAwayFlag, long refCon, 
Handle items);
pascal void CloseDialog(DialogPtr theDialog);
pascal void DisposeDialog(DialogPtr theDialog);
</PRE>
<A NAME=HEADING442-86></A>
<H4>Manipulating Items in Alert and Dialog Boxes</H4>
<PRE>
/*some routines have 2 spellings--see Table 6-1 for the alternate spellings*/
pascal void GetDialogItem(DialogPtr theDialog, short itemNo,
short *itemType, Handle *item, Rect *box);
pascal void SetDialogItem(DialogPtr theDialog, short itemNo, short 
itemType, Handle item, const Rect *box);
pascal void HideDialogItem(DialogPtr theDialog, short itemNo);
pascal void ShowDialogItem(DialogPtr theDialog, short itemNo);
pascal short FindDialogItem(DialogPtr theDialog, Point thePt);
pascal void AppendDITL(DialogPtr theDialog, Handle theDITL, 
DITLMethod theMethod);
pascal void ShortenDITL(DialogPtr theDialog, short numberItems);
pascal short CountDITL(DialogPtr theDialog);
</PRE>
<A NAME=HEADING442-96></A>
<H4>Handling Text in Alert and Dialog Boxes</H4>
<PRE>
/*some routines have 2 spellings--see Table 6-1 for the alternate spellings*/
pascal void ParamText(ConstStr255Param param0, 
ConstStr255Param param1,
ConstStr255Param param2, 
ConstStr255Param param3);
pascal void GetDialogItemText
   (Handle item, Str255 text);
pascal void SetDialogItemText
   (Handle item, ConstStr255Param text);
pascal void SelectDialogItemText
   (DialogPtr theDialog, short itemNo,
short strtSel, short endSel);
pascal void DialogCut(DialogPtr theDialog);
pascal void DialogCopy(DialogPtr theDialog);
pascal void DialogPaste(DialogPtr theDialog);
pascal void DialogDelete(DialogPtr theDialog);
</PRE>
<A NAME=HEADING442-109></A>
<H4>Handling Events in Dialog Boxes</H4>
<PRE>
/*some routines have 2 spellings--see Table 6-1 for the alternate spellings*/
pascal void ModalDialog(ModalFilterProcPtr filterProc, short *itemHit);
pascal Boolean IsDialogEvent(const EventRecord *theEvent);
pascal Boolean DialogSelect(const EventRecord *theEvent, 
DialogPtr *theDialog, short *itemHit);
pascal void DrawDialog(DialogPtr theDialog);
pascal void UpdateDialog(DialogPtr theDialog, RgnHandle updateRgn);
</PRE>
<A NAME=HEADING442-116></A>
<H3>Application-Defined Routines</H3>
<PRE>
pascal void MyItem(WindowPtr theWindow, short itemNo);
pascal void MyAlertSound(short soundNo);
pascal Boolean MyEventFilter(DialogPtr theDialog, *EventRecord theEvent,
*short itemHit);
</PRE>
<A NAME=HEADING442-120></A>
<H2>Assembly-Language Summary</H2>
<A NAME=HEADING442-121></A>
<H3>Data Structures</H3>
<A NAME=HEADING442-122></A>
<H4>DialogRecord Data Structure
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD>dWindow<TD>156 bytes<TD>window record for the alert box or dialog box<TR>
<TD>156 <TD>items<TD>long<TD>handle to the item list resource for the alert box or dialog box<TR>
<TD>160 <TD>teHandle<TD>long<TD>handle to the current editable text item<TR>
<TD>164 <TD>editField<TD>word<TD>current editable text item<TR>
<TD>166 <TD>editOpen<TD>word<TD>used internally<TR>
<TD>168 <TD>aDefItem<TD>word<TD>item number of the default button</TABLE>
</H4>
<A NAME=HEADING442-123></A>
<H3>Global Variables
<TABLE BORDER="0" CELLPADDING=3><TD>DAStrings<TD>Handles to text strings specified with the <CODE>ParamText</CODE> procedure<A NAME=MARKER-2-31></A><TR>
<TD>DABeeper<TD>Address of current sound procedure<A NAME=MARKER-2-32></A><TR>
<TD>DlgFont<TD>Font number for text in dialog boxes and alert boxes<A NAME=MARKER-2-33></A><TR>
<TD>ACount<TD>Alert stage number (0 through 3) of the last alert<A NAME=MARKER-2-34></A><TR>
<TD>ANumber<TD>Resource ID of last alert<A NAME=MARKER-2-35></A><TR>
<TD>ResumeProc<TD>Address of resume procedure (should not be used in System 7)<CODE><A NAME=MARKER-2-36></A></CODE></TABLE>
</H3>
 <A NAME=MARKER-2-682></A><P>
 <P>
</BLOCKQUOTE><P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-441.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-443.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
