<HTML><HEAD>   <title>Technical Q&amp;A QA1184: Signals and Threads</title><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><meta name="keywords" content="pthreads, signals, threads"><meta name="Description" content="Technical Q&amp;A QA1184: This Q&amp;A describes how threads andsignals interact."><meta name="categories" content="Processes"><meta name="week-posted" content="Aug 26, 2002 - Aug 30, 2002"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001713" title="Signals and Threads"></a><P><!-- top_of_header_marker_comment --> <!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/Darwin/index.html">Darwin</a> &gt; <a href="../../technicalqas/Darwin/idxPerformance-date.html">Performance</a> &gt; </p><!-- end_header_information --> <!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QA1184</div>
<div id="pageheadsub">Signals and Threads</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --></P><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600>   <TR>      <td align="left">         <P><!-- begin_content -->                  <hr width=500 align=center>                  </P>                  <P id=p2>Q: I have a multi-threaded process on Mac OS X. If         my process receives a signal, which thread executes the         signal handler?</P>                  <P id=p4>A: Synchronous signals, those caused by the thread         itself (like <CODE>SIGPIPE</CODE> and <CODE>SIGBUS</CODE>),         are delivered to the thread that caused them. Asynchronous         signals (signals sent to the process by an external source)         are delivered to an arbitrary thread within the process.</P>                  <CENTER><TABLE BORDER=0 CELLPADDING=3 WIDTH=550>            <TR>               <td bgcolor="#E6E6E6" align=left>                  <P><B>IMPORTANT:</B><BR>                  At the time of writing, Mac OS X                  chooses the thread to execute                  asynchronous signal handlers using the following                  criteria.</P>                                    <UL>                     <LI>The thread must still                     be running (that is, not                     terminated).</LI>                                          <LI>On Mac OS X 10.2 and                     later, the thread must not have the signal                     masked (using                     <CODE>pthread_sigmask</CODE>).</LI>                                          <LI>An older thread is                     preferred to newer thread.</LI>                  </UL>                                    <P>Thus an asynchronous                  signal is sent to the oldest non-terminated thread                  that does not have it masked. Do not rely on                  this exact behaviour.                  The thread chosen to handle an asynchronous signal                  is not guaranteed (except in the case of                  <CODE>pthread_kill</CODE>, described below)                  and could change an future                  systems.</P>               </TD>            </TR>         </TABLE>         </CENTER>                  <P id=p2>Q: I have a multi-threaded process on Mac OS X. If         one thread receives a signal, will the other threads         stop?</P>                  <P id=p4>A: No. All other threads continue to run during         signal handler invocation.</P>                  <P id=p2>Q: Has there been any change in thread signal         handling in Mac OS X 10.2?</P>                  <P id=p4>A: The above answers still hold. The most         significant changes in thread signal handling in Mac OS X         10.2 are that you can now send an asynchronous signal to a         specific thread within your process         (<CODE>pthread_kill</CODE>), set a per-thread signal mask         (<CODE>pthread_sigmask</CODE>), and wait for a specific         signal (<CODE>sigwait</CODE>).</P>                  <P id=p2>Q: If one of my threads is         waiting in <CODE>sigwait</CODE>, is it guaranteed to be the         thread that executes an asynchronous signal         handler?</P>                  <P id=p4>A: No. The choice of thread         to execute an asynchronous signal handler is described         above, and it is not affected by calls to         <CODE>sigwait</CODE>. This is in line with POSIX standard.         The only way to guarantee that a specific thread will handle         an asynchronous signal is to mask that signal in all other         threads.</P>                  <P>                  <hr width=500 align=center>                  </P>                  <!-- begin_date --><H4><CENTER>[Aug 27 2002]</CENTER></H4><!-- end_date -->      </TD>   </TR></TABLE></CENTER><P><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qa2001/qa1184.html%3Fid%3DDTS10001713-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qa2001/qa1184.html%3Fid%3DDTS10001713-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qa2001/qa1184.html%3Fid%3DDTS10001713-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></P></BODY></HTML>