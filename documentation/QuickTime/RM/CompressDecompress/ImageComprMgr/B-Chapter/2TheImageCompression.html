<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Compression and Decompression Guide: The Image Compression Manager</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="The Image Compression Manager"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager" title="The Image Compression Manager"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../../CompressionDecompression-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000498" target="_top">Compression &amp; Decompression</a> &gt; <a href="../A-Intro/1Introduction.html#//apple_ref/doc/uid/TP40000878-IntroductiontoQuickTimeCompressionandDecompressionGuide-DontLinkElementID_145">QuickTime Compression and Decompression Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../A-Intro/1Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../C-Chapter/3ExtensionstotheImag.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-SW1" title="The Image Compression Manager"></a>
<h1>The Image Compression Manager</h1>

<p>This chapter describes the QuickTime Image Compression Manager (ICM), which compresses images by invoking <strong>image</strong> <strong>compressor</strong> <strong>components</strong> and decompresses images using <strong>image</strong> <strong>decompressor</strong> <strong>components.</strong></p>
<p>The Image Compression Manager enables your application to perform a variety of tasks, including the storage of compressed image data in pictures, compression of image sequences, display of compressed image files, and so on.</p>



<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="2TheImageCompression.html#//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_4">Overview of the ICM</a>
				
			<br/>
			
        
			
			
				<a href="2TheImageCompression.html#//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_5">Data That Is Suitable for Compression</a>
				
			<br/>
			
        
			
			
				<a href="2TheImageCompression.html#//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_6">Storing Images</a>
				
			<br/>
			
        
			
			
				<a href="2TheImageCompression.html#//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_7">Working With Pictures</a>
				
			<br/>
			
        
			
			
				<a href="2TheImageCompression.html#//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_8">Understanding Compressor Components</a>
				
			<br/>
			
        
			
			
				<a href="2TheImageCompression.html#//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_9">Banding and Extending Images</a>
				
			<br/>
			
        
			
			
				<a href="2TheImageCompression.html#//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_10">Fast Dithering</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_4" title="Overview of the ICM"></a>
<h2><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-OverviewoftheICM" title="Overview of the ICM"></a>Overview of the ICM</h2>
<p>The Image Compression Manager provides your application with an interface for compressing and decompressing images and sequences of images that is independent of devices and algorithms.</p>
<p>Uncompressed image data requires a large amount of storage space. Storing a single 640-by-480 pixel image in 32-bit color can require as much as 1.2 MB. Sequences of images, like those that might be contained in a QuickTime movie, demand substantially more storage than single images. This is true even for sequences that consist of fairly small images, because the movie consists of such a large number of those images. Consequently, minimizing the storage requirements for image data is an important consideration for any application that works with images or sequences of images.</p>
<p>The Image Compression Manager compresses images by invoking <strong>image</strong> <strong>compressor</strong> <strong>components</strong> and decompresses images using <strong>image</strong> <strong>decompressor</strong> <strong>components.</strong> Compressor and decompressor components are code resources that present a standard interface to the Image Compression Manager and provide image-compression and image-decompression services, respectively. The Image Compression Manager receives application requests and coordinates the actions of the appropriate components. The components perform the actual compression and decompression. Compressor and decompressor components are standard components and are managed by the Component Manager.</p>
<p>Because the Image Compression Manager is independent of specific compression algorithms and drivers, it provides a number of advantages to developers of image-compression algorithms. Specifically, compressor and decompressor components can</p>
<ul class="ul">
<li class="li"><p>present a common application interface for software-based compressors and hardware-based compressors.</p></li>
<li class="li"><p>provide several different compressors and compression options, allowing the Image Compression Manager or the application to choose the appropriate tool for a particular situation.</p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_5" title="Data That Is Suitable for Compression"></a>
<h2><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DataThatIsSuitableforCompression" title="Data That Is Suitable for Compression"></a>Data That Is Suitable for Compression</h2>
<p>One way to represent an image is with a pixel map, which stores a color for every pixel. For most images, however, a pixel map is an inefficient storage format. For example, a pixel map containing a solid black image would contain the color black stored over and over and over again. By compressing the image, some of this redundant information can be eliminated. The compressed image can occupy much less storage than a pixel map and can be decompressed to a pixel map when necessary.</p>
<p>In addition, human perception of visual images exhibits special qualities that can be exploited to further compress image data. Image-compression algorithms take advantage of these properties to reduce the amount of information required to describe an image well enough to allow a person to see it.</p>
<p>A <strong>lossless</strong> <strong>compression</strong> technique can recreate an exact copy of the original image from the compressed form. Small changes in the image are not objectionable in most applications, however, so most compressors sacrifice some accuracy in order to further decrease the size of the compressed data. However, the compressor carefully chooses the data to omit so that the human visual system compensates for the loss and fools the user into seeing what appears to be the original image.</p>
<p>The Image Compression Manager works only with image data. The Image Compression Manager is primarily useful for compressing pictures that have pixel map images, such as those obtained from scanned still images or digitized video images, or from paint or three-dimensional rendering applications. You do not achieve significant compression treating pictures that are stored as groups of graphics primitives, such as those created by drawing, computer-aided design (CAD), or three-dimensional modeling applications. These applications create images in a compact format that precisely states the characteristics of the objects in the image. In fact, if you were to convert such images to pixel map representations and then compress the resulting image with the Image Compression Manager, you would probably end up with a larger, less precise image than the original. If a picture contains both primitives and pixel map image data (such as text or lines drawn over a painted or digitized image) the Image Compression Manager compresses the pixel map data and leaves the graphics primitives unchanged.</p>
<p>The Image Compression Manager also provides services for compressing and decompressing sequences of images or  <strong>frames</strong> (another term for a single visual image in an image sequence). When processing a sequence, compressors may perform <strong>temporal</strong> <strong>compression,</strong> compressing the sequence by eliminating information that is redundant from one frame to the next. This temporal compression differs from <strong>spatial</strong> <strong>compression,</strong> which is performed on individual images or frames within a sequence. You may use both techniques on a single sequence.</p>
<p>Compressor components perform temporal compression by comparing the current frame in a sequence with the previous frame. The compressor then stores information about only those pixels that change significantly between the two images. When adjacent images contain substantially similar visual information, as is often the case in movies, temporal compression can significantly reduce the amount of data required to describe the images in the sequence. Your application indicates the desired quality level for the compressed image. The compressor uses this value to govern the extent to which it takes advantage of temporal redundancy between images. There is also a spatial quality level that you can use to control the amount of spatial compression applied to each individual image. Both of these quality values govern the amount of accuracy that is lost in the compressed image.</p>
<p>Note that the Image Compression Manager does not maintain any time information for an image sequence. Rather, the Image Compression Manager maintains the order and content of the images in the sequence while the Movie Toolbox handles all timing considerations.</p>

<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_6" title="Storing Images"></a>
<h2><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-StoringImages" title="Storing Images"></a>Storing Images</h2>
<p>The Image Compression Manager can compress two kinds of image data: pictures and pixel maps. Pictures may be stored in memory, in a resource, or in a PICT file. Pixel maps are normally stored in a window or offscreen buffer. When compressing an image from a PICT file, the Image Compression Manager provides facilities that allow applications to spool data to and from the disk file, as appropriate to the operation. These application-provided data-loading and data-unloading functions allow arbitrarily large images to be compressed or decompressed without requiring large amounts of memory.</p>
<p>Applications must convert images that are not stored as pictures or pixel maps into one of these formats before compressing them. The Image Compression Manager contains several high-level functions that make it quite easy for applications to work with compressed images that are stored as PICT files, as discussed in the next section.</p>

<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_7" title="Working With Pictures"></a>
<h2><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-WorkingWithPictures" title="Working With Pictures"></a>Working With Pictures</h2>
<p>The Image Compression Manager provides a set of functions that allow applications to work easily with compressed pictures stored in version 2 PICT files. These functions constitute a high-level interface to image compression and decompression. Applications that require little control over the compression process may use these functions to display pictures that contain compressed image data.</p>
<p>Existing programs can display (without changes) pictures that contain compressed image data. When the Image Compression Manager is installed on a system, it installs a new <code><a href="../../../../Reference/QTRef_CompDecomp/Reference/reference.html#//apple_ref/c/func/StdPix" target="_top">StdPix</a></code> graphics function (see <span class="content_text">Working With the <code><a href="../../../../Reference/QTRef_CompDecomp/Reference/reference.html#//apple_ref/c/func/StdPix" target="_top">StdPix</a></code> Function</span> for more information on the <code><a href="../../../../Reference/QTRef_CompDecomp/Reference/reference.html#//apple_ref/c/func/StdPix" target="_top">StdPix</a></code> graphics function). This function handles all requests to display compressed images. Whenever an application issues the standard QuickDraw <code>DrawPicture</code> routine to display an image that contains compressed image data, the <code><a href="../../../../Reference/QTRef_CompDecomp/Reference/reference.html#//apple_ref/c/func/StdPix" target="_top">StdPix</a></code> function decompresses the image by invoking the Image Compression Manager. The function then delivers the decompressed image to the application.</p>
<p>The Image Compression Manager also provides a simple mechanism for creating a picture that contains compressed image data. For example, to place an existing compressed image into a picture, your application could open the picture with QuickDraw&#8217;s <code>OpenPicture</code> (or <code>OpenCPicture</code>) function and then call the Image Compression Manager&#8217;s <code><a href="../../../../Reference/QTRef_CompDecomp/Reference/reference.html#//apple_ref/c/func/DecompressImage" target="_top">DecompressImage</a></code> function, as if you were going to display the image. The Image Compression Manager places the compressed image and the other data that describe the image into the picture for you.</p>
<p>The Image Compression Manager stores the following information about a compressed picture:</p>
<ul class="ul">
<li class="li"><p>the image description, which describes the compression format and characteristics of the compressed image data</p></li>
<li class="li"><p>the compressed data for the image</p></li>
<li class="li"><p>the transfer mode (source copy mode, dither copy mode, and so on)</p></li>
<li class="li"><p>the matte pixel map</p></li>
<li class="li"><p>the mask region</p></li>
<li class="li"><p>the mapping matrix</p></li>
<li class="li"><p>the source rectangle of the image</p></li>
</ul>
<p>The Image Compression Manager stores this information in the picture as a new PICT  opcode (described in the following paragraphs). When an application draws the compressed picture on a Macintosh computer that is running the Image Compression Manager, the <code><a href="../../../../Reference/QTRef_CompDecomp/Reference/reference.html#//apple_ref/c/func/StdPix" target="_top">StdPix</a></code> function instructs the Image Compression Manager to decompress the image. If an application tries to read a picture file that contains compressed data on a Macintosh that does not have the Image Compression Manager installed, the system ignores the new opcodes and displays a message that indicates that the user needs QuickTime in order to display the compressed image data. The message states &#8220;QuickTime and a &#60;Codec Name&#62; decompressor are needed to see this picture&#8221;.</p>
<p>The Color QuickDraw version 2 picture format includes PICT opcodes for compressed and uncompressed QuickTime images. (An opcode is a hexidecimal number that represents drawing commands and the parameters that affect those drawing commands in a picture.)</p>
<p>The PICT opcodes for compressed and uncompressed QuickTime images are</p>
<ul class="ul">
<li class="li"><p>opcode $8200, which signals a compressed QuickTime image</p></li>
<li class="li"><p>opcode $8201, which signals an uncompressed QuickTime image</p></li>
</ul>
<p>Table&#160;1-1 gives an overview of the opcode for QuickTime compressed pictures.</p>
<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_147" title="Table 1-1Fields of the PICT opcode for compressed QuickTime images"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 1-1&nbsp;&nbsp;</strong>Fields of the PICT opcode for compressed QuickTime images</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Field name</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data size (in bytes)</p></th>
</tr>


<tr>
<td  scope="row"><p><code>Opcode</code></p></td>
<td ><p>Compressed picture data</p></td>
<td ><p>2</p></td>
</tr>
<tr>
<td  scope="row"><p><code>Size</code></p></td>
<td ><p>Size in bytes of data for this opcode</p></td>
<td ><p>4</p></td>
</tr>
<tr>
<td  scope="row"><p><code>Version</code></p></td>
<td ><p>Version of this opcode</p></td>
<td ><p>2</p></td>
</tr>
<tr>
<td  scope="row"><p><code>Matrix</code></p></td>
<td ><p>3 by 3 fixed transformation matrix</p></td>
<td ><p>36</p></td>
</tr>
<tr>
<td  scope="row"><p><code>MatteSize</code></p></td>
<td ><p>Size of matte data in bytes</p></td>
<td ><p>4</p></td>
</tr>
<tr>
<td  scope="row"><p><code>MatteRect</code></p></td>
<td ><p>Rectangle for matte data</p></td>
<td ><p>8</p></td>
</tr>
<tr>
<td  scope="row"><p><code>Mode</code></p></td>
<td ><p>Transfer mode</p></td>
<td ><p>2</p></td>
</tr>
<tr>
<td  scope="row"><p><code>SrcRect</code></p></td>
<td ><p>Rectangle for source</p></td>
<td ><p>8</p></td>
</tr>
<tr>
<td  scope="row"><p><code>Accuracy</code></p></td>
<td ><p>Preferred accuracy</p></td>
<td ><p>4</p></td>
</tr>
<tr>
<td  scope="row"><p><code>MaskSize</code></p></td>
<td ><p>Size of mask region in bytes</p></td>
<td ><p>4</p></td>
</tr>

</table></div>
<div class="warningbox"><img src="../../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_148" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;
Do not attempt to read opcodes directly. For compatibility reasons, use Toolbox routines to access this information.  </p><p>
</p><div class="clear"></div></div>
<p>The <code>MaskSize</code> field of opcode $8200 is followed by five variable fields:</p>
<ul class="ul">
<li class="li"><p>The matte image description, which contains the image description structure for the matte. The variable size is specified in the first long integer in the opcode. This field is not included if the <code>MatteSize</code> field is 0.</p></li>
<li class="li"><p>The matte data, which contains the compressed data for the matte. The size of this field is defined by the <code>MatteSize</code> field listed in Table&#160;1-1. This field is not included if the <code>MatteSize</code> field is 0.</p></li>
<li class="li"><p>The mask region, which contains the region for masking. The size of this variable is defined by the <code>MaskSize</code> field listed in Table&#160;1-1. This field is not included if the <code>MaskSize</code> field is 0.</p></li>
<li class="li"><p>The image description structure for this data. The size of this variable is specified in the first long integer in the <code>idSize</code> field of this image description.</p></li>
<li class="li"><p>The image data, which contains the compressed data for the image. The size of the image data is specified in the image description&#8217;s <code>dataSize</code> field.</p></li>
</ul>
<p>See <span class="content_text"><a href="../F-Chapter/6WorkingwiththeImage.html#//apple_ref/doc/uid/TP40000878-WorkingwiththeImageCompressionManager-TheImageDescriptionStructure">The Image Description Structure</a></span> for details on the <code>idSize</code> and <code>dataSize</code> fields.</p>
<p>Table&#160;1-2 provides an overview of the structure of uncompressed QuickTime images.</p>
<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_149" title="Table 1-2Fields of the PICT opcode for uncompressed QuickTime images"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5">
<caption class="tablecaption"><strong>Table 1-2&nbsp;&nbsp;</strong>Fields of the PICT opcode for uncompressed QuickTime images</caption>

<tr>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Field name</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th>
<th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Data size (in bytes)</p></th>
</tr>


<tr>
<td  scope="row"><p><code>Opcode</code></p></td>
<td ><p>Uncompressed picture data</p></td>
<td ><p>2</p></td>
</tr>
<tr>
<td  scope="row"><p><code>Size</code></p></td>
<td ><p>Size in bytes of data for this opcode</p></td>
<td ><p>4</p></td>
</tr>
<tr>
<td  scope="row"><p><code>Version</code></p></td>
<td ><p>Version of this opcode</p></td>
<td ><p>2</p></td>
</tr>
<tr>
<td  scope="row"><p><code>Matrix</code></p></td>
<td ><p>3 by 3 fixed transformation matrix</p></td>
<td ><p>36</p></td>
</tr>
<tr>
<td  scope="row"><p><code>MatteSize</code></p></td>
<td ><p>Size of matte data in bytes</p></td>
<td ><p>4</p></td>
</tr>
<tr>
<td  scope="row"><p><code>MatteRect</code></p></td>
<td ><p>Rectangle for matte data</p></td>
<td ><p>8</p></td>
</tr>

</table></div>
<p>The <code>MatteRect</code> field of opcode $8201 is followed by three variable fields and a subopcode:</p>
<ul class="ul">
<li class="li"><p>The matte image description, which contains the image description structure for the matte. The size of this variable is specified in the first long integer in this opcode. This field is not included if the <code>MatteSize</code> field is 0.</p></li>
<li class="li"><p>The matte data, which contains information for the matte. The size of this variable is defined by the <code>MatteSize</code> field.</p></li>
<li class="li"><p>A subopcode (2 bytes in length) which describes the image and mask and is entirely within the other opcode. Its size is included in the size for the main opcode; hence it is not included if the QuickTime opcode is skipped. This subopcode can be either $98, $99, $9A, or $9B.</p></li>
<li class="li"><p>The data for the subopcode variable which contains information for the image.</p></li>
</ul>

<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_8" title="Understanding Compressor Components"></a>
<h2><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-UnderstandingCompressorComponents" title="Understanding Compressor Components"></a>Understanding Compressor Components</h2>
<p>This section discusses key attributes of compressor components and the functional interfaces these components must support. (<strong>Compressor</strong> <strong>components</strong> here refers to both image compressor components and image decompressor components.) This information is intended for developers of compressor components. Application developers do not need to be familiar with this material to use the Image Compression Manager.</p>
<p>A compressor component is a code resource that provides image compression or decompression services for image data. These components may also utilize additional hardware to provide their services. Compressor components are registered by the Component Manager, and they present a standard set of function interfaces to the Image Compression Manager. A compressor can be a system-wide resource, or it can be local to a particular application.</p>
<p>Applications never communicate directly with compressors. Applications request compressor services by issuing the appropriate Image Compression Manager functions. The Image Compression Manager then performs its necessary processing before invoking the compressor. Of course, an application could install its own compressor component. However, any interaction between the application and the compressor is still managed by the Image Compression Manager.</p>
<p>The Image Compression Manager knows about two types of compressor components. Components that can compress image data carry a component type (described by the  <code>compressorComponentType</code> data type) of  <code>'imco'</code> and are referred to as <em>compressors.</em> Components that can decompress images have a component type (described by the  <code>decompressorComponentType</code> data type) of  <code>'imdc'</code> and are called <em>decompressors.</em> The value of the component subtype indicates the compression algorithm supported by the component. All compressor components with the same subtype must be able to handle the same format of compressed data. During decompression a component should handle all variations of the data specified for a subtype. Conversely, while compressing an image a compressor must not produce data that decompressors of the same subtype cannot handle during decompression.</p>
<p>The Image Compression Manager defines four callback functions that may be provided to compressors or decompressors by applications. A  <strong>callback</strong> <strong>function</strong> is an application-defined function that is invoked at a specified time or based on specified criteria. These callback functions are data-loading functions, data-unloading functions, completion functions, and progress functions. Data-loading functions and data-unloading functions support spooling of compressed data. Completion functions allow compressors and decompressors to report that asynchronous operations have completed. Progress functions provide a mechanism for compressors and decompressors to report their progress toward completing an operation. For more information about these callback functions, see <span class="content_text"><a href="../F-Chapter/6WorkingwiththeImage.html#//apple_ref/doc/uid/TP40000878-WorkingwiththeImageCompressionManager-ApplicationDefinedFunctions">Application-Defined Functions</a></span>.</p>

<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_9" title="Banding and Extending Images"></a>
<h2><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-BandingandExtendingImages" title="Banding and Extending Images"></a>Banding and Extending Images</h2>
<p>Occasionally a compressor component may not be able to accommodate the destination rectangle for an image decompression or the source for an image-compression operation. This situation may result from compressors that are optimized to work at certain depths or that cannot perform scaling, translation, dithering, or masking during decompression. In such circumstances the Image Compression Manager allocates a temporary buffer that is acceptable to the compressor component and breaks the image up to fit into that new buffer. Since there often is not enough memory to allocate a buffer to hold the entire image, the Image Compression Manager may allocate one that holds a band of the image. A <strong>band</strong> is one horizontal piece of the image. Its height is some portion of the desired image height (before scaling or rotation), and it is at least as wide as the desired image.</p>
<p>The height of the band is determined both by the amount of memory available and the block size of the compressor component. The block size of a compressor is the natural size at which it handles images, and it is peculiar to the image-compression algorithm. The block size for the photo compressor is usually 16 pixels by 16 pixels, for example. Usually the block width and height are equal, but this is not always the case. The minimum height of a band is one strip of blocks. A strip is defined to be a part of an image that is as high as the block height (for the compressor in question) and as wide as the band. The width of a band is either the width of the desired unscaled image, or that width increased by an extension.</p>
<p>Figure&#160;1-1 shows the measurements of several image bands.</p>
<br/><div><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_150" title="Figure 1-1Image bands and their measurements"></a><p><strong>Figure 1-1&nbsp;&nbsp;</strong>Image bands and their measurements</p><img src = "../Art/QT-L-85.gif" alt = "" width="573" height="489"></div><br/>
<p>Some compressors can only handle images with dimensions that are a multiple of their block size. If the desired image does not comply with this restriction in either dimension, the Image Compression Manager extends the band on the right side and bottom by the amount required to meet the needs of the compressor. During compression, the compressor fills the extended region with the same pixel value as the pixels adjacent to the extension. During decompression, the Image Compression Manager writes only the pixels that are part of the source image. The extended portion remains only in the offscreen buffer.</p>

<a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-DontLinkElementID_10" title="Fast Dithering"></a>
<h2><a name="//apple_ref/doc/uid/TP40000878-TheImageCompressionManager-FastDithering" title="Fast Dithering"></a>Fast Dithering</h2>
<p>QuickDraw provides a means of displaying images with high color resolution in pixel maps or on screens with lower color resolution. By dithering the destination image, QuickDraw fools your eyes into seeing colors that are not actually available on the display screen. Unfortunately, the error-diffusion technique used by QuickDraw takes longer than just drawing pixels by directly looking them up in a color table. The drawing delays imposed by standard dithering are unacceptable when working with movies.</p>
<p>To alleviate this problem, Apple has developed a technique that allows faster dithering to destinations that use 8 bits per pixel. Fast dithering uses lookup tables created by the Image Compression Manager. All the decompressors supplied by Apple can use fast dithering.</p>
<p>Apple decompressors use fast dithering when copying from image band buffers to 8-bit destinations. If the accuracy for decompression is above normal, then the decompressors use true error diffusion rather than fast dithering. Note that video sequences are normally displayed at normal or low accuracy so that you can obtain maximum display speed during decompression.</p>




        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../A-Intro/1Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../C-Chapter/3ExtensionstotheImag.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2005, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-01-10<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/RM/CompressDecompress/ImageComprMgr/B-Chapter/2TheImageCompression.html%3Fid%3DTP40000878-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/RM/CompressDecompress/ImageComprMgr/B-Chapter/2TheImageCompression.html%3Fid%3DTP40000878-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/RM/CompressDecompress/ImageComprMgr/B-Chapter/2TheImageCompression.html%3Fid%3DTP40000878-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>