<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>ASPGetParms(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING218></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-217.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-219.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-204.html"><B>Chapter 8 - AppleTalk Session Protocol (ASP)</B></A> / <A HREF="Networking-206.html"><B>ASP Reference</B></A><BR><DL><DD><A HREF="Networking-209.html"><B>Routines</B></A> / <A HREF="Networking-217.html"><B>Obtaining Information About ASP's Maximum Capacities and the Status of the Server</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING218-0></A>
<H3><A NAME=MARKER-9-93></A>ASPGetParms</H3>
 <A NAME=MARKER-11-94></A>The <A NAME=MARKER-2-95></A><CODE>ASPGetParms <A NAME=MARKER-2-96></A></CODE>function returns the maximum size of the data that you can send and receive across an ASP session and the maximum number of concurrent ASP sessions that the .XPP driver running on your node supports. <P>
<PRE>
FUNCTION ASPGetParms (thePBptr: XPPParmBlkPtr;
                      async: Boolean): OSErr;
</PRE>
<DL>
<DT><CODE>thePBptr</CODE>
<DD> A pointer to an XPP parameter block.
<DT><CODE>async</CODE>
<DD> A Boolean that specifies whether the function should be executed asynchronously or synchronously. Specify <CODE>TRUE</CODE> for asynchronous execution.
</DL>
<B>
<TABLE BORDER="0" CELLPADDING=3><TD>--><TD>ioCompletion<TD>ProcPtr<TD>A pointer to a completion routine.<TR>
<TD><--<TD>ioResult<TD>OSErr<TD>The function result.<TR>
<TD>--><TD>ioRefNum<TD>Integer<TD>The .XPP driver reference number.<TR>
<TD>--><TD>csCode<TD>Integer<TD><A NAME=MARKER-13-3></A>Always <A NAME=MARKER-9-33></A>getParms for this function.<TR>
<TD><--<TD>aspMaxCmdSize<TD>Integer<TD>The maximum size of command data.<TR>
<TD><--<TD>aspQuantumSize<TD>Integer<TD>The maximum data size.<TR>
<TD><--<TD>numSesss<TD>Integer<TD>The number of sessions.</TABLE>
</B><P>
<DL>
<H5>Field Description</H5>
<DT><CODE><A NAME=MARKER-2-142></A>aspMaxCmdSize</CODE>
<DD> The maximum size in bytes of a command that you can send to <BR>the server.
<DT><CODE><A NAME=MARKER-2-96></A>aspQuantumSize</CODE>
<DD> The maximum size in bytes of the data that you can either request ASP to transfer to the server in an <CODE>ASPUserWrite</CODE> function call or receive from the server in a command reply.
<DT><CODE><A NAME=MARKER-2-99></A>numSesss</CODE>
<DD> <A NAME=MARKER-2-33></A>The number of concurrent ASP sessions that the .XPP driver supports on your node. 
</DL>
<A NAME=HEADING218-9></A>
<H5>DESCRIPTION</H5>
 The <CODE>ASPGetParms</CODE> function returns information about the data capacity of an ASP session that you need to know to send commands using the <CODE>ASPUserCommand</CODE> and <CODE>ASPUserWrite</CODE> functions and write data using the <CODE>ASPUserWrite</CODE> function. It also <BR>tells you how many concurrent ASP sessions your node supports. You do not need to establish a session before you call the <CODE>ASPGetParms</CODE> function. <A NAME=MARKER-2-26></A><P>
<A NAME=HEADING218-11></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Note that you must provide the .XPP driver reference number as an input parameter <BR>to this function. You can obtain the driver reference number by calling the Device Manager's <CODE>OpenDriver</CODE> function. <P>
<A NAME=HEADING218-13></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 To execute the <CODE>ASPGetParms</CODE> function from assembly language, call the <CODE>_Control</CODE> trap macro with a value of <CODE>getParms</CODE> in the <CODE>csCode</CODE> field of the parameter block. You must also specify the .XPP driver reference number. To execute the <CODE>_Control</CODE> trap asynchro-<BR>nously, include the value <CODE>,ASYNC</CODE> in the operand field.<A NAME=MARKER-2-102></A><P>
<A NAME=HEADING218-15></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error </TABLE>
</H5>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-217.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-219.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
