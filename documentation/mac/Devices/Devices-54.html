<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Introduction to Slots and Cards(IM: D)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING54></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Devices-53.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-55.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Devices-2.html"><B>Devices</B></A> / <BR><DD><A HREF="Devices-53.html"><B>Chapter 2 - Slot Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING54-0></A>
<H1><A NAME=MARKER-9-31></A>Introduction to Slots and Cards</H1>
 <A NAME=MARKER-2-247></A>The Macintosh Operating System provides a standardized interface to expansion cards through the Slot Manager. The Slot Manager supports two types of expansion cards: NuBus and processor-direct slot (PDS). Most Macintosh computers include one or both of these expansion systems. Although the discussion and examples in this chapter use NuBus, the information also applies to PDS expansion cards. <P>
 <B>Processor-direct slot</B> expansion cards connect directly to the processor bus, giving them direct access to the microprocessor and therefore a speed advantage over NuBus cards. However, because the PDS expansion interface is an extension of the processor bus, the configuration of the slot depends on which microprocessor is used by the computer. Refer to <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition,<I> </I>for information specific to PDS expansion cards.<P>
 <A NAME=MARKER-2-248></A>Macintosh computers that include the NuBus expansion interface contain one or more identical NuBus slots. Each slot is identified by slot a number in the range $1 through $E. (Slot $0 corresponds to the main logic board, and slot $F is reserved for NuBus address translation.)<P>
<DL>
<DT><B>Note</B>
<DD>For convenience, this chapter refers to a NuBus configuration with six slots numbered $9 through $E. Keep in mind that Macintosh computers may have more or fewer slots. Refer to the appropriate Macintosh Developer Note or <I>Guide to the Macintosh Family Hardware</I>, second edition, for information about specific models.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 <A NAME=MARKER-9-251></A>In Macintosh computers, the processor bus (which connects the microprocessor to RAM, ROM, and the FPU) and the NuBus (which connects the NuBus slots) are connected by a <B>bus interface</B>, as shown in <A HREF=#MARKER-9-36>Figure 2-1</A>.<A NAME=MARKER-2-35></A><P>
<B>Figure 2-1  <A NAME=MARKER-9-36></A>Simplified processor-bus and NuBus architecture</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SLOT-L-01.jpg"><p>
 <A NAME=MARKER-2-37></A><A NAME=MARKER-2-38></A>Both the processor bus and the NuBus are 4 bytes (32 bits) wide. The bus interface transfers data between the buses in byte lanes. A <B>byte lane</B> is any of the 4 bytes that make up the 32-bit bus. Because the processor bus and the NuBus interpret the significance of bytes within words differently, the bus interface must perform byte-lane swapping between the two buses.<P>
 <A NAME=MARKER-9-212></A>The bus interface also performs some address translation between the two buses. It maps certain address ranges on each bus to different address ranges on the other bus.<I> Designing Cards and Drivers for the Macintosh Family</I>, third edition, discusses byte lanes and address translation in more detail.<A NAME=MARKER-2-256></A><P>
 The next section,<A HREF=#MARKER-9-41>"Slot Address Allocations,"</A> discusses the address ranges assigned by the Macintosh architecture to each NuBus slot.<P>
 The section <A HREF=#MARKER-9-57>"Firmware"</A> on <A HREF=#MARKER-9-57>page 2-7</A> introduces the data structures that cards use to organize information in their firmware.<P>
<A NAME=HEADING54-12></A>
<H2><A NAME=MARKER-9-41></A>Slot Address Allocations</H2>
 <A NAME=MARKER-2-261></A><A NAME=MARKER-2-262></A><A NAME=MARKER-2-263></A><A NAME=MARKER-2-264></A>The Macintosh architecture assigns certain address ranges to each slot. The microprocessor communicates with an expansion card in a particular slot by reading or writing to memory in the slot's address range. Expansion cards can also communicate with each other in this manner. <P>
 The NuBus architecture supports 32-bit addressing, providing 4 gigabytes of address space. All Macintosh computers that use Motorola 68030, 68040, or PowerPC processors support 32-bit addressing under System 7. Macintosh computers that use Motorola 68000 or 68020 processors, and those running System 6, use 24-bit addressing. This section describes address space allocation in both the 32-bit and 24-bit modes.<P>
 In 32-bit mode, the Macintosh architecture assigns two address ranges to each NuBus slot: a 256-m<DFN>egabyte super slot space and a 16-megabyte standard slot space.</DFN><P>
 <A NAME=MARKER-2-364></A><A NAME=MARKER-9-214></A>The 4 gigabytes of 32-bit address space contain 16 regions of 256 megabytes apiece. Each region constitutes the <B>super slot space</B> for one possible slot ID. Each super slot space spans an address range of $s000 0000 through $sFFF FFFF, where <I>s</I> is a hexadecimal digit $1 through $E, corresponding to the slot ID. For example, the address range $9000 0000 through $9FFF FFFF constitutes the super slot space for slot $9.<A NAME=MARKER-2-48></A><A NAME=MARKER-2-49></A><P>
 The <B>standard slot spaces</B> are 16 megabytes apiece and have address ranges of the form $Fs00 0000 through $FsFF FFFF, where <I>s</I> is the slot ID. The standard slot space for slot $9, for example, is $F900 0000 through $F9FF FFFF. <A HREF=#MARKER-9-53>Figure 2-2</A> shows the super slot and standard slot subdivisions of the 32-bit address space.<A NAME=MARKER-2-217></A><P>
 <A NAME=MARKER-2-219></A><A NAME=MARKER-2-52></A>In 24-bit mode, software can address only a fraction of each card's allocated address range. In this mode, the Operating System assigns each slot a 1-megabyte <B>minor slot space</B>. The bus interface translates 24-bit addresses on the processor bus with the form $sx xxxx (where <I>s</I> is a slot ID and <I>x</I> is any hexadecimal digit) into 32-bit NuBus addresses of the form $Fs0x xxxx, which is the first megabyte of the slot's standard slot space.<P>
 For example, 24-bit addresses in the range $90 0000 through $9F FFFF constitute the minor slot space corresponding to slot $9. The hardware translates these addresses into the NuBus address range $F900 0000 through $F90F FFFF.<P>
<B>Figure 2-2  <A NAME=MARKER-9-53></A>The NuBus 32-bit address space</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SLOT-L-02.jpg"><p>
 <A HREF=#MARKER-9-1>Table 2-1</A> shows the address allocations for each slot ID.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-1></A><B>Table 2-1 Slot address allocations by slot ID</B> </CAPTION>
<TH>Slot ID<TH>24-bit minor<BR>slot space (1 MB)<TH>32-bit minor<BR>slot space (1 MB)<TH>Standard slot<BR>space (16 MB)<TH>Super slot<BR>space (256 MB)<TR>
<TD>$1<TD>$1x xxxx<TD>$F10x xxxx<TD>$F1xx xxxx<TD>$1xxx xxxx<TR>
<TD>$2<TD>$2x xxxx<TD>$F20x xxxx<TD>$F2xx xxxx<TD>$2xxx xxxx<TR>
<TD>$3<TD>$3x xxxx<TD>$F30x xxxx<TD>$F3xx xxxx<TD>$3xxx xxxx<TR>
<TD>$4<TD>$4x xxxx<TD>$F40x xxxx<TD>$F4xx xxxx<TD>$4xxx xxxx<TR>
<TD>$5<TD>$5x xxxx<TD>$F50x xxxx<TD>$F5xx xxxx<TD>$5xxx xxxx<TR>
<TD>$6<TD>$6x xxxx<TD>$F60x xxxx<TD>$F6xx xxxx<TD>$6xxx xxxx<TR>
<TD>$7<TD>$7x xxxx<TD>$F70x xxxx<TD>$F7xx xxxx<TD>$7xxx xxxx<TR>
<TD>$8<TD>$8x xxxx<TD>$F80x xxxx<TD>$F8xx xxxx<TD>$8xxx xxxx<TR>
<TD colspan=5>&nbsp;<TR>
<TD>$9<TD>$9x xxxx<TD>$F90x xxxx<TD>$F9xx xxxx<TD>$9xxx xxxx<TR>
<TD>$A<TD>$Ax xxxx<TD>$FA0x xxxx<TD>$FAxx xxxx<TD>$Axxx xxxx<TR>
<TD>$B<TD>$Bx xxxx<TD>$FB0x xxxx<TD>$FBxx xxxx<TD>$Bxxx xxxx<TR>
<TD>$C<TD>$Cx xxxx<TD>$FC0x xxxx<TD>$FCxx xxxx<TD>$Cxxx xxxx<TR>
<TD>$D<TD>$Dx xxxx<TD>$FD0x xxxx<TD>$FDxx xxxx<TD>$Dxxx xxxx<TR>
<TD>$E<TD>$Ex xxxx<TD>$FE0x xxxx<TD>$FExx xxxx<TD>$Exxx xxxx<A NAME=MARKER-2-2></A></TABLE>
<A NAME=MARKER-2-271></A><A NAME=MARKER-2-55></A><A NAME=MARKER-2-272></A><P>
<A NAME=HEADING54-23></A>
<H2><A NAME=MARKER-9-57></A>Firmware</H2>
 <A NAME=MARKER-2-274></A><A NAME=MARKER-2-275></A><A NAME=MARKER-2-276></A><A NAME=MARKER-2-277></A>The firmware of a NuBus expansion card contains information that identifies the card and its functions. Your application uses the Slot Manager to communicate with this firmware. This firmware, called the <B>declaration ROM</B>, may also include other information, such as initialization code or code for drivers that communicate with devices on the card. The sole purpose of many Slot Manager routines is to provide access to the information in the declaration ROM.<P>
 This section discusses the data structures used to store information in the declaration ROM. You'll need to understand these structures in order to use the Slot Manager routines. To create firmware for an expansion card, you'll need to read <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition.<P>
 The declaration ROM includes these elements:<P>
<UL>
<LI>The <B>sResources</B>. An sResource is a data structure in the firmware of an expansion card's declaration ROM that defines a function or capability of the card. An sResource typically contains information about a single function or capability, although some sResources may contain other data--for example, device drivers, icons, fonts, code, or vendor-specific information.<A NAME=MARKER-2-278></A>
<LI><A NAME=MARKER-2-279></A>The <B>sResource directory</B>. The sResource directory is a special sResource that contains offsets to all of the other sResources in the declaration ROM.
<LI><A NAME=MARKER-2-280></A>The <B>format block</B>. The format block is a data structure that allows the Slot Manager to find the declaration ROM and to validate it. It contains some identification information and an offset to the sResource directory.<A NAME=MARKER-2-281></A><P>
</UL>
 The next few sections discuss these data structures in more detail.<P>
<A NAME=HEADING54-31></A>
<H2><A NAME=MARKER-9-66></A>The sResource</H2>
 <DFN><A NAME=MARKER-9-283></A></DFN>An sResource consists of a list of 4-byte entries. The first byte of each entry is an ID field that identifies the type of data contained in the entry. The next 3 bytes contain either data for the sResource or an offset to additional data such as icon definitions, code, or device drivers relating to the sResource. <P>
<DL>
<DT><B>Note</B>
<DD><DFN><A NAME=MARKER-2-284></A>An sResource is sometimes referred to as a <I>slot resource. Note, however, that an sResource is a data structure in the firmware of a NuBus expansion card and not the type of Macintosh resource associated with the Resource Manager (which is described in Inside Macintosh: More Macintosh Toolbox</I></DFN>).<DFN><EM></EM></DFN>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 <DFN><A NAME=MARKER-2-15></A><A NAME=MARKER-2-70></A>The last entry in an sResource must contain an end-of-list marker--a 4-byte series with the value $FF 00 00 00. <A HREF=#MARKER-9-71>Figure 2-3</A></DFN> shows the format of a typical sResource.<P>
<B>Figure 2-3  <A NAME=MARKER-9-71></A>The structure of a typical sResource </B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SLOT-L-04.jpg"><p>
 <DFN>The ID field of each sResource entry indicates the type of information in the offset field of the entry. Apple reserves the range 0 through 127 for common sResource IDs. <I>Designing Cards and Drivers for the Macintosh Family, third edition, includes a complete list of the Apple-defined sResource IDs and their meanings.</I></DFN><P>
 <DFN>The offset field of each entry can contain a byte or word of data, or an offset to a larger block of data. </DFN>This field takes one of three possible forms:<P>
<UL>
<LI>two $00 bytes followed by an 8-bit byte of data
<LI>a single $00 byte followed by a 16-bit word of data
<LI>a signed 24-bit offset to a larger data structure; the offset is relative to <DFN>the address of the preceding ID field</DFN><P>
</UL>
 <A HREF=#MARKER-9-3>Table 2-2</A> lists the kinds of large data types commonly used in sResources.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-3></A><B>Table 2-2 Large data types used in sResources</B></CAPTION>
<TH>Data type<TH>Description<TR>
<TD><CODE>Long</CODE><TD>32 bits, signed or unsigned<TR>
<TD><CODE>Pointer</CODE><TD>32 bits, signed or unsigned<TR>
<TD><CODE>cString</CODE><TD>One-dimensional array of bytes, ending with 0<TR>
<TD><CODE>sBlock</CODE><TD>A sized block of data (see <A HREF=#MARKER-9-73>Figure 2-4</A>)<TR>
<TD><CODE>sExecBlock</CODE><TD>A sized block of code (see <A HREF=#MARKER-9-73>Figure 2-4</A>)</TABLE>
<A NAME=MARKER-2-293></A><P>
 The <CODE>sBlock</CODE> and <CODE>sExecBlock</CODE> data structures begin with a <CODE>size</CODE> field, which contains the physical size of the block (including the <CODE>size</CODE> field). In the <CODE>sBlock</CODE> structure, the <CODE>size</CODE> field is followed by data. The <CODE>sExecBlock</CODE> structure includes additional fields and a code block. <A HREF=#MARKER-9-73>Figure 2-4</A> shows these structures.<P>
<B>Figure 2-4  <A NAME=MARKER-9-73></A>The format of the <CODE>sBlock</CODE> and <CODE>sExecBlock</CODE> data structures</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SLOT-L-05.jpg"><p>
<A NAME=HEADING54-46></A>
<H3>Type and Name Entries</H3>
 As shown in <A HREF=#MARKER-9-71>Figure 2-3</A>, the Slot Manager requires that each sResource contain an <CODE>sRsrcType</CODE> entry, which identifies the sResource type, and an <CODE>sRsrcName</CODE> entry, which provides the sResource name.<P>
 <A NAME=MARKER-2-74></A>The <CODE>sRsrcType</CODE> entry contains an ID value of 1 and an offset to an <CODE>sRsrcType</CODE> entry. <A HREF=#MARKER-9-75>Figure 2-5</A> shows the format of an <CODE>sRsrcType</CODE> entry.<P>
<B>Figure 2-5  <A NAME=MARKER-9-75></A>The <CODE>sRsrcType</CODE> entry format</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SLOT-L-06.jpg"><p>
 
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Field<TH>Description<TR>
<TD><CODE>Category</CODE><TD>The most general classification of card functions. Examples of categories are <CODE>catDisplay</CODE> and <CODE>catNetwork</CODE>.<A NAME=MARKER-4-10></A><TR>
<TD><CODE>cType</CODE><TD>The subclass of the category. For example, within the <CODE>catDisplay</CODE> category there is a <CODE>typeVideo</CODE> subcategory; within the <CODE>catNetwork</CODE> category, there is a <CODE>typeEtherNet</CODE> subcategory.<A NAME=MARKER-4-11></A><TR>
<TD><CODE>DrSW</CODE><TD>The driver software interface to the card. (This provides the calling interface for applications and system software.) For example, under the <CODE>catDisplay</CODE> category and the <CODE>typeVideo</CODE> subcategory, there is a <CODE>drSwApple</CODE> software interface that indicates the Apple-defined interface to work with QuickDraw using Macintosh Operating System frame buffers.<A NAME=MARKER-4-12></A><TR>
<TD><CODE>DrHW</CODE><TD>The identification of the specific hardware device associated with the driver software interface. Generally, only the driver interacts with the hardware specified here.<A NAME=MARKER-4-13></A></TABLE>
The fields of the <CODE>sRsrcType</CODE> entry are as follows:<P>
 Every card has a unique <CODE>sRsrcType</CODE> entry that must be assigned by Apple Computer, Inc. If you are developing a card, refer to <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition, for information on obtaining an <CODE>sRsrcType</CODE> entry.<P>
 <A NAME=MARKER-2-76></A>The <CODE>sRsrcName</CODE> entry in an sResource contains an ID value of 2 and an offset to a <CODE>cString</CODE> data structure containing the sResource name. By convention, the <CODE>sRsrcName</CODE> field is derived by stripping the prefixes from the <CODE>sRsrcType</CODE> values and separating the fields by underscores. For example, the <CODE>sRsrcName</CODE> field for an sResource whose <CODE>sRsrcType</CODE> values are <CODE>catDisplay</CODE>, <CODE>typeVideo</CODE>, <CODE>DrSwApple</CODE>, and <CODE>DrHwTFB</CODE> becomes <CODE>'Display_Video_Apple_TFB'</CODE>.<A NAME=MARKER-2-301></A><P>
 <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition, provides information about these and other sResource entry types.<A NAME=MARKER-2-302></A><P>
<A NAME=HEADING54-55></A>
<H3>The Board sResource and Functional sResources</H3>
 <A NAME=MARKER-2-303></A><A NAME=MARKER-2-304></A><A NAME=MARKER-2-305></A><DFN>Every card must have a single <B>board sResource that contains information about the card as a whole. An sResource relating to a specific function is called a functional sResource</B></DFN>,<DFN> and a card may have as many of them as necessary. For example, a video card may have separate functional sResources for every pixel depth it supports. (See <A HREF=#MARKER-9-104>Figure 2-8 on page 2-14</A> for an example of a functional sResources for a video card, and see <I>Designing Cards and Drivers for the Macintosh Family</I></DFN>, third edition,<DFN> for additional examples that include code listings.)</DFN><P>
 The entries in the board sResource provide the Slot Manager with a card's identification number, vendor information, board flags, and initialization code. Like all sResources, the board sResource must include an <CODE>sRsrcType</CODE> entry and an <CODE>sRsrcName</CODE> entry. The board <CODE>sRsrcType</CODE> entry must contain the constants <CODE>CatBoard</CODE> ($0001), <CODE>TypBoard</CODE> ($0000), <CODE>DrSWBoard</CODE> ($0000), and <CODE>DrHWBoard</CODE> ($0000). The <CODE>sRsrcName</CODE> entry for the board sResource name does not follow the same convention as other sResources: the <CODE>sRsrcName</CODE> entry for the board sResource contains the name of the entire card (for example, <CODE>'Macintosh Display Card'</CODE>).<A NAME=MARKER-4-82></A><P>
 The board sResource must also contain a <CODE>BoardId</CODE> entry, a word that contains the card design identification number assigned by Apple Computer, Inc. <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition, describes other Apple-defined entries specifically for board sResources.<P>
 <A HREF=#MARKER-9-85>Figure 2-6</A> shows a sample board sResource. It shows an <CODE>sRsrcType</CODE> entry and an <CODE>sRsrcName</CODE> entry and also includes three entry types, <CODE>BoardID</CODE>, <CODE>PRAMInitData</CODE>, and <CODE>PrimaryInit</CODE>, which are discussed in <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition.<A NAME=MARKER-2-313></A><A NAME=MARKER-2-314></A><P>
<B>Figure 2-6  <A NAME=MARKER-9-85></A>A sample board sResource<A NAME=MARKER-2-317></A><A NAME=MARKER-2-87></A><A NAME=MARKER-2-201></A><DFN><A NAME=MARKER-2-89></A><A NAME=MARKER-9-318></A></DFN></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SLOT-L-07.jpg"><p>
<A NAME=HEADING54-62></A>
<H3><A NAME=MARKER-9-91></A>The sResource Directory</H3>
 <DFN><A NAME=MARKER-2-320></A>The sResource directory lists all the sResources in the declaration ROM and provides an offset to each one. </DFN>The sResource directory has the same structure as an sResource--that is, an sResource directory consists of a series of 4-byte entries, where the first byte is an ID field and the next 3 bytes contain an offset to additional data. <A HREF=#MARKER-9-93>Figure 2-7</A> shows the format of the sResource directory.<P>
<B>Figure 2-7  The structure of the <A NAME=MARKER-9-93></A>sResource directory </B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SLOT-L-03.jpg"><p>
 The sResource ID field of an entry in the sResource directory always identifies an sResource on the card. Each sResource in the card firmware requires a unique ID defined by the card designer, and the ID must be in the range 1 through 254. For example, an entry for the board sResource must appear first in a card's sResource directory, so card designers typically assign an sResource ID value of 1 to the board sResource. The sResource ID numbers must appear in the sResource directory in ascending order. An sResource directory must conclude with the end-of-list marker ($FF 00 00 00).<A NAME=MARKER-2-94></A><P>
 <DFN>The offset field of each entry contains a signed 24-bit offset to the sResource corresponding to the sResource ID field. The offset value counts only those bytes accessible by valid byte lanes, and is relative to the address of the sResource ID field.</DFN><A NAME=MARKER-2-95></A><P>
<A NAME=HEADING54-68></A>
<H2><A NAME=MARKER-9-96></A>The Format Block</H2>
 <A NAME=MARKER-2-322></A>The format block always resides at the highest address in the standard slot space of a declaration ROM. At startup, the Slot Manager locates installed cards by searching each slot space for a valid format block. The format block contains information about the declaration ROM and an offset to the sResource directory. The Slot Manager uses the format block to validate the declaration ROM and locate the sResources.<P>
 <A NAME=MARKER-2-323></A>The format block also contains a value that specifies which of the four byte lanes are occupied by the declaration ROM. These byte lanes are called the <I>valid byte lanes.</I> Some declaration ROMs do not appear on all four byte lanes, so software cannot read meaningful data at every memory location in the address space for the byte lanes.<A NAME=MARKER-2-99></A><P>
<DL>
<DT><B>IMPORTANT</B>
<DD><A NAME=MARKER-2-100></A>The format block defines which byte lanes are valid for the declaration ROM only. The valid byte lanes are determined by card design, and may be different for other memory-mapped devices on the card.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition, defines the structure of the format block and gives examples of how the valid byte lanes affect communication with a declaration ROM.<P>
 <A HREF=Devices-55.html#MARKER-9-108></A><A HREF=#MARKER-9-104>Figure 2-8</A> illustrates the relationship of the format block, the sResource directory, and the sResources for a sample video card. For every entry in the sResource directory and in the sResources, its ID number is shown on the left side of the entry. As shown in this figure, the board sResource is the first sResource listed in the sResource directory. Each functional sResource that follows in turns defines a display capability provided by the card. (To simplify this figure, only one complete functional sResource is shown.)<A NAME=MARKER-2-101></A><A NAME=MARKER-2-102></A><A NAME=MARKER-2-103></A><P>
<B>Figure 2-8  <A NAME=MARKER-9-104></A>The format block and sResources for a sample video card<A NAME=MARKER-2-328></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SLOT-L-08.jpg"><p>
<HR>
<B>Subtopics</B>
<B><!-- TOC --><DL>
<DT><A HREF="Devices-54.html#HEADING54-12">Slot Address Allocations</A>
<DD>
<DT><A HREF="Devices-54.html#HEADING54-23">Firmware</A>
<DD>
<DT><A HREF="Devices-54.html#HEADING54-31">The sResource</A>
<DD>
<DT><A HREF="Devices-54.html#HEADING54-46">Type and Name Entries</A>
<DD>
<DT><A HREF="Devices-54.html#HEADING54-55">The Board sResource and Functional sResources</A>
<DD>
<DT><A HREF="Devices-54.html#HEADING54-62">The sResource Directory</A>
<DD>
<DT><A HREF="Devices-54.html#HEADING54-68">The Format Block</A>
<DD>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Devices-53.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Devices-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Devices-328.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Devices-55.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Devices-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  

