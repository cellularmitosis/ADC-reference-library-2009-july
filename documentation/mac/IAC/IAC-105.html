<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Sending an Apple Event and Handling the Reply(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING105></A>


<!-- Top of Header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- Bottom of Header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-104.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-106.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-94.html"><B>Chapter 3 - Introduction to Apple Events</B></A> / <A HREF="IAC-102.html"><B>Creating and Sending Apple Events</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING105-0></A>
<H2><A NAME=MARKER-9-230></A>Sending an Apple Event and Handling the Reply</H2>
 After you add all the attributes and parameters required for the Apple event, use the <CODE>AESend</CODE> function to send the Apple event. The Apple Event Manager uses the Event Manager to transmit the Apple event to the server application.<P>
 The <CODE>AESend</CODE> function requires that you specify whether your application should wait for a reply from the server. If you specify that you want a reply, the Apple Event Manager prepares a reply Apple event for your application by passing a default reply Apple event to the server. The Apple Event Manager returns any nonzero result code from the server's handler in the <CODE>keyErrorNumber</CODE> parameter of the reply Apple event. The server can return an error string in the <CODE>keyErrorString</CODE> parameter of the reply Apple event. The server can also use the reply Apple event to return any data you requested--for example, the results of a numeric calculation or a list of misspelled words.<P>
 You specify how your application should wait for a reply by using one of these flags in the <CODE>sendMode</CODE> parameter of the <CODE>AESend</CODE> function:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Flag<TH>Description<TR>
<TD>kAENoReply<TD>Your application does not want a reply Apple event.<TR>
<TD>kAEQueueReply<TD>Your application wants a reply Apple event; the reply appears in your event queue as soon as the server has the opportunity to process and respond to your Apple event.<TR>
<TD>kAEWaitReply<TD>Your application wants a reply Apple event and is willing to give up the processor while waiting for the reply; for example, if the server application is on the same computer as your application, your application yields the processor to allow the server to respond to your Apple event.</TABLE>
<P>
 If you specify the <CODE>kAEWaitReply</CODE> flag, you should provide an idle function. This function should process any non-high-level events that occur while your application is waiting for a reply. You supply a pointer to your idle function as a parameter to the <CODE>AESend</CODE> function. So that your application can process other Apple events while it is waiting for a reply, you can also specify an optional filter function to the <CODE>AESend</CODE> function.<P>
 If you specify the <CODE>kAENoReply</CODE> flag, the reply Apple event prepared by the Apple Event Manager for the server application consists of a null descriptor record.<P>
 If your Apple event may require the user to interact with the server application (for example, to specify print or file options), you can communicate your user interaction preferences to the server by specifying additional flags in the <CODE>sendMode</CODE> parameter of the <CODE>AESend</CODE> function. These flags specify the conditions, if any, under which the server application can interact with the user and, if interaction is allowed, whether the server should come directly to the foreground or post a notification request.<P>
 The server application specifies its own preferences for user interaction by specifying flags to the <CODE>AESetInteractionAllowed</CODE> function, as described in the previous section. The interaction of the client and server applications' preferences is explained in detail in <A HREF=IAC-126.html#MARKER-9-408>"Interacting With the User,"</A> which begins on <A HREF=IAC-126.html#MARKER-9-408>page 4-45</A>.<P>
 After you send an Apple event, your application is responsible for disposing of the Apple event record--and thereby deallocating the memory its data uses--by calling the <CODE>AEDisposeDesc</CODE> function. If you create one descriptor record and add it to another, the Apple Event Manager adds a copy of the newly created one to the existing one and also makes a copy of the associated data. For example, you might use the <CODE>AECreateDesc</CODE> function to create a descriptor record that you wish to add to an Apple event. When you use the <CODE>AEPutParamDesc</CODE> function, it adds a copy of your newly created descriptor record, including its data, as a parameter to an existing Apple event. When you no longer need the original descriptor record, you should call <CODE>AEDisposeDesc</CODE> to dispose of it.<P>
 Your application should dispose of all the descriptor records that are created for the purposes of adding parameters and attributes to an Apple event. You normally dispose of your Apple event and its reply after you receive a result from the <CODE>AESend</CODE> function. You should dispose of these even if <CODE>AESend</CODE> returns an error result. <P>
 If you specify the <CODE>kAEWaitReply</CODE> flag, the reply Apple event is returned in a parameter you pass to the <CODE>AESend</CODE> function. If you specify the <CODE>kAEQueueReply</CODE> flag to the <CODE>AESend</CODE> function, the reply Apple event is returned in the event queue. In this case, the reply is identified by the event class <CODE>kCoreEventClass</CODE> and the event ID <CODE>kAEAnswer</CODE>. Your application processes reply events in its event queue in the same way that server applications process Apple events. <P>
 Your application should check for the existence of the <CODE>keyErrorNumber</CODE> parameter of the reply Apple event to ensure that the server performed the requested action. The server can also return, in the <CODE>keyErrorString</CODE> parameter, any error messages you need to display to the user.<P>
 Whenever a server application provides an error string, it should also provide an error number. However, you can't count on all server applications to do so. The absence of the <CODE>keyErrorNumber</CODE> parameter doesn't necessarily mean that there won't an error string provided in the <CODE>keyErrorString</CODE> parameter. A client application should therefore check for both the <CODE>keyErrorNumber</CODE> and <CODE>keyErrorString</CODE> parameters before assuming that no error has occurred. If a string has been provided without an error number, an error has occurred. <P>
 After extracting the information it needs from the reply event, your handler should dispose of the reply by calling the <CODE>AEDisposeDesc</CODE> function. Similarly, when your handler no longer needs descriptor records it has extracted from the reply, it should call <CODE>AEDisposeDesc</CODE> to dispose of them.<P>
 The next section provides an overview of the way a source application identifies Apple event objects supported by a target application. If you are starting by supporting only the Required suite and the Apple events sent by the Edition Manager, you can skip the next section and go directly to <A HREF=IAC-110.html#MARKER-9-279>"About the Apple Event Manager,"</A> which begins on <A HREF=IAC-110.html#MARKER-9-279>page 3-40</A>. <A NAME=MARKER-2-400></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-104.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-106.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
