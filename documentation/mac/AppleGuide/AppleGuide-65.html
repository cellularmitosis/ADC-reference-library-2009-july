<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>AGFileGetIndDB</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING65></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="AppleGuide-64.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="AppleGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="AppleGuide-240.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="AppleGuide-66.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="AppleGuide-2.html"><B>Apple Guide Complete</B></A> / <A HREF="AppleGuide-55.html"><B>Part 3 - Integrating Guide Files</B></A><BR><DD><A HREF="AppleGuide-56.html"><B>Chapter 9 - Apple Guide API</B></A> / <A HREF="AppleGuide-62.html"><B>Determining Which Guide Files Are Available</B></A><BR><DL><DD> / </DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING65-0></A>
<H3><A NAME=MARKER-9-32></A>AGFileGetIndDB</H3>
 <A NAME=MARKER-2-33></A>Use the <CODE>AGFileGetIndDB</CODE> function to obtain the file system specification record of a guide file located in a specified folder.<P>
<PRE>
OSErr AGFileGetIndDB
                     (short vRefNum, long dirID,
                      AGFileDType databaseType,
                      Boolean wantMixin,
                      short dbIndex, FSSpecType *fileSpec);
</PRE>
<DL>
<DT><CODE>vRefNum</CODE>
<DD> The volume reference number of the volume on which the guide file is located.
<DT><CODE>dirID</CODE>
<DD> The directory ID of the directory where the guide file is located.
<DT><CODE>databaseType</CODE>
<DD> The guide file type. Use these constants to specify the type of guide file:
</DL>
<PRE>
           enum {
            kAGFileDBTypeAny        = 0,/*any guide file*/
            kAGFileDBTypeHelp       = 1,/*Help*/
            kAGFileDBTypeTutorial   = 2,/*Tutorial*/
            kAGFileDBTypeShortcuts  = 3,/*Shortcuts*/
            kAGFileDBTypeAbout      = 4,/*About*/
            kAGFileDBTypeOther      = 8 /*Other*/
           };
</PRE>
<DL>
<DT><CODE>wantMixin</CODE>
<DD> A flag. Specify <CODE>TRUE</CODE> if the desired guide file is a Mixin guide file. Specify <CODE>FALSE</CODE> if the guide file is not a Mixin guide file.
<DT><CODE>dbIndex</CODE>
<DD> A number representing the guide file index. To access the first guide file of the specified type in the folder, set this parameter to 1. To access the second guide file of this type, specify 2, and so on.
<DT>fileSpe<CODE>c</CODE>
<DD> A pointer to a file system specification record. On return, this parameter refers to the file system specification record for the guide file.
</DL>
<A NAME=HEADING65-10></A>
<H5>DESCRIPTION</H5>
 The <CODE>AGFileGetIndDB</CODE> function returns, through its <CODE>fileSpec</CODE> parameter, the file system specification record for the specified guide file. You can call <CODE>AGFileGetIndDB</CODE> repetitively to access the file system specification record for all of the guide files in a folder. To access all of the guide files, increment the <CODE>dbIndex</CODE> parameter by 1, until the value of the <CODE>dbIndex</CODE> parameter is equal to the number of guide files of the requested type in the folder, or until the function result is nonzero.<A NAME=MARKER-2-34></A><P>
<A NAME=HEADING65-12></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>dirNFErr<TD>-12<TD>Directory not found or incomplete pathname<TR>
<TD>nsvErr<TD>-35<TD>Volume doesn't exist</TABLE>
</H5>
<A NAME=HEADING65-13></A>
<H5>SEE ALSO</H5>
 After obtaining a guide file's file system specification record, you can get information about the guide file by using the functions described in <A HREF=AppleGuide-77.html#MARKER-9-50>"Getting Information About Guide Files"</A> beginning on <A HREF=AppleGuide-77.html#MARKER-9-50>page 9-22</A>. You can also open a guide file, as described next.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="AppleGuide-64.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="AppleGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="AppleGuide-240.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="AppleGuide-66.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="AppleGuide-3.html">&copy; Apple Computer, Inc.</A><br>12 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
