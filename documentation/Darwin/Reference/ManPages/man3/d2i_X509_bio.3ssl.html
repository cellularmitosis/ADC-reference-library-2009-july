<html><head><title>Mac OS X Developer Tools
 Manual Page For d2i_X509_bio(3ssl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3ssl/d2i_X509_bio" title="Mac OS X Developer Tools
 Manual Page for d2i_X509_bio(3ssl)"><a name="//apple_ref/doc/man/3/d2i_X509_bio" title="Mac OS X Developer Tools
 Manual Page for d2i_X509_bio(3ssl)"><!-- headerDoc=man; indexgroup=Section 3ssl; uid="//apple_ref/doc/man/3ssl/d2i_X509_bio"; name=d2i_X509_bio(3ssl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
d2i_X509(3)                                        OpenSSL                                       <a href="d2i_X509.3ssl.html#//apple_ref/doc/man/3/d2i_X509">d2i_X509(3)</a>



<b>NAME</b>
       d2i_X509, i2d_X509, d2i_X509_bio, d2i_X509_fp, i2d_X509_bio, i2d_X509_fp - X509 encode and decode
       functions

<b>SYNOPSIS</b>
        #include &lt;openssl/x509.h&gt;

        X509 *d2i_X509(X509 **px, unsigned char **in, int len);
        int i2d_X509(X509 *x, unsigned char **out);

        X509 *d2i_X509_bio(BIO *bp, X509 **x);
        X509 *d2i_X509_fp(FILE *fp, X509 **x);

        int i2d_X509_bio(X509 *x, BIO *bp);
        int i2d_X509_fp(X509 *x, FILE *fp);

<b>DESCRIPTION</b>
       The X509 encode and decode routines encode and parse an <b>X509</b> structure, which represents an X509
       certificate.

       <u>d2i</u><b>_</b><u>X509()</u> attempts to decode <b>len</b> bytes at <b>*out</b>. If successful a pointer to the <b>X509</b> structure is
       returned. If an error occurred then <b>NULL</b> is returned. If <b>px</b> is not <b>NULL</b> then the returned structure
       is written to <b>*px</b>. If <b>*px</b> is not <b>NULL</b> then it is assumed that <b>*px</b> contains a valid <b>X509</b> structure and
       an attempt is made to reuse it. If the call is successful <b>*out</b> is incremented to the byte following
       the parsed data.

       <u>i2d</u><b>_</b><u>X509()</u> encodes the structure pointed to by <b>x</b> into DER format.  If <b>out</b> is not <b>NULL</b> is writes the
       DER encoded data to the buffer at <b>*out</b>, and increments it to point after the data just written.  If
       the return value is negative an error occurred, otherwise it returns the length of the encoded data.

       For OpenSSL 0.9.7 and later if <b>*out</b> is <b>NULL</b> memory will be allocated for a buffer and the encoded
       data written to it. In this case <b>*out</b> is not incremented and it points to the start of the data just
       written.

       <u>d2i</u><b>_</b><u>X509</u><b>_</b><u>bio()</u> is similar to <u>d2i</u><b>_</b><u>X509()</u> except it attempts to parse data from BIO <b>bp</b>.

       <u>d2i</u><b>_</b><u>X509</u><b>_</b><u>fp()</u> is similar to <u>d2i</u><b>_</b><u>X509()</u> except it attempts to parse data from FILE pointer <b>fp</b>.

       <u>i2d</u><b>_</b><u>X509</u><b>_</b><u>bio()</u> is similar to <u>i2d</u><b>_</b><u>X509()</u> except it writes the encoding of the structure <b>x</b> to BIO <b>bp</b>
       and it returns 1 for success and 0 for failure.

       <u>i2d</u><b>_</b><u>X509</u><b>_</b><u>fp()</u> is similar to <u>i2d</u><b>_</b><u>X509()</u> except it writes the encoding of the structure <b>x</b> to BIO <b>bp</b> and
       it returns 1 for success and 0 for failure.

<b>NOTES</b>
       The letters <b>i</b> and <b>d</b> in for example <b>i2d_X509</b> stand for "internal" (that is an internal C structure)
       and "DER". So that <b>i2d_X509</b> converts from internal to DER.

       The functions can also understand <b>BER</b> forms.

       The actual X509 structure passed to <u>i2d</u><b>_</b><u>X509()</u> must be a valid populated <b>X509</b> structure it can <b>not</b>
       simply be fed with an empty structure such as that returned by <u>X509</u><b>_</b><u>new()</u>.

       The encoded data is in binary form and may contain embedded zeroes.  Therefore any FILE pointers or
       BIOs should be opened in binary mode.  Functions such as <u></u><b><u>s</u></b><u></u><b><u>r</u></b><u></u><b><u>e</u></b><u></u><b><u>(</u></b> will <b>not</b> return the correct length
       of the encoded structure.

       The ways that <b>*in</b> and <b>*out</b> are incremented after the operation can trap the unwary. See the <b>WARNINGS</b>
       section for some common errors.

       The reason for the auto increment behaviour is to reflect a typical usage of ASN1 functions: after
       one structure is encoded or decoded another will processed after it.

<b>EXAMPLES</b>
       Allocate and encode the DER encoding of an X509 structure:

        int len;
        unsigned char *buf, *p;

        len = i2d_X509(x, NULL);

        buf = OPENSSL_malloc(len);

        if (buf == NULL)
               /* error */

        p = buf;

        i2d_X509(x, &amp;p);

       If you are using OpenSSL 0.9.7 or later then this can be simplified to:

        int len;
        unsigned char *buf;

        buf = NULL;

        len = i2d_X509(x, &amp;buf);

        if (len &lt; 0)
               /* error */

       Attempt to decode a buffer:

        X509 *x;

        unsigned char *buf, *p;

        int len;

        /* Something to setup buf and len */

        p = buf;

        x = d2i_X509(NULL, &amp;p, len);

        if (x == NULL)
           /* Some error */

       Alternative technique:

        X509 *x;

        unsigned char *buf, *p;

        int len;

        /* Something to setup buf and len */

        p = buf;

        x = NULL;

        if(!d2i_X509(&amp;x, &amp;p, len))
           /* Some error */

<b>WARNINGS</b>
       The use of temporary variable is mandatory. A common mistake is to attempt to use a buffer directly
       as follows:

        int len;
        unsigned char *buf;

        len = i2d_X509(x, NULL);

        buf = OPENSSL_malloc(len);

        if (buf == NULL)
               /* error */

        i2d_X509(x, &amp;buf);

        /* Other stuff ... */

        OPENSSL_free(buf);

       This code will result in <b>buf</b> apparently containing garbage because it was incremented after the call
       to point after the data just written.  Also <b>buf</b> will no longer contain the pointer allocated by
       <u></u><b><u>O</u></b><u></u><b><u>E</u></b><u></u><b><u>S</u></b><u></u><b><u>L</u></b><b>_</b><u></u><b><u>m</u></b><u></u><b><u>l</u></b><u></u><b><u>o</u></b><u></u><b><u>(</u></b> and the subsequent call to <u></u><b><u>O</u></b><u></u><b><u>E</u></b><u></u><b><u>S</u></b><u></u><b><u>L</u></b><b>_</b><u></u><b><u>f</u></b><u></u><b><u>e</u></b><u></u><b><u>(</u></b> may well crash.

       The auto allocation feature (setting buf to NULL) only works on OpenSSL 0.9.7 and later. Attempts to
       use it on earlier versions will typically cause a segmentation violation.

       Another trap to avoid is misuse of the <b>xp</b> argument to <u></u><b><u>d</u></b><u></u><b><u>i</u></b><b>_</b><u></u><b><u>X</u></b><u></u><b><u>0</u></b><u></u><b><u>(</u></b>:

        X509 *x;

        if (!d2i_X509(&amp;x, &amp;p, len))
               /* Some error */

       This will probably crash somewhere in <u></u><b><u>d</u></b><u></u><b><u>i</u></b><b>_</b><u></u><b><u>X</u></b><u></u><b><u>0</u></b><u></u><b><u>(</u></b>. The reason for this is that the variable <b>x</b> is
       uninitialized and an attempt will be made to interpret its (invalid) value as an <b>X509</b> structure,
       typically causing a segmentation violation. If <b>x</b> is set to NULL first then this will not happen.

<b>BUGS</b>
       In some versions of OpenSSL the "reuse" behaviour of <u>d2i</u><b>_</b><u>X509()</u> when <b>*px</b> is valid is broken and some
       parts of the reused structure may persist if they are not present in the new one. As a result the use
       of this "reuse" behaviour is strongly discouraged.

       <u>i2d</u><b>_</b><u>X509()</u> will not return an error in many versions of OpenSSL, if mandatory fields are not
       initialized due to a programming error then the encoded structure may contain invalid data or omit
       the fields entirely and will not be parsed by <u>d2i</u><b>_</b><u>X509()</u>. This may be fixed in future so code should
       not assume that <u>i2d</u><b>_</b><u>X509()</u> will always succeed.

<b>RETURN</b> <b>VALUES</b>
       <u>d2i</u><b>_</b><u>X509()</u>, <u>d2i</u><b>_</b><u>X509</u><b>_</b><u>bio()</u> and <u>d2i</u><b>_</b><u>X509</u><b>_</b><u>fp()</u> return a valid <b>X509</b> structure or <b>NULL</b> if an error
       occurs. The error code that can be obtained by <a href="ERR_get_error.3ssl.html#//apple_ref/doc/man/3/ERR_get_error"><u>ERR</u><b>_</b><u>get</u><b>_</b><u>error</u>(3)</a>.

       <u>i2d</u><b>_</b><u>X509()</u>, <u>i2d</u><b>_</b><u>X509</u><b>_</b><u>bio()</u> and <u>i2d</u><b>_</b><u>X509</u><b>_</b><u>fp()</u> return a the number of bytes successfully encoded or a
       negative value if an error occurs. The error code can be obtained by <a href="ERR_get_error.3ssl.html#//apple_ref/doc/man/3/ERR_get_error"><u>ERR</u><b>_</b><u>get</u><b>_</b><u>error</u>(3)</a>.

       <u>i2d</u><b>_</b><u>X509</u><b>_</b><u>bio()</u> and <u>i2d</u><b>_</b><u>X509</u><b>_</b><u>fp()</u> returns 1 for success and 0 if an error occurs The error code can be
       obtained by <a href="ERR_get_error.3ssl.html#//apple_ref/doc/man/3/ERR_get_error"><u>ERR</u><b>_</b><u>get</u><b>_</b><u>error</u>(3)</a>.

<b>SEE</b> <b>ALSO</b>
       <a href="ERR_get_error.3ssl.html#//apple_ref/doc/man/3/ERR_get_error"><u>ERR</u><b>_</b><u>get</u><b>_</b><u>error</u>(3)</a>

<b>HISTORY</b>
       d2i_X509, i2d_X509, d2i_X509_bio, d2i_X509_fp, i2d_X509_bio and i2d_X509_fp are available in all
       versions of SSLeay and OpenSSL.



0.9.7l                                           2002-11-14                                      <a href="d2i_X509.3ssl.html#//apple_ref/doc/man/3/d2i_X509">d2i_X509(3)</a>
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/d2i_X509_bio.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/d2i_X509_bio.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/d2i_X509_bio.3ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
