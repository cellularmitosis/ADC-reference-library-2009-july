<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating a List (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING210></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-209.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-211.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-202.html"><B>Chapter 4 - List Manager</B></A> / <A HREF="MoreToolbox-209.html"><B>Using the List Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING210-0></A>
<H2>Creating a List<A NAME=MARKER-2-57></A></H2>
 To create a list, you can use the <CODE>LNew</CODE> function. <A HREF=#MARKER-9-138>Listing 4-1</A> shows a typical use of the <CODE>LNew</CODE> function to create a vertically scrolling list in a rectangular space in a window.<P>
<B>Listing 4-1  <A NAME=MARKER-9-138></A>Creating a list with a vertical scroll bar<A NAME=MARKER-2-139></A></B><P>
<PRE>
FUNCTION MyCreateVerticallyScrollingList 
                  (myWindow: WindowPtr; myRect: Rect;
                   columnsInList: Integer; 
                   myLDEF: Integer): ListHandle;
CONST
   kDoDraw              = TRUE;  {always draw list after changes}
   kNoGrow              = FALSE; {don't leave room for size box}
   kIncludeScrollBar    = TRUE;  {leave room for scroll bar}
   kScrollBarWidth      = 15;    {width of vertical scroll bar}
VAR
   myDataBounds:        Rect;    {initial dimensions of the list}
   myCellSize:          Point;   {size of each cell in list}
BEGIN
   {specify dimensions of the list}
   {start with a list that contains no rows}
   SetRect(myDataBounds, 0, 0, columnsInList, 0);

   {let the List Manager calculate the size of a cell}
   SetPt(myCellSize, 0, 0);

   {adjust the rectangle to leave room for the scroll bar}
   myRect.right := myRect.right - kScrollBarWidth;

   {create the list}
   MyCreateVerticallyScrollingList := 
      LNew(myRect, myDataBounds, myCellSize, myLDEF, myWindow,
           kDoDraw, kNoGrow, NOT kIncludeScrollBar,
           kIncludeScrollBar);
END;
</PRE>
 The <CODE>LNew</CODE> function called in the last line of <A HREF=#MARKER-9-138>Listing 4-1</A> takes a number of parameters that let you specify the characteristics of the list you wish to create.<P>
 The first parameter to <CODE>LNew</CODE> sets the rectangle for the list's visible rectangle, specified in local coordinates of the window specified in the fifth parameter to <CODE>LNew</CODE>. Because this rectangular area does not include room for scroll bars, the <CODE>MyCreateVerticallyScrollingList</CODE> function adjusts the right of this rectangle to leave enough room.<P>
 The second parameter to <CODE>LNew</CODE> specifies the data bounds of the list. By setting the <CODE>topLeft</CODE> field of this rectangle to (0,0), you can use the <CODE>botRight</CODE> field to specify the number of columns and rows you want in the list. The <CODE>MyCreateVerticallyScrollingList</CODE> function initially creates a list of no rows. While your application is free to preallocate rows when creating a list, it is often easier to only preallocate columns and then add rows after creating the list, as described in the next section.<A NAME=MARKER-2-43></A><P>
 The third parameter is the size of a cell. By setting this parameter to (0,0), you let the List Manager compute the size automatically. The algorithm the List Manager uses to compute this size is given in the discussion of the <CODE>cellSize</CODE> field of the list record in <A HREF=MoreToolbox-208.html#MARKER-9-99>"About the List Manager" beginning on page 4-13</A>.<A NAME=MARKER-2-215></A><P>
 To specify that you wish to use the default list definition procedure, pass 0 as the fourth parameter to <CODE>LNew</CODE>. To use a custom list definition procedure, pass the resource ID of the list definition procedure. Note that the code for the appropriate list definition procedure is loaded into your application's heap; the code for the default list definition procedure is about 150 bytes in size.<P>
 In the sixth parameter to <CODE>LNew</CODE>, your application can specify whether the List Manager should initially enable the automatic drawing mode. When this mode is enabled, the List Manager always redraws the list after changes. Usually, your application should set this parameter to <CODE>TRUE</CODE>. This does not preclude your application from temporarily disabling the automatic drawing mode.<P>
 The last three parameters to <CODE>LNew</CODE> specify whether the List Manager should leave room for a size box, whether it should include a horizontal scroll bar, and whether it should include a vertical scroll bar. Note that while the List Manager draws scroll bars automatically, it does not draw the grow icon in the size box. Usually, your application can draw the grow icon by calling the Window Manager's <CODE>DrawGrowIcon</CODE> procedure.<A NAME=MARKER-2-59></A><P>
 The <CODE>LNew</CODE> function creates a list according your specifications and returns a handle to the list's list record. Your application uses the returned handle to refer to the list when using other List Manager routines.<P>
 <A NAME=MARKER-2-73></A>Lists are often used in dialog boxes. Because the Control Manager does not define a control for lists, you must define a list in a dialog item list as a user item. <A HREF=#MARKER-9-144>Listing 4-2</A> shows an application-defined procedure that creates a one-column, text-only list in a dialog box.<P>
<B>Listing 4-2  <A NAME=MARKER-9-144></A>Installing a list in a dialog box<A NAME=MARKER-2-145></A></B><P>
<PRE>
FUNCTION MyCreateTextListInDialog (myDialog: DialogPtr;
                                  myItemNumber: Integer)
                                  : ListHandle;
CONST
   kTextLDEF = 0;                {resource ID of default LDEF}
VAR
   myUserItemRect:   Rect;       {enclosure of user item}
   myUserItemType:   Integer;    {for GetDialogItem}
   myUserItemHdl:    Handle;     {for GetDialogItem}
BEGIN
   GetDialogItem(myDialog, myItemNumber, myUserItemType, 
                  myUserItemHdl, myUserItemRect);
   MyCreateTextListInDialog :=
      MyCreateVerticallyScrollingList(myDialog, myUserItemRect,
                                      1, kTextLDEF);
END;
</PRE>
 The <CODE>MyCreateTextListInDialog</CODE> function defined in <A HREF=#MARKER-9-144>Listing 4-2</A> calls the <CODE>MyCreateVerticallyScrollingList</CODE> function defined in <A HREF=#MARKER-9-138>Listing 4-1</A>, after finding the rectangle in which to install the new list by using the Dialog Manager's <CODE>GetDialogItem</CODE> procedure. For more information on the Dialog Manager, see <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>.<A NAME=MARKER-2-272></A><P>
 <A NAME=MARKER-2-147></A>The List Manager does not automatically draw a 1-pixel border around a list. <A HREF=#MARKER-9-148>Listing 4-3</A> shows an application-defined procedure that draws a border around a list.<P>
<B>Listing 4-3  <A NAME=MARKER-9-148></A>Drawing a border around a list<A NAME=MARKER-9-376></A></B><P>
<PRE>
PROCEDURE MyDrawListBorder (myList: ListHandle);
VAR
   myBorder:      Rect;          {box for list}
   myPenState:    PenState;      {current status of pen}
BEGIN
   myBorder := myList^^.rView;   {get view rectangle}
   GetPenState(myPenState);      {store pen state}
   PenSize(1, 1);                {set pen to 1 pixel}
   InsetRect(myBorder, -1, -1);  {adjust rectangle for framing}
   FrameRect(myBorder);          {draw border}
   SetPenState(myPenState);      {restore old pen state}
END;
</PRE>
 The <CODE>MyDrawListBorder</CODE> procedure defined in <A HREF=#MARKER-9-148>Listing 4-3</A> uses standard QuickDraw routines to save the state of the pen, set the pen size to 1 pixel, draw the border, and restore the pen state.<A NAME=MARKER-2-309></A><P>
 When you are finished using a list, you should dispose of it using the <CODE>LDispose</CODE> procedure, passing a handle to the list as the only parameter. The <CODE>LDispose</CODE> procedure disposes of the list record, as well as the data associated with the list; however, it does not dispose of any application-specific data that you might have stored in a relocatable block specified by the <CODE>userHandle</CODE> field of the list record. Thus, if you use this field to store a handle to a relocatable block, you should dispose of the relocatable block before calling <CODE>LDispose</CODE>.<A NAME=MARKER-21-258></A><A NAME=MARKER-2-172></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-209.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-211.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
