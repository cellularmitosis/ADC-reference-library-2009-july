<html><head><title>Mac OS X
 Manual Page For c_rehash(1ssl)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1ssl/c_rehash" title="Mac OS X
 Manual Page for c_rehash(1ssl)"><a name="//apple_ref/doc/man/1/c_rehash" title="Mac OS X
 Manual Page for c_rehash(1ssl)"><!-- headerDoc=man; indexgroup=Section 1ssl; uid="//apple_ref/doc/man/1ssl/c_rehash"; name=c_rehash(1ssl) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
VERIFY(1)                                          OpenSSL                                         <!-- a -->VERIFY(1)<!-- /a -->



<b>NAME</b>
       verify - Utility to verify certificates.

<b>SYNOPSIS</b>
       <b>openssl</b> <b>verify</b> [<b>-CApath</b> <b>directory</b>] [<b>-CAfile</b> <b>file</b>] [<b>-purpose</b> <b>purpose</b>] [<b>-untrusted</b> <b>file</b>] [<b>-help</b>]
       [<b>-issuer_checks</b>] [<b>-verbose</b>] [<b>-</b>] [certificates]

<b>DESCRIPTION</b>
       The <b>verify</b> command verifies certificate chains.

<b>COMMAND</b> <b>OPTIONS</b>
       <b>-CApath</b> <b>directory</b>
           A directory of trusted certificates. The certificates should have names of the form: hash.0 or
           have symbolic links to them of this form ("hash" is the hashed certificate subject name: see the
           <b>-hash</b> option of the <b>x509</b> utility). Under Unix the <b>c_rehash</b> script will automatically create
           symbolic links to a directory of certificates.

       <b>-CAfile</b> <b>file</b>
           A file of trusted certificates. The file should contain multiple certificates in PEM format
           concatenated together.

       <b>-untrusted</b> <b>file</b>
           A file of untrusted certificates. The file should contain multiple certificates

       <b>-purpose</b> <b>purpose</b>
           the intended use for the certificate. Without this option no chain verification will be done.
           Currently accepted uses are <b>sslclient</b>, <b>sslserver</b>, <b>nssslserver</b>, <b>smimesign</b>, <b>smimeencrypt</b>. See the
           <b>VERIFY</b> <b>OPERATION</b> section for more information.

       <b>-help</b>
           prints out a usage message.

       <b>-verbose</b>
           print extra information about the operations being performed.

       <b>-issuer_checks</b>
           print out diagnostics relating to searches for the issuer certificate of the current certificate.
           This shows why each candidate issuer certificate was rejected. However the presence of rejection
           messages does not itself imply that anything is wrong: during the normal verify process several
           rejections may take place.

       <b>-</b>   marks the last option. All arguments following this are assumed to be certificate files. This is
           useful if the first certificate filename begins with a <b>-</b>.

       <b>certificates</b>
           one or more certificates to verify. If no certificate filenames are included then an attempt is
           made to read a certificate from standard input. They should all be in PEM format.

<b>VERIFY</b> <b>OPERATION</b>
       The <b>verify</b> program uses the same functions as the internal SSL and S/MIME verification, therefore
       this description applies to these verify operations too.

       There is one crucial difference between the verify operations performed by the <b>verify</b> program:
       wherever possible an attempt is made to continue after an error whereas normally the verify operation
       would halt on the first error. This allows all the problems with a certificate chain to be
       determined.

       The verify operation consists of a number of separate steps.

       Firstly a certificate chain is built up starting from the supplied certificate and ending in the root
       CA. It is an error if the whole chain cannot be built up. The chain is built up by looking up the
       issuers certificate of the current certificate. If a certificate is found which is its own issuer it
       is assumed to be the root CA.

       The process of 'looking up the issuers certificate' itself involves a number of steps. In versions of
       OpenSSL before 0.9.5a the first certificate whose subject name matched the issuer of the current
       certificate was assumed to be the issuers certificate. In OpenSSL 0.9.6 and later all certificates
       whose subject name matches the issuer name of the current certificate are subject to further tests.
       The relevant authority key identifier components of the current certificate (if present) must match
       the subject key identifier (if present) and issuer and serial number of the candidate issuer, in
       addition the keyUsage extension of the candidate issuer (if present) must permit certificate signing.

       The lookup first looks in the list of untrusted certificates and if no match is found the remaining
       lookups are from the trusted certificates. The root CA is always looked up in the trusted certificate
       list: if the certificate to verify is a root certificate then an exact match must be found in the
       trusted list.

       The second operation is to check every untrusted certificate's extensions for consistency with the
       supplied purpose. If the <b>-purpose</b> option is not included then no checks are done. The supplied or
       "leaf" certificate must have extensions compatible with the supplied purpose and all other
       certificates must also be valid CA certificates. The precise extensions required are described in
       more detail in the <b>CERTIFICATE</b> <b>EXTENSIONS</b> section of the <b>x509</b> utility.

       The third operation is to check the trust settings on the root CA. The root CA should be trusted for
       the supplied purpose. For compatibility with previous versions of SSLeay and OpenSSL a certificate
       with no trust settings is considered to be valid for all purposes.

       The final operation is to check the validity of the certificate chain. The validity period is checked
       against the current system time and the notBefore and notAfter dates in the certificate. The
       certificate signatures are also checked at this point.

       If all operations complete successfully then certificate is considered valid. If any operation fails
       then the certificate is not valid.

<b>DIAGNOSTICS</b>
       When a verify operation fails the output messages can be somewhat cryptic. The general form of the
       error message is:

        server.pem: /C=AU/ST=Queensland/O=CryptSoft Pty Ltd/CN=Test CA (1024 bit)
        error 24 at 1 depth lookup:invalid CA certificate

       The first line contains the name of the certificate being verified followed by the subject name of
       the certificate. The second line contains the error number and the depth. The depth is number of the
       certificate being verified when a problem was detected starting with zero for the certificate being
       verified itself then 1 for the CA that signed the certificate and so on. Finally a text version of
       the error number is presented.

       An exhaustive list of the error codes and messages is shown below, this also includes the name of the
       error code as defined in the header file x509_vfy.h Some of the error codes are defined but never
       returned: these are described as "unused".

       <b>0</b> <b>X509_V_OK:</b> <b>ok</b>
           the operation was successful.

       <b>2</b> <b>X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT:</b> <b>unable</b> <b>to</b> <b>get</b> <b>issuer</b> <b>certificate</b>
           the issuer certificate could not be found: this occurs if the issuer certificate of an untrusted
           certificate cannot be found.

       <b>3</b> <b>X509_V_ERR_UNABLE_TO_GET_CRL</b> <b>unable</b> <b>to</b> <b>get</b> <b>certificate</b> <b>CRL</b>
           the CRL of a certificate could not be found. Unused.

       <b>4</b> <b>X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE:</b> <b>unable</b> <b>to</b> <b>decrypt</b> <b>certificate's</b> <b>signature</b>
           the certificate signature could not be decrypted. This means that the actual signature value
           could not be determined rather than it not matching the expected value, this is only meaningful
           for RSA keys.

       <b>5</b> <b>X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE:</b> <b>unable</b> <b>to</b> <b>decrypt</b> <b>CRL's</b> <b>signature</b>
           the CRL signature could not be decrypted: this means that the actual signature value could not be
           determined rather than it not matching the expected value. Unused.

       <b>6</b> <b>X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY:</b> <b>unable</b> <b>to</b> <b>decode</b> <b>issuer</b> <b>public</b> <b>key</b>
           the public key in the certificate SubjectPublicKeyInfo could not be read.

       <b>7</b> <b>X509_V_ERR_CERT_SIGNATURE_FAILURE:</b> <b>certificate</b> <b>signature</b> <b>failure</b>
           the signature of the certificate is invalid.

       <b>8</b> <b>X509_V_ERR_CRL_SIGNATURE_FAILURE:</b> <b>CRL</b> <b>signature</b> <b>failure</b>
           the signature of the certificate is invalid. Unused.

       <b>9</b> <b>X509_V_ERR_CERT_NOT_YET_VALID:</b> <b>certificate</b> <b>is</b> <b>not</b> <b>yet</b> <b>valid</b>
           the certificate is not yet valid: the notBefore date is after the current time.

       <b>10</b> <b>X509_V_ERR_CERT_HAS_EXPIRED:</b> <b>certificate</b> <b>has</b> <b>expired</b>
           the certificate has expired: that is the notAfter date is before the current time.

       <b>11</b> <b>X509_V_ERR_CRL_NOT_YET_VALID:</b> <b>CRL</b> <b>is</b> <b>not</b> <b>yet</b> <b>valid</b>
           the CRL is not yet valid. Unused.

       <b>12</b> <b>X509_V_ERR_CRL_HAS_EXPIRED:</b> <b>CRL</b> <b>has</b> <b>expired</b>
           the CRL has expired. Unused.

       <b>13</b> <b>X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD:</b> <b>format</b> <b>error</b> <b>in</b> <b>certificate's</b> <b>notBefore</b> <b>field</b>
           the certificate notBefore field contains an invalid time.

       <b>14</b> <b>X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD:</b> <b>format</b> <b>error</b> <b>in</b> <b>certificate's</b> <b>notAfter</b> <b>field</b>
           the certificate notAfter field contains an invalid time.

       <b>15</b> <b>X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD:</b> <b>format</b> <b>error</b> <b>in</b> <b>CRL's</b> <b>lastUpdate</b> <b>field</b>
           the CRL lastUpdate field contains an invalid time. Unused.

       <b>16</b> <b>X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD:</b> <b>format</b> <b>error</b> <b>in</b> <b>CRL's</b> <b>nextUpdate</b> <b>field</b>
           the CRL nextUpdate field contains an invalid time. Unused.

       <b>17</b> <b>X509_V_ERR_OUT_OF_MEM:</b> <b>out</b> <b>of</b> <b>memory</b>
           an error occurred trying to allocate memory. This should never happen.

       <b>18</b> <b>X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT:</b> <b>self</b> <b>signed</b> <b>certificate</b>
           the passed certificate is self signed and the same certificate cannot be found in the list of
           trusted certificates.

       <b>19</b> <b>X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN:</b> <b>self</b> <b>signed</b> <b>certificate</b> <b>in</b> <b>certificate</b> <b>chain</b>
           the certificate chain could be built up using the untrusted certificates but the root could not
           be found locally.

       <b>20</b> <b>X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY:</b> <b>unable</b> <b>to</b> <b>get</b> <b>local</b> <b>issuer</b> <b>certificate</b>
           the issuer certificate of a locally looked up certificate could not be found. This normally means
           the list of trusted certificates is not complete.

       <b>21</b> <b>X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE:</b> <b>unable</b> <b>to</b> <b>verify</b> <b>the</b> <b>first</b> <b>certificate</b>
           no signatures could be verified because the chain contains only one certificate and it is not
           self signed.

       <b>22</b> <b>X509_V_ERR_CERT_CHAIN_TOO_LONG:</b> <b>certificate</b> <b>chain</b> <b>too</b> <b>long</b>
           the certificate chain length is greater than the supplied maximum depth. Unused.

       <b>23</b> <b>X509_V_ERR_CERT_REVOKED:</b> <b>certificate</b> <b>revoked</b>
           the certificate has been revoked. Unused.

       <b>24</b> <b>X509_V_ERR_INVALID_CA:</b> <b>invalid</b> <b>CA</b> <b>certificate</b>
           a CA certificate is invalid. Either it is not a CA or its extensions are not consistent with the
           supplied purpose.

       <b>25</b> <b>X509_V_ERR_PATH_LENGTH_EXCEEDED:</b> <b>path</b> <b>length</b> <b>constraint</b> <b>exceeded</b>
           the basicConstraints pathlength parameter has been exceeded.

       <b>26</b> <b>X509_V_ERR_INVALID_PURPOSE:</b> <b>unsupported</b> <b>certificate</b> <b>purpose</b>
           the supplied certificate cannot be used for the specified purpose.

       <b>27</b> <b>X509_V_ERR_CERT_UNTRUSTED:</b> <b>certificate</b> <b>not</b> <b>trusted</b>
           the root CA is not marked as trusted for the specified purpose.

       <b>28</b> <b>X509_V_ERR_CERT_REJECTED:</b> <b>certificate</b> <b>rejected</b>
           the root CA is marked to reject the specified purpose.

       <b>29</b> <b>X509_V_ERR_SUBJECT_ISSUER_MISMATCH:</b> <b>subject</b> <b>issuer</b> <b>mismatch</b>
           the current candidate issuer certificate was rejected because its subject name did not match the
           issuer name of the current certificate. Only displayed when the <b>-issuer_checks</b> option is set.

       <b>30</b> <b>X509_V_ERR_AKID_SKID_MISMATCH:</b> <b>authority</b> <b>and</b> <b>subject</b> <b>key</b> <b>identifier</b> <b>mismatch</b>
           the current candidate issuer certificate was rejected because its subject key identifier was
           present and did not match the authority key identifier current certificate. Only displayed when
           the <b>-issuer_checks</b> option is set.

       <b>31</b> <b>X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH:</b> <b>authority</b> <b>and</b> <b>issuer</b> <b>serial</b> <b>number</b> <b>mismatch</b>
           the current candidate issuer certificate was rejected because its issuer name and serial number
           was present and did not match the authority key identifier of the current certificate. Only
           displayed when the <b>-issuer_checks</b> option is set.

       <b>32</b> <b>X509_V_ERR_KEYUSAGE_NO_CERTSIGN:key</b> <b>usage</b> <b>does</b> <b>not</b> <b>include</b> <b>certificate</b> <b>signing</b>
           the current candidate issuer certificate was rejected because its keyUsage extension does not
           permit certificate signing.

       <b>50</b> <b>X509_V_ERR_APPLICATION_VERIFICATION:</b> <b>application</b> <b>verification</b> <b>failure</b>
           an application specific error. Unused.

<b>BUGS</b>
       Although the issuer checks are a considerably improvement over the old technique they still suffer
       from limitations in the underlying X509_LOOKUP API. One consequence of this is that trusted
       certificates with matching subject name must either appear in a file (as specified by the <b>-CAfile</b>
       option) or a directory (as specified by <b>-CApath</b>. If they occur in both then only the certificates in
       the file will be recognised.

       Previous versions of OpenSSL assume certificates with matching subject name are identical and
       mishandled them.

<b>SEE</b> <b>ALSO</b>
       <a href="x509.1ssl.html#//apple_ref/doc/man/1/x509"><u>x509</u>(1)</a>



0.9.7l                                           2001-10-08                                        <!-- a -->VERIFY(1)<!-- /a -->
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/c_rehash.1ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/c_rehash.1ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/c_rehash.1ssl.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
