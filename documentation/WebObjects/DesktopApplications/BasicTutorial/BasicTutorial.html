<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>WebObjects Java Client Programming Guide (Legacy): Building a Simple Application</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Building a Simple Application"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30001017-CH300" title="Building a Simple Application"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../LegacyTechnologies/Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000463" target="_top">Tools</a> &gt; <a href="../Introduction/Introduction.html#//apple_ref/doc/uid/TP30001017-CH297-TP1">WebObjects Java Client Programming Guide (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../BasicConcepts/JavaClientBasicConcepts.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../InsideAssistant/InsideAssistant.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP30001017-CH300-TP9" title="Building a Simple Application"></a><h1>Building a Simple Application</h1><p>This chapter leads you through the creation of a Java Client application starting with the Direct to Java Client project type. You’ll learn how to</p><ul class="ul"><li class="li"><p>create a simple database using OpenBase Manager</p></li><li class="li"><p>create tables in that database using EOModeler</p></li><li class="li"><p>build a Direct to Java Client application using Project Builder</p></li><li class="li"><p>perform simple customizations of the application using the Direct to Java Client Assistant</p></li></ul><div class="notebox"><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_140" title="Note"></a><p><strong>Note:</strong>&nbsp;Projects for the tutorials in this book are available on the WebObjects documentation home page: <span class="content_text"><a href="../../../../documentation/WebObjects" target="_top">http://developer.apple.com/documentation/WebObjects</a></span>.</p></div><p>You’ll create a simple college admissions application with a rich user interface and database access. The application stores records of prospective students, which allows you to track students throughout the admissions process. <span class="content_text">Figure 3-1</span> shows a sample student record from this application.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF54" title="Figure 3-1Part of the application created in this chapter"></a><p><strong>Figure 3-1&nbsp;&nbsp;</strong>Part of the application created in this chapter</p><img src = "../Art/stuformwithactivitypop.gif" alt = "Part of the application created in this chapter" width="253" height="278"></div><br/>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF7">Create the Database</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF8">Create an EOModel</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF10">Build the Model</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF12">Completing the Model</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF14">Generate SQL</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF16">Create the Project</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF18">The Default Project</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF23">Add a Launch Argument</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF78">More About Session Timeouts</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF24">Build the Executable</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF25">Run the Client Application</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF32">Using the Application</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF34">Customizing the Application</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF50">Add a Relationship</a>
				
			<br/>
			
        
			
			
				<a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF75">Where to Go From Here</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF7" title="Create the Database"></a><h2>Create the Database</h2><p>The WebObjects developer software package includes a limited-use version of <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_357"></a>OpenBase, a SQL database server. Follow these steps to configure a new OpenBase database:</p><ol class="ol"><li class="li"><p>In Mac OS X, navigate to <code>/Applications/OpenBase</code> and launch OpenBase Manager.</p></li><li class="li"><p>Choose New from the Database menu.</p></li><li class="li"><p>Name the database <code>Admissions</code>. Select the Start Database at Boot option. Choose ISO LATIN 1 from the Internal Encoding pop-up menu. The Configure Database dialog should appear as shown in <span class="content_text">Figure 3-2</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIDJCED" title="Figure 3-2Configuring a new database"></a><p><strong>Figure 3-2&nbsp;&nbsp;</strong>Configuring a new database</p><img src = "../Art/dbsetup.gif" alt = "Configuring a new database" width="270" height="285"></div></li><li class="li"><p>Click Set.</p></li><li class="li"><p>Select the new database in the database list under localhost and start it manually. Make sure the database is started (denoted by the green icon, as <span class="content_text">Figure 3-3</span> shows).</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-CHDCEJGA" title="Figure 3-3OpenBase Manager main window"></a><p><strong>Figure 3-3&nbsp;&nbsp;</strong>OpenBase Manager main window</p><img src = "../Art/obmanager.gif" alt = "OpenBase Manager main window" width="401" height="371"></div></li><li class="li"><p>Quit OpenBase Manager.</p></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF8" title="Create an EOModel"></a><h2>Create an EOModel</h2><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_358"></a>EOModeler is a powerful application that provides tools to build a data model that describes the entity-relationship mapping between the data sources your application uses and the Java business objects that bring that stored data to life. Its product is an EOModel, which contains database connection information, such as the database adaptor, version number, and login information. EOModels also form the foundation of your business logic—they offer an object-oriented view of the tables and relationships in your database. You use EOModeler to</p><ul class="ul"><li class="li"><p>create tables and relationships in a database</p></li><li class="li"><p>generate SQL</p></li><li class="li"><p>generate client and server Java files based on EOModels</p></li><li class="li"><p>build fetch specifications</p></li></ul><p>A good model is important because Direct to Java Client’s dynamic user-interface generation system analyzes EOModels and generates user interfaces from them. If you build good models, Direct to Java Client can generate a full-featured application automatically without requiring you to write a line of code. In fact, a Direct to Java Client application is a great way to test the integrity of EOModels.</p><p>Follow these steps to create an EOModel:</p><ol class="ol"><li class="li"><p>In Mac OS X, navigate to <code>/Developer/Applications</code> and launch EOModeler.</p></li><li class="li"><p>Choose New from the Model menu.</p></li><li class="li"><p>Select JDBC as the adaptor.</p></li><li class="li"><p>In the JDBC Connection window, enter <code>jdbc:openbase://localhost/Admissions</code> in the URL field, as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIBJAJG">Figure 3-4</a></span>. Click OK.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIBJAJG" title="Figure 3-4JDBC connection information"></a><p><strong>Figure 3-4&nbsp;&nbsp;</strong>JDBC connection information</p><img src = "../Art/eomjdbcconnectdialog.gif" alt = "JDBC connection information" width="391" height="250"></div></li><li class="li"><p>Since the database is empty, deselect the four options in the next window and click Next. See <span class="content_text">Figure 3-5</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF55" title="Figure 3-5Deselect all options for this model"></a><p><strong>Figure 3-5&nbsp;&nbsp;</strong>Deselect all options for this model</p><img src = "../Art/eomincludenothing.gif" alt = "Deselect all options for this model" width="429" height="306"></div></li><li class="li"><p>There are currently no tables in the database, so click Finish in the Choose Tables to Include dialog.</p></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF9" title="Behind the Steps"></a><h3>Behind the Steps</h3><p>Step 3: <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_359"></a>WebObjects 5 supports databases with <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_360"></a>JDBC Type 2 and Type 4 connectivity. Oracle, OpenBase, MSSQL 2000, Sybase, and MySQL are qualified for WebObjects 5.2. See the document <em>Post-Installation Guide</em> for more exact specifications. Third parties have developed JDBC adaptor plug-ins for other JDBC-compliant databases. See the Apple Support Knowledge Base for information on creating custom JDBC adaptor plug-ins.</p><p>WebObjects database connectivity is not limited to JDBC-compliant databases. In principle, you can also write adaptors for ERP systems and even flat file systems. WebObjects 5.2 also supports data stores with <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_361"></a>JNDI connectivity.</p><p>Step 5: EOModeler works by <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_362"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_363"></a>reverse-engineering your database. So, if your database is already populated with tables, primary keys, relationships, and stored procedures, you can tell EOModeler to consider these attributes when building a model.</p><ul class="spaceabove"><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_364"></a>Assign primary keys to all entities—When reading and writing to databases, the access layer of Enterprise Objects uses <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_365"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_366"></a>primary keys to uniquely identify enterprise objects and to map them to the appropriate database row. Therefore, each entity in your model needs a primary key. The EOModeler Wizard automatically assigns primary keys to the model if it finds primary key information in the database.</p><p>However, if primary keys aren’t defined in the database schema information, the wizard prompts you to choose primary keys.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_141" title="Note"></a><p><strong>Note:</strong>&nbsp;Although Enterprise Objects uses <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_367"></a>primary keys when reading and writing to the database, it assigns an identifier (an EOGlobalID) to each enterprise object. This allows business logic to be independent of database primary and foreign keys, which makes your business objects reusable. To reiterate, although Enterprise Objects needs to know about database primary keys, your business logic should never explicitly reference database primary or foreign keys.</p></div></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_368"></a>Ask about relationships—If the Wizard finds foreign key definitions in the database schema information, it includes the corresponding relationships in the model. However, foreign key definitions in the schema don’t provide enough information for the Wizard to set all of a relationship’s options. If you select this option you will be prompted to provide additional information, such as the join type, delete rule, batch faulting batch size, and more.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_369"></a>Ask about stored procedures—Selecting this option causes the Wizard to display the stored procedures it finds in the schema and allows you to choose which to include in your model.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_370"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_371"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_372"></a>Use Custom Enterprise objects—Each entity in the model corresponds to a table in the database and each has a corresponding Java class. This Java class can be an instance of <code>com.webobjects.eocontrol.EOGenericRecord</code> or a custom subclass of EOGenericRecord.</p><p>If you deselect this option, the Wizard maps all database tables to EOGenericRecord classes. Otherwise, it maps each entity to a subclass of EOGenericRecord of the same name (a table named “STUDENT” corresponds to an entity named “Student,” which corresponds to a Java class named “Student.java.”)</p><p>You use custom enterprise object classes to add custom business logic to your application (which is quite common).</p></li></ul><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF10" title="Build the Model"></a><h2>Build the Model</h2><p>EOModeler creates an empty model containing just a database connection dictionary, which specifies the adaptor type, database URL, and other basic information. Click the root of the object tree (probably titled “UNTITLED0”), and then choose Inspector from the Tools menu to see the database connection dictionary.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_142" title="Note"></a><p><strong>Note:</strong>&nbsp;The model you create will initially be suboptimal so that the tutorial can demonstrate some features of Java Client you wouldn’t otherwise see with a perfect model.</p></div><p>Follow these steps to add a table with attributes to the model:</p><ol class="ol"><li class="li"><p>Create a new entity by selecting Add Entity from the Property menu.</p></li><li class="li"><p>Select Inspector from the Tools menu if it is not already present. When you created an entity in step 1, the Inspector focused on that entity, so its title is now “Entity Inspector.”</p></li><li class="li"><p>In the Entity Inspector, change the Name field to <code>Student</code> and the Table Name field to <code>STUDENT</code>. Leave the Class field EOGenericRecord. See <span class="content_text">Figure 3-6</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF56" title="Figure 3-6Entity Inspector"></a><p><strong>Figure 3-6&nbsp;&nbsp;</strong>Entity Inspector</p><img src = "../Art/eomstudententityinspect.gif" alt = "Entity Inspector" width="240" height="399"></div></li><li class="li"><p>Select the Student entity in the tree view and add a new attribute to it by selecting Add Attribute from the Property menu. The title of the Inspector window changes to “Attribute Inspector.”</p></li><li class="li"><p>In the Attribute Inspector, change the Name field to <code>name</code> and the Column name to <code>NAME</code>.</p></li><li class="li"><p>In the External Type field, enter <code>char</code>.</p></li><li class="li"><p>Choose String from the Internal Data Type pop-up menu, and enter <code>50</code> in the External Width field, as shown in <span class="content_text">Figure 3-7</span>. Make sure to press Enter or tab out of the field so the value sticks.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF57" title="Figure 3-7Attribute Inspector for the name attribute"></a><p><strong>Figure 3-7&nbsp;&nbsp;</strong>Attribute Inspector for the <code>name</code> attribute</p><img src = "../Art/eomnameattribute.gif" alt = "Attribute Inspector for the name attribute" width="244" height="394"></div></li><li class="li"><p>Add a second attribute named <code>gpa</code> with Column name <code>GPA</code>. Enter <code>int</code> in the External Type field and choose Integer for Internal Data Type. The types selected here are the suboptimal part of the model that will be corrected in a later step.</p></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF11" title="Behind the Steps"></a><h3>Behind the Steps</h3><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_373"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_374"></a>Step 3: In this book, the naming conventions for entities and attributes follow standard Java naming conventions and common relational database conventions. </p><p>Entities adhere to the naming convention for Java classes: The name begins with a capital letter, and the first letter of inner words is capitalized, such as “NewStudent.”</p><p>Table names adhere to the common relational database convention of capitalizing every letter, and separating inner words with the underscore (_) character, such as “NEW_STUDENT.” </p><p>Attribute names follow the Java convention for methods: The name begins with a lowercase letter, and the first letter of inner words is capitalized, such as “firstName.” </p><p>Column names adhere to the same database conventions that tables do.</p><p>Step 6: When adding attributes, you can choose the external type from a pop-up menu in EOModeler’s table view, rather than type it in. Simply click the downward pointing arrow to the right of a row in the External Type column. Doing this will also familiarize you with the different external types for the database you are using.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF12" title="Completing the Model"></a><h2>Completing the Model</h2><p>Simply creating entities with attributes does not make a complete model. You must also assign a primary key to the entity and select certain properties to send to the client. Follow these steps to complete the basic model:</p><ol class="ol"><li class="li"><p>Add a third attribute to the Student entity named <code>studentID</code>. The column name is <code>STUDENT_ID</code>. Give it an external type of <code>int</code> and choose Integer for the internal data type. This attribute is the entity’s primary key. See <span class="content_text">Figure 3-8</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF58" title="Figure 3-8The primary key attribute"></a><p><strong>Figure 3-8&nbsp;&nbsp;</strong>The primary key attribute</p><img src = "../Art/eomstudentattrinspect.gif" alt = "The primary key attribute" width="241" height="394"></div></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_375"></a>In table mode (Tools > Table Mode), there are three icons in the table heads of the attributes pane for an entity, as shown in <span class="content_text">Figure 3-9</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-CHDJFFIF" title="Figure 3-9Default attribute columns in table mode"></a><p><strong>Figure 3-9&nbsp;&nbsp;</strong>Default attribute columns in table mode</p><img src = "../Art/defaultattricolumns.gif" alt = "Default attribute columns in table mode" width="131" height="83"></div><p>If the key icon is present for a particular attribute, that attribute is or is part of the entity’s primary key. If the diamond icon is present for a particular attribute, that attribute is a server-side class property. If the pad lock icon is present for a particular attribute, that attribute is used for optimistic locking. Make the <code>studentID</code> attribute the primary key by clicking in its key field.</p></li><li class="li"><p>Unmark the primary key (<code>studentID</code>) as a server-side class property by clicking the diamond icon to its left.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_376"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_377"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_378"></a>To select which attributes are available to the client-side application, you need to add a view column in table mode. From the Add Column pop-up menu, choose Client-Side Class Property. This adds a column with two opposing arrows to the attribute’s table. (You can remove columns by selecting a column and pressing the Delete key). Make sure that only the <code>gpa</code> and <code>name</code> attributes are selected as client-side class properties, as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF59">Figure 3-10</a></span>.</p></li><li class="li"><p>Save the model as <code>Admissions.eomodeld</code>. It should look like <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF59">Figure 3-10</a></span>, though the columns you see in the table view may be different if you’ve added or removed columns from it.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF59" title="Figure 3-10The finished model"></a><p><strong>Figure 3-10&nbsp;&nbsp;</strong>The finished model</p><img src = "../Art/simplemodel.gif" alt = "The finished model" width="468" height="78"></div></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF13" title="Behind the Steps"></a><h3>Behind the Steps</h3><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_379"></a>Step 2: Each of the records in a table must be unique—no two records can contain exactly the same values. To ensure this, each entity must contain an attribute that’s guaranteed to represent a unique value for each record; this value is called the entity’s primary key.</p><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_380"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_381"></a>By default, EOModeler makes all of an entity’s attributes class properties. When an attribute is a class property, it means that the property is included in your class definition and that it can be fetched from the database. To put it another way, only attributes that are marked as class properties become part of your enterprise objects.</p><p>You should mark as class properties only those attributes whose values are meaningful in the objects that are created when you fetch from the database. Attributes that are essentially database artifacts, such as primary and foreign keys, shouldn’t be marked as class properties unless the key has meaning to the user and must be displayed in the user interface.</p><p>There are two types of class properties: client-side class properties and server-side class properties. EOModeler indicates that an attribute is a server-side class property with the diamond icon. Client-side class properties are represented by the double-arrow icon. </p><p>Step 3: Primary keys are of no use to client-side classes, so they need to be unmarked as client-side class properties.</p><p>Step 4: Likewise, primary keys are of no use to server-side classes, so they need to be unmarked as server-side class properties.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF14" title="Generate SQL"></a><h2>Generate SQL</h2><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_382"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_383"></a><p>Now that you’ve built an EOModel, you need to write the table information to the database. Fortunately, EOModeler generates SQL for you; just follow these steps:</p><ol class="ol"><li class="li"><p>Select the Student entity in the tree view.</p></li><li class="li"><p>Choose Generate SQL from the Property menu.</p></li><li class="li"><p>Deselect all options except Create Tables, Primary Key Constraints, and Create Primary Key Support, as shown in <span class="content_text">Figure 3-11</span>.</p></li><li class="li"><p>Click Execute SQL. The SQL generated is specific to OpenBase. EOModeler knows to generate OpenBase-specific SQL because of the adaptor plug-in the model is using. Were the model connecting to an Oracle database, Oracle-specific SQL would instead be generated.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF60" title="Figure 3-11Generate SQL"></a><p><strong>Figure 3-11&nbsp;&nbsp;</strong>Generate SQL</p><img src = "../Art/generatesqlx.gif" alt = "Generate SQL" width="341" height="360"></div></li><li class="li"><p>To verify the table was written to the database, in OpenBase Manager, select the Admissions database and then choose Schema from the Database menu. You should see two tables: EO_PK_TABLE and STUDENT. Select the Student table and verify that the attributes you added to the model were written to the database.</p></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF15" title="Behind the Steps"></a><h3>Behind the Steps</h3><p>Step 3: EOModeler’s SQL generation<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_384"></a> feature generates database-specific SQL based on the EOAdaptor chosen for the model. These are the eight SQL generation options:</p><ul class="spaceabove"><li class="li"><p><strong>Drop Database<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_385"></a></strong> deletes all entity tables, key constraints, and primary key support tables. This option may not be available for some data stores.</p></li><li class="li"><p><strong>Drop Tables<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_386"></a></strong> deletes only the entity tables selected in EOModeler’s main window.</p></li><li class="li"><p><strong>Drop Primary Key Support<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_387"></a></strong> deletes primary key support from the database; for OpenBase databases, this option deletes the EO_PK_TABLE table.</p></li><li class="li"><p><strong>Create Database<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_388"></a></strong> generates tables in the database for all entities in the EOModel.</p></li><li class="li"><p><strong>Create Tables<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_389"></a></strong> generates tables in the database only for the models selected in EOModeler’s main window.</p></li><li class="li"><p><strong>Primary Key Constraints<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_390"></a></strong> generates database-specific key constraints.</p></li><li class="li"><p><strong>Foreign Key Constraints<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_391"></a></strong> generates database-specific key constraints.</p></li><li class="li"><p><strong>Create Primary Key Support<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_392"></a></strong> generates the <code>EO_PK_TABLE</code> for OpenBase databases.</p></li></ul><p>Step 5: The EO_PK_TABLE table is used by Enterprise Objects when it generates primary keys. This table is written only to certain data sources when you generate SQL from EOModeler. The table is not generated, for example, when the data source is an Oracle database.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF16" title="Create the Project"></a><h2>Create the Project</h2><p>Project Builder<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_393"></a> is the WebObjects integrated development environment. Its many functions include these:</p><ul class="ul"><li class="li"><p>creating working projects from project templates</p></li><li class="li"><p>organizing project files and resources</p></li><li class="li"><p>source-code editing</p></li><li class="li"><p>compiling and debugging projects</p></li><li class="li"><p>running projects</p></li><li class="li"><p>communicating with other WebObjects development tools</p></li></ul><p>Project Builder is a complex, feature-rich development environment that is designed to support many types of application development from Mac OS X device drivers to WebObjects rule-based Java applications. Because it supports so many different kinds of development, it takes some time to learn.</p><p>When you launch Project Builder<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_394"></a> for the first time, you’ll be asked a few questions including what kind of user interface you want to use. The Window Environment pane of the Project Builder setup assistant appears as shown in <span class="content_text">Figure 3-12</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-CHDHIAFD" title="Figure 3-12Project Builder&acirc;&#128;&#153;s Window Environment options"></a><p><strong>Figure 3-12&nbsp;&nbsp;</strong>Project Builder’s Window Environment options</p><img src = "../Art/pbwindowsetup.gif" alt = "Project Builder’s Window Environment options" width="412" height="346"></div><br/><p>The first versions of Project Builder in Mac OS X limited you to a single window in which all files and operations in a project occurred. With the Mac OS X 10.2 version of Project Builder, a new multiwindow user interface is available, which provides a much more flexible workspace. </p><p>The tutorials in this book assume you’re working in Single Window mode but you’re free to choose another window mode if you’re comfortable with Project Builder.</p><p>Project Builder provides an assistant to help you build a Java Client application starting with the Direct to Java Client project type. Follow these steps to create a new project:</p><ol class="ol"><li class="li"><p>In Mac OS X, navigate to <code>/Developer/Applications</code> and launch Project Builder<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_395"></a>.</p></li><li class="li"><p>Choose New Project from the File menu.</p></li><li class="li"><p>Select Direct to Java Client Application (Three Tier) under the WebObjects group as the new project type and click Next.</p></li><li class="li"><p>Name the project <code>Admissions</code> and choose a location in the file system that has no spaces in the complete pathname. Click Next.</p></li><li class="li"><p>In the Enable J2EE Integration pane, make sure neither option is selected, and click Next.</p></li><li class="li"><p>In the Choose Adaptors pane, select JavaJDBCAdaptor.framework and click Next.</p></li><li class="li"><p>In the Choose Frameworks pane, click Next.</p></li><li class="li"><p>In the Choose EOModels pane, click Add and select the EOModel you just created. Then click Next. See <span class="content_text">Figure 3-13</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF61" title="Figure 3-13Choose the EOModel"></a><p><strong>Figure 3-13&nbsp;&nbsp;</strong>Choose the EOModel</p><img src = "../Art/chooseeomodel.gif" alt = "Choose the EOModel" width="363" height="305"></div></li><li class="li"><p>In the Choose Download Classes pane, select the option “Download main bundle and custom framework classes” and click Next. See <span class="content_text">Figure 3-14</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF62" title="Figure 3-14Configure the class loader"></a><p><strong>Figure 3-14&nbsp;&nbsp;</strong>Configure the class loader</p><img src = "../Art/pbclassloaderoptions.gif" alt = "Configure the class loader" width="395" height="331"></div></li><li class="li"><p>In the Web Start pane, you can enter your company’s name in the Vendor Name field and a description of the application in the Description field, but neither is required. This pane is used to configure the Web Start JNLP file when deploying the client application. </p></li><li class="li"><p>In the Build and Launch Project pane, make sure “Build and launch project now” is selected and click Finish. Project Builder sets up the project, builds it, and runs it. If you’re developing in Mac OS X, the client application is automatically launched. If you’re developing in Windows, however, you must manually launch the client application. See <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF23">“Add a Launch Argument”</a></span> to learn how to manually build and run the application.</p><p>If you’re developing in Mac OS X, you can skip to <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF32">“Using the Application.”</a></span> Or, if you want to learn more about the default project, Project Builder, launch arguments, and manually running the client application, continue with the next section.</p></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF17" title="Behind the Steps"></a><h3>Behind the Steps</h3><p>Step 7: It is common to build a custom framework to contain your EOModels and other custom business logic. You add custom frameworks to your project in this step.</p><p>Step 8: The EOModel you select is copied into your project’s directory. From this point on, open the model from within the project to edit it.</p><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_396"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_397"></a>Step 9: This step configures the Java Client Class Loader feature that first shipped with WebObjects 5.1. It facilitates the download of classes to the client for Java Client applications that are deployed as desktop applications. It does not apply to client applications that are deployed with Web Start or as applets. The class loader has four configuration options:</p><ul class="spaceabove"><li class="li"><p><strong>Do not download classes</strong> suppresses the class loader.</p></li><li class="li"><p><strong>Download main bundle class</strong> downloads the <code>.woa</code> build product that includes custom Java classes defined in your project (but not classes defined in custom frameworks).</p></li><li class="li"><p><strong>Download custom framework classes</strong> downloads custom frameworks that your project links against, including custom Java classes in these frameworks.</p></li><li class="li"><p><strong>Download main bundle and custom framework classes</strong> downloads the <code>.woa</code> build product and custom frameworks your project links against.</p></li></ul><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIHAEDJ" title="More About the Java Client Class Loader"></a><h3>More About the Java Client Class Loader</h3><p>Unlike applets running in browsers, Java desktop applications do not have an automatic mechanism to download classes. This usually requires you to install the complete application manually, which can be inconvenient and makes updating the software complicated.</p><p>But with the new Java Client Class Loader feature you need only install a Java Client base system (including Foundation, EOControl, and EOAccess) on the client and download all classes specific to your application (business logic, interface controllers, user interface code, and so forth) at startup time. You configure whether and which classes should be downloaded through bindings of the WOJavaClientComponent of the WebObjects server-side application (the Project Builder Assistant for Java Client projects configures these bindings for you based on the selection you make in the Choose Download Classes pane). All you have to supply on the client is the base Enterprise Objects stack, which is contained in the <code>wojavaclient.jar</code> file.</p><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_398"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_399"></a>The four possible bindings for the Java Client Class Loader are</p><ul class="spaceabove"><li class="li"><p><code>noDownloadClientClasses</code></p></li><li class="li"><p><code>mainBundleClientClasses</code></p></li><li class="li"><p><code>customFrameworksClientClasses</code></p></li><li class="li"><p><code>customBundlesClientClasses</code></p></li></ul><p>This feature is useful for deployment (since installing an update of the client desktop application is necessary only when you switch the version of WebObjects you use, not when you update your own custom classes) and for development (since you can create generic launch programs or scripts without worrying about the classpath).</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF18" title="The Default Project"></a><h2>The Default Project</h2><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_400"></a><p>For Direct to Java Client projects, the Project Builder Assistant creates a fully functional application. Take a moment to examine the default project.</p><p>As in all WebObjects applications, <code>Application.java</code>, <code>Session.java</code>, <code>DirectAction.java</code>, and <code>Main.java</code> are present, along with <code>Main.wo</code>. In the Resources group, notice that there is no interface file (no nib file), only the EOModel and an empty Direct to Web model (the <code>user.d2wmodel</code> file) to store rules generated by the Direct to Java Client Assistant.</p><p>Project Builder offers several tools that allow you to visually organize all the files in a project. This allows you to easily locate a project’s files in a central repository. It also lets you assign files to specific targets to facilitate the building process.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF19" title="Groups"></a><h3>Groups</h3><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_401"></a><p>A group is a collection of related files, similar to folders or directories in a file system. They allow you to collect all of your project’s components, resources, classes, frameworks, and other groups under general categories. There is no restriction on the type of file you can put in a group.</p><p>When you create a Direct to Java Client application, Project Builder<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_402"></a> creates a default hierarchy with eight major groups. You can modify this organization by adding, removing, or deleting groups, and by moving files between groups. Keep in mind that groups are useful only for organizational purposes: they have no effect on how their content or the application behaves.</p><p>These are the eight major groups in a Direct to Java Client application:</p><ul class="spaceabove"><li class="li"><p><strong>Classes<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_403"></a></strong> stores the core Java files (<code>.java</code>) in the project such as <code>Application.java</code>, <code>Session.java</code>, and <code>DirectAction.java</code>. The Java files related to components, such as <code>Main.java</code>, are by default organized in subgroups of the Web Components group.</p></li><li class="li"><p><strong>Web Components<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_404"></a></strong> stores the WebObjects components used in your project. By default, Java Client applications have a single WebObjects component, <code>Main.wo</code>. Later on, you’ll put frozen XML user-interface components in this group.</p></li><li class="li"><p><strong>Resources<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_405"></a></strong> stores the model files (<code>.eomodeld</code>) used in the project as well as custom rule files (<code>d2w.d2wmodel</code>) and Direct to Java Client Assistant’s <code>user.d2wmodel</code> file.</p></li><li class="li"><p><strong>Web Server Resources<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_406"></a></strong> contains image files (<code>.gif</code>, <code>.jpg</code>, <code>.png</code>) and localizable string tables.</p></li><li class="li"><p><strong>Interfaces<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_407"></a></strong> contains Interface Builder files (<code>.nib</code>) for Java Client applications or for Direct to Java Client applications using frozen interface files.</p></li><li class="li"><p><strong>Frameworks<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_408"></a></strong> is a visual representation of the frameworks your project links against at compile and runtime.</p></li><li class="li"><p><strong>Documentation<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_409"></a></strong> contains documentation for your application.</p></li><li class="li"><p><strong>Products<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_410"></a></strong> contains the build application as well as intermediate build files.</p></li></ul><p>You can freely move files to different groups, rename groups, and remove groups. The only attribute of a project file that really matters is the target with which each file is associated.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF20" title="Targets"></a><h3>Targets</h3><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_411"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_412"></a><p>When built, Java Client applications include two products: the client product and the server product. The client product is the client-side application and the server product is the server-side application. The client product is the result of the files built for the Web Server target. The server product is the result of the files built for the Application Server target.</p><p>The Web Server and Application Server targets are build targets and the Admissions target (or the target named after your application) is the root or aggregate target.</p><ul class="spaceabove"><li class="li"><p><strong>Build targets</strong> are used to configure the settings for a particular target, either the client application or the server application. When you define a build target, you tell Project Builder which files are a part of the target and how to build the target’s product.</p></li><li class="li"><p><strong>Root targets</strong> or aggregate targets are used to group two or more build targets into a single unit. No files are associated with root targets except through their association with build targets. When an aggregate target is built, the build targets it contains are built in turn. The root target is the target you compile on.</p></li></ul><p>Use the Target pop-up menu to switch between a project’s targets, as <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF63">Figure 3-15</a></span> shows.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF63" title="Figure 3-15Target pop-up menu"></a><p><strong>Figure 3-15&nbsp;&nbsp;</strong>Target pop-up menu</p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_413"></a><img src = "../Art/targetpopup.gif" alt = "Target pop-up menu" width="267" height="61"></div><br/><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF21" title="Client Files (Web Server Target)"></a><h3>Client Files (Web Server Target)</h3><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_414"></a><p>For Java Client applications, the files associated with the Web Server target are Interface Builder archive files (<code>.nib</code>), interface controller classes (<code>.java</code>), custom controller classes (<code>.java</code>), client-side image resources (<code>.gif</code>, <code>.jpg</code>, <code>.png</code>), client-side business logic classes (<code>.java</code>), and client-side localized string tables (<code>Localizable.strings</code>).</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF22" title="Server Files (Application Server Target)"></a><h3>Server Files (Application Server Target)</h3><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_415"></a><p>The server-side project files created by Project Builder are distributed across several groups. Most notable of these are the two WebObjects components (WOComponent classes). Starting in WebObjects 5.2, Java Client projects include both a Main component (<code>Main.wo</code>) and a JavaClient (<code>JavaClient.wo</code>) component. Both components are put in the Web Components group by default. The two components work together to provide the client application via Web Start.</p><p>The <code>Main.html</code> file in <code>Main.wo</code> contains this markup:</p><div class="codesample"><table><tr><td scope="row"><pre>&lt;HTML><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;HEAD><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;TITLE>Main&lt;/TITLE><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/HEAD><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;BODY><span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;CENTER><span></span></pre></td></tr><tr><td scope="row"><pre>            Please<span></span></pre></td></tr><tr><td scope="row"><pre>            &lt;WEBOBJECT NAME=JavaClientLink>click here&lt;/WEBOBJECT><span></span></pre></td></tr><tr><td scope="row"><pre>            to start RealEstatePhotos through Web Start.<span></span></pre></td></tr><tr><td scope="row"><pre>        &lt;/CENTER><span></span></pre></td></tr><tr><td scope="row"><pre>    &lt;/BODY><span></span></pre></td></tr><tr><td scope="row"><pre>&lt;/HTML><span></span></pre></td></tr></table></div><p>The <code>Main.wod</code> file contains this code:</p><div class="codesample"><table><tr><td scope="row"><pre>JavaClientLink: WOHyperlink {<span></span></pre></td></tr><tr><td scope="row"><pre>    href = javaClientLink;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>The <code>&lt;WEBOBJECT NAME=JavaClientLink></code> tag in <code>Main.html</code> is bound to the definition of <code>JavaClientLink</code> in <code>Main.wod</code>, which resolves to the value of the <code>javaClientLink</code> method in the component’s class file (<code>Main.java</code>). That method returns a URL that points to the Web Start JNLP file of the client application.</p><p>The other WOComponent class, <code>JavaClient.wo</code>, stores information that is used to dynamically generate the Web Start JNLP file when a user clicks the hyperlink in <code>Main.wo</code> that resolves <code>&lt;WEBOBJECT NAME=JavaClientLink></code>. This component contains a number of interesting bindings.</p><p>The most important of these is the <code>applicationClassName</code> binding. This binding is the switch that determines if a Java Client application is of the direct type or nondirect type. As the project type in this tutorial is of the direct type, the binding specifies <code>com.webobjects.eogeneration.EODynamicApplication</code>. The default binding is <code>com.webobjects.eoapplication.EOApplication</code>, so if the binding is not present in <code>Main.wod</code>, the default is assumed (this is the case for projects begun with the nondirect project type). </p><p>The <code>applicationName</code>, <code>applicationDescription</code>, and <code>vendor</code> bindings are used in the Web Start JNLP file, and the <code>downloadClientClasses</code> binding is used to configure the Java Client Class Loader feature (see <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIHAEDJ">“More About the Java Client Class Loader”</a></span> for more details). The optional <code>interfaceControllerClassName</code> binding specifies the fully qualified class name of a <code>.nib</code> file to load at application launch time.</p><p>Bindings are also available to customize the behavior of the distribution layer. See <span class="content_text"><a href="../DistributionLayer/DistributionLayer.html#//apple_ref/doc/uid/TP30001017-CH302-TPXREF38">“Distribution Layer Objects”</a></span> for more information on these bindings.</p><p>Other server files include</p><ul class="spaceabove"><li class="li"><p>the <code>Application.java</code>, <code>Session.java</code>, and <code>DirectAction.java</code> class files</p></li><li class="li"><p>any EOModels your application uses</p></li><li class="li"><p>the exported bindings for the Main component (<code>Main.api</code>)</p></li></ul><p><span class="content_text">Figure 3-16</span> shows the default groups and files.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF64" title="Figure 3-16The default groups and files"></a><p><strong>Figure 3-16&nbsp;&nbsp;</strong>The default groups and files</p><img src = "../Art/defaultgroupsandfiles.gif" alt = "The default groups and files" width="241" height="311"></div><br/><p>The next section continues building the tutorial project.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF23" title="Add a Launch Argument"></a><h2>Add a Launch Argument</h2><p>Java Client applications have usage patterns that are more like those of desktop applications rather than those of HTML applications. Desktop applications are often left open for hours at a time, with only intermittent usage. Users expect to return to desktop applications after hours of no use and start working again. </p><p>The <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_416"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_417"></a>default session timeout (60 minutes) is too short, so you need to set the timeout higher. Setting the timeout to 24 hours (86400 seconds) will better match the usage pattern of Java Client applications.</p><p>Follow these steps to change the session timeout:</p><ol class="ol"><li class="li"><p>Choose Edit Active Executable from the Project menu.</p></li><li class="li"><p>In the Arguments section, click the plus-sign button and enter <code>-WOSessionTimeOut 86400</code> as a launch argument as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIDHDCJ">Figure 3-17</a></span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIDHDCJ" title="Figure 3-17Add session timeout launch argument"></a><p><strong>Figure 3-17&nbsp;&nbsp;</strong>Add session timeout launch argument</p><img src = "../Art/sessiontimeout.gif" alt = "Add session timeout launch argument" width="497" height="78"></div></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF78" title="More About Session Timeouts"></a><h2>More About Session Timeouts</h2><p>What happens when the session times out and a client application is still running? The next time the client tries to connect to the server (either to save or retrieve data or when a request is made to the rule system), an error dialog appears noting that the session timed out and that any data not saved before the timeout was lost.</p><p>The dialog is modal, so the user has no choice but to quit the client application, and there is no way to reconnect except by restarting the client application.</p><p>You could implement an auto-save feature whereby the client application would display a warning dialog shortly before the session times out. Or, the client could just automatically save changes shortly before timeout. You would have to write code to poll for the timeout and implement the method <code>EOEditingContext.saveChanges()</code> accordingly.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_143" title="Note"></a><p><strong>Note:</strong>&nbsp;<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_418"></a>When you deploy a Java Client application, you must set the session timeout in Monitor. Launch arguments set in Project Builder apply only to projects in development mode.</p></div><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF24" title="Build the Executable"></a><h2>Build the Executable</h2><p>You build a Java Client application using Project Builder. It handles everything for you, including specifying the correct Java classpath, configuring makefiles, creating directories, setting permissions, and so on.</p><ol class="ol"><li class="li"><p>Make sure that the Admissions target is selected in the Target pop-up menu as shown in <span class="content_text">Figure 3-18</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-CHDDCBGF" title="Figure 3-18Select the Admissions target"></a><p><strong>Figure 3-18&nbsp;&nbsp;</strong>Select the Admissions target</p><img src = "../Art/admissionstarget.gif" alt = "Select the Admissions target" width="340" height="51"></div></li><li class="li"><p>Click the Build button (the one with the hammer) in the toolbar to build the application. The Build pane slides down and displays all console messages during the build, including any errors.</p></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF25" title="Run the Client Application"></a><h2>Run the Client Application</h2><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_419"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_420"></a><p>A <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_421"></a>Java Client application is made up of two parts: a server-side application and a client-side applet or application. You start the server application as you do any WebObjects application using one of these techniques:</p><ul class="ul"><li class="li"><p>using Project Builder (during development)</p></li><li class="li"><p>from the command line</p></li><li class="li"><p>using Monitor (the preferred deployment mechanism)</p></li></ul><p>The book <em><a href="../../Deployment/Deploying_Applications/index.html#//apple_ref/doc/uid/TP30001009" target="_top">WebObjects Deployment Guide Using JavaMonitor</a></em> covers the second and third options. You can run the server application from Project Builder by clicking the Launch icon or choosing Run Executable from the Debug menu.</p><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_422"></a>By default, Project Builder in Mac OS X runs the client application as a Java desktop application. However, there are many other ways to run the client application. By entering the application URL in a Web browser, you can start the client application as a Web Start application. You can also start applications from the command line or use the client launch script as described later in this section.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF26" title="Prepare to Run the Project"></a><h3>Prepare to Run the Project</h3><p>In Mac OS X with WebObjects 5.1 and later, the client application is automatically started once the server application is up and running. So if you are developing with that configuration, you can skip this section and continue with <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF32">“Using the Application.”</a></span></p><p>The <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_423"></a><code>-WOAutoOpenClientApplication</code> flag (which, if not present in the launch arguments assumes the <code>YES</code> flag on development systems only) tells Project Builder to run the client launch script, which opens the client application as a Java desktop application.</p><p>The other methods of running the client application require some tweaks to the project. Add these <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_424"></a>launch arguments to make running the project manually a bit easier (add them to the same line as the <code>WOSessionTimeOut</code> argument):</p><p><code>-WOAutoOpenClientApplication NO -WOAutoOpenInBrowser NO -WOPort 8888</code></p><p><code>-WOAutoOpenClientApplication NO</code> tells Project Builder to not automatically start the client application as a Java desktop application. Add this flag only if you always want to start the client application manually. When this feature is disabled, Project Builder automatically starts the client application as an applet in a Web browser unless it finds the <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_425"></a><code>-WOAutoOpenInBrowser NO</code> launch argument. Although you can deploy Java Client application as applets, it’s easier and often faster to deploy them as desktop applications during the development process.</p><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_426"></a>By default, WebObjects runs applications on different ports each time they are run. During development, it’s more convenient to use the same port; you can set a fixed port number using <code>WOPort</code>. Any arbitrarily high number (8888) is valid, but avoid common ports like 23 (telnet) and 80 (HTTP).</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF27" title="Client Launch Script"></a><h3>Client Launch Script</h3><p>The client launch script is available only in Mac OS X. On WebObjects 5.1 running in Mac OS X, the <code>-WOAutoOpenClientApplication</code> flag invokes the client launch script automatically.</p><p>In Mac OS X, Project Builder creates a client launch script that includes all the classpath and executable information. All you need to feed it is the application URL. The launch script is named after your project, with a <code>_Client</code> suffix. It’s located in your application’s <code>.woa</code> in the <code>Contents/MacOS</code> directory. By default, an application’s <code>.woa</code> file is in the <code>build</code> directory in the project’s root directory.</p><p>To run the application:</p><ol class="ol"><li class="li"><p>Open a Terminal shell and <code>cd</code> to that directory (<code>Admissions.woa/Contents/MacOS</code>).</p></li><li class="li"><p>Copy the application URL from the Run pane in Project Builder.</p></li><li class="li"><p>At the shell prompt, paste the URL after entering the following:</p><p><code>./Admissions_Client</code></p><p>The complete shell command to run the script is <code>./Admissions_Client http://localhost:8888/cgi-bin/WebObjects/Admissions</code>. Alternatively, you can enter the command with the full pathname from any directory in the shell: <code>~/Projects/Admissions/build/Admissions.woa/Contents/MacOS/Admissions_Client http://localhost:8888/cgi-bin/WebObjects/Admissions</code></p></li></ol><p>The Java virtual machine starts up, and in a few moments, the Direct to Java Client application is ready to use.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF28" title="Behind the Steps"></a><h4>Behind the Steps</h4><p>Step 3. The “./” command followed by a script name tells the shell to look for the script name starting in the current directory. The client launch script is simply a shell script, and you may want to open it in a text editor to see exactly what it does.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF29" title="Java"></a><h3>Java</h3><p>To start the client as a stand-alone Java application outside a browser, use the <code>java</code> command-line tool. The syntax for starting a Java Client application is</p><div class="codesample"><table><tr><td scope="row"><pre>java -classpath path<span></span></pre></td></tr><tr><td scope="row"><pre>com.webobjects.eoapplication.EOApplication<span></span></pre></td></tr><tr><td scope="row"><pre>-applicationURL url<span></span></pre></td></tr><tr><td scope="row"><pre>-page pageName<span></span></pre></td></tr></table></div><p>The <code>classpath</code> argument must specify all the Enterprise Object classes and your custom classes. Fortunately, the <code>wojavaclient.jar</code> file includes all the Enterprise Object classes the client needs, so you simply need to specify its location in the <code>classpath</code> argument.</p><p>The <code>applicationURL</code> argument specifies the URL to connect to, which is displayed in the server application’s console after initialization. The <code>page</code> argument specifies the name of the page that contains the WOJavaClientComponent. If it is not specified, “Main” is assumed, which is the default. Here’s an example:</p><div class="codesample"><table><tr><td scope="row"><pre>[trivium] brent% java -classpath /System/Library/Java/wojavaclient.jar<span></span></pre></td></tr><tr><td scope="row"><pre>com.webobjects.eoapplication.EOApplication -applicationURL http://<span></span></pre></td></tr><tr><td scope="row"><pre>trivium.apple.com:8888/cgi-bin/WebObjects/Admissions<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF31" title="Mac OS X Application"></a><h3>Mac OS X Application</h3><p>In Mac OS X, you can package Java Cilent applications as double-clickable desktop applications. This deployment method is not practical during development and is more appropriate during deployment. See <span class="content_text"><a href="../DeployingApplications/DeployingApplications.html#//apple_ref/doc/uid/TP30001017-CH307-BABCDCEH">“Desktop Applications”</a></span> for instructions<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_427"></a>.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF32" title="Using the Application"></a><h2>Using the Application</h2><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_428"></a><p>When you launch a Direct to Java Client application, the generation layer analyzes your EOModel and generates the user interface accordingly. Currently, your model and database have only a single table, and by default, Direct to Java Client displays a window to enumerate that table, as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BBCICAJI">Figure 3-19</a></span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-BBCICAJI" title="Figure 3-19Default enumeration window"></a><p><strong>Figure 3-19&nbsp;&nbsp;</strong>Default enumeration window</p><img src = "../Art/defaultenumwin.gif" alt = "Default enumeration window" width="286" height="225"></div><br/><p>You can add, delete, and save records, as well as revert changes made since the last save. You can also rearrange the columns.</p><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_429"></a>So far, you haven’t written a single line of code, yet the Enterprise Object technology has provided the following for you:</p><ul class="ul"><li class="li"><p>automatic primary-key generation when you insert new objects</p></li><li class="li"><p>communication between client and server</p></li><li class="li"><p>coordination between user interface and data store</p></li></ul><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_430"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_431"></a>Notice that only the attributes you marked as <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_432"></a>client-side class properties are displayed in the client. <code>studentID</code>, the entity’s primary key, isn’t displayed since it wasn’t marked as a client-side class property in the EOModel.</p><p>There is a significant problem with the GPA field. You’ll notice that decimal points are automatically truncated, which is unacceptable when recording GPAs. This is due to that field’s data type: <code>int</code> (external) and <code>Integer</code> (internal). </p><p>Since uncustomized Direct to Java Client user interfaces are contingent on the contents of their corresponding EOModels, you need to edit the EOModel to correct this problem.</p><p>Follow these steps to edit the EOModel:</p><ol class="ol"><li class="li"><p>First, quit the client application by choosing Quit from the File menu, and quit the server application by clicking the Stop button in the Project Builder toolbar.</p></li><li class="li"><p>When you created the project, Project Builder made a copy of the EOModel and put it in the project directory. So, you must edit that copy. Find <code>Admissions.eomodeld</code> in the Resources group and double-click it to open it in EOModeler.</p></li><li class="li"><p>Change the external type for the <code>gpa</code> attribute to <code>float</code>. You can do this with the Inspector or in the table view. In the Inspector, change the internal data type to <code>Double</code>. The model should now resemble <span class="content_text">Figure 3-20</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIGJCJI" title="Figure 3-20Revised model"></a><p><strong>Figure 3-20&nbsp;&nbsp;</strong>Revised model</p><img src = "../Art/revisedstudentmodel.gif" alt = "Revised model" width="481" height="73"></div></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_433"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_434"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_435"></a>External types are database-specific, so you need to synchronize the model with the database. Save the model, then select the root of the entity tree (Admissions) and choose Synchronize Schema from the Model menu. Deselect all three options in the Schema Synchronization window as shown in <span class="content_text">Figure 3-21</span>. Then click Synchronize.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF65" title="Figure 3-21Schema Synchronization window"></a><p><strong>Figure 3-21&nbsp;&nbsp;</strong>Schema Synchronization window</p><img src = "../Art/schemasynchronization.gif" alt = "Schema Synchronization window" width="427" height="364"></div></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_436"></a>In OpenBase Manager, verify that the data type for the <code>gpa</code> attribute changed. Do this by choosing the Admissions database and clicking the Schema Design button to view the database’s tables.</p></li><li class="li"><p>Save the model, build the project, and run both the client and server applications.</p></li><li class="li"><p>Enter a few new records, and save changes. Notice how decimals are now preserved as shown in <span class="content_text">Figure 3-22</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF74" title="Figure 3-22Revised enumeration window"></a><p><strong>Figure 3-22&nbsp;&nbsp;</strong>Revised enumeration window</p><img src = "../Art/enumwinwithdata.gif" alt = "Revised enumeration window" width="285" height="227"></div></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF33" title="Behind the Steps"></a><h3>Behind the Steps</h3><p>Step 4: Many model modifications do not require you to synchronize the schema. However, anytime you add, remove, or change the name or type of an attribute, synchronization is necessary<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_437"></a>.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF34" title="Customizing the Application"></a><h2>Customizing the Application</h2><p>There are many ways to customize Direct to Java Client applications, including the tool Direct to Java Client Assistant. <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_438"></a>Assistant is a Java application included in every Direct to Java Client application, and it provides an easy way to perform simple customizations. It is described in depth in <span class="content_text"><a href="../InsideAssistant/InsideAssistant.html#//apple_ref/doc/uid/TP30001017-CH301-TP1">“Inside Assistant.”</a></span> </p><p>The following steps introduce you to Assistant:</p><ol class="ol"><li class="li"><p>While the Direct to Java Client application is running, select Assistant from the Tools menu.</p></li><li class="li"><p>Change the Student entity from an Enumeration entity to a Main entity as shown in <span class="content_text">Figure 3-23</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCICCFFF" title="Figure 3-23Change entity type"></a><p><strong>Figure 3-23&nbsp;&nbsp;</strong>Change entity type</p><img src = "../Art/makestudentmain.gif" alt = "Change entity type" width="459" height="467"></div></li><li class="li"><p>Click Save, then Restart to see how the window type changes. You can now search the database using a query string. Alternatively, you can fetch all records in the database by clicking the Find button without entering a query string, as shown in <span class="content_text">Figure 3-24</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF67" title="Figure 3-24Query window with data"></a><p><strong>Figure 3-24&nbsp;&nbsp;</strong>Query window with data</p><img src = "../Art/querywindow.gif" alt = "Query window with data" width="291" height="230"></div></li><li class="li"><p>Click New to add records; then enter different query strings to test the application. <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIBACEH">Figure 3-25</a></span> illustrates a query for names containing “k.”</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIBACEH" title="Figure 3-25Query window searching for names containing &acirc;&#128;&#156;k&acirc;&#128;&#157;"></a><p><strong>Figure 3-25&nbsp;&nbsp;</strong>Query window searching for names containing “k”</p><img src = "../Art/recordswithk.gif" alt = "Query window searching for names containing “k”" width="292" height="230"></div></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_439"></a>You might want to also query on the <code>gpa</code> attribute. In Assistant, switch to the Properties pane, and choose “query” in the Task pop-up menu. You’ll notice that the <code>gpa</code> property key is listed in the Other Property Keys list. Move it to the Property Keys list as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIFGEBC">Figure 3-26</a></span>, save, and restart the application. You can now query on the <code>gpa</code> field also, as illustrated in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIBEECF">Figure 3-27</a></span>. By default, the application provides two fields so you can search for a range of GPAs.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIFGEBC" title="Figure 3-26Properties pane in Assistant"></a><p><strong>Figure 3-26&nbsp;&nbsp;</strong>Properties pane in Assistant</p><img src = "../Art/makegpapkey.gif" alt = "Properties pane in Assistant" width="461" height="465"></div><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIBEECF" title="Figure 3-27Query on GPA"></a><p><strong>Figure 3-27&nbsp;&nbsp;</strong>Query on GPA</p><img src = "../Art/queryongpa.gif" alt = "Query on GPA" width="285" height="212"></div></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_440"></a>You should probably improve the label for the <code>gpa</code> field. It should be all capitals. In Assistant, switch to the Widgets pane. Make sure the Property Key pop-up menu reads “gpa.” Under Customize Widget Parameters, change the Label field to <code>GPA</code>. Save and restart the application. Notice how the widget label changed.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_441"></a>In Assistant, switch to the Windows tab and change the window label to <code>Admissions</code>. Save and restart to see the changes.</p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_442"></a>Direct to Java Client user interfaces are defined in XML descriptions. The <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_443"></a>XML pane in Assistant displays the XML descriptions for the various specifications in an application. Switch to the XML pane and browse the specifications in the current application.</p></li></ol><p>The changes you made in Assistant are stored in the project’s <code>user.d2wmodel</code> file. Open this file in Rule Editor<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_444"></a> to see the rules that were created when you made changes using Assistant. The Rule Editor application is installed in <code>/Developer/Applications</code>.</p><p><span class="content_text">Figure 3-28</span> shows the left-hand side or conditional of each rule that Assistant created as you customized the application. It says “if the application is in this state, fire the rule and resolve the rule’s right-hand side.”</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-CHDBIIGJ" title="Figure 3-28Left-hand side of rules"></a><p><strong>Figure 3-28&nbsp;&nbsp;</strong>Left-hand side of rules</p><img src = "../Art/lhsrules.gif" alt = "Left-hand side of rules" width="421" height="83"></div><br/><p><span class="content_text">Figure 3-29</span> shows the right-hand side of each rule. The first rule says that none of the entities in the application are considered enumeration entities. The second rule says to provide fields in query windows for both the <code>name</code> and <code>gpa</code> properties of the Student entity. The third rule says to use the label “Admissions” for query windows for the Student entity. The fourth rule says to use the label “GPA” for the property key label for the <code>gpa</code> attribute of the entity <code>Student</code>. The fifth rules says that the Student entity is a main entity.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-CHDGFFJA" title="Figure 3-29Right-hand side of rules"></a><p><strong>Figure 3-29&nbsp;&nbsp;</strong>Right-hand side of rules</p><img src = "../Art/rhsrules.gif" alt = "Right-hand side of rules" width="329" height="81"></div><br/><p>At this point, your application should resemble <span class="content_text">Figure 3-30</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIGDEIJ" title="Figure 3-30The application with simple customizations"></a><p><strong>Figure 3-30&nbsp;&nbsp;</strong>The application with simple customizations</p><img src = "../Art/simpleapp.gif" alt = "The application with simple customizations" width="298" height="238"></div><br/><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF35" title="Behind the Steps"></a><h3>Behind the Steps</h3><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_445"></a>Step 1: To disable Assistant in the client application, pass <code>-EOAssistantEnabled NO</code> as a launch argument for the server application.</p><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_446"></a>Assistant is available only when <a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_447"></a>rapid turnaround mode is enabled (it is enabled by default on development systems). Rapid turnaround mode allows the application to access resources from the project directory rather than from the <code>.woa</code> bundle, which eases development and testing. Also, in Mac OS X, Assistant runs only if the project is open in Project Builder. Assistant needs access to write out the <code>user.d2wmodel</code> file, and it can do this only while the project is open.</p><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_448"></a><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_449"></a>Step 2: The Entities pane is selected by default. The entity type determines the window type. That is, each entity type has a default window type. Enumeration entities are represented by Enumeration windows; Main entities are represented by Query windows; Other entities are not represented by any particular window type. The rule system, which will be discussed later on at length, determines these rules.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF50" title="Add a Relationship"></a><h2>Add a Relationship</h2><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_450"></a><p>Now that you’re familiar with Direct to Java Client, you need to expand your EOModel so you can use more of its features. You’ll add a new relationship representing a student’s extracurricular activities.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF51" title="Add an Entity"></a><h3>Add an Entity</h3><p>To create a new relationship, you need more than one entity. Quit the client application, stop the server application, and open the <code>Admissions.eomodeld</code> file from within Project Builder. In EOModeler, complete the following steps to enhance the model:</p><ol class="ol"><li class="li"><p>Add a new entity named “Activity” with table name “ACTIVITY”. Its class is EOGenericRecord.</p></li><li class="li"><p>Add new attributes:</p><ul class="ul"><li class="li"><p>Name: <code>activityID</code>; Column: ACTIVITY_ID; External Type: <code>int</code>; Internal Data Type: <code>Integer</code>. Do not make this a client-side class property or a server-side class property. </p></li><li class="li"><p>Name: <code>name</code>; Column: NAME; External Type: <code>char</code>; Internal Data Type: <code>String</code>, width 50. Make this a client-side class property. Verify that this attribute is also marked as a server-side class property.</p></li><li class="li"><p>Name: <code>achievements</code>; Column: ACHIEVEMENTS; External Type: <code>char</code>; Internal Data Type: <code>String</code>, width 150. Make this a client-side class property. Verify that this attribute is also marked as a server-side class property.</p></li><li class="li"><p>Name: <code>since</code>; Column: SINCE; External Type: <code>date</code>; Internal Data Type: <code>Date</code>; Make this a client-side class property. Verify that this attribute is also marked as a server-side class property. <em>Don’t lock on this attribute: Deselect the lock icon to the left of the attribute to do this.</em></p></li></ul></li><li class="li"><p>Make <code>activityID</code> the primary key in the Activity entity by clicking in the key column. </p></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_451"></a>Add a foreign key by copying Student’s primary key (<code>studentID</code>) into the Activity table. Do this by selecting <code>studentID</code> in the Student table, then choose Copy from the Edit menu, then click in the Activity table, and choose Paste from the Edit menu. Verify that <code>Activity.studentID</code> is not marked as a primary key, as a server-side class property, or as a client-side class property in the Activity entity. The new entity should look as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF68">Figure 3-31</a></span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF68" title="Figure 3-31Activity entity"></a><p><strong>Figure 3-31&nbsp;&nbsp;</strong>Activity entity</p><img src = "../Art/activityentity.gif" alt = "Activity entity" width="504" height="115"></div></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_452"></a>Select the Activity entity in the tree view and choose Generate SQL from the Property menu. Since you already generated primary key support the first time you generated SQL, make sure to deselect the option Create Primary Key Support. Only Create Tables and Primary Key Constraints should be selected.</p></li></ol><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF52" title="Make the Relationship"></a><h3>Make the Relationship</h3><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_453"></a><p>The relationship you’ll add to the model is a <strong>one-to-many</strong> relationship. That is, one Student object can be related to many Activity objects. In most cases, to-many relationships need at least a foreign key and a primary key. These keys are the attributes on which the relationship joins. Follow these steps to form a relationship between Student and Activity:</p><ol class="ol"><li class="li"><p>In diagram view (Tools > Diagram View), Control-drag from Student’s primary key (<code>studentID</code>) to Activity’s foreign key (<code>studentID</code>) as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF69">Figure 3-32</a></span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF69" title="Figure 3-32Relate Student and Activity"></a><p><strong>Figure 3-32&nbsp;&nbsp;</strong>Relate Student and Activity</p><img src = "../Art/studentactivityrelship.gif" alt = "Relate Student and Activity" width="315" height="110"></div><p>This action creates a relationship in both entities: a to-many relationship from Student to Activity and a to-one relationship from Activity to Student.</p></li><li class="li"><p>The Relationship Inspector allows you to customize the relationship. If it is not visible on the screen, select Inspector from the Tools menu. </p><p>Change the relationship name to “activities.”</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIHFHFI" title="Figure 3-33Relationship Inspector for Student&acirc;&#128;&#153;s activities relationship"></a><p><strong>Figure 3-33&nbsp;&nbsp;</strong>Relationship Inspector for Student’s <code>activities</code> relationship</p><img src = "../Art/stuactivityrelshipinspect.gif" alt = "Relationship Inspector for Student’s activities relationship" width="253" height="371"></div></li><li class="li"><p>As each student can have multiple activities, the relationship from the Student entity to the Activity entity is a to-many relationship. Click the plus sign next to the Student entity in the tree view to show its relationship, <code>activities</code>. </p><div class="item_figure"><img src = "../Art/studentactivities.gif" alt = "image: ../Art/studentactivities.gif" width="106" height="70"></div><p>Select the relationship and in the inspector, make sure To Many is selected and that <code>studentID</code> is selected in both the Source Attributes list and the Destination Attributes list, as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIHFHFI">Figure 3-33</a></span>.</p></li><li class="li"><p>Each activity is specific to a particular student so you need to establish ownership and a delete rule that reflects this business logic. With the <code>activities</code> relationship selected, switch to the Advanced Relationship Inspector. Select Cascade as the delete rule and select the box labeled Owns Destination, as shown in <span class="content_text">Figure 3-34</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-CHDEJBHC" title="Figure 3-34Configure ownership and delete rule"></a><p><strong>Figure 3-34&nbsp;&nbsp;</strong>Configure ownership and delete rule</p><img src = "../Art/cascadeownsdest.gif" alt = "Configure ownership and delete rule" width="287" height="393"></div></li><li class="li"><p>Each activity and its attributes are unique to a single student, so the relationship from Activity to Student is a to-one relationship. Click the plus sign next to the Activity entity in the tree view to show its relationship, <code>student</code>. Select the relationship and in the inspector, make sure To One is selected. Also verify that <code>studentID</code> is selected in both attributes lists as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIGAFDG">Figure 3-35</a></span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIGAFDG" title="Figure 3-35Relationship Inspector for Activity&acirc;&#128;&#153;s student relationship"></a><p><strong>Figure 3-35&nbsp;&nbsp;</strong>Relationship Inspector for Activity’s <code>student</code> relationship</p><img src = "../Art/studentrel.gif" alt = "Relationship Inspector for Activity’s student relationship" width="224" height="369"></div></li><li class="li"><p><a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_454"></a>As with entity attributes, you can choose to make relationships available to the client application. You need to add the new relationships<a name="//apple_ref/doc/uid/TP30001017-CH300-DontLinkElementID_455"></a> as client-side class properties. Switch to table mode (Tools > Table Mode). Below the attributes table is a table for relationships. You may need to add the client-side class properties column to the relationship view. </p><p>If the Student entity is selected in the tree view, its relationship (<code>activities</code>) is shown in this table, as <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF70">Figure 3-36</a></span> illustrates. Selecting the Activity entity displays its relationship (<code>student</code>), as <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF71">Figure 3-37</a></span> illustrates. Make the <code>activities</code> relationship in the Student entity a client-side class property by clicking in the double-arrow column to the left of it, as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF70">Figure 3-36</a></span>. However, do not make the <code>student</code> relationship in the Activity entity a client-side class property, as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-TPXREF71">Figure 3-37</a></span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF70" title="Figure 3-36Make Student to Activity relationship a client-side class property"></a><p><strong>Figure 3-36&nbsp;&nbsp;</strong>Make Student to Activity relationship a client-side class property</p><img src = "../Art/activityrelclientside.gif" alt = "Make Student to Activity relationship a client-side class property" width="397" height="46"></div><div class="item_figure"><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF71" title="Figure 3-37Do not make Activity to Student relationship a client-side class property"></a><p><strong>Figure 3-37&nbsp;&nbsp;</strong>Do not make Activity to Student relationship a client-side class property</p><img src = "../Art/activitytostudent.gif" alt = "Do not make Activity to Student relationship a client-side class property" width="388" height="44"></div></li><li class="li"><p>Save the model.</p></li></ol><p>You do not need to synchronize the schema as the Enterprise Object technology manages the relationships for you. This helps you build reusable enterprise object models since the relationship is not database-specific.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF53" title="The Enhanced Application"></a><h3>The Enhanced Application</h3><p>Build the project and run both the client and server applications. Direct to Java Client analyzes the altered EOModel file and generates the user interface based on the new relationship. Now, when you make a new Student record you can also add activities for that student as shown in <span class="content_text"><a href="BasicTutorial.html#//apple_ref/doc/uid/TP30001017-CH300-BCIGEDBD">Figure 3-38</a></span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30001017-CH300-BCIGEDBD" title="Figure 3-38Add activities to new Student record"></a><p><strong>Figure 3-38&nbsp;&nbsp;</strong>Add activities to new Student record</p><img src = "../Art/newrelationship.gif" alt = "Add activities to new Student record" width="341" height="298"></div><br/><p>When you added the Activity entity to the model and related it to the Student entity, you changed how the rule system considers the two entities. They are both now considered Main entities. However, this doesn’t precisely fit the application’s requirements. The Student entity’s <code>activities</code> relationship is a master-detail relationship in which Student objects are the master objects and Activity objects are the detail objects. Each Activity record is specific to a single student so that you can only add Activity records from within a Student record—you cannot add Activity records that aren’t immediately related to a Student record.</p><p>For the rule system to provide a user interface that reflects this relationship, you need to explicitly make the Activity entity an “other” entity in Assistant. Doing this allows you to add activities to a Student record by clicking the Add button in form windows for the Student entity, but it doesn’t allow users to query on Activity records or add Activity records outside the scope of a Student record.</p><p>If you make Activity an enumeration or a main entity using Assistant, the application provides different mechanisms to add activities to student records. Experiment with this by changing Activity’s entity type in Assistant and restarting the client application.</p><p>Make sure to change the Activity entity back to an “other” entity to successfully complete the other tutorials.</p><a name="//apple_ref/doc/uid/TP30001017-CH300-TPXREF75" title="Where to Go From Here"></a><h2>Where to Go From Here</h2><p><span class="content_text"><a href="../DistributionLayer/DistributionLayer.html#//apple_ref/doc/uid/TP30001017-CH302-TP1">“The Distribution Layer”</a></span> provides an important overview of how client-server communication in Java Client applications works. Some of the concepts in that chapter are put into practice in <span class="content_text"><a href="../AdvancedTutorial/AdvancedTutorial.html#//apple_ref/doc/uid/TP30001017-CH303-TP1">“Enhancing the Application”</a></span> However, you may want to continue with the second tutorial and then read the chapter on the distribution layer as it assumes a deeper understanding of Java Client concepts that you’ll learn in <span class="content_text"><a href="../AdvancedTutorial/AdvancedTutorial.html#//apple_ref/doc/uid/TP30001017-CH303-TP1">“Enhancing the Application.”</a></span></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../BasicConcepts/JavaClientBasicConcepts.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../InsideAssistant/InsideAssistant.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-08-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/WebObjects/DesktopApplications/BasicTutorial/BasicTutorial.html%3Fid%3DTP30001017-2.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/WebObjects/DesktopApplications/BasicTutorial/BasicTutorial.html%3Fid%3DTP30001017-2.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/WebObjects/DesktopApplications/BasicTutorial/BasicTutorial.html%3Fid%3DTP30001017-2.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>