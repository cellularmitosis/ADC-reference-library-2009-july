<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Modifying Your Part's Class Definition(Cyberdog)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING23></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="Cyberdog-22.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Cyberdog-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Cyberdog-319.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Cyberdog-24.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Cyberdog-2.html"><B>Cyberdog Programmer's Kit</B></A> / <A HREF="Cyberdog-20.html"><B>Part 2 - Programming in Cyberdog</B></A><BR><DD><A HREF="Cyberdog-21.html"><B>Chapter 3 - Adding Cyberdog Features to an OpenDoc Part</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING23-0></A>
<H1>Modifying Your Part's Class Definition</H1>
 To add Cyberdog features to your OpenDoc part class, you need to modify several methods and define new methods and fields. The button part example assumes that you are modifying the <CODE>SamplePart</CODE> class. This example shows only the steps necessary to modify the class to support Cyberdog items, the Cyberdog menus, and the Cyberdog Preferences command. <A HREF=#MARKER-9-24>Listing 3-1</A> shows the definitions of the methods and fields that you must either add or modify. <P>
<B>Listing 3-1  <A NAME=MARKER-9-24></A>The <CODE>CybTxtBtn</CODE> class definition</B><P>
<PRE>
class CybTxtBtn {
public:
   // Modified to initialize Cyberdog-related fields
   CybTxtBtn();
   virtual ~CybTxtBtn();
   
   // Modified to create a Cyberdog item
   void        InitPart(Environment* ev, ODStorageUnit* storageUnit,
                      ODPart* partWrapper);

   // Modified to allow drag and drop of Cyberdog items or text
   ODDragResultDragEnter(Environment* ev, 
                      ODDragItemIterator* dragInfo, 
                      ODFacet* facet, ODPoint* where);
   ODDropResultDrop  (Environment* ev, 
                      ODDragItemIterator* dragInfo, 
                      ODFacet* facet, ODPoint* where);

   // Modified to remove the Cyberdog service menu object
   void  ReleaseAll(Environment* ev);

   // Added to handle menus
   void CreateMenus(Environment* ev);
   void CheckMenus(Environment *ev, ODFrame* frame);
   ...
protected:
   // Added to initialize Cyberdog
   void  Initialize(Environment* ev, ODStorageUnit* storageUnit);

   // Modified to handle reading and writing of Cyberdog items
   void  InternalizeContent( Environment* ev, 
                        ODStorageUnit* storageUnit);
   void  ExternalizeContent( Environment* ev, 
                        ODStorageUnit* storageUnit,
                        ODDraftKey key, ODFrame* scopeFrame);

   // Modified to open a Cyberdog item
   ODBooleanHandleMouseEvent(Environment* ev, ODEventData* event,
                         ODFacet* facet, ODEventInfo* eventInfo);

   // Modified to handle Cyberdog menus and the Preferences command
   ODBooleanHandleMenuEvent(Environment* ev, ODEventData* event,
                        ODFrame* frame);
   void  PartActivated(Environment* ev, ODFrame* frame);
   void  FocusLost(Environment* ev,ODTypeToken focus, 
                   ODFrame* ownerFrame);
   void  AdjustMenus (Environment* ev, ODFrame* frame);

   ...
private:
   // Added or modified to support Cyberdog
   CyberItem* fCyberItem;        // Reference to Cyberdog item
   CyberServiceMenu* fCyberServiceMenu;// Reference to the Cyberdog
                                 // service menu object
   ODMenuBar* fMenuBar;          // Reference to the menu bar
   ...
}
</PRE>
 The constructor, destructor, and <CODE>Initialize</CODE> and <CODE>ReleaseAll</CODE> methods handle initialization and release or deletion of the Cyberdog objects used in this example. They are described in <A HREF=Cyberdog-24.html#MARKER-9-25>"Initializing and Releasing Cyberdog Objects" (page 94)</A>.<P>
 The <CODE>InitPart</CODE> method handles creating the initial Cyberdog item associated with the button part. The <CODE>InternalizeContent</CODE> and <CODE>ExternalizeContent</CODE> methods read and write Cyberdog items to and from a storage unit. They are described in <A HREF=Cyberdog-25.html#MARKER-9-35>"Reading and Writing Cyberdog Items" (page 98)</A>.<P>
 The <CODE>DragEnter</CODE> and <CODE>Drop</CODE> methods are responsible for handling drag and drop of text or Cyberdog items on the button part. They are described in <A HREF=Cyberdog-25.html#MARKER-9-48>"Supporting Drag and Drop of Cyberdog Items" (page 101)</A>. The <CODE>HandleMouseEvent</CODE> opens the Cyberdog item when the user clicks in the part. It is described in <A HREF=Cyberdog-25.html#MARKER-9-43>"Opening a Cyberdog Item" (page 100)</A>.<P>
 The <CODE>CreateMenus</CODE>, <CODE>CheckMenus</CODE>, <CODE>HandleMenuEvent</CODE>, <CODE>PartActivated</CODE>, <CODE>FocusLost</CODE>, and <CODE>AdjustMenus</CODE> methods handle manipulation of Cyberdog service menus. The <CODE>HandleMenuEvent</CODE> method also initiates the display of the "Cyberdog Preferences" dialog box. For information about setting up Cyberdog menus, see <A HREF=Cyberdog-26.html#MARKER-9-55>"Displaying Cyberdog Menus" (page 105)</A>. For information about implementing the Cyberdog Preferences command, see <A HREF=Cyberdog-27.html#MARKER-9-70>"Implementing the Cyberdog Preferences Command" (page 109)</A>.<P>
 The <CODE>fCyberItem</CODE> field holds a reference to the current Cyberdog item associated with the part. The fCyberServiceMenu field holds a reference to the Cyberdog service menu object. The <CODE>fMenuBar</CODE> field refers to the part's menu bar. Initially, these fields are set to <CODE>kODNULL</CODE>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Cyberdog-22.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Cyberdog-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Cyberdog-319.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Cyberdog-24.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Cyberdog-3.html">&copy; Apple Computer, Inc.</A><br>13 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>   
