<html><head><title>Mac OS X
 Manual Page For Module::Build::Cookbook(3pm)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3pm/Module::Build::Cookbook" title="Mac OS X
 Manual Page for Module::Build::Cookbook(3pm)"><a name="//apple_ref/doc/man/3/Module::Build::Cookbook" title="Mac OS X
 Manual Page for Module::Build::Cookbook(3pm)"><!-- headerDoc=man; indexgroup=Section 3pm; uid="//apple_ref/doc/man/3pm/Module::Build::Cookbook"; name=Module::Build::Cookbook(3pm) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
Module::Build::Cookbook(3)           User Contributed Perl Documentation          Module::Build::Cookbook(3)



<b>NAME</b>
       Module::Build::Cookbook - Examples of Module::Build Usage

<b>DESCRIPTION</b>
       "Module::Build" isn't conceptually very complicated, but examples are always helpful.  I got the idea
       for writing this cookbook when attending Brian Ingerson's "Extreme Programming Tools for Module
       Authors" presentation at YAPC 2003, when he said, straightforwardly, "Write A Cookbook."

       The definitional of how stuff works is in the main "Module::Build" documentation.  It's best to get
       familiar with that too.

<b>BASIC</b> <b>RECIPES</b>
       <b>The</b> <b>basic</b> <b>installation</b> <b>recipe</b> <b>for</b> <b>modules</b> <b>that</b> <b>use</b> <b>Module::Build</b>

       In most cases, you can just issue the following commands:

         perl Build.PL
         ./Build
         ./Build test
         ./Build install

       There's nothing complicated here - first you're running a script called <u>Build.PL</u>, then you're running
       a (newly-generated) script called <u>Build</u> and passing it various arguments.

       The exact commands may vary a bit depending on how you invoke perl scripts on your system.  For
       instance, if you have multiple versions of perl installed, you can install to one particular perl's
       library directories like so:

         /usr/bin/perl5.8.1 Build.PL
         ./Build
         ./Build test
         ./Build install

       If you're on Windows where the current directory is always searched first for scripts, you'll
       probably do something like this:

         perl Build.PL
         Build
         Build test
         Build install

       On the old Mac OS (version 9 or lower) using MacPerl, you can double-click on the <u>Build.PL</u> script to
       create the <u>Build</u> script, then double-click on the <u>Build</u> script to run its "build", "test", and
       "install" actions.

       The <u>Build</u> script knows what perl was used to run "Build.PL", so you don't need to re-invoke the <u>Build</u>
       script with the complete perl path each time.  If you invoke it with the <u>wrong</u> perl path, you'll get
       a warning or a fatal error.

       <b>Making</b> <b>a</b> <b>CPAN.pm-compatible</b> <b>distribution</b>

       New versions of CPAN.pm understand how to use a <u>Build.PL</u> script, but old versions don't.  If you want
       to help users who have old versions, do the following:

       Create a file in your distribution named <u>Makefile.PL</u>, with the following contents:

         use Module::Build::Compat;
         Module::Build::Compat-&gt;run_build_pl(args =&gt; \@ARGV);
         Module::Build::Compat-&gt;write_makefile();

       Now CPAN will work as usual, i.e.: `perl Makefile.PL`, `make`, `make test`, and `make install`,
       provided the end-user already has "Module::Build" installed.

       If the end-user might not have "Module::Build" installed, it's probably best to supply a
       "traditional" <u>Makefile.PL</u>.  The "Module::Build::Compat" module has some very helpful tools for
       keeping a <u>Makefile.PL</u> in sync with a <u>Build.PL</u>.  See its documentation, and also the
       "create_makefile_pl" parameter to the "Module::Build-&gt;new()" method.

       <b>Installing</b> <b>modules</b> <b>using</b> <b>the</b> <b>programmatic</b> <b>interface</b>

       If you need to build, test, and/or install modules from within some other perl code (as opposed to
       having the user type installation commands at the shell), you can use the programmatic interface.
       Create a Module::Build object (or an object of a custom Module::Build subclass) and then invoke its
       "dispatch()" method to run various actions.

         my $build = Module::Build-&gt;new
           (
            module_name =&gt; 'Foo::Bar',
            license     =&gt; 'perl',
            requires    =&gt; { 'Some::Module'   =&gt; '1.23' },
           );
         $build-&gt;dispatch('build');
         $build-&gt;dispatch('test', verbose =&gt; 1);
         $build-&gt;dispatch('install');

       The first argument to "dispatch()" is the name of the action, and any following arguments are named
       parameters.

       This is the interface we use to test Module::Build itself in the regression tests.

       <b>Installing</b> <b>to</b> <b>a</b> <b>temporary</b> <b>directory</b>

       To create packages for package managers like RedHat's "rpm" or Debian's "deb", you may need to
       install to a temporary directory first and then create the package from that temporary installation.
       To do this, specify the "destdir" parameter to the "install" action:

         ./Build install --destdir /tmp/my-package-1.003

       This essentially just prepends all the installation paths with the <u>/tmp/my-package-1.003</u> directory.

       <b>Installing</b> <b>to</b> <b>a</b> <b>non-standard</b> <b>directory</b>

       To install to a non-standard directory (for example, if you don't have permission to install in the
       system-wide directories), you can use the "install_base":

         ./Build install --install_base /foo/bar

       See "INSTALL PATHS" in Module::Build for a much more complete discussion of how installation paths
       are determined.

       <b>Installing</b> <b>in</b> <b>the</b> <b>same</b> <b>location</b> <b>as</b> <b>ExtUtils::MakeMaker</b>

       With the introduction of "--prefix" in Module::Build 0.28 and "INSTALL_BASE" in ExtUtils::MakeMaker
       6.31 its easy to get them both to install to the same locations.

       First, ensure you have at least version 0.28 of Module::Build installed and 6.31 of
       ExtUtils::MakeMaker.  Prior versions have differing installation behaviors.

       The following installation flags are equivalent between ExtUtils::MakeMaker and Module::Build.

           MakeMaker             Module::Build
           PREFIX=...            --prefix ...
           INSTALL_BASE=...      --install_base ...
           DESTDIR=...           --destdir ...
           LIB=...               --install_path lib=...
           INSTALLDIRS=...       --installdirs ...
           INSTALLDIRS=perl      --installdirs core
           UNINST=...            --uninst ...
           INC=...               --extra_compiler_flags ...
           POLLUTE=1             --extra_compiler_flags -DPERL_POLLUTE

       For example, if you are currently installing MakeMaker modules with this command:

           perl Makefile.PL PREFIX=~
           make test
           make install UNINST=1

       You can install into the same location with Module::Build using this:

           perl Build.PL --prefix ~
           ./Build test
           ./Build install --uninst 1

       <u>"prefix"</u> <u>vs</u> <u>"install</u><b>_</b><u>base"</u>

       The behavior of "prefix" is complicated and depends closely on how your Perl is configured.  The
       resulting installation locations will vary from machine to machine and even different installations
       of Perl on the same machine.  Because of this, its difficult to document where "prefix" will place
       your modules.

       In contrast, "install_base" has predictable, easy to explain installation locations.  Now that
       Module::Build and MakeMaker both have "install_base" there is little reason to use "prefix" other
       than to preserve your existing installation locations.  If you are starting a fresh Perl installation
       we encourage you to use "install_base".  If you have an existing installation installed via "prefix",
       consider moving it to an installation structure matching "install_base" and using that instead.

       <b>Running</b> <b>a</b> <b>single</b> <b>test</b> <b>file</b>

       "Module::Build" supports running a single test, which enables you to track down errors more quickly.
       Use the following format:

         ./Build test --test_files t/mytest.t

       In addition, you may want to run the test in verbose mode to get more informative output:

         ./Build test --test_files t/mytest.t --verbose 1

       I run this so frequently that I actually define the following shell alias:

         alias t './Build test --verbose 1 --test_files'

       So then I can just execute "t t/mytest.t" to run a single test.

<b>ADVANCED</b> <b>RECIPES</b>
       <b>Changing</b> <b>the</b> <b>order</b> <b>of</b> <b>the</b> <b>build</b> <b>process</b>

       The "build_elements" property specifies the steps "Module::Build" will take when building a
       distribution.  To change the build order, change the order of the entries in that property:

         # Process pod files first
         my @e = @{$build-&gt;build_elements};
         my $i = grep {$e[$_] eq 'pod'} 0..$#e;
         unshift @e, splice @e, $i, 1;

       Currently, "build_elements" has the following default value:

         [qw( PL support pm xs pod script )]

       Do take care when altering this property, since there may be non-obvious (and non-documented!)
       ordering dependencies in the "Module::Build" code.

       <b>Adding</b> <b>new</b> <b>file</b> <b>types</b> <b>to</b> <b>the</b> <b>build</b> <b>process</b>

       Sometimes you might have extra types of files that you want to install alongside the standard types
       like <u>.pm</u> and <u>.pod</u> files.  For instance, you might have a <u>Bar.dat</u> file containing some data related to
       the "Foo::Bar" module.  Assuming the data doesn't need to be created on the fly, the best place for
       it to end up is probably as <u>Foo/Bar.dat</u> somewhere in perl's @INC path so "Foo::Bar" can access it
       easily at runtime.  The following code from a sample "Build.PL" file demonstrates how to accomplish
       this:

         use Module::Build;
         my $build = Module::Build-&gt;new
           (
            module_name =&gt; 'Foo::Bar',
            ...other stuff here...
           );
         $build-&gt;add_build_element('dat');
         $build-&gt;create_build_script;

       This will find all <u>.dat</u> files in the <u>lib/</u> directory, copy them to the <u>blib/lib/</u> directory during the
       "build" action, and install them during the "install" action.

       If your extra files aren't in the "lib/" directory, you can explicitly say where they are, just as
       you'd do with <u>.pm</u> or <u>.pod</u> files:

         use Module::Build;
         my $build = new Module::Build
           (
            module_name =&gt; 'Foo::Bar',
            dat_files =&gt; {'some/dir/Bar.dat' =&gt; 'lib/Foo/Bar.dat'},
            ...other stuff here...
           );
         $build-&gt;add_build_element('dat');
         $build-&gt;create_build_script;

       If your extra files actually need to be created on the user's machine, or if they need some other
       kind of special processing, you'll probably want to create a special method to do so, named
       "process_${kind}_files()":

         use Module::Build;
         my $class = Module::Build-&gt;subclass(code =&gt; &lt;&lt;'EOF');
           sub process_dat_files {
             my $self = shift;
             ... locate and process *.dat files,
             ... and create something in blib/lib/
           }
         EOF
         my $build = $class-&gt;new
           (
            module_name =&gt; 'Foo::Bar',
            ...other stuff here...
           );
         $build-&gt;add_build_element('dat');
         $build-&gt;create_build_script;

       If your extra files don't go in <u>lib/</u> but in some other place, see "Adding new elements to the install
       process" for how to actually get them installed.

       Please note that these examples use some capabilities of Module::Build that first appeared in version
       0.26.  Before that it could certainly still be done, but the simple cases took a bit more work.

       <b>Adding</b> <b>new</b> <b>elements</b> <b>to</b> <b>the</b> <b>install</b> <b>process</b>

       By default, Module::Build creates seven subdirectories of the <u>blib/</u> directory during the build
       process: <u>lib/</u>, <u>arch/</u>, <u>bin/</u>, <u>script/</u>, <u>bindoc/</u>, <u>libdoc/</u>, and <u>html/</u> (some of these may be missing or
       empty if there's nothing to go in them).  Anything copied to these directories during the build will
       eventually be installed during the "install" action (see "INSTALL PATHS" in Module::Build.

       If you need to create a new type of installable element, e.g. "conf", then you need to tell
       Module::Build where things in <u>blib/conf/</u> should be installed.  To do this, use the "install_path"
       parameter to the "new()" method:

         my $build = Module::Build-&gt;new
           (
            ...other stuff here...
            install_path =&gt; { conf =&gt; $installation_path }
           );

       Or you can call the "install_path()" method later:

         $build-&gt;install_path-&gt;{conf} || $installation_path;

       (Sneakily, or perhaps uglily, "install_path()" returns a reference to a hash of install paths, and
       you can modify that hash to your heart's content.)

       The user may also specify the path on the command line:

         perl Build.PL --install_path conf=/foo/path/etc

       The important part, though, is that <u>somehow</u> the install path needs to be set, or else nothing in the
       <u>blib/conf/</u> directory will get installed.

       See also "Adding new file types to the build process" for how to create the stuff in <u>blib/conf/</u> in
       the first place.

<b>EXAMPLES</b> <b>ON</b> <b>CPAN</b>
       Several distributions on CPAN are making good use of various features of Module::Build.  They can
       serve as real-world examples for others.

       <b>SVN-Notify-Mirror</b>

       &lt;<a href="http://search.cpan.org/~jpeacock/SVN-Notify-Mirror/">http://search.cpan.org/~jpeacock/SVN-Notify-Mirror/</a>

       John Peacock, author of the "SVN-Notify-Mirror" distribution, says:

       1. Using "auto_features", I check to see whether two optional modules are available -<font color="#ffffff" class="whiteout">SVN::Notify::Config&nbsp;availableSVN::Notify::Config</font>
       SVN::Notify::Config and Net::SSH;
       2. If the S::N::Config module is loaded, I automatically generate testfiles for it during Build
       (using the "PL_files" property).
       3. If the "ssh_feature" is available, I ask if the user wishes to perform the ssh tests (since it
       requires a little preliminary setup);
       4. Only if the user has "ssh_feature" and answers yes to the testing, do I generate a test file.
           I'm sure I could not have handled this complexity with EU::MM, but it was very easy to do with
           M::B.

       <b>Modifying</b> <b>an</b> <b>action</b>

       Sometimes you might need an to have an action, say "./Build install", do something unusual.  For
       instance, you might need to change the ownership of a file or do something else peculiar to your
       application.

       You can subclass "Module::Build" on the fly using the "subclass()" method and override the methods
       that perform the actions. You may need to read through "Module::Build::Authoring" to find the methods
       you want to override, but the general pattern is "ACTION_" followed by the name of the action you
       want to modify.  Here's an example of how it would work for "install":

         # Build.PL
         use Module::Build;
         my $class = Module::Build-&gt;subclass(
             class =&gt; "Module::Build::Custom",
             code =&gt; &lt;&lt;'SUBCLASS' );

         sub ACTION_install {
             my $self = shift;
             # YOUR CODE HERE
             $self-&gt;SUPER::ACTION_install;
         }
         SUBCLASS

         $class-&gt;new(
             module_name =&gt; 'Your::Module',
             # rest of the usual Module::Build parameters
         )-&gt;create_build_script;

       See the Module::Build::Authoring pod in 0.27 or above for more complete documentation on this.

<b>AUTHOR</b>
       Ken Williams &lt;kwilliams@cpan.org&gt;

<b>COPYRIGHT</b>
       Copyright (c) 2001-2006 Ken Williams.  All rights reserved.

       This library is free software; you can redistribute it and/or modify it under the same terms as Perl
       itself.

<b>SEE</b> <b>ALSO</b>
       <a href="../man1/perl.1.html#//apple_ref/doc/man/1/perl"><u>perl</u>(1)</a>, <a href="Module__Build.3pm.html#//apple_ref/doc/man/3/Module::Build">Module::Build(3)</a>, <a href="Module__Build__Authoring.3pm.html#//apple_ref/doc/man/3/Module::Build::Authoring">Module::Build::Authoring(3)</a>, <a href="Module__Build__API.3pm.html#//apple_ref/doc/man/3/Module::Build::API">Module::Build::API(3)</a>

<b>POD</b> <b>ERRORS</b>
       Hey! <b>The</b> <b>above</b> <b>document</b> <b>had</b> <b>some</b> <b>coding</b> <b>errors,</b> <b>which</b> <b>are</b> <b>explained</b> <b>below:</b>

       Around line 378:
           =back doesn't take any parameters, but you said =back 4



perl v5.8.8                                      2007-09-23                       Module::Build::Cookbook(3)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/Module__Build__Cookbook.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/Module__Build__Cookbook.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/Module__Build__Cookbook.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
