<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>MyCMMatchColors(IM: ACI Ref)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING320></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="ACIReference-319.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACIReference-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACIReference-371.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACIReference-321.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="ACIReference-2.html"><B>Advanced Color Imaging Reference</B></A> / <BR><DD><A HREF="ACIReference-314.html"><B>Chapter 4 - ColorSync Manager Reference for Color Management Modules</B></A> / <A HREF="ACIReference-318.html"><B>Required CMM-Defined Functions</B></A><BR><DL><DD><A HREF="ACIReference-308.html"><B></B></A> / <A HREF="ACIReference-317.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING320-0></A>
<H3><A NAME=MARKER-9-38></A>MyCMMatchColors</H3>
 Handles the <CODE>kCMMMatchColors</CODE> request by matching the specified colors to the gamut of the destination profile.<P>
 A CMM must <A NAME=MARKER-2-39></A>respond to the <CODE>kCMMMatchColors</CODE> request code. The ColorSync Manager sends this request code to your CMM on behalf of an application or device driver that called the <CODE>CWMatchColors</CODE> function or high-level QuickDraw operations. <P>
 The ColorSync Manager dispatches this request to the Component Manager, which calls your CMM to service the request. A CMM typically responds to the <CODE>kCMMMatchColors</CODE> request code by calling a CMM-defined function (for example, <A NAME=MARKER-11-40></A><CODE>MyCMMatchColors</CODE>) to handle the request by matching colors in the color list. <P>
 The MyCMMatchColors function is a color management module-defined subroutine.<P>
<PRE>
pascal CMError MyCMMatchColors (
ComponentInstance CMSession,
CMColor *myColors,
unsigned long count); 
</PRE>
<DL>
<DT><CODE>CMSession</CODE>
<DD> A handle to your CMM's storage for the instance of your component associated with the calling application or device driver. 
<DT><CODE>myColors</CODE>
<DD> A pointer to a color union array <A HREF=ACIReference-208.html#MARKER-9-294>(page 3-57)</A> specified by the calling application or device driver. On input, this array contains the list of colors to match. The color values are given in the data color space of the source profile specified by a previous <CODE>kNCMMInit</CODE> or <CODE>kCMMConcatInit</CODE> request to your CMM. On output, this array contains the list of matched colors specified by your function in the data color space of the destination profile. For a description of the <CODE>CMColor</CODE> data type, see <A HREF=ACIReference-208.html#MARKER-9-294>"The Color Union" (page 3-57)</A>.
<DT><CODE>count</CODE>
<DD> A one-based count of the number of colors in the color list of the <CODE>CMColor</CODE> array.
<DT><I>function result</I>
<DD> A result code of type CMError. See <A HREF=ACIReference-313.html#MARKER-9-479>"Result Codes" (page 3-172)</A> for a list of ColorSync-specific result codes.
</DL>
<A NAME=HEADING320-10></A>
<H5>DISCUSSION</H5>
 Before the Component Manager calls your CMM with a ColorSync request to match colors, it calls your CMM with a <CODE>kNCMMInit</CODE>, <CODE>kCMMInit</CODE>, or <CODE>kCMMConcatInit </CODE>request, passing your CMM references to the profiles to use for the color-matching session and requesting your CMM to initialize the session.<P>
 If the Component Manager calls your CMM with a ColorSync <CODE>kNCMMInit</CODE> or <CODE>kCMMInit</CODE> request code, it passes references to the source and destination profiles to use for the color-matching session. If it calls your CMM with the ColorSync <CODE>kCMMConcatInit</CODE> request code, it passes a pointer to an array of type <CODE>ConcatProfileSet</CODE> containing a set of profiles or a device-linked profile specified by the calling application to use for the color-matching session. For information about the <CODE>ConcatProfileSet</CODE> data type, see <A HREF=ACIReference-189.html#MARKER-9-250>"Concatenated Profile Set Structure" (page 3-46)</A>.<P>
 When the Component Manager calls your CMM with the <CODE>kCMMMatchColors</CODE> request code, it passes to your CMM in the <CODE>CMSession</CODE> parameter a handle to your CMM's storage for the calling applications's component instance. <P>
 In response to this request code, you must support 16-bit components for color spaces other than multichannel components and 8-bit components for HiFi colors. <P>
 Using the profile data you set in your storage for this component instance, your <CODE>MyCMMatchColors</CODE> function should match the colors specified in the <CODE>myColors</CODE> array to the color gamut of the destination profile, replacing the color value specifications in the <CODE>myColors</CODE> array with the matched colors specified in the data color space of the destination profile. If you used some other method to store profile data for this component instance when you initialized the session, you should obtain the profile data you require for the color matching from that storage. The color list may contain multichannel color data types, so your CMM must support them. <P>
 For a color-matching session with a named color space profile and other profiles, the named color profile must be first in the color world. A color world of this type cannot be used with bitmap or pixel map functions--it can only be used with a function such as MyCMMatchColors, with the <CODE>myColors</CODE> color list containing the named color indexes. For more information on the rules governing the types of profiles you can specify in a profile array, see the following sections:<P>
<UL>
<LI><A HREF=ACIReference-188.html#MARKER-9-246>"Profile Header Structure for ColorSync 1.0" (page 3-44)</A>
<LI><A HREF=ACIReference-258.html#MARKER-9-391>"NCWNewColorWorld" (page 3-106)</A>
<LI><A HREF=ACIReference-259.html#MARKER-9-394>"CWConcatColorWorld" (page 3-108)</A>
<LI><A HREF=ACIReference-260.html#MARKER-9-396>"CWNewLinkProfile" (page 3-110)</A><P>
</UL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="ACIReference-319.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACIReference-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACIReference-371.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACIReference-321.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="ACIReference-3.html">&copy; Apple Computer, Inc.</A><br>11 NOV 1996<P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML> 
