<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickDraw Text Reference (Not Recommended): Deprecated QuickDraw Text Reference (Not Recommended) Functions</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Deprecated QuickDraw Text Reference (Not Recommended) Functions"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000026-AppendixA" title="Deprecated QuickDraw Text Reference (Not Recommended) Functions"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../../reference/Carbon/index.html#//apple_ref/doc/uid/TP30001281-TP30000420" target="_top">Carbon</a> &gt; <a href="../../../../../reference/Carbon/idxTextFonts-date.html#//apple_ref/doc/uid/TP30001281-TP30000420-TP30000461" target="_top">Text &amp; Fonts</a> &gt; <a href="../index.html" target="_top">QuickDraw Text Reference (Not Recommended)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Reference/reference.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../qdtext_ref_docrevhist/qdtext_ref_docrevhist.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <h1>Deprecated QuickDraw Text Reference (Not Recommended) Functions</h1><p>A function identified as deprecated has been superseded and may become unsupported in the future.</p><a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_79" title="Deprecated in Mac OS X v10.4"></a><h2>Deprecated in Mac OS X v10.4</h2><a name="//apple_ref/c/func/CharExtra" title="CharExtra"></a><a name="//apple_ref/doc/c_ref/CharExtra" title="CharExtra"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F00485" title="CharExtra"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_7"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_7"></a><h3 class="tight">CharExtra</h3>
<p class="spaceabove">Specifies, for a color graphics port (<code>CGrafPort</code>), the number of pixels by which to widen (or narrow) the glyphs of each nonspace character in a style run.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
void CharExtra (
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> extra
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>extra</em></dt>
<dd><p>The amount (in pixels or decimal fractions of a pixel) to widen (or narrow) each glyph other than the space character in a range of text.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>CharExtra</code> function sets the value of the <code>chExtra</code> field of the color graphics port structure. This field contains a number that is in 4.12 fractional notation: four bits of signed integer followed by 12 bits of fraction. The <code>CharExtra</code> function uses the value of the <code>txSize</code> field, so you must call <code>TextSize</code> to set the font size of the text before you call <code>CharExtra</code>.</p>
<p>The initial setting is 0. You can pass a negative value for the <code>extra</code> parameter, but be careful not to narrow glyphs so much that the text is unreadable. The measuring and drawing functions use the value in this field when an application calls them to measure or draw text. The <code>CharExtra</code> function is available only for color graphic ports.</p>
<p>Do not use <code>CharExtra</code> for script systems that include zero-width characters, such as diacritical marks, because intercharacter space is added to all glyphs, separating the diacritical mark from the glyph of the character. Do not use it for script systems that include contextual forms, such as ligatures or conjunct characters, which would not be represented properly were intercharacter space added to these glyphs. For example, you should not use <code>CharExtra</code> for the Devanagari or Arabic languages, whose text is drawn as connected glyphs, or with the Sonata font because it includes zero-width characters.</p>
<p>The 2-byte script systems use the <code>chExtra</code> field value properly.</p>
<p>To ensure future compatibility and benefit from any enhancements, always use this function to modify the <code>chExtra</code> field, rather than directly change the field value. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/CharToPixel" title="CharToPixel"></a><a name="//apple_ref/doc/c_ref/CharToPixel" title="CharToPixel"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F00486" title="CharToPixel"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_8"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_8"></a><h3 class="tight">CharToPixel</h3>
<p class="spaceabove">Returns the screen pixel width from the left edge of a text segment to the glyph of the character whose byte offset you specify.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
short CharToPixel (
   <!--a-->Ptr<!--/a--> textBuf,
   long textLength,
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> slop,
   long offset,
   short direction,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/JustStyleCode">JustStyleCode</a> styleRunPosition,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> numer,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> denom
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textBuf</em></dt>
<dd><p>A pointer to the beginning of the text segment.</p></dd>
<dt><em>textLength</em></dt>
<dd><p>The length in bytes of the entire text segment pointed to by <code>textBuf</code>. The <code>CharToPixel</code> function requires the context of the complete text in order to determine the correct value. </p></dd>
<dt><em>slop</em></dt>
<dd><p>The amount of slop for the text to be drawn. A positive value extends the text segment; a negative value condenses the text segment.</p><p>The value of this parameter is the number of pixels by which the width of the text segment is to be changed, after the text has been scaled. The <code>slop</code> is a signed value that specifies how smuch the text is to be extended or condensed. The <code>slop</code> is derived from the calculations made using the proportion returned from the <code>PortionLine</code> function for a style run. To measure or draw text that is not to be extended or condensed, pass a <code>slop</code> value of 0.</p></dd>
<dt><em>offset</em></dt>
<dd><p>The offset from <code>textBuf</code> to the character within the text segment whose display pixel location is to be measured. For 2-byte script systems, if the character whose position is to be measured is 2 bytes long, this is the offset of the first byte.</p></dd>
<dt><em>direction</em></dt>
<dd><p>This parameter specifies whether <code>CharToPixel</code> is to return the caret position for a character with a direction of left-to-right or right-to-left. A direction value of <code>hilite</code> indicates that <code>CharToPixel</code> is to use the caret position for the character direction that matches the primary line direction as specified by the <code>SysDirection</code> global variable. </p></dd>
<dt><em>styleRunPosition</em></dt>
<dd><p>The position on the line of this style run. The style run can be the only one on the line, the leftmost on the line, the rightmost on the line, or one between two other style runs.</p><p>This parameter specifies the position of the style run on the display line. It is used to determine the proportion of total slop to apply to a style run, measure or draw a line of justified text, identify where to break a line of text, and determine the caret position to mark an insertion point or highlight text.</p><p>The style run position parameter is meaningful only for those script systems that use intercharacter spacing for justification. For all other script systems, the parameter exists for future extensibility. Although the style run position parameter is not used, for example, for justifying text in the Roman script system, to allow for future compatibility, you should always specify the appropriate value for it for all calls that take it.</p><p>For those script systems that do use intercharacter spacing, space between style runs may be allocated differently depending upon whether the style run is leftmost, rightmost, or between two other style runs. For example, depending on the script system, if a style run occurs at the beginning or end of a line, extra space may not be added to the outer edge of the outermost glyph, whereas if a style run is interior to a line, all of the glyphs of the text may be treated the same: extra space is allocated to both sides of every glyph including those at either end of the style run.</p><p>The current implementations of simple script systems such as Roman and Cyrillic do not justify a line of text by changing the width of nonspace characters. Instead, they rely solely on the use of space characters: the same amount of extra width is added to (or subtracted from) every space whether the space is at the beginning or end of the line or interior to it.</p><p>See <span class="content_text"><a href="../Reference/reference.html#//apple_ref/c/tdef/JustStyleCode">“Style Run Position Constants”</a></span> for a list of the constants you can supply.</p></dd>
<dt><em>numer</em></dt>
<dd><p>A point giving the numerator for the horizontal and vertical scaling factors.</p><p>Both <code>numer</code> and <code>denom</code> are point values: <code>numer</code> specifies the numerator for the horizontal and vertical scaling factors, and <code>denom</code> specifies the denominator for the horizontal and vertical scaling factors. Together, these values specify the scaling factors for the text: <code>numer.v</code> over <code>denom.v</code> gives the vertical scaling (height), and <code>numer.h</code> over <code>denom.h</code> gives the horizontal scaling factors (width). You need to specify values for <code>numer</code> and <code>denom</code> even if you are not scaling the text. For unscaled text, you can specify scaling factors of 1, 1.</p></dd>
<dt><em>denom</em></dt>
<dd><p>A point giving the denominator for the horizontal and vertical scaling factors.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>The screen pixel width from the left edge of a text segment to the glyph of the character whose byte offset you specify. </p>
<h5 class="tight">Discussion</h5>
<p>You use <code>CharToPixel</code> to find the onscreen pixel location at which to draw a caret and to identify the selection points for highlighting. The <code>CharToPixel</code> function returns the horizontal distance in pixels from the start of the range of text beginning with the byte offset at <code>textBuf</code> to the glyph corresponding to the character whose byte offset is specified by the <code>offset</code> parameter. The pixel location is relative to the beginning of the text segment, not the left margin of the display line. To get the actual display line pixel location of the glyph relative to the left margin, you add the pixel value that <code>CharToPixel</code> returns to the pixel location at the end of the previous style run (on the left) in display order. In other words, you need to know the length of the text in pixels on the display line up to the beginning of the range of text that you call <code>CharToPixel</code> for, and then you add in the screen pixel width that <code>CharToPixel</code> returns.</p>
<p>You specify a value for <code>textLen</code> that is equal to the entire visible part of the style run on a line and includes trailing spaces if and only if they are displayed. They may not be displayed, for example, for the last style run in memory order, which is part of the line. Do not confuse the <code>textLen</code> parameter with the <code>offset</code>, which is the byte offset of the character within the text segment whose pixel location <code>CharToPixel</code> is to return.</p>
<p>If you use <code>CharToPixel</code> to get a caret position to mark the insertion point, you specify a value of <code>leftCaret</code> or <code>rightCaret</code> for the <code>direction</code> parameter. You can use the value of the <code>PixelToChar </code><code>leadingEdge</code> flag to determine the <code>direction</code> parameter value.</p>
<p>If the <code>leadingEdge</code> flag is <code>FALSE</code>, you base the value of the <code>direction</code> parameter on the direction of the character at the byte offset in memory that precedes the one that <code>PixelToChar</code> returns; if <code>leadingEdge</code> is <code>TRUE</code>, you base the value of the <code>direction</code> parameter on the direction of the character at the byte offset that <code>PixelToChar</code> returns. If there isn’t a character at the byte offset, you base the value of the <code>direction</code> parameter on the primary line direction as determined by the <code>SysDirection</code> global variable.</p>
<p>Be sure to pass the same values for <code>styleRunPosition</code> and the scaling factors ( <code>numer</code> and <code>denom</code>) to <code>CharToPixel</code> that you pass to any of the other justification functions for this style run.</p>
<p>The <code>CharToPixel</code> function works with text in all script systems. For 1-byte contextual script systems, <code>CharToPixel</code> calculates the widths of any ligatures, reversals, and compound characters that need to be drawn.</p>
<p>Note that <code>textLen</code> is the number of bytes to be drawn, not the number of characters. Because 2-byte script systems also include characters consisting of only one byte, do not simply multiply the number of characters by 2 to determine this value; you must determine and specify the correct number of bytes. </p>
<h5 class="tight">Special Considerations</h5>
<p>The <code>CharToPixel</code> function may move memory; do not call this function at interrupt time.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/CharWidth" title="CharWidth"></a><a name="//apple_ref/doc/c_ref/CharWidth" title="CharWidth"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F00488" title="CharWidth"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_9"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_9"></a><h3 class="tight">CharWidth</h3>
<p class="spaceabove">Returns the width (horizontel extension), in pixels, of the specified character.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
short CharWidth (
   <!--a-->CharParameter<!--/a--> ch
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>ch</em></dt>
<dd><p>The character whose width is to be measured. </p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>The width (horizontel extension), in pixels, of the specified character. </p>
<h5 class="tight">Discussion</h5>
<p>The <code>CharWidth</code> function includes the effects of the stylistic variations for the text set in the current graphics port. If you change any of these attributes after determining the glyph width but before actually drawing it, the predetermined width may not be correct. For a space character, <code>CharWidth</code> also includes the effect of <code>SpaceExtra</code>. For a nonspace character, <code>CharWidth</code> includes the effect of <code>CharExtra</code>.</p>
<p>Because it takes a single-byte value as the <code>ch</code> parameter, <code>CharWidth</code> works only for 1-byte simple script systems.</p>
<p>A series of calls to <code>CharWidth</code> in a contextual 1-byte font may give incorrect results, because the width of a text segment may be different from the sum of its individual character widths. In that case, to measure a line of text you should call <code>TextWidth</code>.</p>
<p>Do not use the <code>CharWidth</code> function for 2-byte script systems. If you want to measure the width of a single glyph in a 2-byte font, you should use <code>TextWidth</code>. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/DisposeStyleRunDirectionUPP" title="DisposeStyleRunDirectionUPP"></a><a name="//apple_ref/doc/c_ref/DisposeStyleRunDirectionUPP" title="DisposeStyleRunDirectionUPP"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F11465" title="DisposeStyleRunDirectionUPP"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_10"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_10"></a><h3 class="tight">DisposeStyleRunDirectionUPP</h3>
<p class="spaceabove">Disposes of a universal procedure pointer (UPP) to a style run direction callback.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI to handle style runs.)</p>
<p class="spaceabove"><pre>
void DisposeStyleRunDirectionUPP (
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/StyleRunDirectionUPP">StyleRunDirectionUPP</a> userUPP
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>userUPP</em></dt>
<dd><p> </p> </dd></dl><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/DrawChar" title="DrawChar"></a><a name="//apple_ref/doc/c_ref/DrawChar" title="DrawChar"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F01264" title="DrawChar"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_11"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_11"></a><h3 class="tight">DrawChar</h3>
<p class="spaceabove">Draws the glyph for a single 1-byte character at the current pen location in the current graphics port.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p class="spaceabove"><pre>
void DrawChar (
   <!--a-->CharParameter<!--/a--> ch
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>ch</em></dt>
<dd><p>The character code whose glyph is to be drawn. </p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>DrawChar</code> function draws a single character’s glyph and then advances the pen by the width of the glyph. If the glyph isn’t in the font, the font’s missing symbol is drawn. </p>
<p>If you’re drawing more than one character, it’s faster to make one <code>DrawString</code> or <code>DrawText</code> call rather than a series of <code>DrawChar</code> calls.</p>
<p>Because it takes a single-byte value as the <code>ch</code> parameter, <code>DrawChar</code> works only for 1-byte script systems. If you want to draw the glyph of a single character in a 2-byte script, call either <code>DrawText</code>, <code>DrawString</code>, or <code>DrawJustified</code>.</p>
<p>A series of calls to <code>DrawChar</code> in a 1-byte complex script system can give incorrect results because a text string is not always a simple concatenation of a series of characters. In a contextual script, two different glyphs may be used to represent a single character in its contextual form and alone. To draw a sequence of text in a 1-byte complex script system, use <code>DrawText</code>, <code>DrawString</code>, or <code>DrawJustified</code> instead.</p>
<p>For 1-byte complex scripts, you can use <code>DrawChar</code> for special purposes, such as to include the isolated glyph of a character in a book’s index, for example, to show a single glyph as it exists apart from contextual transformations. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/DrawJustified" title="DrawJustified"></a><a name="//apple_ref/doc/c_ref/DrawJustified" title="DrawJustified"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F01270" title="DrawJustified"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_12"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_12"></a><h3 class="tight">DrawJustified</h3>
<p class="spaceabove">Draws the specified text at the current pen location in the current graphics port, taking into account the adjustment necessary to condense or extend the text by the slop value, appropriately for the script system.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
void DrawJustified (
   <!--a-->Ptr<!--/a--> textPtr,
   long textLength,
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> slop,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/JustStyleCode">JustStyleCode</a> styleRunPosition,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> numer,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> denom
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textPtr</em></dt>
<dd><p>A pointer to the memory location of the beginning of the text to be drawn. </p></dd>
<dt><em>textLength</em></dt>
<dd><p>The number of bytes of text to be drawn.</p><p>Note that <code>textLength</code> is the number of bytes to be drawn, not the number of characters. Because 2-byte script systems also include characters consisting of only 1 byte, do not simply multiply the number of characters by 2 to determine this value; you must determine and specify the correct number of bytes.</p></dd>
<dt><em>slop</em></dt>
<dd><p>The amount of slop for the text to be drawn. A positive value extends the text segment; a negative value condenses the text segment. Pass the value assessed for this style run based on the proportion returned for it from <code>PortionLine</code>.</p><p>The value of this parameter is the number of pixels by which the width of the text segment is to be changed, after the text has been scaled. The <code>slop</code> is a signed value that specifies how much the text is to be extended or condensed. The <code>slop</code> is derived from the calculations made using the proportion returned from the <code>PortionLine</code> function for a style run. To measure or draw text that is not to be extended or condensed, pass a <code>slop</code> value of 0.</p></dd>
<dt><em>styleRunPosition</em></dt>
<dd><p>The position on the line of this style run. The style run can be the only one on the line, the leftmost on the line, the rightmost on the line, or one between two other style runs. Be sure to pass the same value that you pass to <code>PortionLine</code>.</p><p>This parameter specifies the position of the style run on the display line. It is used to determine the proportion of total slop to apply to a style run, measure or draw a line of justified text, identify where to break a line of text, and determine the caret position to mark an insertion point or highlight text.</p><p>The style run position parameter is meaningful only for those script systems that use intercharacter spacing for justification. For all other script systems, the parameter exists for future extensibility. Although the style run position parameter is not used, for example, for justifying text in the Roman script system, to allow for future compatibility, you should always specify the appropriate value for it for all calls that take it.</p><p>For those script systems that do use intercharacter spacing, space between style runs may be allocated differently depending upon whether the style run is leftmost, rightmost, or between two other style runs. For example, depending on the script system, if a style run occurs at the beginning or end of a line, extra space may not be added to the outer edge of the outermost glyph, whereas if a style run is interior to a line, all of the glyphs of the text may be treated the same: extra space is allocated to both sides of every glyph including those at either end of the style run.</p><p>The current implementations of simple script systems such as Roman and Cyrillic do not justify a line of text by changing the width of nonspace characters. Instead, they rely solely on the use of space characters: the same amount of extra width is added to (or subtracted from) every space whether the space is at the beginning or end of the line or interior to it.</p><p>See <span class="content_text"><a href="../Reference/reference.html#//apple_ref/c/tdef/JustStyleCode">“Style Run Position Constants”</a></span> for a list of the constants you can supply.</p></dd>
<dt><em>numer</em></dt>
<dd><p>A point giving the numerator for the horizontal and vertical scaling factors.</p><p>Both numer and denom are point values: numer specifies the numerator for the horizontal and vertical scaling factors, and denom specifies the denominator for the horizontal and vertical scaling factors. Together, these values specify the scaling factors for the text: numer.v over denom.v gives the vertical scaling (height), and numer.h over denom.h gives the horizontal scaling factors (width). You need to specify values for numer and denom even if you are not scaling the text. For unscaled text, you can specify scaling factors of 1, 1. Be sure to pass the same value that you pass to <code>PortionLine</code>.</p></dd>
<dt><em>denom</em></dt>
<dd><p>A point giving the denominator for the horizontal and vertical scaling factors. Be sure to pass the same value that you pass to <code>PortionLine</code>.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>DrawJustified</code> function is similar to the <code>DrawText</code> function, except that you use it to draw text that is expanded or condensed by the number of pixels specified by <code>slop</code>. The <code>DrawJustified</code> function is most commonly used to draw a line of justified text.</p>
<p>The <code>DrawJustified</code> function draws the specified text in the font, size, and style of the current graphics port, taking into account any scaling factors, and it distributes the slop appropriately for the script system. Regardless of the line direction of the text to be drawn, you place the pen at the left edge of the line before calling <code>DrawJustified</code> for the first style run. For all subsequent style runs on that line, QuickDraw advances the pen appropriately.</p>
<p>If <code>DrawJustified</code> changes the width of spaces, it temporarily resets the space extra ( <code>spExtra</code>) value. It adds to the current value of the field, if any, the amount of extra space to be applied to each space character within the range of text in order to justify the text, based on calculations that take into account the slop value and all of the text characteristics. On exit, <code>DrawJustified</code> restores the original value.</p>
<p>The <code>DrawJustifie</code> d function works with text in all script systems. For example, to depict justified Arabic text, <code>DrawJustified</code> uses extension bars to create the additional width that is distributed as slop within a style run.</p>
<p>For 1-byte complex script systems, <code>DrawJustified</code> substitutes the proper ligatures, reversals, and compound characters as needed.</p>
<p>For 2-byte script systems that do not use space characters to delimit words, <code>DrawJustified</code> distributes the slop value in a manner appropriate to the script system. For script systems, such as Japanese, that use ideographic characters, <code>DrawJustified</code> distributes the additional screen pixel width appropriately for the text representation.</p>
<h5 class="tight">Special Considerations</h5>
<p>The <code>DrawJustified</code> function may move memory; do not call this function at interrupt time.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/DrawString" title="DrawString"></a><a name="//apple_ref/doc/c_ref/DrawString" title="DrawString"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F01276" title="DrawString"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_13"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_13"></a><h3 class="tight">DrawString</h3>
<p class="spaceabove">Draws the text of the specified Pascal string at the pen location in the current graphics port (<code>GrafPort</code> or <code>CGrafPort</code>).&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p class="spaceabove"><pre>
void DrawString (
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/ConstStr255Param" target="_top">ConstStr255Param</a> s
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>s</em></dt>
<dd><p>A Pascal string consisting of the text to be drawn. </p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>DrawString</code> function draws the string with its left edge at the current pen location, extending right. The final position of the pen location, after the text is drawn, is to the right of the rightmost glyph in the string. QuickDraw does not do any formatting, such as handling of carriage returns or line feeds.</p>
<p>Note that you can use <code>DrawString</code> only for a Pascal string containing a single style run.</p>
<p>QuickDraw temporarily stores on the stack all of the text you ask it to draw, even if the text is to be clipped. When drawing large font sizes or complex style variations, draw only what is visible on the screen. You can determine the number of characters whose corresponding glyphs actually fit on the screen by calling the <code>StringWidth</code> function to determine the length of the string before calling <code>DrawString</code>.</p>
<p>If you specify values in the graphics port <code>spExtra</code> or <code>chExtra</code> fields to change the width of space or nonspace characters, <code>DrawString</code> takes these values into account.</p>
<p>For right-to-left text, such as Hebrew or Arabic, QuickDraw draws the final (leftmost) glyph first, then moves to the right through all the glyphs, drawing the initial (rightmost) glyph last.</p>
<p>Note that you should not change the width of nonspace characters for 1-byte simple script systems with zero-width characters or 1-byte complex script systems. For more information, see  <code><a href="AppendixADeprecatedAPI.html#//apple_ref/c/func/CharExtra">CharExtra</a></code>.</p>
<p>For contextual script systems, <code>DrawString</code> substitutes the proper ligatures, reversals, and compound characters as needed. Inside a picture definition, <code>DrawString</code> can’t have a <code>byteCount</code> greater than 255. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/HideMenuBar/index.html#//apple_ref/doc/uid/DTS10000577" target="_top">HideMenuBar</a></span></li><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/Simple_DrawSprocket/index.html#//apple_ref/doc/uid/DTS10000169" target="_top">Simple DrawSprocket</a></span></li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/DrawText" title="DrawText"></a><a name="//apple_ref/doc/c_ref/DrawText" title="DrawText"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F01277" title="DrawText"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_14"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_14"></a><h3 class="tight">DrawText</h3>
<p class="spaceabove">Draws the specified text at the current pen location in the current graphics port.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p class="spaceabove"><pre>
void DrawText (
   const void * textBuf,
   short firstByte,
   short byteCount
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textBuf</em></dt>
<dd><p>A pointer to a buffer containing the text to be drawn. </p></dd>
<dt><em>firstByte</em></dt>
<dd><p>An offset from the start of the text buffer (<code>textBuf</code>) to the first byte of the text to be drawn. </p></dd>
<dt><em>byteCount</em></dt>
<dd><p>The number of bytes of text to be drawn. Inside a picture definition, <code>DrawText</code> cannot have a <code>byteCount</code> greater than 255.</p><p>For 2-byte script systems, note that <code>byteCount</code> is the number of bytes to be drawn, not the number of glyphs. Because 2-byte script systems also include characters consisting of only 1 byte, do not simply multiply the number of characters by 2 to determine this value; you must determine and specify the correct number of bytes.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>DrawText</code> function draws the text with the leftmost glyph at the current pen location, extending right. After QuickDraw draws the text, it sets the pen location to the right of the rightmost glyph.</p>
<p>QuickDraw temporarily stores on the stack all of the text you ask it to draw, even if the text is to be clipped. When drawing a range of text, it’s best to draw only what is visible on the screen. If an entire text string does not fit on a line, truncate the text at a word boundary. If possible, avoid truncating within a style run. You can determine the number of characters whose glyphs actually fit on the screen by calling the <code>TextWidth</code> function before calling <code>DrawText</code>.</p>
<p>If you specify values in the graphics port <code>spExtra</code> and <code>chExtra</code> fields to change the width of nonspace and space characters, both <code>TextWidth</code> and <code>DrawText</code> take these values into account.</p>
<p>For 1-byte complex script systems, <code>DrawText</code> substitutes the proper ligatures, reversals, and compound characters as needed.</p>
<p>For right-to-left text, such as Hebrew or Arabic, QuickDraw draws the final (leftmost) glyph first, then moves to the right through all the characters, drawing the initial (rightmost) glyph last. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/GetFontInfo" title="GetFontInfo"></a><a name="//apple_ref/doc/c_ref/GetFontInfo" title="GetFontInfo"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F01772" title="GetFontInfo"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_15"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_15"></a><h3 class="tight">GetFontInfo</h3>
<p class="spaceabove">Returns information about the current graphics port’s font, taking into account the style and size in which the glyphs are to be drawn.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
void GetFontInfo (
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/FontInfo">FontInfo</a> *info
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>info</em></dt>
<dd><p>Pointer to a font information structure that contains the font measurement information, in integer values. </p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>GetFontInfo</code> function returns the ascent, descent, leading, and width of the largest glyph of the font in the text font, size, and style specified in the current graphics port. If the script system specified by the current graphics port <code>txFont</code> field has an associated font, as do Hebrew and Arabic, <code>GetFontInfo</code> returns combined information based on both fonts. This is to accommodate text written in the Roman script when the primary script system is non-Roman. However, even if all of the text is written in a non-Roman script, if there is an associated font, <code>GetFontInfo</code> always bases its information on the combined fonts. You can determine the line height, in pixels, by adding the values of the ascent, descent, and leading fields.</p>
<p>The <code>GetFontInfo</code> function is similar to the Font Manager’s <code>FontMetrics</code> function, except that the <code>GetFontInfo</code> function returns integer values. See  <code><a href="../Reference/reference.html#//apple_ref/c/tdef/FontInfo">FontInfo</a></code>  for a description of the structure and its fields. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/GetFormatOrder" title="GetFormatOrder"></a><a name="//apple_ref/doc/c_ref/GetFormatOrder" title="GetFormatOrder"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F01775" title="GetFormatOrder"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_16"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_16"></a><h3 class="tight">GetFormatOrder</h3>
<p class="spaceabove">Determines the display order of style runs for a line of text containing multiple style runs with mixed directions.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
void GetFormatOrder (
   <!--a-->FormatOrderPtr<!--/a--> ordering,
   short firstFormat,
   short lastFormat,
   <!--a-->Boolean<!--/a--> lineRight,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/StyleRunDirectionUPP">StyleRunDirectionUPP</a> rlDirProc,
   <!--a-->Ptr<!--/a--> dirParam
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>ordering</em></dt>
<dd><p>A pointer to a format order array, with (<code>lastFormat – firstFormat + 1</code>) entries. The function fills the array with the display order of each style run. On exit, the array contains a permuted list of the numbers from <code>firstFormat</code> to <code>lastFormat</code>.</p><p>The first entry in the array is the number of the style run to draw first; this is the leftmost style run in display order. The last entry in the array is the number of the entry to draw last, the rightmost style run in display order.</p><p>Upon completion of the call, the <code><a href="../Reference/reference.html#//apple_ref/c/tdef/FormatOrder">FormatOrder</a></code> array contains the numbers identifying the style runs in display order.</p><p></p></dd>
<dt><em>firstFormat</em></dt>
<dd><p>A number greater than or equal to 0 identifying the first style run in storage order that is part of the line for which you are calling <code>GetFormatOrder</code>. </p></dd>
<dt><em>lastFormat</em></dt>
<dd><p>A number greater than or equal to 0 identifying the last style run in storage order that is part of the line for which you are calling <code>GetFormatOrder</code>.</p></dd>
<dt><em>lineRight</em></dt>
<dd><p>A flag that you set to <code>TRUE</code> if the primary line direction is right-to-left. </p></dd>
<dt><em>rlDirProc</em></dt>
<dd><p>A pointer to a callback function that calculates the correct direction, given the style run identifier. The <code>GetFormatOrder</code> function calls the application-defined <code>rlDirProc</code> function for each identifier from <code>firstFormat</code> to <code>lastFormat</code>.</p><p>This function returns <code>TRUE</code> for right-to-left text direction and <code>FALSE</code> for left-to-right. Given <code>dirParam</code> and a style run identifier, the callback function should be able to determine the style run direction. For more information, see <code><a href="../Reference/reference.html#//apple_ref/c/tdef/StyleRunDirectionProcPtr">StyleRunDirectionProcPtr</a></code>.</p><p></p></dd>
<dt><em>dirParam</em></dt>
<dd><p>A pointer to a parameter block that contains the font and script information for each style run in the text.  This parameter block is used by the application-supplied function. </p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>GetFormatOrder</code> function helps you determine how to draw text that contains multiple style runs with mixed directions. For mixed-directional text, after you determine where to break the line, you need to call <code>GetFormatOrder</code> to determine the display order. When you call <code>GetFormatOrder</code>, you supply a Boolean function, and reference it using the <code>rlDirProc</code> parameter. This function calculates the direction of each style run identified by number. Do not call <code>GetFormatOrder</code> if there is only one style run on the line.</p>
<p>You must index the style runs in storage order. You pass <code>GetFormatOrder</code> numbers identifying the first and last style runs of the line in storage order and the primary line direction. The <code>GetFormatOrder</code> function returns to you an equivalent sequence in display order.</p>
<p>If you do not explicitly define the primary line direction of the text, base the <code>lineRight</code> parameter on the value of the <code>SysDirection</code> global variable. (The <code>SysDirection</code> global variable is set to <code>-1</code> if the system direction is right to left, and 0 if the system direction is left to right.) </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/HiliteText" title="HiliteText"></a><a name="//apple_ref/doc/c_ref/HiliteText" title="HiliteText"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F02861" title="HiliteText"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_17"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_17"></a><h3 class="tight">HiliteText</h3>
<p class="spaceabove">Finds all the characters between two byte offsets in a text segment whose glyphs are to be highlighted.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
void HiliteText (
   <!--a-->Ptr<!--/a--> textPtr,
   short textLength,
   short firstOffset,
   short secondOffset,
   <!--a-->OffsetTable<!--/a--> offsets
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textPtr</em></dt>
<dd><p>A pointer to a buffer that contains the text to be highlighted. </p></dd>
<dt><em>textLength</em></dt>
<dd><p>The length in bytes of the entire text segment pointed to by <code>textPtr</code>. </p></dd>
<dt><em>firstOffset</em></dt>
<dd><p>The byte offset from <code>textPtr</code> to the first character to be highlighted.</p></dd>
<dt><em>secondOffset</em></dt>
<dd><p>The byte offset from <code>textPtr</code> to the last character to be highlighted.</p></dd>
<dt><em>offsets</em></dt>
<dd><p>A table that, upon completion of the call, specifies the boundaries of the text to be highlighted. </p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>HiliteText</code> function returns three pairs of byte offsets that mark the onscreen ranges of text to be highlighted. This is because for bidirectional text, although the characters are contiguous in memory, their displayed glyphs can include up to three separate ranges of text.</p>
<p>The <code>HiliteText</code> function takes into account the fact that to highlight the complete range of text whose beginning and ending byte offsets you pass it, it must return byte offsets that encompass the glyphs of the first and last characters in the text segment. To determine the correct offset pairs, <code>HiliteText</code> relies on the primary line direction as specified by the <code>SysDirection</code> global variable.</p>
<p>Before calling <code>HiliteText</code>, you must set up an offset table (of type <code>OffsetTable</code> ) in your application to hold the results. You can consider the offset table to be a set of three offset pairs.</p>
<p>If the two offsets in any pair are equal, the pair is empty and you can ignore it. Otherwise the pair identifies a run of characters whose glyphs are to be highlighted.</p>
<p>The offsets that <code>HiliteText</code> returns depend on the primary line direction as defined by the <code>SysDirection</code> global variable. If you change the value of <code>SysDirection</code>, <code>HiliteText</code> returns the offset that is meaningful according to the primary line direction for ambiguous offsets on the boundary of right-to-left and left-to-right text. </p>
<h5 class="tight">Special Considerations</h5>
<p>The <code>HiliteText</code> function may move memory; do not call this function at interrupt time.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/InvokeStyleRunDirectionUPP" title="InvokeStyleRunDirectionUPP"></a><a name="//apple_ref/doc/c_ref/InvokeStyleRunDirectionUPP" title="InvokeStyleRunDirectionUPP"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F11906" title="InvokeStyleRunDirectionUPP"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_18"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_18"></a><h3 class="tight">InvokeStyleRunDirectionUPP</h3>
<p class="spaceabove">Calls your style run direction callback.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI to handle style runs.)</p>
<p class="spaceabove"><pre>
<!--a-->Boolean<!--/a--> InvokeStyleRunDirectionUPP (
   short styleRunIndex,
   void *dirParam,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/StyleRunDirectionUPP">StyleRunDirectionUPP</a> userUPP
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>userUPP</em></dt>
<dd> </dd></dl>
<h5 class="tight">Return Value</h5>
<p>A <code>Boolean</code> value that indicates whether the callback was invoked successfully.</p>
<h5 class="tight">Discussion</h5>
<p>You should not need to use the function <code><a href="AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/InvokeStyleRunDirectionUPP">InvokeStyleRunDirectionUPP</a></code> as the system calls your style run direction callback for you.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/MeasureJustified" title="MeasureJustified"></a><a name="//apple_ref/doc/c_ref/MeasureJustified" title="MeasureJustified"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F03826" title="MeasureJustified"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_19"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_19"></a><h3 class="tight">MeasureJustified</h3>
<p class="spaceabove">Calculates, for text that is expanded, condensed, or scaled, the onscreen width in pixels from the left edge of the text segment to the glyph of the character.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
void MeasureJustified (
   <!--a-->Ptr<!--/a--> textPtr,
   long textLength,
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> slop,
   <!--a-->Ptr<!--/a--> charLocs,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/JustStyleCode">JustStyleCode</a> styleRunPosition,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> numer,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> denom
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textPtr</em></dt>
<dd><p>A pointer to the memory location of the beginning of the text to be measured. </p></dd>
<dt><em>textLength</em></dt>
<dd><p>The number of bytes of text to be measured. The text length should equal the entire visible part of the text on a line, including trailing spaces if and only if they are displayed. Otherwise, the results for the last glyph on the line may be invalid. </p></dd>
<dt><em>slop</em></dt>
<dd><p>The amount of slop for the text to be drawn. A positive value extends the text segment; a negative value condenses the text segment.</p><p>The value of this parameter is the number of pixels by which the width of the text segment is to be changed, after the text has been scaled. The <code>slop</code> is a signed value that specifies how much the text is to be extended or condensed. The <code>slop</code> is derived from the calculations made using the proportion returned from the <code>PortionLine</code> function for a style run. To measure or draw text that is not to be extended or condensed, pass a <code>slop</code> value of 0.</p></dd>
<dt><em>charLocs</em></dt>
<dd><p>A pointer to an application-defined array of <code>textLength</code> + 1 integers.</p></dd>
<dt><em>styleRunPosition</em></dt>
<dd><p>The position on the line of this style run. The style run can be the only one on the line, the leftmost on the line, the rightmost on the line, or one between two other style runs.</p><p>This parameter specifies the position of the style run on the display line. It is used to determine the proportion of total slop to apply to a style run, measure or draw a line of justified text, identify where to break a line of text, and determine the caret position to mark an insertion point or highlight text.</p><p>The style run position parameter is meaningful only for those script systems that use intercharacter spacing for justification. For all other script systems, the parameter exists for future extensibility. Although the style run position parameter is not used, for example, for justifying text in the Roman script system, to allow for future compatibility, you should always specify the appropriate value for it for all calls that take it.</p><p>For those script systems that do use intercharacter spacing, space between style runs may be allocated differently depending upon whether the style run is leftmost, rightmost, or between two other style runs. For example, depending on the script system, if a style run occurs at the beginning or end of a line, extra space may not be added to the outer edge of the outermost glyph, whereas if a style run is interior to a line, all of the glyphs of the text may be treated the same: extra space is allocated to both sides of every glyph including those at either end of the style run.</p><p>The current implementations of simple script systems such as Roman and Cyrillic do not justify a line of text by changing the width of nonspace characters. Instead, they rely solely on the use of space characters: the same amount of extra width is added to (or subtracted from) every space whether the space is at the beginning or end of the line or interior to it.</p><p>See <span class="content_text"><a href="../Reference/reference.html#//apple_ref/c/tdef/JustStyleCode">“Style Run Position Constants”</a></span> for a list of the constants you can supply.</p></dd>
<dt><em>numer</em></dt>
<dd><p>A point giving the numerator for the horizontal and vertical scaling factors.</p><p>Both numer and denom are point values: numer specifies the numerator for the horizontal and vertical scaling factors, and denom specifies the denominator for the horizontal and vertical scaling factors. Together, these values specify the scaling factors for the text: <code>numer.v</code> over <code>denom.v</code> gives the vertical scaling (height), and <code>numer.h</code> over <code>denom.h</code> gives the horizontal scaling factors (width). You need to specify values for numer and denom even if you are not scaling the text. For unscaled text, you can specify scaling factors of 1, 1.</p></dd>
<dt><em>denom</em></dt>
<dd><p>A point giving the denominator for the horizontal and vertical scaling factors.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>MeasureJustified</code> function is similar to the <code>MeasureText</code> function, except that it is used to find the pixel location of a character’s glyph in text that is expanded or condensed. The function calculates the onscreen pixel width of the glyph of each character, beginning from the left edge of the text segment, taking into account <code>slop</code> value, scaling, and style run position.</p>
<p>On return, the first element in the <code>charLocs</code> array contains 0 and the last element contains the total width of the text segment, when the primary line direction is left to right and the text is unidirectional. When the primary line direction is right to left and the text is unidirectional, the first element in the array contains the total width of the text segment, and the last element in the array contains 0. When the text is bidirectional, at a direction boundary, <code>MeasureJustified</code> selects the character whose direction maps to that of the primary line direction.</p>
<p>The <code>MeasureJustified</code> function returns the same results that an application would get if it called <code>CharToPixel</code> for each character with a direction parameter value of <code>hilite</code>. Using <code>MeasureJustified</code> to find the pixel location of a character’s glyph is less efficient than using the <code>CharToPixel</code> function because the application must define the array pointed to by <code>charLocs</code>, and then walk the array after <code>MeasureText</code> returns the results.</p>
<p>The <code>MeasureJustified</code> function temporarily resets the space extra ( <code>spExtra</code>) value, adding to the current value of the field, if any, the amount of extra space to be added to space characters in order to fully justify the text, based on calculations that take into account the slop value and all the text characteristics. On exit, <code>MeasureJustified</code> restores the original value.</p>
<p>Because <code>MeasureJustified</code> measures text in only the current font, style, and size, you need to call it once for each individual style run. For additional information about <code>MeasureJustified</code>, contact Developer Technical Support.</p>
<p>The <code>MeasureJustified</code> function works properly for text in all script systems. For 1-byte complex script systems, <code>MeasureJustified</code> calculates the widths of any ligatures, reversals, and compound characters that would need to be drawn.</p>
<p>Note that <code>textLength</code> is the number of bytes to be drawn, not the number of characters. Because 2-byte script systems also include characters consisting of only one byte, you should not simply multiply the number of characters by 2 to determine this value; the application must determine and specify the correct number of bytes.</p>
<p>Some 1-byte script system fonts may have zero-width characters, which are usually overlapping diacritical marks that typically follow the base character in memory. In this case, <code>MeasureJustified</code> measures both the glyph of the base character (the high-order, low-address byte) and the width of the diacritical mark. The <code>charLoc</code> array includes an entry for each, but both entries contain the same value.</p>
<p>For 1-byte complex script systems, <code>MeasureJustified</code> calculates the widths of any ligatures, reversals, compound characters, and character clusters that need to be drawn. For example, for an Arabic ligature, the entry that corresponds to the trailing edge of each character that is part of the ligature is the trailing edge of the entire ligature.</p>
<h5 class="tight">Special Considerations</h5>
<p>The <code>MeasureJustified</code> function may move memory; do not call this function at interrupt time.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/MeasureText" title="MeasureText"></a><a name="//apple_ref/doc/c_ref/MeasureText" title="MeasureText"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F03827" title="MeasureText"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_20"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_20"></a><h3 class="tight">MeasureText</h3>
<p class="spaceabove">Calculates the width of the character’s glyph in pixels from the left edge of the text segment.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
void MeasureText (
   short count,
   const void *textAddr,
   void *charLocs
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>count</em></dt>
<dd><p>The number of bytes (as opposed to characters) to be measured. Because 2-byte script systems also include characters consisting of only one byte, do not simply multiply the number of characters by 2 to determine this value; you must determine and specify the correct number of bytes.</p><p>For 2-byte characters, the <code>charLocs</code> array contains two entries—one corresponding to each byte—but both entries contain the same pixel-width value.</p><p></p></dd>
<dt><em>textAddr</em></dt>
<dd><p>A pointer to the memory location of the beginning of the text to be measured. The value of <code>textAddr</code> must point directly to the first character whose glyph is to be measured. </p></dd>
<dt><em>charLocs</em></dt>
<dd><p>A pointer to an application-defined array of <code>count</code> + 1 integers. On return, the first element in the <code>charLocs</code> array contains 0 and the last element contains the total width of the text segment, when the primary line direction is left to right and the text is unidirectional.</p><p>When the primary line direction is right to left, and the text is unidirectional, the first element in the array contains the total width of the text segment, and the last element in the array contains 0. When the text is bidirectional, at a direction boundary, <code>MeasureText</code> selects the character whose direction maps to that of the primary line direction.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>Provides an array version of the <code>TextWidth</code> function. The <code>MeasureText</code> function calculates the onscreen pixel width of the glyph of each character, beginning from the left edge of the text segment. The function returns the same results that an application would get if it called <code>CharToPixel</code> for each character with a direction parameter value of <code>hilite</code>. Using <code>MeasureText</code> to find the pixel location of a character’s glyph is less efficient than using the <code>CharToPixel</code> function because the application must define the array pointed to by <code>charLocs</code>, and then walk the array after <code>MeasureText</code> returns the results.</p>
<p>Because this function measures text in the font, style, and size of the current graphics port, you need to call it once for each individual style run in any line of text that contains multiple style runs.</p>
<p>Some fonts in 1-byte script systems may have zero-width characters, which are usually overlapping diacritical marks that typically follow the base character in memory. In this case, <code>MeasureText</code> measures both the glyph of the base character (the high-order, low-address byte) and the width of the diacritical mark. The <code>charLoc</code> array includes an entry for each, but both entries contain the same value.</p>
<p>For 1-byte complex script systems, <code>MeasureText</code> calculates the widths of any ligatures, reversals, compound characters, and character clusters that need to be drawn. For example, for an Arabic ligature, the entry that corresponds to the trailing edge of each character that is part of the ligature is the trailing edge of the entire ligature. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/NewStyleRunDirectionUPP" title="NewStyleRunDirectionUPP"></a><a name="//apple_ref/doc/c_ref/NewStyleRunDirectionUPP" title="NewStyleRunDirectionUPP"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F12219" title="NewStyleRunDirectionUPP"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_21"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_21"></a><h3 class="tight">NewStyleRunDirectionUPP</h3>
<p class="spaceabove">Creates a new universal procedure pointer (UPP) to a style run direction callback.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI to handle style runs.)</p>
<p class="spaceabove"><pre>
<a href="../Reference/reference.html#//apple_ref/doc/c_ref/StyleRunDirectionUPP">StyleRunDirectionUPP</a> NewStyleRunDirectionUPP (
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/StyleRunDirectionProcPtr">StyleRunDirectionProcPtr</a> userRoutine
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>userRoutine</em></dt>
<dd> <p> </p> </dd></dl>
<h5 class="tight">Return Value</h5>
<p>See the description of the <code>StyleRunDirectionUPP</code> data type.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/PixelToChar" title="PixelToChar"></a><a name="//apple_ref/doc/c_ref/PixelToChar" title="PixelToChar"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F04974" title="PixelToChar"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_22"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_22"></a><h3 class="tight">PixelToChar</h3>
<p class="spaceabove">Returns the byte offset of a character in a style run, or part of a style run, whose onscreen glyph is nearest the place where the user clicked the mouse.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
short PixelToChar (
   <!--a-->Ptr<!--/a--> textBuf,
   long textLength,
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> slop,
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> pixelWidth,
   <!--a-->Boolean<!--/a--> *leadingEdge,
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> *widthRemaining,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/JustStyleCode">JustStyleCode</a> styleRunPosition,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> numer,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> denom
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textBuf</em></dt>
<dd><p>A pointer to the start of the text segment. </p></dd>
<dt><em>textLength</em></dt>
<dd><p>The length in bytes of the entire text segment pointed to by <code>textBuf</code>. The <code>PixelToChar</code> function requires the context of the complete text segment in order to determine the correct value. </p></dd>
<dt><em>slop</em></dt>
<dd><p>The amount of slop for the text to be drawn. A positive value extends the text segment; a negative value condenses the text segment.</p><p>The value of this parameter is the number of pixels by which the width of the text segment is to be changed, after the text has been scaled. The <code>slop</code> is a signed value that specifies how much the text is to be extended or condensed. The <code>slop</code> is derived from the calculations made using the proportion returned from the <code>PortionLine</code> function for a style run. To measure or draw text that is not to be extended or condensed, pass a <code>slop</code> value of 0.</p></dd>
<dt><em>pixelWidth</em></dt>
<dd><p>The screen location of the glyph associated with the character whose byte offset is to be returned. The screen location is measured in pixels beginning from the left edge of the text segment for which you call <code>PixelToChar</code>.</p></dd>
<dt><em>leadingEdge</em></dt>
<dd><p>Pointer to a Boolean flag that, upon completion of the call, is set to <code>TRUE</code> if the pixel location is on the leading edge of the glyph, and <code>FALSE</code> if the pixel location is on the trailing edge of the glyph. The leading edge is the left side if the direction of the character that the glyph represents is left-to-right (such as a Roman character), and the right side if the character direction is right-to-left (such as an Arabic or a Hebrew letter).</p></dd>
<dt><em>widthRemaining</em></dt>
<dd><p>Pointer to a location that, upon completion of the call, contains –1 if the pixel location (specified by the <code>pixelWidth</code> parameter) falls within the style run (represented by the <code>textLen</code> bytes starting at <code>textBuf</code>). Otherwise, the location contains the amount of pixels by which the input pixel location (<code>pixelWidth</code>) extends beyond the right edge of the text for which you called <code>PixelToChar</code>.</p></dd>
<dt><em>styleRunPosition</em></dt>
<dd><p>The position on the line of this style run. The style run can be the only one on the line, the leftmost on the line, the rightmost on the line, or one between two other style runs.</p><p>This parameter specifies the position of the style run on the display line. It is used to determine the proportion of total slop to apply to a style run, measure or draw a line of justified text, identify where to break a line of text, and determine the caret position to mark an insertion point or highlight text.</p><p>The style run position parameter is meaningful only for those script systems that use intercharacter spacing for justification. For all other script systems, the parameter exists for future extensibility. Although the style run position parameter is not used, for example, for justifying text in the Roman script system, to allow for future compatibility, you should always specify the appropriate value for it for all calls that take it.</p><p>For those script systems that do use intercharacter spacing, space between style runs may be allocated differently depending upon whether the style run is leftmost, rightmost, or between two other style runs. For example, depending on the script system, if a style run occurs at the beginning or end of a line, extra space may not be added to the outer edge of the outermost glyph, whereas if a style run is interior to a line, all of the glyphs of the text may be treated the same: extra space is allocated to both sides of every glyph including those at either end of the style run.</p><p>The current implementations of simple script systems such as Roman and Cyrillic do not justify a line of text by changing the width of nonspace characters. Instead, they rely solely on the use of space characters: the same amount of extra width is added to (or subtracted from) every space whether the space is at the beginning or end of the line or interior to it.</p><p>See <span class="content_text"><a href="../Reference/reference.html#//apple_ref/c/tdef/JustStyleCode">“Style Run Position Constants”</a></span> for a list of the constants you can supply.</p></dd>
<dt><em>numer</em></dt>
<dd><p>A point giving the numerator for the horizontal and vertical scaling factors.</p><p>Both <code>numer</code> and <code>denom</code> are point values: <code>numer</code> specifies the numerator for the horizontal and vertical scaling factors, and <code>denom</code> specifies the denominator for the horizontal and vertical scaling factors. Together, these values specify the scaling factors for the text: <code>numer.v</code> over <code>denom.v</code> gives the vertical scaling (height), and <code>numer.h</code> over <code>denom.h</code> gives the horizontal scaling factors (width). You need to specify values for <code>numer</code> and <code>denom</code> even if you are not scaling the text. For unscaled text, you can specify scaling factors of 1, 1.</p></dd>
<dt><em>denom</em></dt>
<dd><p>A point giving the denominator for the horizontal and vertical scaling factors.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>The byte offset of a character in a style run, or part of a style run, whose onscreen glyph is nearest the place where the user clicked the mouse. </p>
<h5 class="tight">Discussion</h5>
<p>You can use the information that <code>PixelToChar</code> returns for highlighting, word selection, and identifying the caret position. The <code>PixelToChar</code> function returns a byte offset and a Boolean value that describes whether the pixel location is on the leading edge or trailing edge of the glyph where the mouse-down event occurred. When the pixel location falls on a glyph that corresponds to one or more characters that are part of the text segment, the <code>PixelToChar</code> function uses the direction of the character or characters to determine which side of the glyph is the leading edge. (A glyph can represent more than one character, for example, for a ligature. Generally, if a glyph represents more than one character, all of the characters have the same text direction.)</p>
<p>If the pixel location is on the leading edge, <code>PixelToChar</code> returns the byte offset of the character whose glyph is at the pixel location. (If the glyph represents multiple characters, it returns the byte offset of the first of these characters in memory.) If the pixel location is on the trailing edge, <code>PixelToChar</code> returns the byte offset of the first character in memory following the character or characters represented by the glyph. If the pixel location is on the trailing edge of the glyph that corresponds to the last character in the text segment, <code>PixelToChar</code> returns a byte offset equal to the length of the text segment.</p>
<p>When the pixel location is before the leading edge of the first glyph in the displayed text segment, <code>PixelToChar</code> returns a leading edge value of <code>FALSE</code> and the byte offset of the first character. When the pixel location is after the trailing edge of the last glyph in the displayed text segment, <code>PixelToChar</code> returns a leading edge value of <code>TRUE</code> and the next byte offset in memory, the one after the last character in the text segment. If the primary line direction is left to right, before means to the left of all of the glyphs for the characters in the text segment, and after means to the right of all these glyphs. If the primary line direction is right to left, before and after hold the opposite meanings.</p>
<p>You also use the value of the <code>leadingEdge</code> flag to help determine the value of the <code>direction</code> parameter to pass to <code>CharToPixel</code>, which you call to get the caret position. If the <code>leadingEdge</code> flag is <code>FALSE</code>, you base the value of the <code>direction</code> parameter on the direction of the character at the byte offset in memory that precedes the one that <code>PixelToChar</code> returns; if <code>leadingEdge</code> is <code>TRUE</code>, you base the value of the <code>direction</code> parameter on the direction of the character at the byte offset that <code>PixelToChar</code> returns. If there isn’t a character at the byte offset, you base the value of the <code>direction</code> parameter on the primary line direction as determined by the <code>SysDirection</code> global variable.</p>
<p>You specify a value for <code>textLen</code> that is equal to the entire visible part of the style run on a line and includes trailing spaces if and only if they are displayed. They may not be displayed, for example, for the last style run in memory order that is part of the current line.</p>
<p>Be sure to pass the same values for <code>styleRunPosition</code> and the scaling factors ( <code>numer</code> and <code>denom</code>) to <code>PixelToChar</code> that you pass to any of the other justification functions for this style run.</p>
<p>You pass <code>PixelToChar</code> a pointer to the byte offset of the character in the text buffer that begins the text segment or style run containing the character whose glyph is at the pixel location. If you do not know which style run on the display line contains the character whose glyph is at the pixel location, you can loop through the style runs until you find the one that contains the pixel location. If the style run contains the character, <code>PixelToChar</code> returns its byte offset. If it doesn’t, you can use the <code>widthRemaining</code> parameter value to help determine which style run contains the glyph at the pixel location.</p>
<p>If you pass <code>PixelToChar</code> the pixel width of the display line, you can use the returned value of <code>widthRemaining</code> to calculate the length of a style run. The <code>widthRemaining</code> parameter contains the length in pixels from the end of the style run for which you call <code>PixelToChar</code> to the end of the display line, in this case, if the style run for which you call it does not include the byte offset whose glyph corresponds to the pixel location. You subtract the returned <code>widthRemaining</code> value from the screen pixel width of the display line to get the style run’s length.</p>
<p>To truncate a line of text, you can use <code>PixelToChar</code> to find the byte offset of the character where the line should be broken. To return the correct byte offset associated with the pixel location of a mouse-down event when the text belongs to a right-to-left script system, the <code>PixelToChar</code> function reorders the text. If right-to-left text is reordered when you use <code>PixelToChar</code> to determine where to break a line, it returns the wrong byte offset. To get the correct result, you must turn off reordering before you call <code>PixelToCha</code> r. Remember to restore reordering after you have determined where to break the line.</p>
<p>The <code>PixelToChar</code> function works with text in all script systems, and for text that is justified or not. For contextual script systems, <code>PixelToChar</code> takes into account the widths of any ligatures, reversals, and compound characters that were created when the text was drawn.</p>
<p>Because 2-byte script systems also include characters consisting of only one byte, you should not simply multiply the number of characters by 2 to determine this value; you must determine and specify the correct number of bytes. </p>
<h5 class="tight">Special Considerations</h5>
<p>The <code>PixelToChar</code> function may move memory; do not call this function at interrupt time.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/PortionLine" title="PortionLine"></a><a name="//apple_ref/doc/c_ref/PortionLine" title="PortionLine"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F05014" title="PortionLine"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_23"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_23"></a><h3 class="tight">PortionLine</h3>
<p class="spaceabove">Determines the correct proportion of extra space to apply to the specified style run in a line of justified text; that is, how to distribute the total slop value for a line among the style runs on that line.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
<a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> PortionLine (
   <!--a-->Ptr<!--/a--> textPtr,
   long textLen,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/JustStyleCode">JustStyleCode</a> styleRunPosition,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> numer,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> denom
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textPtr</em></dt>
<dd><p>A pointer to the style run. </p></dd>
<dt><em>textLen</em></dt>
<dd><p>The number of bytes in the text of the style run. </p></dd>
<dt><em>styleRunPosition</em></dt>
<dd><p>The position on the line of this style run. The style run can be the only one on the line, the leftmost on the line, the rightmost on the line, or one between two other style runs.</p><p>This parameter specifies the position of the style run on the display line. It is used to determine the proportion of total slop to apply to a style run, measure or draw a line of justified text, identify where to break a line of text, and determine the caret position to mark an insertion point or highlight text.</p><p>The style run position parameter is meaningful only for those script systems that use intercharacter spacing for justification. For all other script systems, the parameter exists for future extensibility. Although the style run position parameter is not used, for example, for justifying text in the Roman script system, to allow for future compatibility, you should always specify the appropriate value for it for all calls that take it.</p><p>For those script systems that do use intercharacter spacing, space between style runs may be allocated differently depending upon whether the style run is leftmost, rightmost, or between two other style runs. For example, depending on the script system, if a style run occurs at the beginning or end of a line, extra space may not be added to the outer edge of the outermost glyph, whereas if a style run is interior to a line, all of the glyphs of the text may be treated the same: extra space is allocated to both sides of every glyph including those at either end of the style run.</p><p>The current implementations of simple script systems such as Roman and Cyrillic do not justify a line of text by changing the width of nonspace characters. Instead, they rely solely on the use of space characters: the same amount of extra width is added to (or subtracted from) every space whether the space is at the beginning or end of the line or interior to it.</p><p>See <span class="content_text"><a href="../Reference/reference.html#//apple_ref/c/tdef/JustStyleCode">“Style Run Position Constants”</a></span> for a list of the constants you can supply.</p></dd>
<dt><em>numer</em></dt>
<dd><p>A point giving the numerator for the horizontal and vertical scaling factors.</p><p>Both <code>numer</code> and <code>denom</code> are point values: <code>numer</code> specifies the numerator for the horizontal and vertical scaling factors, and <code>denom</code> specifies the denominator for the horizontal and vertical scaling factors. Together, these values specify the scaling factors for the text: <code>numer.v</code> over <code>denom.v</code> gives the vertical scaling (height), and <code>numer.h</code> over <code>denom.h</code> gives the horizontal scaling factors (width). You need to specify values for <code>numer</code> and <code>denom</code> even if you are not scaling the text. For unscaled text, you can specify scaling factors of 1, 1.</p></dd>
<dt><em>denom</em></dt>
<dd><p>A point giving the denominator for the horizontal and vertical scaling factors.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>A number that represents the portion of the slop to be applied to the style run for which it is called. </p>
<h5 class="tight">Discussion</h5>
<p>You use <code>PortionLine</code> in formatting a line of justified text. It helps you determine how to distribute the slop for a line among its style runs. When you know the total slop for a line of text, you need to determine what portion of it to attribute to each style run. To do this, you call the <code>PortionLine</code> function once for each style run on the line. The <code>PortionLine</code> function computes the portion of extra space for a style run, taking into account the font, size, style, and scaling factors of the style run. It returns a number that represents the portion of the slop to be applied to the style run for which it is called. You use the value that <code>PortionLine</code> returns to determine the percentage of slop that you should attribute to a style run.</p>
<p>To determine the percentage of slop to allocate to each style run, you compute what percentage each portion is of the sum of all portions. To determine the actual slop value in pixels for each style run, you apply the percentage to the total slop value. The following steps summarize this process:</p>
<ol class="ol"><li class="li"><p> Call <code>PortionLine</code> for each style run on the line. </p></li>
<li class="li"><p> Add the returned values together. </p></li>
<li class="li"><p> Calculate the percentage of the slop value for each style run using the ratio of the value returned by <code>PortionLine</code> for that style run and the total of the values returned for all of the style runs on the line. </p></li>
<li class="li"><p> Calculate the number of pixels to be added to each style run by multiplying the percentage of the slop for each style run by the total number of pixels. </p></li></ol>
<p>Be sure to pass the same values for <code>styleRunPosition</code> and the scaling factors ( <code>numer</code> and <code>denom</code>) to <code>PortionLine</code> that you pass to any of the other justification functions for this style run. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/SpaceExtra" title="SpaceExtra"></a><a name="//apple_ref/doc/c_ref/SpaceExtra" title="SpaceExtra"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07377" title="SpaceExtra"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_24"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_24"></a><h3 class="tight">SpaceExtra</h3>
<p class="spaceabove">Specifies the number of pixels by which to widen (or narrow) each space in a style run to be drawn in the current graphics port.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
void SpaceExtra (
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> extra
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>extra</em></dt>
<dd><p>The amount (in pixels or binary fractions of a pixel) to widen (or narrow) each space in a style run on a line.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>SpaceExtra</code> function sets the value of the extra space ( <code>spExtra</code>) field in the current graphics port structure. The initial setting is <code>0</code>. You can pass a negative value for the extra parameter, but be careful not to narrow spaces so much that the text is unreadable. The value you specify is added to the width of each space character in the style run. For those script systems that do not use spaces, any value set in the extra space field is ignored. For those script systems that use spaces as delimiters, if you do not want to justify a line of text using <code>DrawJustified</code>, you can use the <code>SpaceExtra</code> function to set a fixed number of pixels to be added to each space character, then call <code>DrawText</code> or <code>DrawString</code>.</p>
<p>When you use the justification functions ( <code>MeasureJustified</code>, <code>DrawJustified</code>) to measure or draw justified text, they temporarily reset the extra space value. They add to the current value of the field, if any, the amount of extra space to be added to space characters in the specified text in order to justify the text, based on calculations that take into account the slop value for the range of text and all of the text characteristics. On exit, these functions restore the original value.</p>
<p>For a color graphics port ( <code>CGrafPort</code>), you can use <code>SpaceExtra</code> by itself or in conjunction with the <code>CharExtra</code> function to format a line of text in the 1-byte simple or 2-byte script systems. You should not use <code>CharExtra</code> for 1-byte complex script systems.</p>
<p>To ensure future compatibility and benefit from any enhancements, always use this function to modify the <code>spExtra</code> field, rather than directly change the field value. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/StandardGlyphs" title="StandardGlyphs"></a><a name="//apple_ref/doc/c_ref/StandardGlyphs" title="StandardGlyphs"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07558" title="StandardGlyphs"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_25"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_25"></a><h3 class="tight">StandardGlyphs</h3>
<p class="spaceabove">This obsolete function doesn’t do anything in Mac OS X. &#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI to render Unicode text.)</p>
<p><i style="background-color: #e9e9e9; padding: 5px; margin-top: 10px; margin-bottom:5px;">Not recommended.</i></p>
<p class="spaceabove"><pre>
OSStatus StandardGlyphs (
   void *dataStream,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/ByteCount" target="_top">ByteCount</a> size
);
</pre></p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/StdText" title="StdText"></a><a name="//apple_ref/doc/c_ref/StdText" title="StdText"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07582" title="StdText"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_26"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_26"></a><h3 class="tight">StdText</h3>
<p class="spaceabove">Draws text from an arbitrary structure in memory. &#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p class="spaceabove"><pre>
void StdText (
   short count,
   const void *textAddr,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> numer,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> denom
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>count</em></dt>
<dd><p>The number of bytes of text to draw. </p></dd>
<dt><em>textAddr</em></dt>
<dd><p>A memory structure containing the text to draw. </p></dd>
<dt><em>numer</em></dt>
<dd><p>Scaling numerator. </p></dd>
<dt><em>denom</em></dt>
<dd><p>Scaling denominator.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>This is QuickDraw’s standard low-level function for drawing text. The <code>StdText</code> function draws text from the arbitrary structure in memory specified by the <code>textBuf</code> parameter, starting from the first byte and continuing for the number of bytes specified in the <code>byteCount</code> parameter. The <code>numer</code> and <code>denom</code> parameters specify the scaling factor: <code>numer.v</code> over <code>denom.v</code> gives the vertical scaling, and <code>numer.h</code> over <code>denom.h</code> gives the horizontal scaling factor.</p>
<p>You should only call this low-level function from your customized QuickDraw functions. </p>
<h5 class="tight">Special Considerations</h5>
<p>The <code>StdText</code> function may move or purge memory blocks in the application heap; do not call this function at interrupt time.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/stdtext" title="stdtext"></a><a name="//apple_ref/doc/c_ref/stdtext" title="stdtext"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F08640" title="stdtext"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_27"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_27"></a><h3 class="tight">stdtext</h3>
<p class="spaceabove">Draws text from an arbitrary structure in memory. &#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p><i style="background-color: #e9e9e9; padding: 5px; margin-top: 10px; margin-bottom:5px;">Modified</i></p>
<p class="spaceabove"><pre>
void stdtext (
   short count,
   const void *textAddr,
   const <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> *numer,
   const <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> *denom
);
</pre></p><h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/StdTxMeas" title="StdTxMeas"></a><a name="//apple_ref/doc/c_ref/StdTxMeas" title="StdTxMeas"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07583" title="StdTxMeas"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_28"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_28"></a><h3 class="tight">StdTxMeas</h3>
<p class="spaceabove">Measures the width of scaled or unscaled text.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
short StdTxMeas (
   short byteCount,
   const void *textAddr,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> *numer,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Point" target="_top">Point</a> *denom,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/FontInfo">FontInfo</a> *info
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>byteCount</em></dt>
<dd><p>The number of bytes to be counted. </p></dd>
<dt><em>textAddr</em></dt>
<dd><p>A pointer to the beginning of the text in memory. </p></dd>
<dt><em>numer</em></dt>
<dd><p>Pointer to a point giving the numerator for the horizontal and vertical scaling factors. For this function, <code>numer</code> and <code>denom</code> are reference parameters. On output, these parameters contain additional scaling to be applied to the text.</p><p>Both <code>numer</code> and <code>denom</code> are point values: <code>numer</code> specifies the numerator for the horizontal and vertical scaling factors, and <code>denom</code> specifies the denominator for the horizontal and vertical scaling factors. Together, these values specify the scaling factors for the text: <code>numer.v</code> over <code>denom.v</code> gives the vertical scaling (height), and <code>numer.h</code> over <code>denom.h</code> gives the horizontal scaling factors (width). You need to specify values for <code>numer</code> and <code>denom</code> even if you are not scaling the text. For unscaled text, you can specify scaling factors of 1, 1.</p></dd>
<dt><em>denom</em></dt>
<dd><p>Pointer to a point giving the denominator for the horizontal and vertical scaling factors.</p></dd>
<dt><em>info</em></dt>
<dd><p>Pointer to a font information structure that describes the current font. </p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>The width of the text stored in memory, beginning with the first character at <code>textAddr</code> and continuing for <code>byteCount</code> bytes. </p>
<h5 class="tight">Discussion</h5>
<p>The <code>StdTxMeas</code> function is a QuickDraw bottleneck function that the QuickDraw text-measuring functions use extensively. The <code>StdTxMeas</code> function returns the width of the text stored in memory beginning with the first character at <code>textAddr</code> and continuing for <code>byteCount</code> bytes. You can call the <code>StdTxMeas</code> function directly, for example, to measure text that you want to explicitly scale, but not justify. You can also use <code>StdTxMeas</code> to get the font metrics for scaled text in order to determine the line height, instead of using <code>GetFontInfo</code>, which doesn’t support scaling.</p>
<p>The high-level QuickDraw text functions provide most of the functionality needed to measure and draw text.  However, if you need to call <code>StdTxMeas</code> directly, you must first check the graphics port <code>grafProcs</code> field to determine whether the bottleneck functions have been customized, and if so, you must call the customized function instead of the standard one.  The bottleneck functions are always customized for printing.</p>
<p>If the <code>grafProcs</code> field contains <code>NULL</code>, the standard bottleneck functions have not been customized.  If the <code>grafProcs</code> field contains a pointer, the standard bottleneck functions have been replaced by customized ones.  This pointer (of type <code>QDProcPtr</code>) points to a <code>QDProc</code> structure, which contains fields that point to the bottleneck function to be used for a specific drawing function.  If the standard bottleneck function has been customized, your application needs to use the customized function indicated by the <code>QDProc</code> structure field.</p>
<p>On input, you need to specify values for <code>numer</code> and <code>denom</code>, even if you are not scaling the text. You can specify 1,1 scaling factors, in this case, so that no scaling is applied. On return, <code>numer</code> and <code>denom</code> contain the additional scaling to be applied to the text.</p>
<p>The <code>StdTxtMeas</code> function returns output scaling factors that you need to apply to the text to get the right measurement if the Font Manager was not able to fully satisfy the scaling request. You can use the Toolbox Utilities’ <code>FixRound</code> and <code>FixRatio</code> functions to help with this process.</p>
<p>The <code>StdTxMeas</code> function gives the correct results for all script systems. The <code>byteCount</code> parameter is the number of bytes of the text to be drawn, not characters. When specifying this value, consider that 2-byte script systems also include characters consisting of only one byte. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/StringWidth" title="StringWidth"></a><a name="//apple_ref/doc/c_ref/StringWidth" title="StringWidth"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07600" title="StringWidth"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_29"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_29"></a><h3 class="tight">StringWidth</h3>
<p class="spaceabove">Returns the length, in pixels, of the specified text string.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
short StringWidth (
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/ConstStr255Param" target="_top">ConstStr255Param</a> s
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>s</em></dt>
<dd><p>A Pascal string containing the text to be measured.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>The length, in pixels, of the specified text string. </p>
<h5 class="tight">Discussion</h5>
<p>You should not call <code>StringWidth</code> to measure scaled text. Although <code>StringWidth</code> takes into account the graphics port structure settings, it does not accept scaling parameters, and therefore cannot determine the correct text width result for text to be drawn using scaling factor parameters.</p>
<p>If you specify values in the graphics port <code>spExtra</code> or <code>chExtra</code> fields to change the width of space or nonspace characters, <code>StringWidth</code> takes these values into account.</p>
<p>Because this function measures text in the font, style, and size of the current graphics port, you need to call it once for each individual style run in any line of text that contains multiple style runs.</p>
<p>The <code>StringWidth</code> function works with all script systems. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/Simple_DrawSprocket/index.html#//apple_ref/doc/uid/DTS10000169" target="_top">Simple DrawSprocket</a></span></li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/StyledLineBreak" title="StyledLineBreak"></a><a name="//apple_ref/doc/c_ref/StyledLineBreak" title="StyledLineBreak"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07612" title="StyledLineBreak"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_30"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_30"></a><h3 class="tight">StyledLineBreak</h3>
<p class="spaceabove">Returns the proper location to break a line of text, taking into account script and language considerations, making use of tables in the string-manipulation (<code>'itl2'</code>) resource in its computations.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
<a href="../Reference/reference.html#//apple_ref/doc/c_ref/StyledLineBreakCode">StyledLineBreakCode</a> StyledLineBreak (
   <!--a-->Ptr<!--/a--> textPtr,
   SInt32 textLen,
   SInt32 textStart,
   SInt32 textEnd,
   SInt32 flags,
   <a href="../../Mathematical_al_Utilities/Reference/reference.html#//apple_ref/doc/c_ref/Fixed" target="_top">Fixed</a> *textWidth,
   SInt32 *textOffset
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textPtr</em></dt>
<dd><p>A pointer to the beginning of a script run on the current line to be broken.</p></dd>
<dt><em>textLen</em></dt>
<dd><p>The number of bytes in the script run on the current line to be broken. </p></dd>
<dt><em>textStart</em></dt>
<dd><p>A byte offset to the beginning of a style run within the script run.</p><p>When used with unformatted text, <code>textStart</code> can be 0, and <code>textEnd</code> is identical to <code>textLen</code>. With styled text, the interval between <code>textStart</code> and <code>textEnd</code> specifies a style run. The interval between <code>textPtr</code> and <code>textLen</code> specifies a script run. Note that the style runs in <code>StyledLineBreak</code> must be traversed in memory order, not in display order.</p></dd>
<dt><em>textEnd</em></dt>
<dd><p>A byte offset to the end of the style run within the script run.</p></dd>
<dt><em>flags</em></dt>
<dd><p>Reserved for future expansion; must be 0.</p></dd>
<dt><em>textWidth</em></dt>
<dd><p>A pointer to the maximum length of the displayed line in pixels. <code>StyledLineBreak</code> decrements this value for its own use. You are responsible for setting it before your first call to <code>StyledLineBreak</code> for a line.</p><p><code>StyledLineBreak</code> automatically decrements the <code>textWidth</code> variable by the width of the style run for use on the next call. You need to set the value of <code>textWidth</code> before calling it to process a line.</p></dd>
<dt><em>textOffset</em></dt>
<dd><p>A pointer to the text offset value, which must be nonzero on your first call to <code>StyledLineBreak</code> for a line, and zero for subsequent calls to <code>StyledLineBreak</code> for that line. This value allows <code>StyledLineBreak</code> to differentiate between the first and subsequent calls, which is important when a long word is found (as described below).</p><p>The <code>textOffset</code> parameter must be nonzero for the first call on a line and zero for each call to the function on the line. This allows <code>StyledLineBreak</code> to act differently when a long word is encountered: if the word is in the first style run on the line, <code>StyledLineBreak</code> breaks the line on a character boundary within the word; if the word is in a subsequent style run on the line, <code>StyledLineBreak</code> breaks the line before the start of the word.</p><p>On output, <code>textOffset</code> is the count of bytes from <code>textPtr</code> to the location in the text string where the line break is to occur. When <code>StyledLineBreak</code> finds a line break, it sets the value of <code>textOffset</code> to the count of bytes that can be displayed starting at <code>textPtr</code>.</p><p>When <code>StyledLineBreak</code> is called for the second or subsequent style runs within a script run, the <code>textOffset</code> value at exit may be less than the <code>textStart</code> parameter (that is, it may specify a line break before the current style run).</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>Indicates whether the function broke on a word boundary or a character boundary, or if the width extended beyond the edge of the text. See <span class="content_text"><a href="../Reference/reference.html#//apple_ref/c/tdef/StyledLineBreakCode">“Style Line Break Values”</a></span> for a list of the constants that can be returned.</p>
<h5 class="tight">Discussion</h5>
<p>The function <code>StyledLineBreak</code> breaks the line on a word boundary if possible and allows for multiscript runs and style runs on a single line.</p>
<p>Use the <code>StyledLineBreak</code> function when you are laying out lines in an environment that may include text from multiple scripts. To use this function, you need to understand how QuickDraw draws text.</p>
<p>You can only use the <code>StyledLineBreak</code> function when you have organized your text in script runs and style runs within each script run. This type of text organization is used by most text-processing applications that allow for multiscript text. Use this function when you are displaying text in a screen area to determine the best place to break each displayed line.</p>
<p>What you do is iterate through your text, a script run at a time starting from the first character past the end of the previous line. Use <code>StyledLineBreak</code> to check each style run in the script run (in memory order) until the function determines that it has arrived at a line break. As you loop through each style run, before calling <code>StyledLineBreak</code>, you must set the text values in the graphics port structure that are used by QuickDraw to measure the text. These include the font, font size, and font style of the style run.</p>
<p>If the current style run is included in a contiguous sequence of other style runs of the same script, then <code>textPtr</code> should point to the start of the first style run of the same script on the line, and <code>textLen</code> should include the last style run of the same script on the line. This is because word boundaries can extend across style runs, but not across script runs.</p>
<p>Although the offsets are in long integer values and the widths are in fixed values for future extensions, in the current version the long integer values are restricted to the integer range, and only the integer portion of the widths is used.</p>
<p><code>StyledLineBreak</code> always chooses a line break for the last style run on the line in memory order as if all whitespace in that style run would be stripped. The <code>VisibleLength</code> function, which is a QuickDraw function used to eliminate trailing spaces from a style run before drawing it, can be called for the style run that is at the display end of a line. This leads to a potential conflict when both functions are used with mixed-directional text: if the end of a line in memory order actually occurs in the middle of the displayed line, <code>StyledLineBreak</code> assumes that the whitespace is stripped from that run, but <code>VisibleLength</code> does not strip the characters. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/TextFace" title="TextFace"></a><a name="//apple_ref/doc/c_ref/TextFace" title="TextFace"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07864" title="TextFace"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_31"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_31"></a><h3 class="tight">TextFace</h3>
<p class="spaceabove">Sets the style of the font in which the text is to be drawn in the current graphics port. &#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p class="spaceabove"><pre>
void TextFace (
   <!--a-->StyleParameter<!--/a--> face
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>face</em></dt>
<dd><p>The style for text to be drawn in the current graphics port.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>TextFace</code> function sets the value for the style of the font in the text face ( <code>txFace</code>) field of the current graphics port. The <code>Style</code> data type allows you to specify a set of one or more of the following predefined constants: <code>bold</code>, <code>italic</code>, <code>underline</code>, <code>outline</code>, <code>shadow</code>, <code>condense</code>, and <code>extend</code>. In Pascal, you specify the constants within square brackets. For example:</p>
<div class="codesample"><table><tr><td scope="row"><pre>TextFace([bold]);<span></span></pre></td></tr><tr><td scope="row"><pre>{bold}TextFace([bold,italic]);<span></span></pre></td></tr><tr><td scope="row"><pre>{bold and italic}<span></span></pre></td></tr></table></div>
<p>The style is set to the empty set ( <code>[]</code>) by default, which specifies plain.</p>
<p>To ensure future compatibility and benefit from any enhancements, always use this function to modify the <code>txFace</code> field, rather than directly change the field value. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/TextFont" title="TextFont"></a><a name="//apple_ref/doc/c_ref/TextFont" title="TextFont"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07865" title="TextFont"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_32"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_32"></a><h3 class="tight">TextFont</h3>
<p class="spaceabove">Sets the font of the current graphics port in which the text is to be rendered. &#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p class="spaceabove"><pre>
void TextFont (
   short font
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>font</em></dt>
<dd><p>The font family ID. The initial font family ID is <code>0</code>, which represents the system font. The value that you specify for this field is either an integer or a constant. The range of integers currently defined are from <code>0</code> to <code>32767</code>. Currently, negative font family IDs are not supported, although they may be supported in the future.</p><p>The system font and application font have different font IDs and sizes on various script systems. However, the special designators <code>0</code> and <code>1</code> always map to the system font and the application font for the system script, respectively.</p><p></p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>TextFont</code> function sets the value of the graphics port text font (<code>txFont</code>) field. To ensure future compatibility and benefit from any enhancements, always use this function to modify the <code>txFont</code> field, rather than directly change the field value. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/Simple_DrawSprocket/index.html#//apple_ref/doc/uid/DTS10000169" target="_top">Simple DrawSprocket</a></span></li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/TextMode" title="TextMode"></a><a name="//apple_ref/doc/c_ref/TextMode" title="TextMode"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07873" title="TextMode"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_33"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_33"></a><h3 class="tight">TextMode</h3>
<p class="spaceabove">Sets the transfer mode for drawing text in the current graphics port.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p class="spaceabove"><pre>
void TextMode (
   short mode
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>mode</em></dt>
<dd><p>The transfer mode to be used to draw the text. </p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code><a href="AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/TextMode">TextMode</a></code> function sets the transfer mode in the graphics port <code>txMode</code> field. The transfer mode determines the interplay between what an application is drawing (the source) and what already exists on the display device (the destination), resulting in the text display.</p>
<p>There are two basic kinds of modes: pattern (<code>pat</code>) and source (<code>src</code>). Source is the kind that you use for drawing text. There are four basic Boolean operations: <code>Copy</code>, <code>Or</code>, <code>Xor</code>, and <code>Bic</code> (bit clear), each of which has an inverse variant in which the source is inverted before the transfer, yielding eight operations in all. Original QuickDraw supports these eight transfer modes. Color QuickDraw enables your application to achieve color effects within those basic transfer modes, and offers an additional set of transfer modes that perform arithmetic operations on the RGB values of the source and destination pixels. Other transfer modes are <code>grayishTextOr</code>, <code>transparent</code> mode, and text mask mode.</p>
<p>To ensure future compatibility and benefit from any enhancements, always use this function to modify the <code>txMode</code> field, rather than directly change the field value. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/TextSize" title="TextSize"></a><a name="//apple_ref/doc/c_ref/TextSize" title="TextSize"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07876" title="TextSize"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_34"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_34"></a><h3 class="tight">TextSize</h3>
<p class="spaceabove">Sets the font size for text drawn in the current graphics port to the specified number of points.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI or Quartz instead.)</p>
<p class="spaceabove"><pre>
void TextSize (
   short size
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>size</em></dt>
<dd><p>The font size in points (0 to 32,767). The initial setting is 0, which specifies that the font size of the system font (normally 12 points) is to be used. </p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>TextSize</code> function sets the font size in the text size (<code>txSize</code>) field of the current graphics port structure. To ensure future compatibility and benefit from any enhancements, always use this function to modify the <code>txSize</code> field, rather than directly change the field value. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Related Sample Code</h5><ul class="availability"><li class="availability">  <span class="content_text"><a href="../../../../../samplecode/Simple_DrawSprocket/index.html#//apple_ref/doc/uid/DTS10000169" target="_top">Simple DrawSprocket</a></span></li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/TextWidth" title="TextWidth"></a><a name="//apple_ref/doc/c_ref/TextWidth" title="TextWidth"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07878" title="TextWidth"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_35"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_35"></a><h3 class="tight">TextWidth</h3>
<p class="spaceabove">Returns the length, in pixels, of the specified text.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
short TextWidth (
   const void *textBuf,
   short firstByte,
   short byteCount
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textBuf</em></dt>
<dd><p>A pointer to a buffer that contains the text to be measured. </p></dd>
<dt><em>firstByte</em></dt>
<dd><p>An offset from <code>textBuf</code> to the first byte of the text to be measured. </p></dd>
<dt><em>byteCount</em></dt>
<dd><p>The number of bytes of text to be measured.</p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>The length, in pixels, of the specified text. </p>
<h5 class="tight">Discussion</h5>
<p>You can use <code>TextWidth</code> to measure the screen pixel width of any text segment that has uniform character attributes. You can use it to measure the style runs in a line of text, whether you intend to draw the line using <code>DrawText</code> or <code>DrawJustified</code>. The <code>TextWidth</code> function takes into account the character attributes set in the graphics port. If you change any of these attributes after determining the text width but before actually drawing the text, the predetermined width may not be correct. For a space character, <code>TextWidth</code> also includes the effect of <code>SpaceExtra</code>. For a nonspace character, <code>TextWidth</code> includes the effect of <code>CharExtra</code>.</p>
<p>Because this function measures text in the font, style, and size of the current graphics port, you need to call it once for each individual style run in any line of text that contains multiple style runs.</p>
<p>The <code>TextWidth</code> function works with text in all script systems because the script management system modifies the function if necessary to give the proper results.</p>
<p>To draw justified lines of text that include multiple style runs, you calculate the amount of extra pixels, or slop, that remains to be distributed throughout the line. This process entails measuring the screen pixel width of each style run on the line: you can use <code>TextWidth</code> for this purpose.</p>
<p>For 1-byte complex script systems, <code>TextWidth</code> calculates the widths of any ligatures, reversals, and compound characters that need to be drawn.</p>
<p>Note that <code>byteCount</code> is the number of bytes to be measured, not the number of characters. Because 2-byte script systems also include characters consisting of only one byte, you should not simply multiply the number of characters by 2 to determine this value; you must determine and specify the correct number of bytes. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/TruncString" title="TruncString"></a><a name="//apple_ref/doc/c_ref/TruncString" title="TruncString"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07955" title="TruncString"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_36"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_36"></a><h3 class="tight">TruncString</h3>
<p class="spaceabove">Ensures that a Pascal string fits into the specified pixel width, by truncating the string as necessary. This function makes use of the current script and font.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use CFString instead.)</p>
<p class="spaceabove"><pre>
short TruncString (
   short width,
   <a href="../../../../QuickTime/Reference/QTRef_DataTypes/Reference/reference.html#//apple_ref/doc/c_ref/Str255" target="_top">Str255</a> theString,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/TruncCode">TruncCode</a> truncWhere
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>width</em></dt>
<dd><p>The number of pixels in which the string must be displayed in the current script and font. </p></dd>
<dt><em>theString</em></dt>
<dd><p>The Pascal string to be displayed. On output, contains a version of the string that has been truncated (if necessary) to fit in the number of pixels specified by <code>width</code>.</p></dd>
<dt><em>truncWhere</em></dt>
<dd><p>A constant that indicates where the string should be truncated. If you supply the <code>truncEnd</code> value, characters are truncated off the end of the string. If you supply the <code>truncMiddle</code> value, characters are truncated from the middle of the string; this is useful when displaying pathnames. </p><p>See <span class="content_text"><a href="../Reference/reference.html#//apple_ref/c/tdef/TruncCode">“Truncation Positions”</a></span> for a list of the constants you can supply.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>The <code>TruncString</code> function ensures that a Pascal string fits into the pixel width specified by the <code>width</code> parameter by modifying the string, if necessary, through truncation. <code>TruncString</code> uses the font script to determine how to perform truncation. If truncation occurs, <code>TruncString</code> inserts a truncation indicator, which is the ellipsis (…) in the Roman script system. You can specify which token to use for indicating truncation as the <code>tokenEllipsis</code> token type in the untoken table of a tokens (<code>'itl4'</code>) resource.</p>
<p>To determine the width of a string in the current font and script, use the QuickDraw <code>StringWidth</code> function. </p>
<h5 class="tight">Special Considerations</h5>
<p><code>TruncString</code> may move memory; your application should not call this function at interrupt time.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/TruncText" title="TruncText"></a><a name="//apple_ref/doc/c_ref/TruncText" title="TruncText"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F07956" title="TruncText"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_37"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_37"></a><h3 class="tight">TruncText</h3>
<p class="spaceabove">Ensures that a text string fits into the specified pixel width, by truncating the string as necessary. This function makes use of the current script and font. &#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use CFString instead.)</p>
<p class="spaceabove"><pre>
short TruncText (
   short width,
   <!--a-->Ptr<!--/a--> textPtr,
   short *length,
   <a href="../Reference/reference.html#//apple_ref/doc/c_ref/TruncCode">TruncCode</a> truncWhere
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>width</em></dt>
<dd><p>The number of pixels in which the text string must be displayed in the current script and font. </p></dd>
<dt><em>textPtr</em></dt>
<dd><p>A pointer to the text string to be truncated. The text string can be up to 32 KB long.</p></dd>
<dt><em>length</em></dt>
<dd><p>On input, a pointer to a value containing the length, in bytes, of the text string to be truncated. On output, this value is updated to reflect the length of the (possibly) truncated text.</p></dd>
<dt><em>truncWhere</em></dt>
<dd><p>A constant that indicates where the text string should be truncated. You must set this parameter to one of the constants <code>truncEnd</code> or <code>truncMiddle</code>. If you supply the <code>truncEnd</code> value, characters are truncated off the end of the string. If you supply the <code>truncMiddle</code> value, characters are truncated from the middle of the string; this is useful when displaying pathnames. </p><p>See <span class="content_text"><a href="../Reference/reference.html#//apple_ref/c/tdef/TruncCode">“Truncation Positions”</a></span> for a list of the constants you can supply.</p></dd></dl>
<h5 class="tight">Discussion</h5>
<p>You can use the <code>TruncText</code> function to ensure that a string defined by a pointer and a byte length fits into the specified pixel width, by truncating the string in a manner dependent on the font script.</p>
<p><code>TruncText</code> uses the font script to determine how to perform truncation. If truncation occurs, <code>TruncText</code> inserts a truncation indicator which is the ellipsis (…) in the Roman script system. You can specify which token to use for indicating truncation as the <code>tokenEllipsis</code> token type in the untoken table of a tokens resource.</p>
<p>To determine the width of a string in the current font and script, use the QuickDraw <code>StringWidth</code> function. </p>
<h5 class="tight">Special Considerations</h5>
<p><code>TruncText</code> may move memory; your application should not call this function at interrupt time.</p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code><a name="//apple_ref/c/func/VisibleLength" title="VisibleLength"></a><a name="//apple_ref/doc/c_ref/VisibleLength" title="VisibleLength"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-F08191" title="VisibleLength"></a>
<a name="//apple_ref/doc/uid/TP30000026-AppendixA-DontLinkElementID_38"></a><a name="//apple_ref/doc/uid/TP30000026-CH1g-DontLinkElementID_38"></a><h3 class="tight">VisibleLength</h3>
<p class="spaceabove">Calculates the length, in bytes, of a given text segment, excluding trailing white space.&#032;(<font color="red">Deprecated in Mac OS X v10.4.</font>&#032;Use ATSUI instead.)</p>
<p class="spaceabove"><pre>
long VisibleLength (
   <!--a-->Ptr<!--/a--> textPtr,
   long textLength
);
</pre></p>
<h5 class="tight">Parameters</h5><dl class="termdef">
<dt><em>textPtr</em></dt>
<dd><p>A pointer to a text string.</p></dd>
<dt><em>textLength</em></dt>
<dd><p>The number of bytes in the text segment. </p></dd></dl>
<h5 class="tight">Return Value</h5>
<p>The length, in bytes, of a given text segment, excluding trailing white space. </p>
<h5 class="tight">Discussion</h5>
<p>The <code>VisibleLength</code> function determines how much of a style run to display, without displaying trailing spaces. You call <code>VisibleLength</code> for the last style run of a line in memory order. The last style run in memory order of the text constituting the line is not always the last style run in display order. For a line of unidirectional left-to-right text, the last style run in memory order is the rightmost style run in display order. For a line of unidirectional right-to-left text, the last style run in memory order is the leftmost style run in display order. However, if the text contains mixed directions, the last style run in memory order may be an interior style run in display order.</p>
<p>The text justification functions do not automatically exclude trailing spaces, so you pass them the value that <code>VisibleLength</code> returns as the length of the last style run in memory order.</p>
<p>The <code>VisibleLength</code> function behaves differently for various script systems. For simple script systems, such as Roman and Cryllic, and for 2-byte script systems, <code>VisibleLength</code> does not include in the byte count it returns trailing spaces that occur at the display end of the text segment. For 2-byte script systems, <code>VisibleLength</code> does not count them, whether they are 1-byte or 2-byte space characters.</p>
<p>For 1-byte complex script systems, <code>VisibleLength</code> does not include in the byte count that it returns spaces whose character direction is the same as the primary line direction. For 1-byte complex script systems that support bidirectional text, Roman spaces take on a character direction based on the primary line direction. If the Roman spaces then fall at the end of the text, <code>VisibleLength</code> does not include them in the returned byte count.</p>
<p>The purpose of <code>VisibleLength</code> is to trim off white space at the display end of the line. The <code>VisibleLength</code> function does not eliminate the white space by removing its character code from memory. Rather, it does not include white space characters in the count that it returns as the length of the range of text for which you call it. </p>
<h5 class="tight">Availability</h5><ul class="availability"><li class="availability">Available in Mac OS X v10.0 and later.</li><li class="availability">Deprecated in Mac OS X v10.4.</li><li class="availability">Not available to 64-bit applications.</li></ul><h5 class="tight">Declared In</h5><code>QuickdrawText.h</code>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Reference/reference.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../qdtext_ref_docrevhist/qdtext_ref_docrevhist.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-07-13<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Reference/QuickDraw_Text/DeprecationAppendix/AppendixADeprecatedAPI.html%3Fid%3DTP30000026-3.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Reference/QuickDraw_Text/DeprecationAppendix/AppendixADeprecatedAPI.html%3Fid%3DTP30000026-3.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Reference/QuickDraw_Text/DeprecationAppendix/AppendixADeprecatedAPI.html%3Fid%3DTP30000026-3.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>