<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Core Image Kernel Language Reference: Core Image Kernel Language</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Core Image Kernel Language"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="toc.html"/>
	<meta id="RESOURCES" content="../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40004397-CH206" title="Core Image Kernel Language"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> &gt; <a href="../../../../reference/GraphicsImaging/index.html#//apple_ref/doc/uid/TP30001281-TP30000424" target="_top">Graphics &amp; Imaging</a> &gt; <a href="../../../../reference/GraphicsImaging/idxQuartz-date.html#//apple_ref/doc/uid/TP30001281-TP30000424-TP30000559" target="_top">Quartz</a> &gt; <a href="Introduction/Introduction.html#//apple_ref/doc/uid/TP40004397-CH1-SW1">Core Image Kernel Language Reference</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Introduction/Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40004397-CH206-TPXREF101" title="Core Image Kernel Language"></a><h1>Core Image Kernel Language</h1><p>The following sections list the symbols provided by the Core Image Kernel Language:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BAJJGAFI">“Data Types”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BAJBIGJJ">“Keywords”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BAJDJBAA">“Functions”</a></span></p></li></ul><p>You can use these symbols together with any of the OpenGL Shading Language routines that Core Image supports. See <span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BAJJCCHE">“Unsupported Items”</a></span> for those you can’t use.</p><a name="//apple_ref/doc/uid/TP40004397-CH206-BAJDJBAA" title="Functions"></a><h2>Functions</h2><p>This section describes the following functions:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIECEBI">“compare”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIBJHBB">“cos_”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIBEIGF">“cossin”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIIIEED">“cossin_”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIHADEI">“destCoord”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIFCGCI">“premultiply”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIGDHGG">“sample”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIJHJJC">“samplerCoord”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIFCHCD">“samplerExtent”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIBDIDG">“samplerOrigin”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIFCCHA">“samplerSize”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIEGAIJ">“samplerTransform”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIIJDGH">“sin_”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIDGJAA">“sincos”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIIAIJF">“sincos_”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIEGJGD">“tan_”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ci_gslang_ext.html#//apple_ref/doc/uid/TP40004397-CH206-BCIGDJBC">“unpremultiply”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIECEBI" title="compare"></a><h3>compare</h3><dl class="termdef">	<dt><code>genType compare (genType x, genType y, genType z)</code></dt><dd><p>For each component, returns <code>x &lt; 0 ? y : z</code>. Note that <code>genType</code> is a placeholder for an arbitrary vector type.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIBJHBB" title="cos_"></a><h3>cos_</h3><dl class="termdef">	<dt><code>genType cos_ (genType x)</code></dt><dd><p>Similar to <code>cos (x)</code> except that <code>x</code> must be in the [<code>–pi</code>, <code>pi</code>] range. Note that <code>genType</code> is a placeholder for an arbitrary vector type.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIBEIGF" title="cossin"></a><h3>cossin</h3><dl class="termdef">	<dt><code>vec2 cossin (float x)</code></dt><dd><p>Returns <code>vec2 (cos (x), sin (x))</code>.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIIIEED" title="cossin_"></a><h3>cossin_</h3><dl class="termdef">	<dt><code>vec2 cossin_ (float x)</code></dt><dd><p>Returns <code>vec2 (cos (x), sin (x))</code>. This function expects <code>x</code> to be in the [<code>–pi</code>, <code>pi</code>] range.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIHADEI" title="destCoord"></a><h3>destCoord</h3><dl class="termdef">	<dt><code>varying vec2 destCoord ()</code></dt><dd><p>Returns the position, in working space coordinates, of the pixel currently being computed. The destination space refers to the coordinate space of the image you are rendering.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIFCGCI" title="premultiply"></a><h3>premultiply</h3><dl class="termdef">	<dt><code>vec4 premultiply (vec4 color)</code></dt><dd><p>Multiplies the red, green, and blue components of the <code>color</code> parameter by its alpha component.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIGDHGG" title="sample"></a><h3>sample</h3><dl class="termdef">	<dt><code>vec4 sample (uniform sampler src, vec2 point)</code></dt><dd><p>Returns the pixel value produced from sampler <code>src</code> at the position <code>point</code>, where <code>point</code> is specified in sampler space.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIJHJJC" title="samplerCoord"></a><h3>samplerCoord</h3><dl class="termdef">	<dt><code>varying vec2 samplerCoord (uniform sampler src)</code></dt><dd><p>Returns the position, in sampler space, of the sampler <code>src</code> that is associated with the current output pixel (that is, after any transformation matrix associated with <code>src</code> is applied). The sample space refers to the coordinate space of that you are texturing from.</p><p>Note that if your source data is tiled, the sample coordinate will have an offset (dx/dy). You can convert a destination location to the sampler location using the <code>samplerTransform</code> function.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIFCHCD" title="samplerExtent"></a><h3>samplerExtent</h3><dl class="termdef">	<dt><code>uniform vec4 samplerExtent (uniform sampler src)</code></dt><dd><p>Returns the extent of the sampler in world coordinates, as a four-element vector [x, y, width, height].</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIBDIDG" title="samplerOrigin"></a><h3>samplerOrigin</h3><dl class="termdef">	<dt><code>uniform vec2 samplerOrigin (uniform sampler src)</code></dt><dd><p>Equivalent to <code>samplerExtent (src).xy</code>.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIFCCHA" title="samplerSize"></a><h3>samplerSize</h3><dl class="termdef">	<dt><code>uniform vec2 samplerSize (uniform sampler src)</code></dt><dd><p>Equivalent to <code>samplerExtent (src).zw</code>.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIEGAIJ" title="samplerTransform"></a><h3>samplerTransform</h3><dl class="termdef">	<dt><code>vec2 samplerTransform (uniform sampler src, vec2 point)</code></dt><dd><p>Returns the position in the coordinate space of <code>src</code> that is associated with the position <code>point</code> defined in working space coordinates (that is, after sampler transformations are applied).</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIIJDGH" title="sin_"></a><h3>sin_</h3><dl class="termdef">	<dt><code>genType sin_ (genType x)</code></dt><dd><p>Similar to <code>sin (x)</code> except that <code>x</code> must be in the [<code>–pi</code>, <code>pi</code>] range. Note that <code>genType</code> is a placeholder for an arbitrary vector type.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIDGJAA" title="sincos"></a><h3>sincos</h3><dl class="termdef">	<dt><code>vec2 sincos (float x)</code></dt><dd><p>Returns <code>vec2 (sin (x), cos (x))</code>.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIIAIJF" title="sincos_"></a><h3>sincos_</h3><dl class="termdef">	<dt><code>vec2 sincos_ (float x)</code></dt><dd><p>Returns <code>vec2 (sin (x), cos (x))</code>. This function expects <code>x</code> to be in the [<code>–pi</code>, <code>pi</code>] range.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIEGJGD" title="tan_"></a><h3>tan_</h3><dl class="termdef">	<dt><code>genType tan_ (genType x)</code></dt><dd><p>Similar to <code>tan (x)</code> except that <code>x</code> must be in the [<code>–pi</code>, <code>pi</code>] range. Note that <code>genType</code> is a placeholder for an arbitrary vector type.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BCIGDJBC" title="unpremultiply"></a><h3>unpremultiply</h3><dl class="termdef">	<dt><code>vec4 unpremultiply (vec4 color)</code></dt><dd><p>If the alpha component of the <code>color</code> parameter is greater than 0, divides the red, green and blue components by alpha. If alpha is 0, this function returns <code>color</code>.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BAJJGAFI" title="Data Types"></a><h2>Data Types</h2><dl class="termdef">	<dt><code>sampler</code></dt><dd><p>Specifies a sampler passed in from CISampler that is used to get samples from data.</p></dd></dl><dl class="termdef">	<dt><code>__color</code></dt><dd><p>Specifies a type for kernel parameters that need to be color matched to the current CIContext working color space.</p></dd></dl><dl class="termdef">	<dt><code>__table</code></dt><dd><p>Specifies a flag for a sampler  that fetches values from a lookup table.</p><p>The <code>__table</code> flag must precede the <code>sampler</code> type. The flag ensures that Core Image does not sample the table values using world coordinates.</p><p>For example, to use a lookup table sampler in a kernel named <code>shadedmaterial</code>, the kernel declaration would be:</p><p><code>kernel vec4 shadedmaterial(sampler heightfield, __table sampler envmap, float surfaceScale, vec2 envscaling)</code></p><p>Using the <code>__table</code> flag prevents the <code>envmap</code> sampler values from being transformed, even if the shaded material kernel gets inserted into a filter chain with an affine transform. If you don’t tag the sampler this way and you chain the shaded material filter to an affine transform for rotation, then looking up values in the environment map results in getting rotated  values, which is not correct because the lookup table is simply a data collection.</p></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BAJBIGJJ" title="Keywords"></a><h2>Keywords</h2><dl class="termdef">	<dt><code>kernel</code></dt><dd><p>Specifies a kernel routine. Kernel routines are extracted and compiled by the CIKernel class. A kernel encapsulates the computation required to compute a single pixel in the output image.</p><p>Each kernel is tagged by the <code>kernel</code> keyword in its return type. The underlying return type of the kernel must be <code>vec4</code> . Core Image requires this type in order to return the output pixel for the input pixel currently being evaluated.</p><p>All parameters to the kernel are implicitly marked <code>uniform</code>. Parameters marked <code>out</code> and <code>inout</code> are not allowed.</p><p>You can pass the following types to a kernel routine:</p><ul class="termdef"><li class="termdef"><p><code>sampler</code>: Requires a CISampler object when applied.</p></li><li class="termdef"><p><code>__table</code>: A qualifier for a <code>sampler</code> type.</p></li><li class="termdef"><p><code>float</code>, <code>vec2</code>, <code>vec3</code>, <code>vec4</code>: Requires an NSNumber or CIVector.</p></li><li class="termdef"><p><code>__color</code>: A color that will be matched to the CIContext working color space when passed into the program. It requires a CIColor object when applied. To the kernel program it appears to be a <code>vec4</code> type in premultiplied RGBA format.</p></li></ul></dd></dl><a name="//apple_ref/doc/uid/TP40004397-CH206-BAJJCCHE" title="Unsupported Items"></a><h2>Unsupported Items</h2><p>Core Image does not support the OpenGL Shading Language source code preprocessor. In addition, the following are not implemented:</p><ul class="ul"><li class="li"><p>Data types: <code>mat2</code>, <code>mat3</code>, <code>mat4</code>, <code>struct</code>, <code>arrays</code></p></li><li class="li"><p>Statements: <code>continue</code>, <code>break</code>, <code>discard</code>. Other flow control statements (<code>if</code>, <code>for</code>, <code>while</code>, <code>do while</code>) are supported only when the loop condition can be inferred at the time the code compiles.</p></li><li class="li"><p>Expression operators: <code>% &lt;&lt; >> | &amp; ^ || &amp;&amp; ^^ ~ </code></p></li><li class="li"><p>Built-in functions: <code>ftransform</code>, <code>matrixCompMult</code>, <code>dfdx</code>, <code>dfdy</code>, <code>fwidth</code>, <code>noise1</code>, <code>noise2</code>, <code>noise3</code>, <code>noise4</code>, <code>refract</code></p></li></ul>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="Introduction/Introduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-06-09<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/GraphicsImaging/Reference/CIKernelLangRef/ci_gslang_ext.html%3Fid%3DTP40004397-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/GraphicsImaging/Reference/CIKernelLangRef/ci_gslang_ext.html%3Fid%3DTP40004397-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/GraphicsImaging/Reference/CIKernelLangRef/ci_gslang_ext.html%3Fid%3DTP40004397-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>