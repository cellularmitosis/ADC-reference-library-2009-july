<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>QuickTime Kit Programming Guide: Adding Multimedia Playback Capability</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Adding Multimedia Playback Capability"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001245-CH223" title="Adding Multimedia Playback Capability"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000433" target="_top">QuickTime</a> &gt; <a href="../../../Cocoa-date.html#//apple_ref/doc/uid/TP30000440-TP30000433-TP30000495" target="_top">Cocoa</a> &gt; <a href="../Chapter01/Introduction.html#//apple_ref/doc/uid/TP40001245-CH202-TPXREF101">QuickTime Kit Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Chapter06/AddingStreaming.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Revision/RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001245-CH223-TPXREF101" title="Adding Multimedia Playback Capability"></a><h1>Adding Multimedia Playback Capability</h1><p>In this chapter, you’ll add multimedia playback to your QTKitPlayer, working with the tools available to you in Interface Builder and Xcode 2.0. The goal is, as in previous chapters, to build on the code you’ve written and the interface you’ve constructed, so that you can enhance the capabilities of the QTKitPlayer—with a minimum of programming effort. </p><p>When completed, the results will be dramatic and visually exciting: a multimedia playback engine capable of simultaneously playing in real time as many as six different QuickTime movies, QuickTime VR panoramas and object movies, streaming audio and video, animation and wired sprite movies, and other content that QuickTime can import and display. The user experience will be enhanced and require some degree of interactivity with the multimedia content that is displayed. Just controlling multichannel sound or interactive VR movies will alter the user experience. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001245-CH223-SW1" title="Note"></a><p><strong>Note:</strong>&nbsp;Multimedia is an often misused term, with different meanings, implied or otherwise. To developers of digital media, “multimedia is defined by a set of standards that enable media to be acquired, represented, compressed, delivered and displayed,” according to Phillip John McKerrow, a computer scientist and teacher of multimedia programming, in a recent article in the journal <em>IEEE Multimedia</em>. “For a production to be considered multimedia it must include a provision for the user to interact with the content and influence the course of the presentation.”</p></div><p>In the completed project, you’ll add a new menu title, Studio, to the QTKitPlayer and a menu item, Present Movies. You’ll also add code to open and display all six QuickTime movies in a window, with multiple—and resizable—views of each movie. </p><p>Clicking a button in the Play Multimedia Content window will open a dialog box from which users will be able to select any movie or media type of their choice (<span class="content_text">Figure 6-1</span>). After each movie is chosen, a new dialog box appears, prompting the user for another selection until the user has populated the window with all six QuickTime movies, as shown in <span class="content_text">Figure 6-2</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIDDIHJ" title="Figure 6-1Opening six QuickTime movies of the user&acirc;&#128;&#153;s choosing for display in the multimedia content window of the QTKitPlayer application"></a><p><strong>Figure 6-1&nbsp;&nbsp;</strong>Opening six QuickTime movies of the user’s choosing for display in the multimedia content window of the QTKitPlayer application</p><img src = "../Art/open_six_movies.jpg" alt = "Opening six QuickTime movies of the user’s choosing for display in the multimedia content window of the QTKitPlayer application" ></div><br/><p>The window in which the movies are displayed can be resized to full screen for maximum visual impact and the toolbar at the top can be collapsed for a kiosk-like effect. The three movies displayed at the top of window contain an NSSplitView, while an NSTabView is provided for two movies and a text view below, and an NSScrollView with a movie appears in the right corner of the window.</p><p>The intended effect is for some degree of user interactivity with one or all of the QuickTime movies displayed, either by splitting the views and tabbing through them, or starting and stopping the playback of each movie. If all six movies are different QuickTime VR panoramas or object movies, for example, the user will be able to point and click through a variety of landscapes or hotspots from different points of view. The result is a heightened user experience.</p><br/><div><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIHGBFA" title="Figure 6-2All six movies selected by the user playing in different views"></a><p><strong>Figure 6-2&nbsp;&nbsp;</strong>All six movies selected by the user playing in different views</p><img src = "../Art/show_six_movies.jpg" alt = "All six movies selected by the user playing in different views" ></div><br/><p>Users may interact as they would with a multimedia kiosk or presentation, playing each movie at a different rate using the playback commands available in the QTKitPlayer.</p><p>At the programming level, each movie is simply a QTMovieView object and is intended to interact with other standard Cocoa views. The Show Movies button in the Play Multimedia Content window will launch each of the six dialogs that enable the user to choose a movie for display and playback. Users can then control the playback of each movie using the commands available in the QTKitPlayer to start, stop, go to the beginning, go to the end, show poster frame, step forward and step backward. Movies can also be controlled by toggling the spacebar to start and stop playback. Movie editing, however, is not enabled for any movie being displayed. </p><p>If you’ve worked through the examples in the previous chapters, you’ll be ready to move ahead with constructing and coding the multimedia playback enhancement for your QTKitPlayer. </p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="AddingMultimediaPlayback.html#//apple_ref/doc/uid/TP40001245-CH223-TPXREF141">Tasks to Accomplish</a>
				
			<br/>
			
        
			
			
				<a href="AddingMultimediaPlayback.html#//apple_ref/doc/uid/TP40001245-CH223-SW2">Constructing The Multimedia Playback Engine</a>
				
			<br/>
			
        
			
			
				<a href="AddingMultimediaPlayback.html#//apple_ref/doc/uid/TP40001245-CH223-TPXREF126">Adding Code To Display and Playback Multimedia</a>
				
			<br/>
			
        
			
			
				<a href="AddingMultimediaPlayback.html#//apple_ref/doc/uid/TP40001245-CH223-SW3">The Completed QTKit Multimedia Player</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001245-CH223-TPXREF141" title="Tasks to Accomplish"></a><h2>Tasks to Accomplish</h2><p>The tasks you want to accomplish in adding this new functionality to your QTKitPlayer application are less complex than those in the previous chapter. You’ll build on the existing QTKitPlayer, using the tools available to you in Interface Builder 2.5 and Xcode 2.0. The code you’ll need to add to the project in order to make it work will be surprisingly simple—but powerful. You’ll do this:</p><ol class="ol"><li class="li"><p>Add a View Tests Window to your MainMenu.nib in Interface Builder and populate that window with the QTMovieView objects you need to display QuickTime movies, as indicated in <span class="content_text">Figure 6-3</span>. </p></li><li class="li"><p>Specify the attributes of the View Tests Window you’ve added to the nib.</p></li><li class="li"><p>Subclass NSObject with a <code>ViewTestsController</code> class in your MainMenu.nib and wire it up with outlets and actions to handle the opening and display of movies in the View Tests Window.</p></li><li class="li"><p>Add to your Xcode project a new <code>ViewTestsController.h</code> declaration file in which you define the instance variables and actions for your <code>ViewTestsController</code> class.</p></li><li class="li"><p>Add an <code>ViewTestsController.m</code> implementation file to your QTKitPlayer project in which you handle getting and setting the movies you want to play, notifications, stopping and clearing the movies that are playing, and adding a toolbar which can be shown or not shown. </p></li><li class="li"><p>Add a new menu title to the QTKitPlayer and a menu item to open the window</p></li><li class="li"><p>Connect the Show Movies button to the ViewTestsController object. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIIADGD" title="Figure 6-3The layout of the objects in the content window with the Present Movies menu item selected "></a><p><strong>Figure 6-3&nbsp;&nbsp;</strong>The layout of the objects in the content window with the Present Movies menu item selected </p><img src = "../Art/present_movies.jpg" alt = "The layout of the objects in the content window with the Present Movies menu item selected" ></div></li></ol><p>Each task is outlined in the next sections of this chapter. You’ll start as you have before with Interface Builder and then move on to add the code you need in two separate Xcode files. </p><a name="//apple_ref/doc/uid/TP40001245-CH223-SW2" title="Constructing The Multimedia Playback Engine"></a><h2>Constructing The Multimedia Playback Engine</h2><p>By now you should be familiar with how to work with Interface Builder and its various palettes, icons, and objects. For purposes of simplicity and to move things forward a bit faster, this means combining a few basic steps in constructing your multimedia playback engine with all the different QTMovieView objects in view. To start:</p><ol class="ol"><li class="li"><p>Drag a window object from the Cocoa-Windows palette in Interface Builder into your MainMenu.nib and name it View Tests Window. </p></li><li class="li"><p>Command-1 to open the NSWindow info panel and set the attributes for the window object, as shown in <span class="content_text">Figure 6-4</span>. Enter the window title Play Multimedia Content. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIEJFDA" title="Figure 6-4The attributes pane for the View Tests Window object"></a><p><strong>Figure 6-4&nbsp;&nbsp;</strong>The attributes pane for the View Tests Window object</p><img src = "../Art/view_window_attributes.jpg" alt = "The attributes pane for the View Tests Window object" ></div></li><li class="li"><p>Press Command-3 to open the Size of the View Tests Window and set the size and springs, as shown in <span class="content_text">Figure 6-5</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIJAGJI" title="Figure 6-5The size of the View Tests Window with the springs set"></a><p><strong>Figure 6-5&nbsp;&nbsp;</strong>The size of the View Tests Window with the springs set</p><img src = "../Art/view_window_size_springs.jpg" alt = "The size of the View Tests Window with the springs set" ></div></li><li class="li"><p>Now you want to construct your Play Multimedia Content window, as shown completed in <span class="content_text">Figure 6-6</span>. Drag CustomView objects into the window and subclass them as QTMovieView objects. (In the Info window, use the Custom Class pop-up to subclass the objects.)</p></li><li class="li"><p><span class="content_text">Figure 6-6</span> shows a lot of steps that may not be obvious. To simplify, do this: Drag the TabView object into the window from the palette. Drag three CustomView objects into the window, select all three by shift-clicking, and choose Layout > Make Subviews Of > Split View. Repeat this for the ScrollView. This is the preferred way of working with these objects in your window.</p></li><li class="li"><p>Now you want to drag CustomView objects onto the TabView, SplitView, and ScrollView objects. Subclass them as QTMovieView objects. </p></li><li class="li"><p>Add textfields for Split View:, Tab View:, and Scroll View. Also, you want to add buttons in Tab View for Movie, Text, and Movie, as shown in <span class="content_text">Figure 6-6</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCICHIJC" title="Figure 6-6The layout of QTMovieView objects with textfields added for different views"></a><p><strong>Figure 6-6&nbsp;&nbsp;</strong>The layout of QTMovieView objects with textfields added for different views</p><img src = "../Art/qtmovieview_content.jpg" alt = "The layout of QTMovieView objects with textfields added for different views" ></div></li><li class="li"><p>Drag a button from the Cocoa-Controls palette into the upper right corner of the window. Name the button Show Movies and specify its attributes, as shown in <span class="content_text">Figure 6-7</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIEIAFJ" title="Figure 6-7Button attributes"></a><p><strong>Figure 6-7&nbsp;&nbsp;</strong>Button attributes</p><img src = "../Art/button_attributes.jpg" alt = "Button attributes" ></div></li><li class="li"><p>Create an action <code>doSetMovies:</code> for the Show Movies button in the upper right hand corner of the window. Double-click the ViewTestsController object. Click the actions pane. Click the Add button to add an action <code>doSetMovies:</code>. </p></li><li class="li"><p>Wire the Show Movies button to the doSetMovies: action. Click t he Show Movies button and press the Control key. Click-drag from the button to the ViewTestsController object. In the Info window for the ViewTestsController object, click the Connect button. </p></li><li class="li"><p>Now you want to specify the window attributes for the Split View, shown in <span class="content_text">Figure 6-8</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIFDCDD" title="Figure 6-8Split View attributes specified "></a><p><strong>Figure 6-8&nbsp;&nbsp;</strong>Split View attributes specified </p><img src = "../Art/window_attributes.jpg" alt = "Split View attributes specified" ></div></li><li class="li"><p>Specify the window attributes for the Tab View. Note the number of items in the TabView object, as shown in <span class="content_text">Figure 6-9</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIJCHGI" title="Figure 6-9Tab view attributes specified"></a><p><strong>Figure 6-9&nbsp;&nbsp;</strong>Tab view attributes specified</p><img src = "../Art/window_tab_attributes.jpg" alt = "Tab view attributes specified" ></div></li><li class="li"><p>Specify the attributes in the Text TabViewItem, as shown in <span class="content_text">Figure 6-10</span>. The user will be able to enter text into this window.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIHGDEG" title="Figure 6-10Text attribute specified"></a><p><strong>Figure 6-10&nbsp;&nbsp;</strong>Text attribute specified</p><img src = "../Art/view_tab_text.jpg" alt = "Text attribute specified" ></div></li><li class="li"><p>Specify the attributes of the Scroll View object, with border style, and vertical and horizontal scroller checked, as shown in <span class="content_text">Figure 6-11</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIHGIBJ" title="Figure 6-11Scroll View attributes specified"></a><p><strong>Figure 6-11&nbsp;&nbsp;</strong>Scroll View attributes specified</p><img src = "../Art/view_window_scroll_attrib.jpg" alt = "Scroll View attributes specified" ></div></li><li class="li"><p>To make the controller, subclass NSObject, and name the controller ViewTestsController. </p></li><li class="li"><p>Add outlets to ViewTestsController. Double-click the ViewTestsController object. In the Info window, click the Add button to add the following outlets: <code>mScrollViewMovieView</code>, <code>mSplitViewMovieView1</code>, <code>mSplitViewMovieView2</code>, <code>mSplitViewMovieView3</code>, <code>mTabViewMovieView1</code>, <code>mTabViewMovieView2</code>, and <code>mViewTestsWindow</code>, as shown in <span class="content_text">Figure 6-12</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIJIEGD" title="Figure 6-12Outlet connections for the ViewTestsController"></a><p><strong>Figure 6-12&nbsp;&nbsp;</strong>Outlet connections for the ViewTestsController</p><img src = "../Art/view_controller_connections.jpg" alt = "Outlet connections for the ViewTestsController" ></div></li><li class="li"><p>Now you want to wire up the connections from the various QTMovieView objects in the window to their respective outlets. Control-drag from the ViewTestController object to the ScrollView, TabView, and SplitView objects in the window and click the Connect button, as shown in <span class="content_text">Figure 6-13</span>.</p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIEHDIJ" title="Figure 6-13Connecting the ViewTestsController to an outlet"></a><p><strong>Figure 6-13&nbsp;&nbsp;</strong>Connecting the ViewTestsController to an outlet</p><img src = "../Art/outlet_connect_controller.jpg" alt = "Connecting the ViewTestsController to an outlet" ></div></li><li class="li"><p>Add another menu to the MainMenu.nib - MainMenu in Interface Builder with the title Studio, and add a menu item entitled Present Movies with a Command-1 keystroke equivalent.</p></li><li class="li"><p>Add an action <code>doShowViewTestsWindow:</code> to ViewTestsController. Double-click the ViewTestsController icon. In the Info window, click the Actions pane. Click the Add button to add an action <code>doShowViewTestsWindow:</code>. </p></li><li class="li"><p>Connect the Present Movies menu item by pressing the Control key and drag-connecting the wire to the <code>ViewTestsController</code> object. Make the connection to the <code>doShowViewTestsWindow</code> target, as shown in <span class="content_text">Figure 6-14</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIBEGDC" title="Figure 6-14The present movie connection to the ViewTestsController and target"></a><p><strong>Figure 6-14&nbsp;&nbsp;</strong>The present movie connection to the ViewTestsController and target</p><img src = "../Art/present_movie_target.jpg" alt = "The present movie connection to the ViewTestsController and target" ></div></li><li class="li"><p>Connect the Show Movies button to the ViewTestsController object, as shown in <span class="content_text">Figure 6-15</span>. </p><div class="item_figure"><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIFHDBF" title="Figure 6-15Connecting the Show Movies button to the ViewTestsController with its target"></a><p><strong>Figure 6-15&nbsp;&nbsp;</strong>Connecting the Show Movies button to the ViewTestsController with its target</p><img src = "../Art/show_movies_target.jpg" alt = "Connecting the Show Movies button to the ViewTestsController with its target" ></div></li></ol><p>This completes the steps you need to follow in Interface Builder. You’re now ready to add the code to make the project work. </p><a name="//apple_ref/doc/uid/TP40001245-CH223-TPXREF126" title="Adding Code To Display and Playback Multimedia"></a><h2>Adding Code To Display and Playback Multimedia</h2><p>In this section, you’ll add two new files to your Xcode project, including a <code>ViewTestsController.h</code> declaration file and an <code>ViewTestsController.m</code> implementation file. <span class="content_text">Figure 6-16</span> shows the class model for the <code>ViewTestsController</code> class with its properties and their connections listed </p><br/><div><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIJJHDG" title="Figure 6-16The class model in Xcode 2.0 of the ViewTestsController class"></a><p><strong>Figure 6-16&nbsp;&nbsp;</strong>The class model in Xcode 2.0 of the ViewTestsController class</p><img src = "../Art/class_model_viewtests.jpg" alt = "The class model in Xcode 2.0 of the ViewTestsController class" ></div><br/><a name="//apple_ref/doc/uid/TP40001245-CH223-TPXREF163" title="Adding Code To Your ViewTestsController Class Interface"></a><h3>Adding Code To Your ViewTestsController Class Interface</h3><p>In this next sequence of steps, you’ll be adding a small amount of code to your <code>ViewTestsController.h</code> class interface file. </p><p>To begin, in your QTKitPlayer project, choose File > New File. In the Assistant window for your new file in Xcode 2.0, select Cocoa > Objective-C class and in the window that opens enter the title <code>ViewTestsController.h</code> . Now follow these steps:</p><ol class="ol"><li class="li"><p>Insert the following import code at the beginning of your file:</p><div class="codesample"><table><tr><td scope="row"><pre>#import &lt;Cocoa/Cocoa.h><span></span></pre></td></tr><tr><td scope="row"><pre>#import &lt;QTKit/QTKit.h><span></span></pre></td></tr></table></div></li><li class="li"><p>Add this line of code: </p><div class="codesample"><table><tr><td scope="row"><pre>@class QTMovieView;<span></span></pre></td></tr></table></div></li><li class="li"><p>Add the following block of code declaring the instance variables that belong to your <code>ViewTestsController</code> class:</p><div class="codesample"><table><tr><td scope="row"><pre>@interface ViewTestsController : NSObject<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    IBOutlet NSWindow    *mViewTestsWindow;<span></span></pre></td></tr><tr><td scope="row"><pre>    IBOutlet QTMovieView *mSplitViewMovieView1;<span></span></pre></td></tr><tr><td scope="row"><pre>    IBOutlet QTMovieView *mSplitViewMovieView2;<span></span></pre></td></tr><tr><td scope="row"><pre>    IBOutlet QTMovieView *mSplitViewMovieView3;<span></span></pre></td></tr><tr><td scope="row"><pre>    IBOutlet QTMovieView *mTabViewMovieView1;<span></span></pre></td></tr><tr><td scope="row"><pre>    IBOutlet QTMovieView *mTabViewMovieView2;<span></span></pre></td></tr><tr><td scope="row"><pre>    IBOutlet QTMovieView *mScrollViewMovieView;<span></span></pre></td></tr><tr><td scope="row"><pre> }<span></span></pre></td></tr></table></div></li><li class="li"><p>Define the actions you need before the <code>@end</code> directive in order to show movies in your window and to show the window itself:</p><div class="codesample"><table><tr><td scope="row"><pre>- (IBAction)doSetMovies:(id)sender;<span></span></pre></td></tr><tr><td scope="row"><pre>- (IBAction)doShowViewTestsWindow:(id)sender;<span></span></pre></td></tr></table></div></li></ol><p>That’s it. Save your <code>ViewTestsController.h</code> file.</p><a name="//apple_ref/doc/uid/TP40001245-CH223-TPXREF140" title="Adding Code To Your ViewTestController.m "></a><h3>Adding Code To Your ViewTestController.m </h3><p>In this next sequence of steps, you’ll be adding a larger chunk of code to your <code>ViewTestsController.m</code> implementation file. </p><p>To begin, in your QTKitPlayer project, choose File > New File. In the Assistant window for your new file in Xcode 2.0, select Cocoa > Objective-C class and in the window that opens enter the title <code>ViewTestsController.m</code> . Now follow these steps</p><ol class="ol"><li class="li"><p>Insert the following import line at the beginning of your file:</p><div class="codesample"><table><tr><td scope="row"><pre>#import "ViewTestsController.h"<span></span></pre></td></tr></table></div></li><li class="li"><p>Following your import statement, you want to add this line:</p><div class="codesample"><table><tr><td scope="row"><pre>@implementation ViewTestsController<span></span></pre></td></tr></table></div></li><li class="li"><p>You want to be notified when the window is closing so you can do a cleanup. Insert these lines of code:</p><div class="codesample"><table><tr><td scope="row"><pre>-(void)awakeFromNib<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre> [ [NSNotificationCenter defaultCenter]<span></span></pre></td></tr><tr><td scope="row"><pre>    addObserver:self selector:@selector(closeWin:)<span></span></pre></td></tr><tr><td scope="row"><pre> name:NSWindowWillCloseNotification object:mViewTestsWindow ];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div></li><li class="li"><p>Add this next block to specify if the movie is playing or not. If the movie is currently playing, it returns <code>YES</code>. If not, it returns <code>NO</code>. </p><div class="codesample"><table><tr><td scope="row"><pre>-(BOOL)isPlaying:(QTMovie *)aMovie<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre> if ([aMovie rate] == 0)<span></span></pre></td></tr><tr><td scope="row"><pre> {<span></span></pre></td></tr><tr><td scope="row"><pre>return NO;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>return YES:<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div></li><li class="li"><p>Next, you need to add code to stop the movie from playing. Add these lines:</p><div class="codesample"><table><tr><td scope="row"><pre>-(void)stopPlayingMovie:(QTMovie *)aMovie<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([self isPlaying:aMovie] == YES)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        [aMovie stop];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div></li><li class="li"><p>Insert the following code to handle stopping of any currently playing movies and to clear the movies that were previously set for each view:</p><div class="codesample"><table><tr><td scope="row"><pre>- (void)closeWin:(void *)userInfo<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    // stop any currently playing movies<span></span></pre></td></tr><tr><td scope="row"><pre>    [self stopPlayingMovie:[mSplitViewMovieView1 movie]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [self stopPlayingMovie:[mSplitViewMovieView2 movie]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [self stopPlayingMovie:[mSplitViewMovieView3 movie]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [self stopPlayingMovie:[mTabViewMovieView1 movie]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [self stopPlayingMovie:[mTabViewMovieView2 movie]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [self stopPlayingMovie:[mScrollViewMovieView movie]];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // clear the movies that were previously set for each view<span></span></pre></td></tr><tr><td scope="row"><pre>    [mSplitViewMovieView1 setMovie:NULL];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mSplitViewMovieView2 setMovie:NULL];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mSplitViewMovieView3 setMovie:NULL];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mTabViewMovieView1 setMovie:NULL];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mTabViewMovieView2 setMovie:NULL];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mScrollViewMovieView setMovie:NULL];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div></li><li class="li"><p>To get the movies you want to play and open the panel so the user can choose, insert this chunk of code:</p><div class="codesample"><table><tr><td scope="row"><pre>- (QTMovie *)getAMovieFile<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSOpenPanel *openPanel;<span></span></pre></td></tr><tr><td scope="row"><pre> openPanel = [NSOpenPanel openPanel];<span></span></pre></td></tr><tr><td scope="row"><pre>    [openPanel setCanChooseDirectories:NO];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if ([openPanel runModalForTypes:[QTMovie movieUnfilteredFileTypes]] == NSOKButton)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        return [QTMovie movieWithFile:[openPanel filename] error:NULL];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    return nil;<span></span></pre></td></tr></table></div></li><li class="li"><p>To set the movies, add this chunk of code: </p><div class="codesample"><table><tr><td scope="row"><pre>- (IBAction)doSetMovies:(id)sender<span></span></pre></td></tr><tr><td scope="row"><pre>    // set the movies<span></span></pre></td></tr><tr><td scope="row"><pre> [mSplitViewMovieView1 setMovie:[self getAMovieFile]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mSplitViewMovieView2 setMovie:[self getAMovieFile]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mSplitViewMovieView3 setMovie:[self getAMovieFile]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mTabViewMovieView1 setMovie:[self getAMovieFile]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mTabViewMovieView2 setMovie:[self getAMovieFile]];<span></span></pre></td></tr><tr><td scope="row"><pre>    [mScrollViewMovieView setMovie:[self getAMovieFile]];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div></li><li class="li"><p>To add a toolbar and to show the window, add the following code:</p><div class="codesample"><table><tr><td scope="row"><pre>- (IBAction)doShowViewTestsWindow:(id)sender<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    // add a toolbar<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([mViewTestsWindow toolbar] == nil)<span></span></pre></td></tr><tr><td scope="row"><pre>        [mViewTestsWindow setToolbar:[[[NSToolbar alloc] initWithIdentifier:@"QTKitPlayer"] autorelease]];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // show the window<span></span></pre></td></tr><tr><td scope="row"><pre>    [mViewTestsWindow makeKeyAndOrderFront:nil];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>@end<span></span></pre></td></tr></table></div></li></ol><p>This completes the steps for adding code to your <code>ViewTestsController.m</code> implementation file. You can build and compile your QTKitPlayer application for multimedia playback. </p><a name="//apple_ref/doc/uid/TP40001245-CH223-SW3" title="The Completed QTKit Multimedia Player"></a><h2>The Completed QTKit Multimedia Player</h2><p>If you’ve worked through the steps outlined in this chapter, you’ll have extended your knowledge of how to build a media player that is capable of displaying and playing back up to six QuickTime movies. You can modify the code to meet your own needs, if, for example, you want to set up the QTKitPlayer so that it only displays movies that are pre-selected. This is possible with a minimum amount of code tweaking. </p><p>The goal is to expand the possibilities that are available to you with the new QTKit framework. </p><p>The effect of multimedia playback can be dramatic, indeed, when the user is able to view all six movies at full screen on their computer and even resize each movie to meet their viewing needs. In the illustration shown in <span class="content_text">Figure 6-17</span>, the QuickTime VR movie in the lower left portion of the playback window is stretched out for improved VR viewing and navigation.</p><br/><div><a name="//apple_ref/doc/uid/TP40001245-CH223-BCIDEGJB" title="Figure 6-17Full screen multimedia playback with resizing of the QuickTime VR movie in the lower left portion of the window"></a><p><strong>Figure 6-17&nbsp;&nbsp;</strong>Full screen multimedia playback with resizing of the QuickTime VR movie in the lower left portion of the window</p><img src = "../Art/show_movies_wow.jpg" alt = "Full screen multimedia playback with resizing of the QuickTime VR movie in the lower left portion of the window" ></div><br/>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../Chapter06/AddingStreaming.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Revision/RevisionHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-11-09<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/QuickTime/Conceptual/QTKitProgrammingGuide/Chapter07/AddingMultimediaPlayback.html%3Fid%3DTP40001245-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/QuickTime/Conceptual/QTKitProgrammingGuide/Chapter07/AddingMultimediaPlayback.html%3Fid%3DTP40001245-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/QuickTime/Conceptual/QTKitProgrammingGuide/Chapter07/AddingMultimediaPlayback.html%3Fid%3DTP40001245-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>