<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE>Trimeshes</TITLE></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><H1 CLASS="RH3.RoutineHd3"><A NAME="pgfId=21392"> </A><A NAME="marker=27927"> </A>Trimeshes</H1><P CLASS="T1.Text1"><A NAME="pgfId=21393"> </A>This section gives the 3DMF specification of the Trimesh object. Trimesh binary metafiles implement a simple type of compression, using a scheme described below.</P><P CLASS="Note"><A NAME="pgfId=21764"> </A>Normally a Trimesh also has one or more <TT CLASS="cv">AttributeArray</TT> subobjects. For details, see <A HREF="qd3dmetafile.34.htm#20162" CLASS="XRef">&quot;Attribute Arrays&quot;</A>. </P><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=21583"> </A>Labels</H3><DL COMPACT><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=27929"> </A>ASCII</DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=21584"> </A><TT CLASS="cv">TriMesh</TT></DD><DT CLASS="DT.DefinitionTerm"><A NAME="pgfId=27938"> </A>Binary</DT><DD CLASS="DD.DefinitionDef"><A NAME="pgfId=21585"> </A><TT CLASS="cv">tmsh</TT> ( = <TT CLASS="cv">0x746D7368</TT>)</DD></DL COMPACT></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=21606"> </A>AUXILIARY DATA STRUCTURES</H3><P CLASS="T1.Text1"><A NAME="pgfId=21397"> </A>The following auxiliary data structures are used to specify trimeshes. They are mirror images of the similarly-named structures in the file QD3DGeometry.h. See <I CLASS="italics">3D Graphics Programming With QuickDraw 3D 1.5</I> for a detailed description. </P><CODE CLASS="Cv.Code"><A NAME="pgfId=32783"> </A>typedef struct TriMeshTriangleData {<BR>&nbsp;&nbsp;&nbsp;&nbsp;Uns32&nbsp;&nbsp;&nbsp;pointIndices[3];<BR>} TriMeshTriangleData;<BR></CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=32787"> </A>typedef struct TriMeshEdgeData {<BR>&nbsp;&nbsp;&nbsp;&nbsp;Uns32&nbsp;&nbsp;&nbsp;pointIndices[2];<BR>&nbsp;&nbsp;&nbsp;&nbsp;Uns32&nbsp;&nbsp;&nbsp;triangleIndices[2];<BR>} TriMeshEdgeData;<BR></CODE><CODE CLASS="Cv.Code"><A NAME="pgfId=32791"> </A>typedef struct BoundingBox {<BR>&nbsp;&nbsp;&nbsp;&nbsp;Point3D &nbsp;&nbsp;&nbsp;&nbsp;min;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Point3D &nbsp;&nbsp;&nbsp;&nbsp;max;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Boolean&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isEmpty;<BR>} BoundingBox;<BR></CODE></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=21637"> </A>Data format</H3><CODE CLASS="Cv.Code"><A NAME="pgfId=32795"> </A>Uns32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numTriangles<BR>Uns32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numTriangleAttributeTypes<BR>Uns32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numEdges<BR>Uns32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numEdgeAttributeTypes<BR>Uns32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numPoints<BR>Uns32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numVertexAttributeTypes<BR>TriMeshTriangleData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;triangles[numTriangles]<BR>TriMeshEdgeData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edges[numEdges]<BR>Point3D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;points[numPoints]<BR>BoundingBox&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bBox<BR></CODE></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=21640"> </A>Data COMPRESSION</H3><P CLASS="T1.Text1"><A NAME="pgfId=21403"> </A>The <TT CLASS="cv">triangles</TT> and <TT CLASS="cv">edges</TT> fields in a trimesh are compressed. These fields are arrays of indices into arrays of elements; the maximum value of the indices depends on the size of the array of elements. Hence, the maximum value of an index in the <TT CLASS="cv">TriMeshTriangleData</TT> field <TT CLASS="cv">pointIndices</TT> is equal to <TT CLASS="cv">numPoints</TT>. The same is true for the <TT CLASS="cv">pointIndices</TT> field of <TT CLASS="cv">TriMeshEdgeData</TT>; the maximum value of an index in the <TT CLASS="cv">triangleIndices</TT> field is <TT CLASS="cv">numTriangles</TT>. Compression is performed as follows: </P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=21404"> </A>If maximum value of <TT CLASS="cv">index</TT> &lt;= 0xFE, write <TT CLASS="cv">index</TT> as <TT CLASS="cv">Uns8</TT></LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=21778"> </A>If maximum value of <TT CLASS="cv">index</TT> &gt; 0xFE and &lt;= 0xFFFE, write <TT CLASS="cv">index</TT> as <TT CLASS="cv">Uns16</TT></LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=21779"> </A>If maximum value of <TT CLASS="cv">index</TT> &gt; 0xFFFE, write <TT CLASS="cv">index</TT> as <TT CLASS="cv">Uns32</TT></LI></UL><P CLASS="T1.Text1"><A NAME="pgfId=21405"> </A>The <TT CLASS="cv">triangleIndices</TT> field of <TT CLASS="cv">TriMeshEdgeData</TT> has, in addition, the following special case. If a side of an edge does not have a triangle (as is the case if the edge is on a boundary), this is indicated in the trimesh data structure by the constant <TT CLASS="cv">kQ3ArrayIndexNULL</TT>. Since this is a 32-bit quantity, you may need to compress it. Do this by writing <TT CLASS="cv">kQ3ArrayIndexNULL</TT> as follows: </P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=21406"> </A>If maximum value of <TT CLASS="cv">index</TT> &lt;= 0xFE, write 0xFF</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=21780"> </A>If maximum value of <TT CLASS="cv">index</TT> &gt; 0xFE and &lt;= 0xFFFE, write 0xFFFF</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=21781"> </A>If maximum value of <TT CLASS="cv">index</TT> &gt; 0xFFFE, write <TT CLASS="cv">kQ3ArrayIndexNULL</TT></LI></UL></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=21775"> </A>Example</H3><P CLASS="T1.Text1"><A NAME="pgfId=21407"> </A>For an example of a trimesh text metafile, see <A HREF="qd3dmetafile.34.htm#20162" CLASS="XRef">&quot;Attribute Arrays&quot;</A>. </P></DIV><hr>&#169; 1997 Apple Computer, Inc.</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>