<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">
<script language="JavaScript" src="frametest.js"></script>
<TITLE> TECConvertText</TITLE><LINK REL="stylesheet" TYPE="text/css" HREF="../../../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../../../Resources/JavaScript/page.js"></script>
</head>
<body bgcolor="#ffffff">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>

<DIV>
<a name="top"></a>
<!-- start of header -->
<!--#include virtual="/includes/framesetheader" -->
<!-- end of header --><A HREF="TEC.61.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.61.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.63.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A><br>
<font face="Geneva,Helvetica,Arial" size="1"><b><br>
		PATH<spacer type="horizontal" size="5">&nbsp;</b></font><a href="../../../mac8.html"><font face="Geneva,Helvetica,Arial" size="1">Mac OS 8 and 9 Developer Documentation</a>  <b>&gt;</b> Text Encoding Conversion Manager<br>
		<img src="images/im_smblue.gif" width="116" height="8"><img src="images/space.gif" width="6" height="11">Programming With the Text Encoding Conversion Manager</font><br>
		<br>
		<hr>

</DIV>
<H1>
<A NAME="pgfId=4643">
 </A>
<A NAME="31902">
 </A>
TECConvertText</H1>
<P>
<A NAME="pgfId=7140">
 </A>
Converts a stream of text from a source encoding to a destination encoding. </P>
<TT>
<A NAME="pgfId=31868">
 </A>
pascal OSStatus TECConvertText(<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TECObjectRef encodingConverter,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConstTextPtr inputBuffer,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount inputBufferLength,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount *actualInputLength,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TextPtr outputBuffer,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount outputBufferLength,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteCount *actualOutputLength);</TT>
<DL COMPACT>
<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31872">
 </A>
<TT>encodingConverter</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=7061">
 </A>
 The reference to the text encoding converter object to be used for the conversion.This can be a reference returned by the function <A HREF="TEC.5b.html" CLASS="XRef"><TT>TECCreateConverter</A> or <A HREF="TEC.5c.html" CLASS="XRef">TECCreateConverterFromPath</TT></A>. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31883">
 </A>
<TT>inputBuffer</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=7029">
 </A>
The stream of text to be converted.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31892">
 </A>
<TT>inputBufferLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=4669">
 </A>
 The length in bytes of the stream of text specified in the <TT>inputBuffer</TT> parameter. A byte is currently defined as a value of type <TT>UInt8</TT> or <TT>unsigned char</TT>.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31902">
 </A>
<TT>actualInputLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=7075">
 </A>
 A pointer to a value of type <TT>ByteCount</TT>. On output, this value is the number of source text bytes from the input buffer that <TT>TECConvertText</TT> converted. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31912">
 </A>
<TT>outputBuffer</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=4679">
 </A>
A pointer to a buffer for a byte stream. On output, this buffer holds the converted text. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31921">
 </A>
<TT>outputBufferLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=21761">
 </A>
 The length in bytes of the buffer provided by the <TT>outputBuffer</TT> parameter. </DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31931">
 </A>
<TT>actualOutputLength</TT></DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=7125">
 </A>
 A pointer to a value of type <TT>ByteCount</TT>. On output this value is the number of bytes of converted text returned in the buffer specified by the <TT>outputBuffer</TT> parameter.</DD><P>

<DT CLASS="DT.DefinitionTerm">
<A NAME="pgfId=31941">
 </A>
<I CLASS="italics">
function result</I>
</DT>
<DD CLASS="DD.DefinitionDef">
<A NAME="pgfId=7131">
 </A>
 A result code. See <A HREF="TEC.20.html" CLASS="XRef">
Text Encoding Conversion Manager Result Codes</A>
 for a list of possible values. If there is not enough memory available for <TT>TECConvertText</TT> to convert the text when allocating internal buffers, the function returns the appropriate Memory Manager result code.</DD><P>

</DL COMPACT>
<DIV>
<H5 CLASS="RSb.RoutineSbhd">
<A NAME="pgfId=4700">
 </A>
DISCUSSION</H5>
<P>
<A NAME="pgfId=4703">
 </A>
The <TT>TECConvertText</TT> function converts a buffer of text according to information contained in the converter object. The converter object specifies the source encoding, destination encoding, and any intermediate encodings required for conversion. The function returns the text in the output buffer that you provide. <P>


<A NAME="pgfId=10563">
 </A>
In allocating an output buffer, a good rule of thumb is larger is better, basing your estimate on the byte requirements of the destination encoding. You should always allocate a buffer at least 32 bytes long. For the function to return successfully, the output buffer you allocate must be large enough to accommodate at least part of the converted text. Then, if the function cannot convert all of the text, it executes successfully, returns the portion of the text it converted, and returns the number of source bytes it removed from input in the <TT>actualInputLength</TT> parameter. You can use this number to identify the next byte to be taken and to determine how many bytes remain. To convert the remaining text, you simply call the function again with the remaining text and a new output buffer. <P>


<A NAME="pgfId=10617">
 </A>
If the output buffer you allocate is too small to accommodate <I CLASS="italics">
any</I>
 of the converted text, the function fails. For example, if the destination encoding requires additional bytes in addition to the actual text (for instance, an escape sequence preceding the converted text), your buffer must be large enough to accommodate both.</P>
</DIV>
<DIV>
<H4>
<A NAME="pgfId=31953">
 </A>
<BLOCKQUOTE>IMPORTANT</H4>
<P>
<A NAME="pgfId=17524">
 </A>
If the destination encoding is a character encoding scheme--such as ISO-2022-JP, which begins in ASCII and switches to other coded character sets through limited combinations of escape sequences--then you need to allocate enough space to accommodate escape sequences that signal switches. ISO-2022-JP requires 3 to 5 bytes for an escape sequence preceding the 1-byte or 2-byte character it introduces. If you allocate a buffer that is less than 5 bytes, the <TT>TECConvertText</TT> function could fail, depending on the text being converted. <P></BLOCKQUOTE>


<A NAME="pgfId=24336">
 </A>
To make sure that you receive all of the converted text, you should call the function <A HREF="TEC.63.html" CLASS="XRef"><TT>TECFlushText</TT></A> when you are finished converting all the text in a particular text stream. </P>
</DIV>
<HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 13 Dec 99)<P><A HREF="TEC.61.html"><img src="images/up.gif" border="0" alt="Up"></A><nobr>&nbsp;</nobr><A HREF="TEC.61.html"><img src="images/previous.gif" border="0" alt="Previous"></A><nobr>&nbsp;</nobr><A HREF="TEC.63.html"><img src="images/next.gif" border="0" alt="Next"></A><nobr>&nbsp;</nobr>
<!-- insert Show/Hide frames -->
<a href="javascript:testFrame()">
<script>
<!--
document.write(frameLink);
//	-->
</script><!-- end Show/Hide frames --></A>

<!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY>
</HTML>
