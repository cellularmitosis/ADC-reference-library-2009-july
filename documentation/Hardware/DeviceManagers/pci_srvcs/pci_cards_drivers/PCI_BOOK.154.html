<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> DMA Alignment Requirements</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.149.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.153.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.155.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H3.Heading3"><A NAME="pgfId=3704"> </A><A NAME="37753"> </A>DMA Alignment Requirements</H1><P CLASS="T1.Text1"><A NAME="pgfId=3705"> </A>A variation on the physical transfer of data occurs when the client's buffer does not meet the alignment requirements of the <A NAME="direct memory access (DMA)"> </A>DMA hardware. In this case, the driver needs to supply a logical mapping table in addition to the physical mapping table, so that programmed I/O can be performed in the unaligned beginning and/or end of the buffer. Otherwise, the driver would have to prepare the beginning and end separately from the middle portion.</P><P CLASS="T1.Text1"><A NAME="pgfId=3707"> </A>Because only the beginning and the end of the buffer will be transferred with programmed I/O, only the first and last logical mapping table entries are actually needed--the middle entries are page aligned, which is usually sufficient for any DMA engine. To reduce memory usage, the driver may limit the size of the logical mapping table to just two entries per range and may specify the <TT CLASS="cv">kIOMinimalLogicalMapping</TT> option. <TT CLASS="cv">PrepareMemoryForIO</TT> will fill in the first logical mapping table entry of each range as usual and will fill the second entry with the static logical mapping of the last page in the range. Two entries per range are used, regardless of the range sizes. However, the value of the second entry of the pair is undefined if the range is contained within a single page.</P><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.149.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.153.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.155.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>