<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>GiMeDaPalette with Sound - /GiMeDaPalette&amp;Sound.c</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; <A HREF="javascript:location.replace('index.html');">GiMeDaPalette with Sound</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/index.html" target="_blank">Reference Library</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">GiMeDaPalette with Sound</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/GiMeDaPalette&amp;Sound.c</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/GiMeDaPalette&amp;Sound.c</option></select>
				</p>
				</form>
				<p><strong><a href="GiMeDaPalette_with_Sound.zip">Download Sample</a></strong> (&#147;GiMeDaPalette_with_Sound.zip&#148;, 18.2K)<BR>
<strong><a href="GiMeDaPalette_with_Sound.dmg">Download Sample</a></strong> (&#147;GiMeDaPalette_with_Sound.dmg&#148;, 78.7K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*  File:    GiMeDaPalette&amp;Sound.c  Contains:  This is the original version of GiMeDaPalette with the change to it to make it         possible to play a sound at the same time as the colors are being animated.          The method which is being used to play the sound is to use Double Buffering.          When ever you select some form of Animation from the menu, there will be sound         to go with it.  Written by: RICHARD P. COLLYER       Copyright:  Copyright &copy; 1990-1999 by Apple Computer, Inc., All Rights Reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        8/2/1999  Karl Groethe  Updated for Metrowerks Codewarror Pro 2.1        */#include  &lt;CType.h&gt;#include  &lt;Quickdraw.h&gt;#include  &lt;Windows.h&gt;#include  &lt;desk.h&gt;#include  &lt;dialogs.h&gt;#include  &lt;Events.h&gt;#include   &lt;GestaltEqu.h&gt;#include  &lt;Memory.h&gt;#include  &lt;Menus.h&gt;#include  &lt;OSEvents.h&gt;#include  &lt;Palettes.h&gt;#include  &lt;SegLoad.h&gt;#include  &lt;Sound.h&gt;#include  &lt;Resources.h&gt;#include  &lt;ToolUtils.h&gt;#include  &lt;StdIO.h&gt;#include  &lt;QDOffscreen.h&gt;extern _DataInit();#define pmInhibitG2    0x0100#define pmInhibitC2    0x0200#define pmInhibitG4    0x0400#define pmInhibitC4    0x0800#define pmInhibitG8    0x1000#define pmInhibitC8    0x2000#define  TRUE      0xFF#define  FALSE      0#define Gestalttest    0xA1AD#define NoTrap      0xA89F#define  appleID      128      #define  appleMenu    0#define  aboutMeCommand  1#define  fileID      129#define  quitCommand   1#define  PaletteID    130#define  CourCommand   1#define  TolCommand     2#define  ExpCommand     3#define  AniCommand     4#define  TolExpCommand   6#define  TolAniCommand   7#define  ExpAniCommand   8#define  TEACommand     10#define  PictID      128#define  clutID      150#define  aboutMeDLOG    128#define  okButton    1#define  authorItem    2#define  languageItem  3#define  numcolor    256#define kDoubleBufferSize  0x1000struct LocalVars {    long  bytesTotal;    long  bytesCopied;    Ptr    dataPtr;};typedef struct LocalVars LocalVars;typedef LocalVars *LocalVarsPtr;Rect          TotalRect, minRect, WinMinusScroll, InitWindowSize;WindowPtr        myWindow;CTabHandle        mycolors;PaletteHandle      srcPalette;Boolean          DoneFlag;MenuHandle        mymenu1, mymenu2, mymenu0;PicHandle        ThePict;GWorldPtr        offscreenGWorld;SndDoubleBufferHeader  doubleHeader;SndDoubleBufferPtr    doubleBuffer;SCStatus        Stats;SndChannelPtr      chan;SoundHeaderPtr      Head;Handle          SoundData;LocalVars        myVars;SndDoubleBackUPP        gSndDoubleBackUPP;pascal void MyDoubleBackProc (SndChannelPtr channel, SndDoubleBufferPtr doubleBufferPtr);void CheckMenu(int whichMenu);void SoundSetUp();void SoundOff();void Draw();void SetInhibited(int Usage);void showAboutMeDialog();void doCommand(long mResult);void init();/*______________________________________________________*//*              Sound Double Back Proc                  *//*______________________________________________________*/pascal void MyDoubleBackProc (SndChannelPtr chan,SndDoubleBufferPtr doubleBuffer){  #pragma unused(chan)LocalVarsPtr  myVarsPtr;long      bytesToCopy;myVarsPtr = (LocalVarsPtr) doubleBuffer-&gt;dbUserInfo[0];bytesToCopy = myVarsPtr-&gt;bytesTotal - myVarsPtr-&gt;bytesCopied;if (bytesToCopy &gt; kDoubleBufferSize)  bytesToCopy = kDoubleBufferSize;  BlockMove (myVarsPtr-&gt;dataPtr, &amp;doubleBuffer-&gt;dbSoundData[0], bytesToCopy);doubleBuffer-&gt;dbNumFrames = bytesToCopy;doubleBuffer-&gt;dbFlags = (doubleBuffer-&gt;dbFlags) | dbBufferReady;myVarsPtr-&gt;dataPtr = (Ptr) ((myVarsPtr-&gt;dataPtr) + bytesToCopy);myVarsPtr-&gt;bytesCopied = myVarsPtr-&gt;bytesCopied + bytesToCopy;if (myVarsPtr-&gt;bytesCopied == myVarsPtr-&gt;bytesTotal) {  doubleBuffer-&gt;dbFlags = (doubleBuffer-&gt;dbFlags) | dbLastBuffer;  }  return;}/*______________________________________________________*//*                Check Correct Menu                    *//*______________________________________________________*/void CheckMenu(int whichMenu)/* This procedure checks and unchecks the appropriate menus */{      CheckItem(mymenu2,CourCommand,FALSE);      CheckItem(mymenu2,TolCommand,FALSE);      CheckItem(mymenu2,ExpCommand,FALSE);      CheckItem(mymenu2,AniCommand,FALSE);      CheckItem(mymenu2,TolExpCommand,FALSE);      CheckItem(mymenu2,TolAniCommand,FALSE);      CheckItem(mymenu2,ExpAniCommand,FALSE);      CheckItem(mymenu2,TEACommand,FALSE);  switch (whichMenu) {    case CourCommand:      CheckItem(mymenu2,CourCommand,TRUE);      break;    case TolCommand:      CheckItem(mymenu2,TolCommand,TRUE);      break;    case ExpCommand:      CheckItem(mymenu2,ExpCommand,TRUE);      break;    case AniCommand:      CheckItem(mymenu2,AniCommand,TRUE);      break;    case TolExpCommand:      CheckItem(mymenu2,TolExpCommand,TRUE);      break;    case TolAniCommand:      CheckItem(mymenu2,TolAniCommand,TRUE);      break;    case ExpAniCommand:      CheckItem(mymenu2,ExpAniCommand,TRUE);      break;    case TEACommand:      CheckItem(mymenu2,TEACommand,TRUE);      break;    defalut:      break;    }}/*______________________________________________________*//*                     Start Sound                      *//*______________________________________________________*/void SoundSetUp(){  int        i;  OSErr      err;    chan = nil;  err = SndNewChannel (&amp;chan, sampledSynth, 0, nil);  if (err != noErr)    Debugger();    Head = (SoundHeaderPtr) NewPtrClear (sizeof(SoundHeader));  Head-&gt;samplePtr = *SoundData;  Head-&gt;length = 45838;  Head-&gt;sampleRate = 0x56EE8BA3;    //recorded at 22KHz  Head-&gt;loopStart = 0;  Head-&gt;loopEnd = 0;  Head-&gt;encode = 0;  Head-&gt;baseFrequency = 60;  Head-&gt;sampleArea[0] = 0;  myVars.bytesTotal = Head-&gt;length;  myVars.bytesCopied = 0;  myVars.dataPtr = Head-&gt;samplePtr;  doubleHeader.dbhNumChannels = 1;  doubleHeader.dbhSampleSize = 8;  doubleHeader.dbhCompressionID = 0;  doubleHeader.dbhPacketSize = 0;  doubleHeader.dbhSampleRate = Head-&gt;sampleRate;    doubleHeader.dbhDoubleBack = gSndDoubleBackUPP;  for (i = 0; i &lt;= 1; ++i) {    doubleBuffer = (SndDoubleBufferPtr) NewPtrClear (sizeof(SndDoubleBuffer) + kDoubleBufferSize);      if (doubleBuffer == nil || MemError() != 0)      Debugger();        doubleBuffer-&gt;dbNumFrames = 0;    doubleBuffer-&gt;dbFlags = 0;    doubleBuffer-&gt;dbUserInfo [0] = (long) &amp;myVars;      MyDoubleBackProc (chan, doubleBuffer);      // initialize the buffers      doubleHeader.dbhBufferPtr [i] = doubleBuffer;    }}/*______________________________________________________*//*                     Start Sound                      *//*______________________________________________________*/void SoundOff(){  OSErr    err;    err = SndPlayDoubleBuffer (chan, &amp;doubleHeader);  if (err != noErr)    Debugger();}/*______________________________________________________*//*             Set Up Usage of Palette                  *//*______________________________________________________*/void Draw(){  RGBColor    black = {0,0,0}, White = {65535,65535,65535};      RGBForeColor (&amp;black);  RGBBackColor (&amp;White);  CopyBits ((BitMap *) *offscreenGWorld-&gt;portPixMap, &amp;myWindow-&gt;portBits,           &amp;InitWindowSize, &amp;WinMinusScroll, srcCopy, nil);}/*______________________________________________________*//*             Set Up Usage of Palette                  *//*______________________________________________________*/void SetInhibited(int Usage)/* When the usage of the palette changes I need to rebuild the palette,so I call this routine.  I need to call SetEntryUsage on all of the entriesof the palette, but I want to make sure that if the monitor is set to a bit depthlow than 8 bits that the palette is limited in its colors.  So the first two colors(not including white) are set to work at all depths except 1 bit mode.  The next 12 entries are set to work on all depths except 1 &amp; 2 bit modes.  The rest of the colors are set to only work in 8 bit mode.  I have also set the tolerance tohex 1500.  With this tolerance I will be able to get most of the colors I need and those that I don't get exact will be very close. */{  int    i;    CTab2Palette (mycolors, srcPalette, Usage, 0x1500);  for (i = 1; i &lt;= 2; ++i) {    SetEntryUsage (srcPalette, i, Usage, 0x1500);    }  for (i = 3; i &lt;= 14; ++i) {    SetEntryUsage (srcPalette, i, Usage+pmInhibitG2+pmInhibitC2, 0x1500);    }  for (i = 15; i &lt; numcolor; ++i) {    SetEntryUsage (srcPalette, i, Usage+pmInhibitG2+pmInhibitC2+            pmInhibitG4+pmInhibitC4, 0x1500);    }}/*______________________________________________________*//*                 About Prog Dialog                    *//*______________________________________________________*/void showAboutMeDialog(){  GrafPtr   savePort;  DialogPtr  theDialog;  short    itemHit;  GetPort(&amp;savePort);  theDialog = GetNewDialog(aboutMeDLOG, nil, (WindowPtr) -1);  SetPort(theDialog);  do {    ModalDialog(nil, &amp;itemHit);  } while (itemHit != okButton);  CloseDialog(theDialog);  SetPort(savePort);  return;}/*______________________________________________________*//*                 Do Menu Function                     *//*______________________________________________________*/void doCommand(long mResult){  int           theMenu, theItem;  Str255          daName;  GrafPtr         savePort;  theItem = LoWord(mResult);  theMenu = HiWord(mResult);    switch (theMenu) {/*______________________________________________________*//*                    Do Apple Menu                     *//*______________________________________________________*/    case appleID:      if (theItem == aboutMeCommand)        showAboutMeDialog();      else {        GetMenuItemText(mymenu0, theItem, daName);        GetPort(&amp;savePort);        (void) OpenDeskAcc(daName);        SetPort(savePort);      }      break;/*______________________________________________________*//*                     Do File Menu                     *//*______________________________________________________*/    case fileID:      switch (theItem) {        case quitCommand:          DoneFlag = TRUE;          break;        default:          break;        }      break;/*______________________________________________________*//*                     Do File Menu                     *//*______________________________________________________*/    case PaletteID:      switch (theItem) {        case CourCommand:          CheckMenu(CourCommand);          SetInhibited(pmCourteous);          break;        case TolCommand:          CheckMenu(TolCommand);          SetInhibited(pmTolerant);          break;        case ExpCommand:          CheckMenu(ExpCommand);          SetInhibited(pmExplicit);          break;        case AniCommand:          CheckMenu(AniCommand);          SetInhibited(pmAnimated);          SoundOff();          break;        case TolExpCommand:          CheckMenu(TolExpCommand);          SetInhibited(pmTolerant+pmExplicit);          break;        case TolAniCommand:          CheckMenu(TolAniCommand);          SetInhibited(pmTolerant+pmAnimated);          SoundOff();          break;        case ExpAniCommand:          CheckMenu(ExpAniCommand);          SetInhibited(pmAnimated+pmExplicit);          SoundOff();          break;        case TEACommand:          CheckMenu(TEACommand);          SetInhibited(pmTolerant+pmExplicit+pmAnimated);          SoundOff();          break;        default:          break;        }      SetPalette ((WindowPtr) myWindow, srcPalette, TRUE);      ActivatePalette ((WindowPtr) myWindow);      break;    }  HiliteMenu(0);  return;}/*______________________________________________________*//*               Initialization traps                   *//*______________________________________________________*/void init(){  RgnHandle      tempRgn;  Rect        BaseRect;  OSErr        err;  long        QDfeature, OSfeature;  GDHandle      SaveGD;  CGrafPtr      SavePort;  RGBColor      black = {0,0,0}, White = {65535,65535,65535};  //UnloadSeg(_DataInit);  InitGraf(&amp;qd.thePort);  FlushEvents(everyEvent, 0);  InitMenus();  InitWindows();  InitDialogs(nil);  InitCursor();    /* set up the UPP for MyDoubleBackProc */  gSndDoubleBackUPP = NewSndDoubleBackProc(MyDoubleBackProc);    DoneFlag = FALSE;  ThePict = GetPicture(PictID);  if (ThePict == nil)    DoneFlag = TRUE;/*______________________________________________________*//*            Use Gestalt to find 32BQD                 *//*______________________________________________________*/  err = Gestalt(gestaltQuickdrawVersion, &amp;QDfeature);  if (err &amp;&amp; (QDfeature &amp; 0x0f00) &lt; 0x0200)    DoneFlag = TRUE;  err = Gestalt(gestaltSystemVersion, &amp;OSfeature);  if (err)    DoneFlag = TRUE;  if (!DoneFlag &amp;&amp; (QDfeature &amp; 0x0f00) != 0x0200 &amp;&amp; OSfeature &lt; 0x0605)    DoneFlag = TRUE;/*______________________________________________________*//*                     Set Rects                        *//*______________________________________________________*/if (DoneFlag == FALSE) {  SetRect(&amp;BaseRect, 40, 60, 472, 282);  SetRect(&amp;WinMinusScroll, BaseRect.left-40, BaseRect.top-60, BaseRect.right-60,         BaseRect.bottom - 80);  SetRect(&amp;InitWindowSize, WinMinusScroll.left, WinMinusScroll.top,               WinMinusScroll.right, WinMinusScroll.bottom);  tempRgn = GetGrayRgn();  HLock ((Handle) tempRgn);  TotalRect = (**tempRgn).rgnBBox;  SetRect(&amp;minRect, 80, 80, (**tempRgn).rgnBBox.right - 40,         (**tempRgn).rgnBBox.bottom - 40);  HUnlock ((Handle) tempRgn);/*______________________________________________________*//*        Open Window &amp; set Palette &amp; Picture           *//*______________________________________________________*/  GetGWorld (&amp;SavePort, &amp;SaveGD);  mycolors = GetCTable (clutID);  (*mycolors)-&gt;ctFlags |= 0x4000;  myWindow = NewCWindow(nil, &amp;BaseRect, &quot;\p&quot;, TRUE, zoomDocProc,               (WindowPtr) -1, TRUE, 150);  SetGWorld((CGrafPtr)myWindow, SaveGD);  DrawGrowIcon (myWindow);  srcPalette = NewPalette (numcolor, mycolors, pmCourteous, 0);  SetInhibited(pmCourteous);  SetPalette ((WindowPtr) myWindow, srcPalette, TRUE);    DrawPicture (ThePict, &amp;InitWindowSize);  GetGWorld (&amp;SavePort, &amp;SaveGD);  err = NewGWorld (&amp;offscreenGWorld, 8, &amp;InitWindowSize, mycolors, nil, nil);  if (err)    Debugger();  SetGWorld (offscreenGWorld, nil);  EraseRect (&amp;InitWindowSize);  DrawPicture (ThePict, &amp;InitWindowSize);  SetGWorld (SavePort, SaveGD);    /*______________________________________________________*//*                    Set menus                         *//*______________________________________________________*/  mymenu0 = GetMenu(appleID);  AppendResMenu(mymenu0, 'DRVR');  InsertMenu(mymenu0,0);  mymenu1 = GetMenu(129);  InsertMenu(mymenu1,0);  mymenu2 = GetMenu(130);  InsertMenu(mymenu2,0);  DrawMenuBar();/*______________________________________________________*//*                  Set Up Sound                        *//*______________________________________________________*/  SoundData = GetResource ('snd ', 100);  if (ResError() != noErr || SoundData == nil)    Debugger();  HLock (SoundData);  SoundSetUp();  }    return;}main(){  char      key;  Boolean      track;  long      growResult;  EventRecord   myEvent;  WindowPtr    whichWindow;  int        yieldTime;  RGBColor    changecolor;  CTabHandle    StoreCTab;  short      Usage, Tolerance;  OSErr      err;/*______________________________________________________*//*                   Main Event loop                    *//*______________________________________________________*/  init();  yieldTime = 0;  StoreCTab = GetCTable (clutID);  for ( ;; ) {    if (DoneFlag) {      ExitToShell();      }          /* If the usage is set to animate than animate the colors one step for eash event loop */    GetEntryUsage(srcPalette, 1, &amp;Usage, &amp;Tolerance);    Usage &amp;= 0x0004;    if (Usage == 0x0004) {      err = SndChannelStatus (chan, sizeof (Stats), &amp;Stats);      if (err != noErr)        Debugger();      if (!Stats.scChannelBusy) {        err = SndDisposeChannel (chan,FALSE);        if (err != noErr)          Debugger();            SoundSetUp();        SoundOff();        }      GetEntryColor (srcPalette, 1, &amp;changecolor);      AnimatePalette (myWindow, StoreCTab, 2, 1, numcolor - 2);      AnimateEntry (myWindow, numcolor - 1, &amp;changecolor);      Palette2CTab (srcPalette, StoreCTab);      }          if (WaitNextEvent(everyEvent, &amp;myEvent, yieldTime, nil)) {      switch (myEvent.what) {        case mouseDown:          switch (FindWindow(myEvent.where, &amp;whichWindow)) {            case inSysWindow:              SystemClick(&amp;myEvent, whichWindow);              break;            case inMenuBar:              doCommand(MenuSelect(myEvent.where));              break;            case inContent:              break;            case inDrag:              DragWindow (whichWindow, myEvent.where, &amp;TotalRect);              Draw();              DrawGrowIcon (whichWindow);              break;            case inGrow:              growResult = GrowWindow (whichWindow, myEvent.where,                          &amp;minRect);              SizeWindow(whichWindow, LoWord(growResult),                   HiWord(growResult), TRUE);              EraseRect(&amp;whichWindow-&gt;portRect);              SetRect(&amp;WinMinusScroll, whichWindow-&gt;portRect.left,                   whichWindow-&gt;portRect.top,                   whichWindow-&gt;portRect.right-20,                   whichWindow-&gt;portRect.bottom - 20);              Draw();              DrawGrowIcon (whichWindow);              break;            case inGoAway:              track = TrackGoAway (whichWindow, myEvent.where);              if (track) {                CloseWindow (whichWindow);                DoneFlag = TRUE;                }              break;            case inZoomIn:              track = TrackBox (whichWindow, myEvent.where, inZoomIn);              if (track) {                ZoomWindow (whichWindow, inZoomIn, TRUE);                EraseRect(&amp;whichWindow-&gt;portRect);                SetRect(&amp;WinMinusScroll, whichWindow-&gt;portRect.left,                     whichWindow-&gt;portRect.top,                     whichWindow-&gt;portRect.right-20,                     whichWindow-&gt;portRect.bottom - 20);                Draw();                DrawGrowIcon (whichWindow);                }              break;            case inZoomOut:              track = TrackBox (whichWindow, myEvent.where, inZoomOut);              if (track) {                ZoomWindow (whichWindow, inZoomOut, TRUE);                EraseRect(&amp;whichWindow-&gt;portRect);                SetRect(&amp;WinMinusScroll, whichWindow-&gt;portRect.left,                     whichWindow-&gt;portRect.top,                     whichWindow-&gt;portRect.right-20,                     whichWindow-&gt;portRect.bottom - 20);                Draw();                DrawGrowIcon (whichWindow);                }              break;            default:              break;            }          break;        case keyDown:        case autoKey:          key = myEvent.message &amp; charCodeMask;          if ( myEvent.modifiers &amp; cmdKey )            if ( myEvent.what == keyDown )              doCommand(MenuKey(key));          break;        case updateEvt:          if ((WindowPtr) myEvent.message == myWindow) {            BeginUpdate((WindowPtr) myWindow);            EndUpdate((WindowPtr) myWindow);            Draw();            }          break;        case diskEvt:          break;        case activateEvt:          break;        case app4Evt:          if ((myEvent.message &lt;&lt; 31) == 0) { /* Suspend */            yieldTime = 30;            HideWindow((WindowPtr) myWindow);            }          else { /* Resume */            yieldTime = 0;            ShowWindow((WindowPtr) myWindow);            SetPort((WindowPtr) myWindow);            }          break;        default:          break;        }      }    }}</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/GiMeDaPalette_with_Sound/listing1.html%3Fid%3DDTS10000364-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/GiMeDaPalette_with_Sound/listing1.html%3Fid%3DDTS10000364-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/GiMeDaPalette_with_Sound/listing1.html%3Fid%3DDTS10000364-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>