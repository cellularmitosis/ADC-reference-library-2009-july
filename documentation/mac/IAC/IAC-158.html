<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>AEInteractWithUser(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING158></A>


<!-- Top of Header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- Bottom of Header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-157.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-159.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-115.html"><B>Chapter 4 - Responding to Apple Events</B></A> / <A HREF="IAC-130.html"><B>Reference to Responding to Apple Events</B></A><BR><DL><DD><A HREF="IAC-134.html"><B>Routines for Responding to Apple Events</B></A> / <A HREF="IAC-155.html"><B>Requesting User Interaction</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING158-0></A>
<H3>AEInteractWithUser</H3>
 <A NAME=MARKER-2-205></A>You can use the <CODE>AEInteractWithUser</CODE> function to initiate interaction with the user when your application is a server application responding to an Apple event.<P>
<PRE>
FUNCTION AEInteractWithUser (timeOutInTicks: LongInt; 
                             nmReqPtr: NMRecPtr; 
                             idleProc: IdleProcPtr): OSErr;
</PRE>
<DL>
<DT><CODE>timeOutInTicks</CODE>
<DD> <BR>The amount of time (in ticks) that your handler is willing to wait for a response from the user. You can specify a number of ticks or use one of the following constants:
<DT><CODE></CODE>
<DD> CONST kAEDefaultTimeout = -1; {value determined }<BR>                                    { by AEM}<BR>      kNoTimeOut        = -2; {wait until reply }<BR>                              { comes back}
<DT><CODE>nmReqPtr</CODE> 
<DD> A pointer to a Notification Manager record provided by your application. You can specify <CODE>NIL</CODE> for this parameter to get the default notification handling provided by the Apple Event Manager.
<DT><CODE>idleProc</CODE> 
<DD> A pointer to your application's idle function, which handles events while waiting for the Apple Event Manager to return control. 
</DL>
<A NAME=HEADING158-7></A>
<H5>DESCRIPTION</H5>
 Your application should call the <CODE>AEInteractWithUser</CODE> function before displaying a dialog box or alert box or otherwise interacting with the user in response to an Apple event. If the user interaction preference settings permit the application to come to the foreground, this function brings your application to the front, either directly or by posting a notification request.<P>
 Your application should normally pass a notification record in the <CODE>nmReqPtr</CODE> parameter rather than specifying <CODE>NIL</CODE> for default notification handling. If you specify <CODE>NIL</CODE>, the Apple Event Manager looks for an application icon with the ID specified by the application's bundle (<CODE>'BNDL'</CODE>) resource and the application's file reference (<CODE>'FREF'</CODE>) resource. The Apple Event Manager first looks for <CODE>an</CODE> <CODE>'SICN'</CODE> resource with the specified ID; if it can't find an <CODE>'SICN'</CODE> resource, it looks for the <CODE>'ICN#'</CODE> resource and compresses the icon to fit in the menu bar. The Apple Event Manager won't look for any members of an icon family other than the icon specified in the <CODE>'ICN#'</CODE> resource.<P>
 If the application doesn't have <CODE>'SICN'</CODE> or <CODE>'ICN#'</CODE> resources, or if it doesn't have a file reference resource, the Apple Event Manager passes <CODE>NIL</CODE> to the Notification Manager, and no icon appears in the upper-right corner of the screen. Therefore, if you want to display any icon other than those of type <CODE>'SICN'</CODE> or <CODE>'ICN#'</CODE>, you must specify a notification record as the second parameter to the <CODE>AEInteractWithUser</CODE> function.<P>
<DL>
<DT><B>Note</B>
<DD>If you want the Notification Manager to use a color icon when it posts a notification request, you should provide a Notification Manager record that specifies a <CODE>'cicn'</CODE> resource.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The <CODE>AEInteractWithUser</CODE> function checks whether the client application set the <CODE>kAENeverInteract</CODE> flag for the Apple event and, if so, returns an error. If not, then the <CODE>AEInteractWithUser</CODE> function checks the server application's preference set by the <CODE>AESetInteractionAllowed</CODE> function and compares it against the source of the Apple event--that is, whether it came from the same application, another process on the same computer, or a process running on another computer. The <CODE>AEInteractWithUser</CODE> function returns the <CODE>errAENoUserInteraction</CODE> result code if the user interaction preferences don't allow user interaction. If user interaction is allowed, the Apple Event Manager brings your application to the front, either directly or by posting a notification request. If <CODE>AEInteractWithUser</CODE> returns the <CODE>noErr</CODE> result code, then your application is in the foreground and is free to interact with the user.<P>
<A NAME=HEADING158-13></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>errAETimeout<TD>-1712<TD>Apple event timed out<TR>
<TD>errAENoUserInteraction<TD>-1713<TD>No user interaction allowed<A NAME=MARKER-2-394></A><A NAME=MARKER-8-202></A></TABLE>
</H5>
<A NAME=HEADING158-14></A>
<H5>SEE ALSO</H5>
 For information about idle functions, see <A HREF=IAC-202.html#MARKER-9-123>"Writing an Idle Function" on page 5-22</A>.<P>
 For examples of the use of the <CODE>AEInteractWithUser</CODE> function, see <A HREF=IAC-126.html#MARKER-9-408>"Interacting With the User,"</A> which begins on <A HREF=IAC-126.html#MARKER-9-408>page 4-47</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-157.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-159.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
