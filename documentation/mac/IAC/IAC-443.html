<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>PPCBrowser(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING443></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-442.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-444.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-423.html"><B>Chapter 11 - Program-to-Program Communications Toolbox</B></A> / <A HREF="IAC-434.html"><B>PPC Toolbox Reference</B></A><BR><DL><DD><A HREF="IAC-439.html"><B>PPC Toolbox Routines</B></A> / <A HREF="IAC-442.html"><B>Using the Program Linking Dialog Box</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING443-0></A>
<H3><A NAME=MARKER-9-225></A>PPCBrowser</H3>
 Use the <CODE>PPCBrowser</CODE> function to display the program linking dialog box, which allows a user to select a port to communicate with.<A NAME=MARKER-2-194></A><P>
<PRE>
FUNCTION PPCBrowser (prompt: Str255; applListLabel: Str255; 
                     defaultSpecified: Boolean; 
                     VAR theLocation: LocationNameRec; 
                     VAR thePortInfo: PortInfoRec; 
                     portFilter: PPCFilterProcPtr; 
                     theLocNBPType: Str32): OSErr; 
</PRE>
<DL>
<DT><CODE>prompt</CODE>
<DD> A line of text that the <CODE>PPCBrowser</CODE> function displays as a prompt in the program linking dialog box. If you specify <CODE>NIL</CODE> or an empty string is passed, the default prompt "Choose a program to link to:" is used.
<DT><CODE>applListLabel</CODE>
<DD> The title of the list of PPC ports. If you specify <CODE>NIL</CODE> or an empty string is passed, the default title "Programs" is used.
<DT><CODE>defaultSpecified</CODE>
<DD> A value that determines which port is initially selected in the program linking dialog box. If you specify <CODE>TRUE</CODE>, you must provide information in the parameters <CODE>theLocation</CODE> and <CODE>thePortInfo</CODE>. In this case, the <CODE>PPCBrowser</CODE> function tries to select the PPC port specified by the parameters <CODE>theLocation</CODE> and <CODE>thePortInfo</CODE> when the program linking dialog box first appears. If you specify <CODE>FALSE</CODE>, the <CODE>PPCBrowser</CODE> function selects the first port in the list and you can leave the location name record and the port information record (in the parameters <CODE>theLocation</CODE> and <CODE>thePortInfo</CODE>) uninitialized.
<DT><CODE>theLocation</CODE>
<DD> The port location. For information on this data structure, see <A HREF=IAC-437.html#MARKER-9-214>"The Location Name Record" on page 11-50</A>.
<DT><CODE>thePortInfo</CODE>
<DD> The port name. For information on this data structure, see <A HREF=IAC-438.html#MARKER-9-218>"The Port Information Record" on page 11-51</A>.
<DT><CODE>portFilter</CODE>
<DD> Determines how the list of PPC ports is filtered. If this parameter is <CODE>NIL</CODE>, the names of all existing PPC ports are displayed. If this parameter isn't <CODE>NIL</CODE>, it must be a pointer to a port filter function.
<DT><CODE>theLocNBPType</CODE>
<DD> The NBP type passed to <CODE>NBPLookup</CODE> to generate the list of computers. If you specify <CODE>NIL</CODE> or an empty string is passed, the default, "PPCToolBox", is used.
</DL>
<A NAME=HEADING443-10></A>
<H5>DESCRIPTION</H5>
 The <CODE>PPCBrowser</CODE> function builds the list of ports and then displays the program linking dialog box.<P>
 If you set the <CODE>defaultSpecified</CODE> parameter to <CODE>TRUE</CODE>, the <CODE>PPCBrowser</CODE> function tries to select the PPC port specified by the parameters <CODE>theLocation</CODE> and <CODE>thePortInfo</CODE> when the program linking dialog box first appears. The <CODE>locationKindSelector</CODE> field in the location name record must be set to the <CODE>ppcNoLocation</CODE> constant (which specifies the local computer) or the <CODE>ppcNBPLocation</CODE> constant (which specifies the NBP object and NBP zone). The <CODE>ppcNBPTypeLocation</CODE> constant is not supported for matching. When matching the location, only the object string and the zone string of the entity name are used--the type string is ignored. When matching the port, the entire PPC port record (script, name, and port type) is used in the port information record. The <CODE>authRequired</CODE> field of the port information record is ignored.<A NAME=MARKER-2-199></A><P>
 The parameter <CODE>theLocNBPType</CODE> of the <CODE>PPCBrowser</CODE> function specifies the NBP type passed to <CODE>NBPLookup</CODE> to generate the list of computers. If you specify <CODE>NIL</CODE> or an empty string is passed, the default, "PPCToolBox", is used. Note that the current computer is always included in the list of computers (even if a location with the specified type does not exist for it). If the parameter <CODE>theLocNBPType</CODE> contains either of the NBP wildcard characters (= or \xE2), the <CODE>PPCBrowser</CODE> function returns a <CODE>paramErr</CODE> result code.<P>
 If the <CODE>PPCBrowser</CODE> function returns <CODE>noErr</CODE>, the parameters <CODE>theLocation</CODE> and <CODE>thePortInfo</CODE> specify the port chosen by the user. If the <CODE>PPCBrowser</CODE> function returns a <CODE>userCanceledErr</CODE> result code, the user clicked the Cancel button, and no port was selected. If the function returns a <CODE>memFullErr</CODE> result code, there was not enough memory to load the <CODE>PPCBrowser</CODE> package, and the dialog box did not appear. <P>
<DL>
<DT><B>Note</B>
<DD>You must not call the <CODE>PPCBrowser</CODE> function from an application that is running in the background, since this function displays a dialog box on the user's screen.<EM></EM><A NAME=MARKER-2-200></A>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING443-16></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>paramErr<TD>-50<TD>Illegal parameter<TR>
<TD>memFullErr<TD>-108<TD>Not enough memory to load <CODE>PPCBrowser</CODE> package<TR>
<TD>userCanceledErr<TD>-128<TD>User decided not to conduct a session</TABLE>
</H5>
<A NAME=HEADING443-17></A>
<H5>SEE ALSO</H5>
 For an example of the use of the <CODE>PPCBrowser</CODE> function, see <A HREF=IAC-429.html#MARKER-9-94>Listing 11-4 on page 11-26</A>. For an example of the program linking dialog box, see <BR><A HREF=IAC-429.html#MARKER-9-82>Figure 11-12 on page 11-22</A>. For information on port filter functions, <BR>see <A HREF=IAC-466.html#MARKER-9-273>page 11-79</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-442.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-444.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
