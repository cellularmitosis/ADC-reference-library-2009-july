<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Overview of the PowerPC System Software (IM: PS)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING12></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="PPCSoftware-11.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-13.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="PPCSoftware-2.html"><B>PowerPC System Software</B></A> / <BR><DD><A HREF="PPCSoftware-11.html"><B>Chapter 1 - Introduction to PowerPC System Software</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING12-0></A>
<H1>Overview of the PowerPC System Software</H1>
 <A NAME=MARKER-2-4></A>The system software for PowerPC processor-based Macintosh computers is System 7.1, with suitable changes made to support the <B>mixed environment</B> that allows both 680x0 software and PowerPC software to execute on a computer. The mixed environment provides virtually complete compatibility for existing 680x0 software, as well as vastly increased performance for applications and other software that are built to use the native instruction set of the PowerPC microprocessor.<A NAME=MARKER-2-344></A><A NAME=MARKER-2-6></A><P>
 Because the system software for PowerPC processor-based Macintosh computers is derived from System 7.1 for 680x0-based Macintosh computers, your application--whether 680x0 or PowerPC--must conform to the basic requirements imposed by system software versions 7.0 and later. In particular, your application (or other software) must be<P>
<UL>
<LI>32-bit clean<A NAME=MARKER-2-352></A>
<LI>compatible with the operations of the Virtual Memory Manager<A NAME=MARKER-2-357></A>
<LI>able to operate smoothly in the cooperative multitasking environment maintained by the Process Manager<A NAME=MARKER-2-351></A><P>
</UL>
 If your 680x0 software conforms to these specific requirements and to the general requirements for Macintosh software documented throughout <I>Inside Macintosh</I>, it is highly probable that it will execute without problems on PowerPC processor-based Macintosh computers. This is because the system software for PowerPC processor-based Macintosh computers includes a very efficient 68LC040 Emulator that emulates 680x0 instructions with PowerPC instructions. In addition, the system software includes the Mixed Mode Manager, which is responsible for handling any necessary mode switches between the native PowerPC environment and the 680x0 environment.<P>
 <A HREF=#MARKER-9-13>Figure 1-1</A> shows a general overview of the system software for PowerPC processor-<BR>based Macintosh computers. A small kernel, called the <B>nanokernel,</B> communicates directly with the PowerPC processor and provides very low-level services (such as interrupt handling and memory management).<A NAME=MARKER-2-346></A><A NAME=MARKER-2-11></A><A NAME=MARKER-2-152></A><P>
<B>Figure 1-1  <A NAME=MARKER-9-13></A>The system software for PowerPC processor-based Macintosh computers</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/PPCO-L-20.jpg">
 Even applications written entirely in 680x0 code might cause mode switches while they are executing, because some portions of the Macintosh Operating System have been rewritten in PowerPC code for increased performance. For example, the Memory Manager has been rewritten in C and recompiled into PowerPC code. In general, however, mode switches occur completely transparently to 680x0 software. Only native PowerPC software needs to worry about mode switches. See <A HREF=PPCSoftware-14.html#MARKER-9-78>"Mixed Mode" beginning on page 1-13</A> for details.<A NAME=MARKER-2-350></A><P>
 As you would expect, the emulation environment provided by the 68LC040 Emulator uses the standard 680x0 run-time model. The organization of an application partition and the run-time behavior of emulated software are identical to what is provided on 680x0-based Macintosh computers. However, the execution environment for native PowerPC software is significantly different from the standard 680x0 run-time environ-<BR>ment. The PowerPC environment provides a much simpler and easier-to-use run-time model based on fragments. A <B>fragment</B> is any block of executable PowerPC code and its associated data. Fragments are created by your development system's linker.<P>
<DL>
<DT><B>Note</B>
<DD><A NAME=MARKER-9-16></A>The term <I>fragment</I> is not intended to suggest that the block of code and data is in any way either small, detached, or incomplete. Fragments can be of virtually any size, and they are complete, executable entities. The term <I>fragment</I> was chosen to avoid confusion with the terms already used in <I>Inside Macintosh</I> to describe executable code (such as <I>component</I> and <I>module</I>).<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 Fragments use a method of addressing the data they contain that is different and more general than the A5-relative method that 680x0 applications use to address their global data. One important consequence is that any PowerPC software packaged as a fragment has easy access to global data. In the 680x0-based system software, it was sometimes difficult to use global data within types of software other than applications.<P>
 In addition, it was often complicated for a routine installed by some code to gain <BR>access to the code's global variables. For example, you cannot--in the current 680x0 environment--write a VBL task that uses your application's global variables without somehow passing your application's A5 value to the VBL task. (A <B>VBL task</B> is a task that executes during a vertical blanking interrupt.) In the PowerPC environment, any routine contained in an application has automatic access to the application's global variables. You do not need to devise special ways to pass the address of your application's A5 world to the installed routine. More generally, any routine executing in the PowerPC environment has access to the global data of the fragment it's contained in.<P>
 The new run-time model used for native PowerPC software incorporates other important simplifications as well. In native applications, there is no segmentation of the executable code. The existing compilers that produce PowerPC code ignore any segmentation directives you include in your source code. In addition, any calls you make to the Segment Manager's <CODE>UnloadSeg</CODE> procedure are simply ignored by the PowerPC system software. The task of keeping required code in memory is handled completely by the Virtual Memory Manager or the Process Manager, not by your application.<A NAME=MARKER-2-17></A><P>
 The remaining sections in this chapter describe in greater detail the mixed environment of PowerPC processor-based Macintosh computers and the new native run-time environment. If you're interested mainly in rebuilding your application as native PowerPC code, you can skip to the section <A HREF=PPCSoftware-14.html#MARKER-9-78>"Mixed Mode" beginning on page 1-13</A>, which describes the ways in which you might need to use the Mixed Mode Manager to make your native application compatible with the mixed environment.<A NAME=MARKER-2-18></A><P>

<B><!-- TOC --></B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="PPCSoftware-11.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-13.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="PPCSoftware-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
