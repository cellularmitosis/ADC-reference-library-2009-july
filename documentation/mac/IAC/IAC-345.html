<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Data Structures(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING345></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-344.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-346.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-344.html"><B>Scripting Components Reference</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING345-0></A>
<H2><A NAME=MARKER-9-166></A>Data Structures</H2>
 This section describes the principal data structures and Component Manager type codes used by the standard scripting component routines. Data structures used by individual routines are described with the appropriate routines in the sections that follow.<P>
 The Component Manager type code for components that support the standard scripting component routines is <CODE>'osa '</CODE>, and the subtype code for the generic scripting component is <CODE>'scpt'</CODE>.<P>
<PRE>
CONST
   kOSAComponentType                      = 'osa ';
   kOSAGenericScriptingComponentSubtype   = 'scpt';
</PRE>
 Because all results returned by the Component Manager are of type <CODE>ComponentResult</CODE> (a long integer), scripting components also define this type for result codes.<P>
<PRE>
TYPE
   OSAError = ComponentResult;
</PRE>
 Scripting components keep track of script data in memory by means of script IDs of type <CODE>OSAID</CODE>.<P>
<PRE>
TYPE OSAID = LongInt; 
</PRE>
 A scripting component assigns a script ID when it creates the associated script data (that is, a compiled script, a script value, a script context, or other kinds of script data supported by a scripting component) or loads it into memory. The scripting routines that create, load, compile, and execute scripts all return script IDs, and your application must pass valid script IDs to the other routines that manipulate scripts. A script ID remains valid until a client application calls <CODE>OSADispose</CODE> to reclaim the memory used for the corresponding script data. <P>
 If the execution of a script does not result in a value, <CODE>OSAExecute</CODE> returns the constant <CODE>kOSANullScript</CODE> as the script ID. If a client application passes <CODE>kOSANullScript</CODE> to the <CODE>OSAGetSource</CODE> function instead of a valid script ID, the scripting component should display a null source description (possibly an empty text string). If a client application passes <CODE>kOSANullScript</CODE> to <CODE>OSAStartRecording</CODE>, the scripting component creates a new compiled script for editing or recording.<P>
<PRE>
CONST kOSANullScript = 0;
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-344.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-346.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
