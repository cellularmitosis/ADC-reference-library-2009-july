<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MyMntrExt (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING473></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-472.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-474.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-453.html"><B>Chapter 8 - Control Panels</B></A> / <A HREF="MoreToolbox-468.html"><B>Control Panels Reference</B></A><BR><DL><DD><A HREF="MoreToolbox-469.html"><B>Application-Defined Routines</B></A> / <A HREF="MoreToolbox-472.html"><B>Monitors Extension Functions</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING473-0></A>
<H3>MyMntrExt</H3>
 <A NAME=MARKER-2-367></A>You provide a monitors extension function to implement the features that allow users to set the controls for your video card. Your function should respond appropriately to any messages sent to it by the Monitors control panel. In the <CODE>message</CODE> parameter, the Monitors control panel passes a value indicating which action your function should perform. Here's how you declare a monitors extension function called <CODE>MyMntrExt</CODE>:<P>
<PRE>
FUNCTION MyMntrExt (message, item, numItems: Integer; 
                  monitorValue: LongInt; mDialog: DialogPtr; 
                  theEvent: EventRecord;
                  screenNum: Integer; VAR screens: ScrnRsrcHandle;
                  VAR scrnChanged: Boolean): LongInt;
</PRE>
<DL>
<DT><CODE>message</CODE>
<DD> A value that identifies the event or action to which your monitors extension function should respond. See <A HREF=#MARKER-9-12>Table 8-4 on page 8-81</A> for the values your function can receive in this parameter. 
<DT><CODE>item</CODE>
<DD> For <CODE>hitDev</CODE> messages, the number of the item that the user clicked. The Monitors control panel appends your item list to its own. So, although you begin numbering your item list with 1 in your item list resource, the Monitors control panel adds the number of standard items in the Options dialog box's item list to your item. Therefore, to get the actual number of the clicked item, your monitors extension function should always subtract <CODE>numItems</CODE> from <CODE>item</CODE>. 
<DT>
<DD> For the <CODE>startupMsg</CODE> message, the <CODE>item</CODE> parameter indicates whether the user has selected superuser status. If so, the <CODE>item</CODE> parameter is 1; if not, it is 0. 
<DT><CODE>numItems</CODE>
<DD> The item list number of the last standard item in the Options dialog box. 
<DT><CODE>monitorValue</CODE>
<DD> <BR>The first time the Monitors control panel calls your monitors extension function, that is, when the <CODE>message</CODE> parameter equals <CODE>startupMsg</CODE>, the value of the <CODE>monitorValue</CODE> parameter is 0. After the first call, this parameter contains the result your monitors extension function returned the last time the Monitors control panel called it. Because control panel routines, including a monitors extension function, cannot use global variables to store data between calls, your function can use its function result to return a handle to any memory it allocates. The next time the Monitors control panel calls your monitors extension function, it passes the handle back to your function in the <CODE>monitorValue</CODE> parameter. 
<DT>
<DD> If your monitors extension function returns a function result in the range 1 through 255, the Monitors control panel interprets this result as an error and closes your Options dialog box. Therefore, your monitors extension function will not receive a value in this range in the <CODE>monitorValue</CODE> parameter.
<DT><CODE>mDialog</CODE>
<DD> The dialog pointer for the Options dialog box. See the chapter "Dialog Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for a description of dialog pointers.
<DT><CODE>theEvent</CODE>
<DD> The event record for an event that caused the Monitors control panel to pass a <CODE>hitMsg</CODE>, <CODE>nulMsg</CODE>, or <CODE>keyEvtMsg</CODE> message to your monitors extension function. See the chapter "Event Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for a description of events and event records.
<DT><CODE>screenNum</CODE>
<DD> The number of the screen device (that is, the monitor) that the user selected. The Monitors control panel numbers monitors consecutively, in the same order as the slots in which the cards are installed, starting with 1.
<DT><CODE>screens</CODE>
<DD> A handle to a screen (<CODE>'scrn'</CODE>) resource. See <I><A HREF="../Devices/Devices-2.html">Inside Macintosh: Devices</A></I> for information on the screen resource. 
<DT><CODE>scrnChanged</CODE>
<DD> A Boolean value that you can use to indicate whether you have modified the screen (<CODE>'scrn'</CODE>) resource. Set this parameter to <CODE>TRUE</CODE> if you have modified the screen resource. When you set the <CODE>scrnChanged</CODE> parameter to <CODE>TRUE</CODE>, the Monitors control panel checks whether the values in the screen resource are still valid; if there is a problem, the Monitors control panel tries to correct it.
<DT>
<DD> This parameter makes it easier to implement a control that changes the apparent area displayed on the screen. For example, your monitor might be able to display either two pages of a document or a magnified view of a single page. If the user changes the area displayed on one screen in a system with multiple screens, the displays on adjacent screens could overlap or show gaps. When you change the screen resource to implement this change, the coordinates of the global rectangles for adjacent screens are no longer contiguous. In this case, if you have set the <CODE>scrnChanged</CODE> parameter to <CODE>TRUE</CODE>, the Monitors control panel shifts the virtual locations of the screens to eliminate the gaps or overlaps.
</DL>
<A NAME=HEADING473-15></A>
<H5>DESCRIPTION</H5>
 The Monitors control panel calls your monitors extension function repeatedly with messages requesting your function to perform an action or handle an event that occurs while the Options dialog box is displayed. <A HREF=#MARKER-9-12>Table 8-4</A> lists the constant names for the values that the Monitors control panel passes in the <CODE>message</CODE> parameter and provides a description of the action your function should perform. 
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-12></A><B>Table 8-4 Messages from the Monitors control panel</B> (Continued)</CAPTION>
<TH>Constant<TH>Value<TH>Description<TR>
<TD rowspan=2>initMsg<TD>1<TD>Your monitor extension function should perform initialization; it should allocate any memory it needs and set default values for its controls. <TR>
<TD>&nbsp;<TD>The Monitors control panel sends this message to your function before it displays the Options dialog box but after it locates any resources, such as gamma tables, that your extension includes. <TR>
<TD rowspan=2>okMsg<TD>2<TD>When the user clicks the OK button, the Monitors control panel hides the Options dialog box and calls your monitors extension function with this message. This is your function's last chance to check the values of dialog items that the user might have changed. Your function should release any memory that it previously allocated before returning control to the Monitors control panel.<TR>
<TD>&nbsp;<TD>The OK button is a standard control put in the Options dialog box by the Monitors control panel.<TR>
<TD rowspan=2>cancelMsg<TD>3<TD>The user clicked the Cancel button. Your monitors extension function should return the device that your monitors extension controls to the condition it was in before the user clicked the Options button, release any memory that your function previously allocated, and return control to the Monitors control panel.<TR>
<TD>&nbsp;<TD>The Cancel button is a standard control put in the Options dialog box by the Monitors control panel.<TR>
<TD rowspan=2>hitMsg<TD>4<TD>The user clicked an enabled control in the Options dialog box, and your extension function should handle the click. <TR>
<TD>&nbsp;<TD>The Monitors control panel appends your item list to the standard list of items in the Options dialog box and passes, in the <CODE>item</CODE> parameter, the item's item number in the combined list. To get the actual number of the clicked item as defined in your item list, subtract <CODE>numItems</CODE> from <CODE>item</CODE>. <TR>
<TD>nulMsg<TD>5<TD>A null event occurred. Your monitors extension function should perform tasks that have to be done repeatedly, if any. Do not assume any particular timing for this message.<TR>
<TD>updateMsg<TD>6<TD>An update event occurred. Your monitors extension function should update any user items and redraw any controls that are not standard items handled by the Dialog Manager. <TR>
<TD>activateMsg<TD>7<TD>An activate event occurred, indicating that the Options dialog box is becoming active. Currently, the Monitors control panel does not call your monitors extension function with this message, because the Options dialog box is modal. However, your function should handle this message as it would any activate event, because in future versions of the Operating System the Options dialog box might be modeless.<TR>
<TD>deactivateMsg<TD>8<TD>An activate event occurred, indicating that the Options dialog box is becoming inactive. Currently, the Monitors control panel does not call your extension function with this message, because the Options dialog box is modal. However, your function should handle this message as you would any activate event, because in future versions of the Operating System the Options dialog box might be modeless.<TR>
<TD>keyEvtMsg<TD>9<TD>A keyboard event occurred. Your monitors extension function should process the keyboard event.<TR>
<TD rowspan=4>superMsg<TD>10<TD>The user has selected superuser status. Your monitors extension function should display any controls that are reserved for superusers.<TR>
<TD>&nbsp;<TD>The Monitors control panel sends this message when the user holds down the Option key while clicking the Options button. <TR>
<TD>&nbsp;<TD>This message is provided for backward compatibility with System 6. However, your monitors extension function can respond to it by initializing any controls that you have reserved for superusers, if your function has not already done this in response to either the <CODE>startupMsg</CODE> or <CODE>initMsg</CODE> message. If your code does not handle this message, it should return as its function result a handle to any previously allocated memory.<TR>
<TD>&nbsp;<TD>The Monitors control panel sends this message or the normal message immediately following the initialization message.<TR>
<TD rowspan=2>normalMsg<TD>11<TD>The user is not a superuser. This message is provided for backward compatibility with System 6. However, your monitors extension function can respond to it by initializing any controls, if your function has not already done this in response to either the <CODE>startupMsg</CODE> or <CODE>initMsg</CODE> message. If your function does not handle this message, it should return as its function result a handle to any previously allocated memory.<TR>
<TD>&nbsp;<TD>The Monitors control panel sends this message or the superuser message immediately following the initialization message.<TR>
<TD rowspan=2>startupMsg<TD>12<TD>The Monitors control panel sends this message as soon as the code in your monitors code (<CODE>'mntr'</CODE>) resource has been loaded, and before the Monitors control panel finds any resources that your monitors extension function refers to. If the user is a superuser, the Monitors control panel sets the <CODE>item</CODE> parameter to 1 when it sends the startup message. <TR>
<TD>&nbsp;<TD>When your monitors extension function receives this message, it can load and modify any resources that must allow for the capabilities of the system or for superusers. For example, your function can modify the item list resource to display special controls for superusers.</TABLE>
<P>
 Your monitors extension function can return either an error code or a value that you want to have available the next time the Monitors control panel calls your function. For example, if your monitors extension function allocates memory, it can return a handle to the memory as its function result. Each time the Monitors control panel calls your monitors extension function, the <CODE>monitorValue</CODE> parameter contains the value that your function returned the last time it was called. <P>
 Your<A NAME=MARKER-2-368></A> monitors extension function must also detect and recover from any error conditions or report them to the user.<A NAME=MARKER-2-369></A> If it cannot recover from an error, your monitors extension function should display an error dialog box and then return a value between 1 and 255. If your function returns a value in this range, the Monitors control panel closes the Options dialog box immediately and does not call your function again. If your function returns an error in response to the <CODE>initMsg</CODE> or <CODE>startupMsg</CODE> message, the Monitors control panel does not display the Options dialog box. Your function can display an alert box describing the error before returning control to the Monitors control panel. <P>
<A NAME=HEADING473-19></A>
<H5>SEE ALSO</H5>
 For more information about the messages the Monitors control panel sends to your monitors extension function and how to handle them, see <A HREF=MoreToolbox-466.html#MARKER-9-312>"Writing a Monitors Extension Function" beginning on page 8-61</A>.<A NAME=MARKER-2-370></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-472.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-474.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
