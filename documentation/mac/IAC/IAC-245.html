<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Defining Tokens(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING245></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-244.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-246.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-242.html"><B>Writing Object Accessor Functions</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING245-0></A>
<H2><A NAME=MARKER-9-178></A>Defining Tokens</H2>
 <A NAME=MARKER-2-179></A>It is up to you to decide how many token descriptor types you need to define for your application. In many cases you may be able to define one token that can identify Apple event objects of several different object classes, such as a token of type <CODE>typeMyTextToken</CODE> that identifies Apple event objects of object classes <CODE>cText</CODE>, <CODE>cWord</CODE>, <CODE>cItem</CODE>, and <CODE>cChar</CODE>. In other cases you may need to define specific token descriptor types for specific object classes.<P>
 For example, the <CODE>MyFindDocumentObjectAccessor</CODE> routine shown in <A HREF=IAC-243.html#MARKER-9-165>Listing 6-5</A> on <A HREF=IAC-243.html#MARKER-9-165>page 6-36</A> returns a token of descriptor type <CODE>typeMyDocToken</CODE>, which identifies a document record.<P>
<PRE>
CONST                             {application-defined token}
   typeMyDocToken       = 'docr'; {identifies a document record}
</PRE>
 <A HREF=#MARKER-9-180>Figure 6-5</A> shows the logical arrangement of a descriptor record of descriptor type <CODE>typeMyDocToken</CODE> whose data is specified by a pointer to a document record.<P>
<B>Figure 6-5  <A NAME=MARKER-9-180></A>Descriptor record for an application-defined token that identifies a document</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-26.jpg"><P>
 The <CODE>MyFindPropertyOfWindowObjectAccessor</CODE> routine shown in <A HREF=IAC-244.html#MARKER-9-176>Listing 6-9</A> returns a token of descriptor type <CODE>typeMyWindowProp</CODE> for every property that it can locate.<P>
<PRE>
CONST                             {application-defined token}
   typeMyWindowProp     = 'wprp'; {a window pointer and a }
                                  { property ID}
</PRE>
 <A HREF=#MARKER-9-181>Figure 6-6</A> shows the logical arrangement of a descriptor record of descriptor type <CODE>typeMyWindowProp</CODE> that identifies the bounds property of a window. Its data consists of a window pointer and the constant <CODE>pBounds</CODE>. The application can use this token either to return or to change the window's bounds setting, depending on the Apple event that specified the property. If the token specified <CODE>pName</CODE> instead, the application could use it either to return the window's name as a string or to change the window's name.<P>
<B>Figure 6-6  Descriptor record for an application-defined token that identifies the <CODE>pbounds</CODE> property of a window<A NAME=MARKER-9-181></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-23.jpg"><P>
 A token's data should always contain a reference to the corresponding Apple event objects--not a copy of the data for those objects. This allows the same token to be used for both reading and writing tokens.<P>
 It's often possible to use the same token type for objects of several object classes, or for both an object of a given class and one of its properties. A token's data is private to your application and can be organized in any way that is convenient.<P>
 When an object accessor function that supports key form <CODE>formRange</CODE> locates a range of Apple event objects, it should normally return a descriptor list (<CODE>AEDescList</CODE>) of tokens for the individual objects. A typical exception is an object accessor function that returns a range of objects of class <CODE>cText</CODE>, which should return a single token representing the entire range. For example, an object accessor function that finds "all the characters from char 1 to char 1024" should return a token that consists of a list of 1024 objects, each of class <CODE>cChar</CODE>, whereas an object specifier function that finds "all the text from char 1 to char 1024" should return a single token for a single item of class <CODE>cText</CODE> that is 1024 characters long. <A NAME=MARKER-2-182></A><P>
 A token is valid only until the Apple Event Manager has located the requested element in the container the token represents and returned another token for the element. The Apple Event Manager disposes of intermediate tokens after it finishes resolving an object specifier record, but one token is always left over--the token that identifies the specified Apple event object or objects. Your application should dispose of this final token by calling the <CODE>AEDisposeToken</CODE> function, which in turn calls your application's token disposal function (if one exists), an optional object callback function that disposes of a token. See <A HREF=IAC-282.html#MARKER-9-363>page 6-111</A> for the declaration of a token disposal function. <A NAME=MARKER-9-160></A><A NAME=MARKER-2-319></A><P>
 If your application does not provide a token disposal function, the Apple Event Manager uses the <CODE>AEDisposeDesc</CODE> function to dispose of tokens. This function does the job as long as disposing of tokens involves nothing more than simply disposing of a descriptor record. Otherwise, you need to provide a custom token disposal function. For example, suppose the data field of a token descriptor record contains a handle to a block that in turn contains references to memory for the Apple event object referred to by the token. In this case, the application should provide a token disposal function that performs the tasks required to dispose of the token and any associated structures. <A NAME=MARKER-2-185></A> <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-244.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-246.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
