<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Quartz Composer Programming Guide: Publishing Ports and Binding Them to Controls</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Publishing Ports and Binding Them to Controls"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001357-CH208" title="Publishing Ports and Binding Them to Controls"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000424" target="_top">Graphics &amp; Imaging</a> &gt; <a href="../../../Quartz-date.html#//apple_ref/doc/uid/TP30000440-TP30000424-TP30000559" target="_top">Quartz</a> &gt; <a href="../qc_intro/qc_intro.html#//apple_ref/doc/uid/TP40001357-CH201-TPXREF101">Quartz Composer Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../qc_play_ib/qc_play_ib.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../qc_play_renderer/qc_play_renderer.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001357-CH208-TPXREF101" title="Publishing Ports and Binding Them to Controls"></a><h1>Publishing Ports and Binding Them to Controls</h1><p>Any input or output port in a composition can be controlled through the use of Cocoa bindings by publishing the ports that you want to control. This chapter shows how to publish ports in a composition and then add controls to the user interface. When you make changes to the controls in Interface Builder, the changed values pass to the appropriate input ports that are in the composition.</p><p>Perform these tasks to publish ports and bind them to controls:</p><ol class="ol"><li class="li"><p><span class="content_text"><a href="qc_play_ib_input.html#//apple_ref/doc/uid/TP40001357-CH208-BAJHFEBC">“Publishing Ports”</a></span></p></li><li class="li"><p><span class="content_text"><a href="qc_play_ib_input.html#//apple_ref/doc/uid/TP40001357-CH208-CJBFDCJC">“Setting Up a Patch Controller”</a></span></p></li><li class="li"><p><span class="content_text"><a href="qc_play_ib_input.html#//apple_ref/doc/uid/TP40001357-CH208-BAJGEICH">“Binding Controls to Input Ports ”</a></span></p></li></ol><div class="notebox"><a name="//apple_ref/doc/uid/TP40001357-CH208-DontLinkElementID_8" title="Note"></a><p><strong>Note:</strong>&nbsp;This chapter assumes that you are using Xcode and Interface Builder Version 3.0. Interface Builder Version 3.0  is a major update from the previous version of Interface Builder. For detailed information on how to use the new version, see <em><a href="../../../../DeveloperTools/Conceptual/IB_UserGuide/index.html#//apple_ref/doc/uid/TP40005344" target="_top">Interface Builder User Guide</a></em>.</p></div><a name="//apple_ref/doc/uid/TP40001357-CH208-BAJHFEBC" title="Publishing Ports"></a><h2>Publishing Ports</h2><p>You’ll revise the MacEngraving composition provided with Mac OS X v10.5 so that it has two published input ports at the root macro patch level—one that controls the clear color and the other that controls the text shown on the computer.</p><ol class="ol"><li class="li"><p>Open the MacEngraving composition located in <code>Developer/Examples/Quartz Compositions/Interface Builder</code>.</p><p>Notice that the <code>"Text"</code> input port of the Image With String patch is gray, to indicate that this port is already published. </p></li><li class="li"><p>Control-click the Clear Color input port on the Clear patch and choose Published Inputs > Clear Color. Then press Return.</p><p>Notice that the Clear Color input port appears gray to indicate that it is published.</p></li><li class="li"><p>In the Viewer window, click Input Parameters.</p><p>The Text and Clear Color input ports appear as a sheet in the Viewer window. When you  change the text and the clear color, you immediately see the results in the View window.</p></li><li class="li"><p>Click the workspace to make sure that no patches are selected. Then open the Inspector to the Published Inputs &amp; Outputs pane. </p><p>You should see the Text and Clear Color input port names and the key assigned to each. The key for the Text input port is <code>text</code>. The key for the Clear Color input port is <code>Clear_Color</code>. Make note of these, because you must use these keys in Interface Builder to set up the bindings. The keys you supply in Interface Builder must match exactly what you see in this pane; keys are case-sensitive.</p><div class="item_figure"><img src = "../art/published_in_outs.jpg" alt = "The Published Input and Output ports pane in the Patch Inspector" ></div></li><li class="li"><p>Save the composition and quit Quartz Composer.</p></li></ol><a name="//apple_ref/doc/uid/TP40001357-CH208-CJBFDCJC" title="Setting Up a Patch Controller"></a><h2>Setting Up a Patch Controller</h2><p>The <code>QCPatchController</code> class establishes Cocoa bindings between the user interface controls and a composition. In the Cocoa model-view-controller (MVC) paradigm, <code>QCPatchController</code> acts as a controller between a composition (which is the model) and a <code><a href="../../../Reference/QuartzFramework/Classes/QCView_Class/Reference/Reference.html#//apple_ref/occ/cl/QCView" target="_top">QCView</a></code> (which is the view). For more information on the MVC paradigm, see <em><a href="../../../../Cocoa/Conceptual/ObjCTutorial/index.html#//apple_ref/doc/uid/TP40000863" target="_top">Cocoa Application Tutorial</a></em>. </p><p>Follow these steps to set up a patch controller:</p><ol class="ol"><li class="li"><p>Launch Interface Builder and choose a Cocoa Window template.</p></li><li class="li"><p>Drag a Quartz Composer View from the Quartz Composer objects in the Library to the window.</p><p>If you don’t see Quartz Composer as an entry in the Library, you may need to add the Quartz Composer plug-in. See <span class="content_text"><a href="../qc_play_ib/qc_play_ib.html#//apple_ref/doc/uid/TP40001357-CH207-SW1">“Add the Quartz Composer Plug-in.”</a></span></p></li><li class="li"><p>Drag a Quartz Composer Patch Controller (<code>QCPatchController</code> instance) from Library to the Nib document window.</p></li><li class="li"><p>Select the patch controller and open the Attributes inspector.</p></li><li class="li"><p>Click “Load from Composition File” and choose the MacEngraving composition you modified in the previous section. </p></li><li class="li"><p>Select the <code><a href="../../../Reference/QuartzFramework/Classes/QCView_Class/Reference/Reference.html#//apple_ref/occ/cl/QCView" target="_top">QCView</a></code> and then open the Bindings inspector.</p></li><li class="li"><p>Click the disclosure triangle next to “Patch.”</p></li><li class="li"><p>Choose Patch Controller from the “Bind to” pop-up menu.</p></li><li class="li"><p>Enter <code>patch</code> in the Controller Key text field to bind the <code>patch</code> property to the <code>patch</code> key of the QCPatchController. </p><p>This binds the <code>QCView</code> to the composition that’s loaded in the <code>QCPatchController</code> so that the <code>QCView</code> renders this composition.</p></li><li class="li"><p>Choose File > Simulate Interface. </p><p>The engraved computer appears in the window.</p></li><li class="li"><p>Quit the interface test application.</p></li></ol><div class="notebox"><a name="//apple_ref/doc/uid/TP40001357-CH208-DontLinkElementID_9" title="Note"></a><p><strong>Note:</strong>&nbsp; When you bind the patch property of a <code>QCView</code>, you can make sure that a composition is not loaded on the <code>QCView</code> by clicking the Unload button in the Attributes Inspector for the <code>QCView</code>.</p></div><p>In the next section you’ll add controls to the interface and set up bindings between them and the inputs of the composition root macro patch.</p><a name="//apple_ref/doc/uid/TP40001357-CH208-BAJGEICH" title="Binding Controls to Input Ports "></a><h2>Binding Controls to Input Ports </h2><p>This section adds a color well and text field to the interface and binds them to the Clear Color and Power input ports published from the MacEngraving composition. (For information on color wells, see <span class="content_text"><a href="../../../../Cocoa/Conceptual/DrawColor/Tasks/ChoosingColors.html#//apple_ref/doc/uid/20000791" target="_top">Choosing Colors With Color Wells and Color Panels</a></span>.) </p><ol class="ol"><li class="li"><p>Drag a Text Field from the Library to the window.</p><p>The easiest way to locate the field is to type <code>text</code> in the Search field of the Library.</p></li><li class="li"><p>Place the control below the <code>QCView</code>, on the left side. </p></li><li class="li"><p>Resize the text field to so it is half the width of the window.</p></li><li class="li"><p>With the text field selected, open the Bindings inspector and click the disclosure triangle next to Value.</p></li><li class="li"><p>Click “Bind to” and then choose Patch Controller  in the “Bind to” popup menu.</p></li><li class="li"><p>Enter <code>patch</code> in the Controller Key text field.</p></li><li class="li"><p>Enter <code>text.value</code> in the Model Key Path text field.</p><p>This binds the text field to the text input parameter of the composition that’s loaded in the <code>QCPatchController</code>. You retrieve the value on the port itself by appending <code>.value</code> to its unique key.</p><p>Note that keys are case sensitive, so the Model Key Path field must reflect exactly the key listed in the Published Inputs &amp; Outputs pane of the Inspector in the composition for that port. Recall that the key for the Text input port is <code>text</code>.</p></li><li class="li"><p>Drag a color well control (<code><a href="../../../../Cocoa/Reference/ApplicationKit/Classes/NSColorWell_Class/Reference/Reference.html#//apple_ref/occ/cl/NSColorWell" target="_top">NSColorWell</a></code> instance) from the Library to the window.</p></li><li class="li"><p>Place the control below the right side of <code>QCView</code>, using the guides to align the color well properly in the window.</p></li><li class="li"><p>With the color well selected, open the Bindings inspector and click the disclosure triangle next to Value.</p></li><li class="li"><p>Click “Bind to” and then choose Patch Controller in the “Bind to” popup menu.</p></li><li class="li"><p>Enter <code>patch</code> in the Controller key text field.</p></li><li class="li"><p>Enter <code>Clear_Color.value</code> in the Model Key Path text field. </p><p>Recall that the key for the Clear Color input port is <code>Clear_Color</code>. The Model Key Path field must reflect exactly what’s specified in the composition for that port.</p><p>This binds the color well to the clear color input parameter of the composition that’s loaded in the <code>QCPatchController</code>. You retrieve the value on the port itself by appending <code>.value</code> to its unique key.</p></li><li class="li"><p>Choose File > Simulate Interface. </p></li><li class="li"><p>Enter text in the text field. Then click the color well control and change the background color.</p><p>The rendered view changes as the settings change.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40001357-CH208-DontLinkElementID_10" title="Note"></a><p><strong>Note:</strong>&nbsp;If the controls don’t modify the composition, check the text that you typed into the Model Key Path text field. It must match exactly the key that you see in the Published Inputs &amp; Outputs pane of the Inspector in the Quartz Composer development tool. Keys are case-sensitive.</p></div></li></ol><a name="//apple_ref/doc/uid/TP40001357-CH208-DontLinkElementID_5" title="See Also"></a><h2>See Also</h2><ul class="ul"><li class="li"><p><code>/Developer/Examples/Quartz Composer Compositions/Interface Builder Compositions</code> contains other examples of nib files that bind controls in Interface Builder to input ports in a composition. You may want to look at these files before you bind controls to your own composition.</p></li><li class="li"><p><em><a href="../../../../Cocoa/Conceptual/CocoaBindings/index.html#//apple_ref/doc/uid/10000167i" target="_top">Cocoa Bindings Programming Topics</a></em> contains more details and provides pointers to additional information.</p></li></ul>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../qc_play_ib/qc_play_ib.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../qc_play_renderer/qc_play_renderer.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-10-15<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/GraphicsImaging/Conceptual/QuartzComposer/qc_play_ib_input/qc_play_ib_input.html%3Fid%3DTP40001357-4.2&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/GraphicsImaging/Conceptual/QuartzComposer/qc_play_ib_input/qc_play_ib_input.html%3Fid%3DTP40001357-4.2&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/GraphicsImaging/Conceptual/QuartzComposer/qc_play_ib_input/qc_play_ib_input.html%3Fid%3DTP40001357-4.2&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>