<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Text Services Manager(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING409></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-408.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-410.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / </DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING409-0></A>
<H1>Chapter 7 - Text Services Manager</H1>
 This chapter describes how text-processing applications can communicate flexibly and efficiently with utilities that provide services to those applications. Applications that need input methods, spell-checking, hyphenation, and so forth can use the Text Services Manager to search for, obtain information about, and communicate with those utilities. Utilities can use the Text Services Manager to request actions and information from applications, and to send data to them.<A NAME=MARKER-2-54></A>  <A NAME=MARKER-2-345></A>  <A NAME=MARKER-2-356></A>  <A NAME=MARKER-2-58></A><P>
 Read this chapter if you are developing or enhancing an application to use text services. In particular, if you want your application to support text input in a 2-byte script system, you should use the Text Services Manager. Your application will then work with multiple script systems and many input methods.<P>
 Read this chapter if you are writing or adapting a utility that provides a text service such as text input. Utilities that work with the Text Services Manager are called <I>text service components</I>. If your utility is a text service component, it will be able to communicate with a wide range of applications.<P>
 Before reading this chapter, read the chapter "Introduction to Text on the Macintosh" in this book. To use this chapter, you should also be familiar with the Apple Event Manager and the Component Manager. For details on the Apple Event Manager, see <I><A HREF="../IAC/IAC-2.html">Inside Macintosh: Interapplication Communication</A></I>. For more on the Component Manager, see <I><A HREF="../MoreToolbox/MoreToolbox-2.html">Inside Macintosh: More Macintosh Toolbox</A></I>.<P>
 This chapter refers to routines, constants, and data structures from QuickDraw, the Event Manager, the Window Manager, the Menu Manager, and the Process Manager. For details on QuickDraw, see <I><A HREF="../QuickDraw/QuickDraw-2.html">Inside Macintosh: Imaging</A></I>. For more on the Event Manager, Window Manager, and Menu Manager, see <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>. For information on the Process Manager, see <I><A HREF="../Processes/Processes-2.html">Inside Macintosh: Processes</A></I>.<P>
 This chapter first provides a brief introduction to text services in general, input methods in particular, and the Text Services Manager itself. If you are writing an application, it then discusses how you can<P>
<UL>
<LI>use the Text Services Manager routines for client applications, to send information to text service components
<LI>implement the text-service Apple event handlers in your client application, to receive information from text service components
<LI>communicate directly with the Component Manager and text service components, if your application's special needs require you to bypass the Text Services Manager<P>
</UL>
 If you are writing a text service component, this chapter discusses how you can<P>
<UL>
<LI>implement the text service component routines, so that the Text Services Manager and client applications can request the text services you provide
<LI>use the Text Services Manager routines for text service components, to send information to client applications and the Text Services Manager<P>
</UL>
<HR>
<B>Chapter </B><B>Contents</B>
<B><!-- TOC --><DL>
<DL>
<DT><A HREF="Text-410.html#HEADING410-0">About Text Services</A>
<DD>
<DT><A HREF="Text-411.html#HEADING411-0">About Input Methods</A>
<DD>
<DT><A HREF="Text-412.html#HEADING412-0">About the Text Services Manager</A>
<DD>
<DL>
<DT><A HREF="Text-413.html#HEADING413-0">The Text Services Environment</A>
<DD>
<DT><A HREF="Text-414.html#HEADING414-0">The Text Services Manager and Input Methods</A>
<DD>
<DL>
<DT><A HREF="Text-414.html#HEADING414-2">Inline Input</A>
<DD>
<DT><A HREF="Text-414.html#HEADING414-12">Floating Input Windows</A>
<DD>
<DT><A HREF="Text-414.html#HEADING414-23">Floating Utility Windows</A>
<DD>
</DL>
</DL>
<DT><A HREF="Text-415.html#HEADING415-0">About Text Service Components</A>
<DD>
<DT><A HREF="Text-416.html#HEADING416-0">Using the Text Services Manager (for Client Applications)</A>
<DD>
<DL>
<DT><A HREF="Text-417.html#HEADING417-0">Testing for the Availability of the Text Services Manager</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-0">Calling the Text Services Manager</A>
<DD>
<DL>
<DT><A HREF="Text-418.html#HEADING418-10">Initializing as a TSM-Aware Application</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-15">Creating a TSM Document</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-21">Making Text Services Available to the User</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-29">Activating and Deactivating a TSM Document</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-37">Passing Events, Menu Selections, and Cursor Setting</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-44">Confirming Active Text Within a TSM Document</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-50">Deleting a TSM Document</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-53">Closing Down as a TSM-Aware Application</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-57">Requesting a Floating Input Window for Text Entry</A>
<DD>
<DT><A HREF="Text-418.html#HEADING418-60">Associating Input Methods With Scripts and Languages</A>
<DD>
</DL>
<DT><A HREF="Text-419.html#HEADING419-0">Handling Text Service Apple Events</A>
<DD>
<DL>
<DT><A HREF="Text-419.html#HEADING419-11">Receiving Text and Updating the Active Input Area</A>
<DD>
<DT><A HREF="Text-419.html#HEADING419-26">Converting Screen Position to Text Offset</A>
<DD>
<DT><A HREF="Text-419.html#HEADING419-39">Converting Text Offset to Screen Position</A>
<DD>
<DT><A HREF="Text-419.html#HEADING419-48">Showing or Hiding the Input Window</A>
<DD>
</DL>
<DT><A HREF="Text-420.html#HEADING420-0">Direct Access to Text Service Components</A>
<DD>
<DL>
<DT><A HREF="Text-420.html#HEADING420-2">Calling the Component Manager</A>
<DD>
<DT><A HREF="Text-420.html#HEADING420-4">Calling Text Service Components</A>
<DD>
</DL>
</DL>
<DT><A HREF="Text-421.html#HEADING421-0">Using the Text Services Manager (for Text Service Components)</A>
<DD>
<DL>
<DT><A HREF="Text-422.html#HEADING422-0">Providing Menus and Icons</A>
<DD>
<DL>
<DT><A HREF="Text-422.html#HEADING422-2">Providing a Text Service Component Menu</A>
<DD>
<DT><A HREF="Text-422.html#HEADING422-11">Providing Input Method Icons for the Keyboard Menu</A>
<DD>
</DL>
<DT><A HREF="Text-423.html#HEADING423-0">Responding to Calls</A>
<DD>
<DL>
<DT><A HREF="Text-423.html#HEADING423-2">Initiating a Text Service</A>
<DD>
<DT><A HREF="Text-423.html#HEADING423-5">Activating Text Service Component Windows</A>
<DD>
<DT><A HREF="Text-423.html#HEADING423-9">Responding to Events and Updating the Cursor and Menu</A>
<DD>
<DT><A HREF="Text-423.html#HEADING423-13">Confirming Active Text Input</A>
<DD>
<DT><A HREF="Text-423.html#HEADING423-16">Closing a Text Service</A>
<DD>
<DT><A HREF="Text-423.html#HEADING423-19">Identifying the Supported Scripts and Languages</A>
<DD>
</DL>
<DT><A HREF="Text-424.html#HEADING424-0">Making Calls</A>
<DD>
<DL>
<DT><A HREF="Text-424.html#HEADING424-2">Sending Apple Events to Client Applications</A>
<DD>
<DT><A HREF="Text-424.html#HEADING424-17">Opening Floating Utility Windows</A>
<DD>
</DL>
</DL>
<DT><A HREF="Text-425.html#HEADING425-0">Text Services Manager Reference</A>
<DD>
<DL>
<DT><A HREF="Text-426.html#HEADING426-0">Text Services Manager Routines for Client Applications</A>
<DD>
<DL>
<DT><A HREF="Text-427.html#HEADING427-0">Initializing and Closing as a TSM-Aware Application</A>
<DD>
<DT><A HREF="Text-430.html#HEADING430-0">Creating and Activating TSM Documents</A>
<DD>
<DT><A HREF="Text-435.html#HEADING435-0">Passing Events to Text Service Components</A>
<DD>
<DT><A HREF="Text-437.html#HEADING437-0">Passing Menu Selections and Cursor Setting</A>
<DD>
<DT><A HREF="Text-440.html#HEADING440-0">Confirming Active Input in a TSM Document</A>
<DD>
<DT><A HREF="Text-442.html#HEADING442-0">Making Text Services Available to the User</A>
<DD>
<DT><A HREF="Text-446.html#HEADING446-0">Requesting a Floating Input Window</A>
<DD>
<DT><A HREF="Text-448.html#HEADING448-0">Associating Scripts and Languages With Components</A>
<DD>
</DL>
<DT><A HREF="Text-453.html#HEADING453-0">Apple Event Handlers Supplied by Client Applications</A>
<DD>
<DL>
<DT><A HREF="Text-454.html#HEADING454-0">Creating and Updating an Active Input Area</A>
<DD>
<DT><A HREF="Text-455.html#HEADING455-0">Converting Global Coordinates to Text Offsets</A>
<DD>
<DT><A HREF="Text-456.html#HEADING456-0">Converting Text Offsets to Global Coordinates</A>
<DD>
<DT><A HREF="Text-457.html#HEADING457-0">Showing or Hiding the Floating Input Window</A>
<DD>
</DL>
<DT><A HREF="Text-458.html#HEADING458-0">Text Services Manager Routines for Components</A>
<DD>
<DL>
<DT><A HREF="Text-459.html#HEADING459-0">Sending Apple Events to a Client Application</A>
<DD>
<DT><A HREF="Text-461.html#HEADING461-0">Opening Floating Utility Windows</A>
<DD>
</DL>
<DT><A HREF="Text-466.html#HEADING466-0">Text Service Component Routines</A>
<DD>
<DL>
<DT><A HREF="Text-467.html#HEADING467-0">Providing a Text Service</A>
<DD>
<DT><A HREF="Text-473.html#HEADING473-0">Responding to Events and Updating the Cursor and Menu</A>
<DD>
<DT><A HREF="Text-478.html#HEADING478-0">Confirming Active Input in a TSM Document</A>
<DD>
<DT><A HREF="Text-480.html#HEADING480-0">Identifying the Supported Scripts and Languages</A>
<DD>
</DL>
</DL>
<DT><A HREF="Text-482.html#HEADING482-0">Summary of the Text Services Manager</A>
<DD>
<DL>
<DT><A HREF="Text-482.html#HEADING482-1">Pascal Summary</A>
<DD>
<DL>
<DT><A HREF="Text-482.html#HEADING482-2">Constants</A>
<DD>
<DT><A HREF="Text-482.html#HEADING482-13">Data Types</A>
<DD>
<DT><A HREF="Text-482.html#HEADING482-23">Text Services Manager Routines for Client Applications</A>
<DD>
<DT><A HREF="Text-482.html#HEADING482-56">Text Services Manager Routines for Components</A>
<DD>
<DT><A HREF="Text-482.html#HEADING482-66">Text Service Component Routines</A>
<DD>
</DL>
<DT><A HREF="Text-482.html#HEADING482-89">C Summary</A>
<DD>
<DL>
<DT><A HREF="Text-482.html#HEADING482-90">Constants</A>
<DD>
<DT><A HREF="Text-482.html#HEADING482-103">Data Types</A>
<DD>
<DT><A HREF="Text-482.html#HEADING482-113">Text Services Manager Routines for Client Applications</A>
<DD>
<DT><A HREF="Text-482.html#HEADING482-149">Text Services Manager Routines for Components</A>
<DD>
<DT><A HREF="Text-482.html#HEADING482-162">Text Service Component Routines</A>
<DD>
</DL>
<DT><A HREF="Text-482.html#HEADING482-189">Assembly-Language Summary</A>
<DD>
<DL>
<DT><A HREF="Text-482.html#HEADING482-190">Trap Macros</A>
<DD>
</DL>
<DT><A HREF="Text-482.html#HEADING482-194">Result Codes</A>
<DD>
</DL>
</DL>
</DL>
</B>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-408.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-410.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
