<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>CWMatchBitmap(IM: ACI Ref)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING265></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="ACIReference-264.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACIReference-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACIReference-371.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACIReference-266.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="ACIReference-2.html"><B>Advanced Color Imaging Reference</B></A> / <BR><DD><A HREF="ACIReference-154.html"><B>Chapter 3 - ColorSync Manager Reference for Applications and Device Drivers</B></A> / <A HREF="ACIReference-218.html"><B>ColorSync Manager Functions</B></A><BR><DL><DD><A HREF="ACIReference-257.html"><B>Matching Colors Using Low-Level Functions Without QuickDraw</B></A> / <A HREF="ACIReference-204.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING265-0></A>
<H3><A NAME=MARKER-11-404></A><A NAME=MARKER-9-405></A>CWMatchBitmap</H3>
 Matches the colors of a bitmap to the gamut of a destination device using the profiles specified by a color world.<P>
<PRE>
pascal CMError CWMatchBitmap (
CMWorldRef cw,
CMBitMap *bitMap,
CMBitmapCallBackUPP progressProc,
void *refCon,
CMBitMap *matchedBitMap); 
</PRE>
<DL>
<DT><CODE>cw</CODE>
<DD> A reference to the color world <A HREF=ACIReference-214.html#MARKER-9-308>(page 3-66)</A> in which matching is to occur.
<DT><CODE>matchedBitMap</CODE>
<DD> A pointer to the bitmap <A HREF=ACIReference-209.html#MARKER-9-296>(page 3-61)</A> whose colors are to be matched. 
<DT><CODE>progressProc</CODE>
<DD> A calling program-supplied callback function that allows your application to monitor progress or abort the operation as the bitmap colors are matched. The Apple CMM calls your function approximately every half-second unless color matching occurs in less time; this happens when there is a small amount of data to be matched. If the function returns a result of <CODE>true</CODE>, the operation is aborted. To match colors without monitoring the process, specify <CODE>NULL</CODE> for this parameter. For a description of the function your application supplies, see <CODE>MyCMBitmapCallBackProc</CODE> <A HREF=ACIReference-310.html#MARKER-9-474>(page 3-170)</A>.
<DT><CODE>refCon</CODE>
<DD> A reference constant for application data passed through as a parameter to calls to the <CODE>progressProc</CODE> function.
<DT><CODE>matchedBitMap</CODE>
<DD> A pointer to a bitmap. On output, contains the color-matched image. You must allocate the pixel buffer pointed to by the <CODE>image</CODE> field of the <CODE>CMBitMap</CODE> structure <A HREF=ACIReference-209.html#MARKER-9-296>(page 3-61)</A>. If you specify <CODE>NULL</CODE> for <CODE>matchedBitMap</CODE>, then the source bitmap is matched in place. 
<DT><I>function result</I>
<DD> A result code of type CMError. See <A HREF=ACIReference-313.html#MARKER-9-479>"Result Codes" (page 3-174)</A> for a list of ColorSync-specific result codes.
</DL>
<A NAME=HEADING265-9></A>
<H5>DISCUSSION</H5>
 The <CODE>CWMatchBitmap</CODE> function matches a bitmap using the profiles specified by the given color world. <P>
 The ColorSync Manager dispatches this function to the preferred CMM. The ColorSync Manager determines the preferred CMM based on the color world configuration. If the color world you pass in was created by the <CODE>NCWNewColorWorld</CODE> function, it contains a source and destination profile, in which case the arbitration scheme described in <A HREF=#nonexistent-marker>"Introduction to the ColorSync Manager"</A> in <I>Advanced Color Imaging on the Mac OS</I> is used to determine the preferred CMM. If the color world you pass in was created by the <CODE>CWConcatColorWorld</CODE> function, then the <CODE>keyIndex</CODE> field of the <CODE>CMConcatProfileSet</CODE> data structure identifies the preferred CMM. If the preferred CMM is not available, the ColorSync Manager uses the default Apple CMM to perform the color matching.<P>
 You should ensure that the buffer pointed to by the <CODE>image </CODE>field of the bitmap passed in the <CODE>bitMap</CODE> parameter is zeroed out before you call this function.<P>
 The following color spaces are currently supported for the <CODE>CWMatchBitmap</CODE> function:<P>
<UL>
<LI><CODE>cmGraySpace</CODE>
<LI><CODE>cmGrayASpace</CODE>
<LI><CODE>cmRGB16Space</CODE>
<LI>cmRGB24Space
<LI><CODE>cmRGB32Space</CODE>
<LI><CODE>cmARGB32Space</CODE>
<LI><CODE>cmRGBA32Space</CODE>
<LI><CODE>cmCMYK32Space</CODE>
<LI><CODE>cmHSV32Space</CODE>
<LI><CODE>cmHLS32Space</CODE>
<LI><CODE>cmYXY32Space</CODE>
<LI><CODE>cmXYZ32Space</CODE>
<LI><CODE>cmLUV32Space</CODE>
<LI><CODE>cmLAB24Space</CODE>
<LI><CODE>cmLAB32Space</CODE>
<LI>cmNamedIndexed32Space
<LI>cmMCFive8Space
<LI>cmMCSix8Space
<LI>cmMCSeven8Space
<LI>cmMCEight8Space<P>
</UL>
 The ColorSync Manager does not explicitly support a CMY color space. However, for printers that have a CMY color space, you can use either of the following circumventions to make the adjustment:<P>
<UL>
<LI>You can use a CMY profile, which the ColorSync Manager does support, with a CMYK color space. If you specify a CMYK color space in this case, the ColorSync Manager zeroes out the K channel to simulate a CMY color space.
<LI>You can use an RGB color space and pass in the bitmap along with an RGB profile, then perform the conversion from RGB to CMY yourself.<P>
</UL>
 For this function to execute successfully, the source profile's <CODE>dataColorSpace</CODE> field value and the <CODE>space</CODE> field value of the source bitmap pointed to by the <CODE>bitMap</CODE> parameter must specify the same data color space. Additionally, the destination profile's <CODE>dataColorSpace</CODE> field value and the <CODE>space</CODE> field value of the resulting bitmap pointed to by the <CODE>matchedBitMap</CODE> parameter must specify the same data color space, unless the destination profile is a named color space profile.<P>
<DL>
<DT><B>IMPORTANT</B>
<DD>If you set matchedBitMap to <CODE>NULL</CODE> to specify in-place matching, you must be sure the space required by the destination bitmap is less than or equal to the size of the source bitmap.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
<A NAME=HEADING265-39></A>
<H5>SEE ALSO</H5>
 The <CODE>NCWNewColorWorld</CODE> function <A HREF=ACIReference-258.html#MARKER-9-391>(page 3-108)</A> and the <CODE>CWConcatColorWorld</CODE> function <A HREF=ACIReference-259.html#MARKER-9-394>(page 3-110)</A> both allocate color world references of type <CODE>CMWorldRef</CODE>. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="ACIReference-264.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="ACIReference-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="ACIReference-371.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="ACIReference-266.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="ACIReference-3.html">&copy; Apple Computer, Inc.</A><br>11 NOV 1996<P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML> 
