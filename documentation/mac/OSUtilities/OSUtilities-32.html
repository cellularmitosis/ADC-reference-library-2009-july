<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SysError (IM: U)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING32></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="OSUtilities-31.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="OSUtilities-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="OSUtilities-222.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="OSUtilities-33.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="OSUtilities-2.html"><B>Operating System Utilities</B></A> / <BR><DD><A HREF="OSUtilities-28.html"><B>Chapter 2 - System Error Handler</B></A> / <A HREF="OSUtilities-30.html"><B>System Error Handler Reference</B></A><BR><DL><DD><A HREF="OSUtilities-31.html"><B>System Error Handler Routines</B></A> / <A HREF="OSUtilities-25.html"><B></B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING32-0></A>
<H3><A NAME=MARKER-2-74></A>SysError</H3>
 You can use the <CODE>SysError</CODE> procedure to simulate a system error. Ordinarily, however, only the Operating System invokes this procedure.<P>
<PRE>
PROCEDURE SysError (errorCode: Integer);
</PRE>
<DL>
<DT><CODE>errorCode</CODE>
<DD> The system error ID corresponding to the system error condition identified.
</DL>
<A NAME=HEADING32-4></A>
<H5>DESCRIPTION</H5>
 The <CODE>SysError</CODE> procedure generates a system error with the system error ID specified by the <CODE>errorCode</CODE> parameter. The value of the system error ID determines the exact response of the System Error Handler (for example, whether it can intercept the error) and determines the contents of the system error alert box displayed for the error.<P>
 The <CODE>SysError</CODE> procedure begins by saving all registers and the stack pointer and by storing the system error ID in a global variable (named <CODE>DSErrCode</CODE>). The Finder uses this global variable when reporting that an application unexpectedly quit.<P>
 If there is not a system error alert table in memory, <CODE>SysError</CODE> loads it in. (The global variable <CODE>DSAlertTab</CODE> stores a pointer to the current system error alert table. If no system error alert table is in memory, <CODE>DSAlertTab</CODE> is <CODE>NIL</CODE>.) If there is no table in memory (indicating that the error likely occurred at the beginning of system startup), the System Error Handler draws the "sad Macintosh" icon and plays appropriate ominous tones through the Macintosh speaker. Different tones correspond to different problems that the <CODE>SysError</CODE> procedure determines have occurred.<A NAME=MARKER-2-13></A><P>
 After allocating memory for QuickDraw global variables on the stack and initializing QuickDraw, <CODE>SysError</CODE> initializes a graphics port in which the alert box is drawn. The <CODE>SysError</CODE> procedure draws the alert box (in the rectangle specified by the global variable <CODE>DSAlertRect</CODE>) unless the <CODE>errorCode</CODE> parameter contains a negative value. <I>Note that the system error alert box is not a Dialog Manager modal dialog box.</I> Negative values are used to force the <CODE>SysError</CODE> procedure to display a sequence of consecutive messages in a system startup alert box without redrawing the entire alert box. If the value in the <CODE>errorCode</CODE> parameter does not correspond to an entry in the system error alert table, the default alert box definition at the start of the table is used, displaying the message "Sorry, a system error occurred."<P>
 The <CODE>SysError</CODE> procedure uses the value in the <CODE>errorCode</CODE> parameter to determine the contents of the system error alert box. It looks in the system error alert table resource for an alert definition whose definition ID matches the <CODE>errorCode</CODE> parameter. It then draws the text and icon of the alert box according to that alert definition in the system error alert table. <P>
 System error alert tables include procedures and button definitions. (See the description of the system error alert table resource in the section <A HREF=OSUtilities-36.html#MARKER-9-76>"The System Error Alert Table Resource" beginning on page 2-16</A>, for details.) If the procedure definition ID in the table is not 0, <CODE>SysError</CODE> invokes the procedure with the specified ID. If the button definition ID in the table is 0, <CODE>SysError</CODE> returns control to the procedure that called it. This mechanism allows the disk-switch alert box to return control to the File Manager after the "Please insert the disk:" message has been displayed.<P>
 If a resume procedure has been defined, the button definition ID is incremented by 1. This mechanism allows the System Error Handler to use one of two layouts depending on whether a resume procedure has been defined. After drawing the buttons using QuickDraw rather than the Control Manager, <CODE>SysError</CODE> performs hit-testing on the buttons, highlighting them appropriately. When a button is pressed, the appropriate procedure is invoked. If there is no procedure code defined for a button, the <CODE>SysError</CODE> procedure returns to the routine that called it. The resume procedure is described in the next section.<P>
<A NAME=HEADING32-12></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Calling the <CODE>SysError</CODE> procedure might cause a system crash even if no condition that would have caused a system crash existed prior to the invocation of <CODE>SysError</CODE>.<P>
 <CODE>SysError</CODE> works correctly only if the following conditions are met:<P>
<UL>
<LI>The trap dispatcher is operative. (See the chapter "Trap Manager" in this book for information about the trap dispatcher.)
<LI>The Font Manager procedure <CODE>InitFonts</CODE> has been called. Ordinarily, it is called when the system starts up.
<LI>Register A7 points to a reasonable place in memory (for example, not to video RAM).
<LI>A few important system data structures do not appear to be too badly damaged.<A NAME=MARKER-9-47></A><A NAME=MARKER-2-75></A><P>
</UL>
<A NAME=HEADING32-19></A>
<H5>SEE ALSO</H5>
 A list of system error IDs is provided in <A HREF=OSUtilities-29.html#MARKER-9-1>Table 2-1 on page 2-7</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="OSUtilities-31.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="OSUtilities-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="OSUtilities-222.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="OSUtilities-33.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="OSUtilities-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
