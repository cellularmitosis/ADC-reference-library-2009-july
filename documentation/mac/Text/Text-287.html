<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Sorting Strings in the Same Language(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING287></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-286.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-288.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-279.html"><B>Chapter 5 - Text Utilities</B></A> / <A HREF="Text-284.html"><B>Using the Text Utilities</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING287-0></A>
<H2><A NAME=MARKER-2-373></A>Sorting Strings in the Same Language<A NAME=MARKER-9-112></A><A NAME=MARKER-2-839></A><A NAME=MARKER-2-389></A></H2>
 The Text Utilities provide a number of routines that you can use to compare and sort strings in the same language. Some of these routines perform a comparison that assumes single-byte character codes in the strings; others take into account the sorting rules of the current script system, and still others allow you to explicitly specify the script system resource to use for sorting strings.<P>
 Comparing strings can be an extremely intricate operation, because in many languages you may have to account for subtleties such as complex characters, ignorable characters, and exceptional words. Even for a straightforward language such as English, you can't always determine the sorting order by a simple table lookup or character value comparison.<P>
 This section provides an introduction to some of the principles of text comparison and sorting used by the Macintosh script management system. It then describes the routines you can use for different comparison tasks.<P>
<A NAME=HEADING287-4></A>
<H3><A NAME=MARKER-9-115></A>Primary and Secondary Sorting Order<A NAME=MARKER-9-52></A><A NAME=MARKER-2-194></A><A NAME=MARKER-9-89></A></H3>
 Sorting consists of two steps: determining primary sorting order and determining secondary sorting order.<P>
 What happens in primary sorting order and secondary sorting order depends on the language of the strings that are being sorted; however, there are two levels of importance in the sorting operation, with some sorting differences subordinate to others. In the primary sorting order for many Roman script system languages, uppercase and lowercase characters are equivalent and diacritical marks are ignored. Thus, after primary sorting, the two strings "The" and "th&eacute;" are considered equivalent. In the secondary sorting order, lowercase characters are ranked after uppercase characters and characters with diacritical marks are ranked individually. Thus, after secondary sorting, "The" would sort before "th&eacute;".<P>
 You can think of the character ranking that is used to determine sorting order as a two-dimensional table. Each row of the table is a class of all characters such as all <I>A</I>'s: uppercase and lowercase, with and without diacritical marks. The characters are ordered within each row to form a secondary sorting order, while the order within each column determines primary sorting order. <A HREF=#MARKER-9-1>Table 5-1</A> shows an example of such a table.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-1></A><B>Table 5-1 Excerpt from the Standard Roman script system sorting order</B> (Continued) (Continued)</CAPTION>
<TH>Primary sorting <BR>order<TH>Secondary sorting order<BR><TR>
<TD>A<TD>A &Agrave; &Aacute; &Acirc; &Auml; &Aring; --> a &agrave; &aacute; &acirc; &auml; &aring; &aelig; <TR>
<TD>B<TD>B b<TR>
<TD>C<TD>C &Ccedil; c &ccedil;<TR>
<TD>D<TD>D d<TR>
<TD>E<TD>E &Egrave; &Eacute; &Ecirc; &Euml; e &egrave; &eacute; &ecirc; &euml;<TR>
<TD>F<TD>F f</TABLE>
<P>
 In primary sorting, each of the characters in the first row would be considered equivalent and sorted before characters in the second row. In secondary sorting, the order of the characters in each row would be taken into consideration. Another way of saying this is to say that primary sorting characteristics take precedence over secondary sorting characteristics: if any primary differences are present, all secondary differences are ignored. When the strings being compared are of different lengths, each character in the longer string that does not correspond to a character in the shorter one results in a "comes after" result. This takes precedence over secondary sorting order.<P>
 For example, here is a list of strings that have not yet been sorted:<P>
 &Aring; ab &Aacute;c ac Ab &agrave;b Ac <P>
 After primary sorting, the list appears as follows<P>
 &Aring; ab Ab &agrave;b &Aacute;c ac Ac <P>
 After secondary sorting, the list appears as follows<P>
 &Aring; Ab ab &agrave;b ac &Aacute;c Ac <A NAME=MARKER-9-132></A><P>
<A NAME=HEADING287-15></A>
<H3>Expansion and Contraction of Characters</H3>
 In some languages, a single character may be expanded--that is, sorted as a sequence of characters. First, the sorting routine expands the character, then it performs sorting on the expanded version. Next, the sorting routine recombines the character and then performs secondary sorting. For instance, the <I>&auml;</I> in German may be sorted as if it were the two characters <I>ae</I>: <I>B&auml;cker</I> would come after <I>Bad</I>, but before <I>Bahn</I>.<P>
 A sequence of characters may also be contracted--that is, sorted as a single character. For instance, <I>ch</I> in Spanish may be sorted as if it were one character that sorts after <I>c</I> but before <I>d</I>: <I>coche</I> comes after <I>coco</I> but before <I>codo</I>.<A NAME=MARKER-2-183></A><A NAME=MARKER-9-101></A><P>
<A NAME=HEADING287-18></A>
<H3>Ignorable Characters<A NAME=MARKER-21-108></A></H3>
 Certain characters need to be ignored unless the strings are otherwise equal; that is, these characters have no effect on the primary sorting order, but they do influence the secondary sorting order. In English, hyphens, apostrophes, and spaces are ignorable characters. For instance, the hyphen is ignored in primary sorting order in English: <I>black-bird</I> would come after <I>blackbird</I>, but before <I>blackbirds</I>.<P>
<A NAME=HEADING287-20></A>
<H3>Converting and Stripping Characters<A NAME=MARKER-2-146></A><A NAME=MARKER-2-235></A><A NAME=MARKER-2-109></A><A NAME=MARKER-2-112></A><A NAME=MARKER-2-278></A></H3>
 Sometimes you may want to strip out certain characters (notably diacritical marks) or convert the case of characters in a string to produce a different comparison result. For example, you may want to convert all alphabetic characters in two strings into uppercase before comparing the strings, rendering uppercase and lowercase characters equivalent. The Text Utilities provide a number of routines for converting the case of characters and for stripping diacritical marks. These routines are described in the section <A HREF=Text-288.html#MARKER-9-143>"Modifying Text,"</A> which begins on <A HREF=Text-288.html#MARKER-9-143>page 5-18</A>.<P>
<A NAME=HEADING287-22></A>
<H3><A NAME=MARKER-2-128></A>Special Cases for Sorting</H3>
 Sometimes the sorting order changes drastically for special cases. For instance, when words are understood to be abbreviations, the strings should be sorted as if they were spelled out in full, as in the following examples.<A NAME=MARKER-2-52></A>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>First string<TH>Second string<TH>Explanation<TR>
<TD>McDonald<TD>Mary<TD><I>McDonald</I> is treated as <I>MacDonald</I><TR>
<TD>St. James<TD>Smith<TD><I>St.</I> is an abbreviation for <I>Saint</I><TR>
<TD>Easy Step<TD>Easy St.<TD><I>St.</I> is an abbreviation for <I>Street</I></TABLE>
<P>
 Cases such as these require a direct dictionary lookup and are not handled automatically by the Macintosh script management system. Note that some abbreviations are context-dependent, such as <I>St.</I>, which may denote <I>Saint</I> or <I>Street</I>, depending on the meaning of the adjacent text.<A NAME=MARKER-2-130></A><P>
<A NAME=HEADING287-25></A>
<H3><A NAME=MARKER-2-131></A>Variations in Sorting Behavior</H3>
 Here are some examples of variations in sorting behavior in different writing systems of the world.<P>
<UL>
<LI>Sorting in Japanese depends upon the subscript. Kana and Romaji sorting are complicated by the presence of both 1- and 2-byte character codes. Moreover, many Katakana symbols have diacritical marks indicating a sound modification. For example, the symbol for <I>ga i</I>s formed from the symbol for <I>ka.</I> The secondary sorting order for <I>ga</I> includes the four combinations of 1-byte or 2-byte <I>ka</I> with the 1-byte or 2-byte diacritical mark, plus a 2-byte character that combines the character and diacritical into a single glyph.<P>
In the Japanese script system, Kanji is currently sorted by character code, which can produce unexpected results. Proper sorting in Kanji is commonly done using one of three methods:<P>
<UL>
<LI>First by a character's primary radical, then by the number of remaining strokes.
<LI>First by the number of total strokes, then by the primary radical.
<LI>By sound value.<P>
</UL>
<LI>Sorting in Arabic is quite straightforward except that some characters are ignorable, such as vowels and the extension bar (used to lengthen the cursive connection between characters). Vowels in Arabic are also diacritical marks, overlapping over or under the previous character (the character to the right).
<LI>The Thai script system currently provides for third-level sorting involving character clusters. For more on character clusters, see the chapter "Introduction to Text on the Macintosh" in this book.<A NAME=MARKER-2-986></A><P>
</UL>
<DL>
<DT><B>Note</B>
<DD>If you need to modify a script system's standard string comparison or replace it with your own version, you have to create your own string-manipulation (<CODE>'itl2'</CODE>) resource by following the guidelines described in the appendix "International Resources" in this book.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<A NAME=HEADING287-35></A>
<H3>Choosing a Comparison Routine  <A NAME=MARKER-2-133></A></H3>
 The Text Utilities include six different routines for comparing one string to another. Three of these routines test two strings for equality and the other three determine the ordering relationship between two strings. You can use these routines with Pascal strings and text strings, and they allow you to work with information from various resources or to ignore script and language information altogether.<P>
 <A HREF=#MARKER-9-134>Figure 5-6</A> provides you with convenient guidelines for choosing from among the comparison routines included in the Text Utilities. You first decide whether you are comparing two Pascal strings or two text strings, and then decide whether to unconditionally use the Macintosh file system string comparison rules or to explicitly specify a string-manipulation resource that defines such rules. If you use a routine that requires a parameter for a string-manipulation resource handle, you can specify <CODE>NIL</CODE> for the value of that parameter to indicate that you want the current script system's string-manipulation resource.<P>
 The top routine names in the boxes in <A HREF=#MARKER-9-134>Figure 5-6</A> are used to test two strings for equality, and the bottom routine names in the boxes are used to compare two strings and determine their sorting order. The term script-aware is used in this figure to indicate that you must explicitly specify a string-manipulation resource as a parameter to a routine, rather than the routine automatically using the file system's string-manipulation rules.<P>
<B>Figure 5-6  <A NAME=MARKER-9-134></A>Choosing a string comparison routine</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/TU_L-03.jpg">
 <A NAME=MARKER-2-160></A>The Macintosh file system string comparison rules are a subset of the Roman script system comparison rules. These rules are used when the Macintosh file system compares filenames for sorting. Since the <A NAME=MARKER-9-269></A><I>Macintosh character set</I> only contains characters with codes from $0 to $D8, the file system comparison rules only work correctly for character codes through $D8. You should only use the routines that use these rules when you are trying to emulate the way that the Macintosh file system compares strings. <A HREF=#MARKER-9-21>Table 5-2</A> describes the sorting behavior implemented by the routines that use the file system comparison rules.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-21></A><B>Table 5-2 Sorting features of the Macintosh file system</B></CAPTION>
<TH colspan=2>Reordering of ligatures<TH colspan=2>Stripping of diacritical marks<TH colspan=2>Uppercase conversion<TR>
<TH>Ligature<TH>Falls between<TH>Marked character<TH>Stripped to<TH>Lower<TH>Upper<TR>
<TD>--><TD>&Aring; and a<TD>&Auml;, &Aring;, &Agrave;, &Atilde;<TD>A<TD>a-z<TD>A-Z<A HREF="#FOOTNOTE-1">[1]</A><TR>
<TD>&aelig; <TD> &aring; and B<TD>&Ccedil;<TD>C<TD>&agrave;<TD>&Agrave;<TR>
<TD>\xEB<TD>&Oslash; and o<TD>&Eacute;<TD>E<TD>&atilde;<TD>&Atilde;<TR>
<TD>\xB6 <TD>&oslash; and P<TD>&Ntilde;<TD>N<TD>&auml;<TD>&Auml;<TR>
<TD>&szlig;<TD> s and T<TD>&Ouml;, &Otilde;, &Oslash;<TD>O<TD>&aring;<TD>&Aring;<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&Uuml;<TD>U<TD>&aelig;<TD>--><TR>
<TD>&nbsp;<TD>&nbsp;<TD>&aacute;, &agrave;, &acirc;, &auml;, &atilde;, &aring;, \x81<TD>a<TD>&ccedil;<TD>&Ccedil;<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&ccedil;<TD>c<TD>&eacute;<TD>&Eacute;<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&eacute;, &egrave;, &ecirc;, &euml;<TD>e <TD>&ntilde;<TD>&Ntilde;<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&iacute;, &igrave;, &icirc;, &iuml;<TD>i<TD>&ouml;<TD>&Ouml;<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&ntilde;<TD>n <TD>&otilde;<TD>&Otilde;<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&oacute;, &ograve;, &ocirc;, &ouml;, &otilde;, &oslash;, \x86<TD>o <TD>&oslash;<TD>&Oslash;<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&uacute;, &ugrave;, &ucirc;, &uuml;<TD>u<TD>\xB6<TD>\xEB<TR>
<TD>&nbsp;<TD>&nbsp;<TD>&yuml;<TD>y <TD>&uuml;<TD>&Uuml;<A NAME=MARKER-2-206></A></TABLE>
<P>
<A NAME=HEADING287-42></A>
<H3>Testing Two Strings for Equality</H3>
 To test whether two strings are equal, use <CODE>EqualString</CODE>, <CODE>IdenticalString</CODE>, or <CODE>IdenticalText</CODE>. You can use the first two functions with Pascal strings, and the last one with text strings.<P>
 The functions that work with Pascal strings--<CODE>EqualString</CODE> and <CODE>IdenticalString</CODE>--allow you to specify the kind of information you want to consider in your test. If you want to test two Pascal strings using the Macintosh file system comparison rules, use <CODE>EqualString</CODE>. If you want to consider the information from a string-manipulation resource, use the <CODE>IdenticalString</CODE> function. You can explicitly specify the handle of a string-manipulation resource or you can specify <CODE>NIL</CODE> as the value to indicate that you want the current script's string-manipulation resource used.<A NAME=MARKER-2-280></A><P>
 To test two text strings for equality, you use the <CODE>IdenticalText</CODE> function, which makes use of the information in a string-manipulation resource. You can explicitly specify the handle of a string-manipulation resource or you can specify <CODE>NIL</CODE> as the value to indicate that you want the current script's string-manipulation resource used.<A NAME=MARKER-2-407></A><P>
<A NAME=HEADING287-46></A>
<H3>Comparing Two Strings for Ordering</H3>
 There are also three Text Utilities routines that compare two strings and return a value that indicates whether the first string is less than, equal to, or greater than the second string. Two of these routines take Pascal string parameters and the other takes text string parameters.<P>
 To compare one Pascal string to another, you have to choose either the <CODE>RelString</CODE> function or the <CODE>CompareString</CODE> function. If you want to compare two Pascal strings using the Macintosh file system comparison rules, use <CODE>RelString</CODE>. If you want to consider the information from a string-manipulation resource, use the <CODE>CompareString</CODE> function. You can explicitly specify the handle of a string-manipulation resource or you can specify <CODE>NIL</CODE> as the value to indicate that you want the current script's string-manipulation resource used.<A NAME=MARKER-2-249></A><P>
 To compare one text string to another, you use the <CODE>CompareText</CODE> function, which makes use of the information in a string-manipulation resource. You can explicitly specify the handle of a string-manipulation resource or you can specify <CODE>NIL</CODE> as the value to indicate that you want the current script's string-manipulation resource used<A NAME=MARKER-2-76></A><A NAME=MARKER-2-425></A>.<A NAME=MARKER-2-82></A><P>
<HR>

<A NAME="FOOTNOTE-1">[1] All simple lowercase Roman characters are converted to their uppercase equivalents.
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-286.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-288.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
