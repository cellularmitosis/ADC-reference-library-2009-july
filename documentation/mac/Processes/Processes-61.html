<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Performing Periodic Tasks (IM: Pr)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING61></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Processes-60.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-62.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="Processes-2.html"><B>Processes</B></A><BR><DD><A HREF="Processes-53.html"><B>Chapter 3 - Time Manager</B></A> / <A HREF="Processes-58.html"><B>Using the Time Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING61-0></A>
<H2><A NAME=MARKER-9-100></A>Performing Periodic Tasks</H2>
 <A NAME=MARKER-2-143></A><A NAME=MARKER-2-92></A><A NAME=MARKER-2-103></A>One way to install a periodic Time Manager task is to have the task reactivate itself. Because the task record is already inserted into the Time Manager task queue, the task can simply call <CODE>PrimeTime</CODE> to reactivate itself. To call <CODE>PrimeTime</CODE>, however, the task needs to know the address of the corresponding task record. In the revised and extended Time Managers, the task record's address is placed into register A1 when the task is called. <A HREF=#MARKER-9-104>Listing 3-4</A> illustrates how the task can reactivate itself by retrieving the address in register A1 and passing that address to <CODE>PrimeTime</CODE>.<P>
<B>Listing 3-4  <A NAME=MARKER-9-104></A><A NAME=MARKER-21-105></A>Defining a periodic Time Manager task</B><P>
<PRE>
FUNCTION GetTMInfo: TMInfoPtr;
   INLINE $2E89;                 {MOVE.L A1,(SP)}

PROCEDURE MyTask;                {for revised and extended TMs}
VAR
   recPtr:        TMInfoPtr;
CONST
   kDelay = 2000;                {delay value}
BEGIN
   recPtr := GetTMInfo;          {first get your own address}

   {Do something here.}

   PrimeTime(QElemPtr(recPtr), kDelay);
END;
</PRE>
<DL>
<DT><B>IMPORTANT</B>
<DD>You cannot use the technique illustrated in <A HREF=#MARKER-9-104>Listing 3-4</A> with the original Time Manager because it does not pass the address of the task record in register A1.<B></B><A NAME=MARKER-2-106></A><A NAME=MARKER-2-93></A><A NAME=MARKER-2-145></A>  <B>&#183;</B>
</DL>
</BLOCKQUOTE><P>
<HR>
<center>
<A HREF="Processes-60.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Processes-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Processes-171.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Processes-62.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Processes-3.html">&copy; Apple Computer, Inc.</A><br>17 JUN 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
