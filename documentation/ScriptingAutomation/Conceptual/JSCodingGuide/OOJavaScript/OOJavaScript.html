<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Apple JavaScript Coding Guidelines: Object-Oriented JavaScript</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Object-Oriented JavaScript"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40006539" title="Object-Oriented JavaScript"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../JavaScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP40005952" target="_top">JavaScript</a> &gt; <a href="../index.html" target="_top">Apple JavaScript Coding Guidelines</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../JSIntroduction/JSIntroduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Advanced/Advanced.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40006539-SW2" title="Object-Oriented JavaScript"></a><hr /><H1>Object-Oriented JavaScript</H1><p>JavaScript code doesn’t necessarily follow object-oriented design patterns. However, the JavaScript language provides support for common object-oriented conventions, like constructors and inheritance, and benefits from using these principles by being easier to maintain and reuse.</p><p>Read this chapter if you’re already familiar with object-oriented programming and want to see how to create object-oriented code with JavaScript.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="OOJavaScript.html#//apple_ref/doc/uid/TP40006539-DontLinkElementID_16">Declaring an Object</a>
				
			<br/>
			
        
			
			
				<a href="OOJavaScript.html#//apple_ref/doc/uid/TP40006539-SW1">Freeing Objects</a>
				
			<br/>
			
        
			
			
				<a href="OOJavaScript.html#//apple_ref/doc/uid/TP40006539-SW4">Arrays and Objects</a>
				
			<br/>
			
        
			
			
				<a href="OOJavaScript.html#//apple_ref/doc/uid/TP40006539-DontLinkElementID_17">Getters and Setters</a>
				
			<br/>
			
        
			
			
				<a href="OOJavaScript.html#//apple_ref/doc/uid/TP40006539-DontLinkElementID_18">Inheritance</a>
				
			<br/>
			
        
			
			
				<a href="OOJavaScript.html#//apple_ref/doc/uid/TP40006539-SW3">Copying an Object</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40006539-DontLinkElementID_16" title="Declaring an Object"></a><h2>Declaring an Object</h2><p>JavaScript provides the ability to create objects that contain member variables and functions. To define a new object, first create a new function with the desired object’s name, like this:</p><div class="codesample"><table><tr><td scope="row"><pre>function myObject()<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    // constructor code goes here<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>This function works as the object’s constructor, setting up any variables needed by the object and handling any initializer values passed in as arguments. Within the constructor or any member function, persistent instance variables are created by adding them to the <code>this</code> keyword and providing the variable with a value, like this:</p><div class="codesample"><table><tr><td scope="row"><pre>this.myVariable = 5;<span></span></pre></td></tr></table></div><p>To create a new member function, create a new anonymous function and assign it to the prototype property of the object. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>myObject.prototype.memberMethod = function()<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    // code to execute within this method<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/TP40006539-DontLinkElementID_22" title="Important:"></a><p><strong>Important:</strong>&nbsp;You must do this assignment outside the constructor. Assigning a member function to a prototype should not be confused with assigning an anonymous function to a member variable of a class, which only adds the function to a particular instance of the class, and is probably not what you want.</p><p></p></div><p>After you have created the constructor for your object, you can create new object instances by using the <code>new</code> keyword followed by a call to the constructor function. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>var myObjectVariable = new myObject();<span></span></pre></td></tr></table></div><p>This particular constructor takes no parameters. However, you can also create more complex constructors for classes that allow you to specify commonly used or mandatory initial values. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>function myObject(bar)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>        this.bar = bar;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>myobj = new myObject(3);<span></span></pre></td></tr><tr><td scope="row"><pre>alert('myobj.bar is '+myobj.bar); // prints 3.<span></span></pre></td></tr></table></div><p>One common use of this technique is to create initializers that duplicate the contents of an existing object. This is described further in <span class="content_text"><a href="OOJavaScript.html#//apple_ref/doc/uid/TP40006539-SW3">“Copying an Object.”</a></span></p><a name="//apple_ref/doc/uid/TP40006539-SW1" title="Freeing Objects"></a><h2>Freeing Objects</h2><p>Just as you used the <code>new</code> operator to create an object, you should delete objects when you are finished with them, like this:</p><div class="codesample"><table><tr><td scope="row"><pre>delete myObjectVariable;<span></span></pre></td></tr></table></div><p>The JavaScript runtime automatically garbage collects objects when their value is set to <code>null</code>. However, setting an object to <code>null</code> doesn’t remove the variable that references the object from memory. Using <code>delete</code> ensures that this memory is reclaimed in addition to the memory used by the object itself. (It is also easier to see places where your allocations and deallocations are unbalanced if you explicitly call <code>delete</code>.)</p><a name="//apple_ref/doc/uid/TP40006539-SW4" title="Arrays and Objects"></a><h2>Arrays and Objects</h2><p>JavaScript provides arrays for collecting data. Since an array is an object, you need to create a new instance of an array before using it, like this:</p><div class="codesample"><table><tr><td scope="row"><pre>var myArray = new Array();<span></span></pre></td></tr></table></div><p>Alternatively, you can use this simpler syntax:</p><div class="codesample"><table><tr><td scope="row"><pre>var myArray = [];<span></span></pre></td></tr></table></div><p>Once you create an array, you reference elements using integer values inside of brackets, like this:</p><div class="codesample"><table><tr><td scope="row"><pre>myArray[0] = "first value";<span></span></pre></td></tr><tr><td scope="row"><pre>myArray[1] = 5;<span></span></pre></td></tr></table></div><p>The previous example shows that arrays, like variables, can hold data of any type.</p><p>Generic objects and arrays can be used with associative properties, where strings replace the index number:</p><div class="codesample"><table><tr><td scope="row"><pre>myObject["indexOne"] = "first value";<span></span></pre></td></tr><tr><td scope="row"><pre>myObject["indexTwo"] = 5;<span></span></pre></td></tr></table></div><p>When you use a string as an index, you can use a period instead of brackets to access and assign data to that property:</p><div class="codesample"><table><tr><td scope="row"><pre>myObject.name = "Apple Inc.";<span></span></pre></td></tr><tr><td scope="row"><pre>myObject.city = "Cupertino";<span></span></pre></td></tr></table></div><p>You can declare an object and its contents inline, as well:</p><div class="codesample"><table><tr><td scope="row"><pre>myObject = {<span></span></pre></td></tr><tr><td scope="row"><pre>    name: "Apple Inc.",<span></span></pre></td></tr><tr><td scope="row"><pre>    city: "Cupertino"<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>A variation of the <code>for</code> loop is available for iterating within the properties of an array or object. Called a <code>for-in</code> loop, it looks like this:</p><div class="codesample"><table><tr><td scope="row"><pre>for ( var index in myArray )<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    // code to execute within this loop<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40006539-DontLinkElementID_17" title="Getters and Setters"></a><h2>Getters and Setters</h2><p>Recent WebKit builds (available from webkit.org) contain support for getter and setter functions. These functions behave like a variable but really call a function to change any underlying values that make a property. Declaring a getter looks like this:</p><div class="codesample"><table><tr><td scope="row"><pre>myObject.__defineGetter__( "myGetter", function() { return this.myVariable; } );<span></span></pre></td></tr></table></div><p>It is essential that a getter function return a value because, when used, the returned value is used in an assignment operation like this:</p><div class="codesample"><table><tr><td scope="row"><pre>var someVariable = myObject.myGetter;<span></span></pre></td></tr></table></div><p>Like a getter, a setter is defined on an object and provides a keyword and a function:</p><div class="codesample"><table><tr><td scope="row"><pre>myObject.__defineSetter__( "mySetter", function(aValue) { this.myVariable = aValue; } );<span></span></pre></td></tr></table></div><p>Note that setter functions need to take an argument that’s used in an assignment statement, like this:</p><div class="codesample"><table><tr><td scope="row"><pre>myObject.mySetter = someVariable;<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40006539-DontLinkElementID_18" title="Inheritance"></a><h2>Inheritance</h2><p>JavaScript allows an object to inherit from other objects via the <code>prototype</code> keyword. To inherit from another object, set your object’s prototype equal to the prototype of the parent object, like this:</p><div class="codesample"><table><tr><td scope="row"><pre>MyChildObject.prototype = MyParentObject.prototype;<span></span></pre></td></tr></table></div><div class="notebox"><a name="//apple_ref/doc/uid/TP40006539-DontLinkElementID_23" title="Note"></a><p><strong>Note:</strong>&nbsp;Because the prototype keyword is undefined on instances of a class, this action must be performed on the <em>constructor function</em> names, not on variables containing instances of the class.</p></div><p>This copies all of the parent’s functions and variables to your object. It does <em>not</em>, however, copy the default values stored in that object. If your purpose is to subclass an object completely, you must also execute code equivalent to the original constructor or construct an instance of the original type and copy its values as described in <span class="content_text"><a href="OOJavaScript.html#//apple_ref/doc/uid/TP40006539-SW3">“Copying an Object.”</a></span></p><p>Recent WebKit builds also include the ability to extend an existing DOM object via the <code>prototype</code> keyword. The advantage of this over inheritance is a smaller memory footprint and easier function overloading.</p><a name="//apple_ref/doc/uid/TP40006539-SW3" title="Copying an Object"></a><h2>Copying an Object</h2><p>In object-oriented programming, you often need to make a copy of an object. The most straightforward (but painful) way to do this is to methodically copy each value by hand. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>function myObjectCopy(oldobj)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>        // copy values one at a time<span></span></pre></td></tr><tr><td scope="row"><pre>        this.bar = oldobj.bar;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>For very simple objects, explicit copying is fine. However, as objects grow larger, this technique can become unmanageable, particularly if additional variables are added to an object outside the constructor. Fortunately, because a JavaScript object is essentially an associative array, you can manipulate it just as you would an array. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>function myObjectCopy(oldobj)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>        // copy values with an iterator<span></span></pre></td></tr><tr><td scope="row"><pre>        for (myvar in oldobj) {<span></span></pre></td></tr><tr><td scope="row"><pre>                this[myvar] = oldobj[myvar];<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>You should be aware, however, that assigning an object to a variable merely stores a reference to that object, not a copy of that object, and thus any objects stored within this object will not be copied by the above code.</p><p>If you need to perform a deep copy of a structured tree of data, you should explicitly call a function to copy the nested objects. The easiest way to do this is to include a <code>clone</code> function in each class, test each variable to see if it contains an object with a clone function, and call that function if it exists. For example:</p><div class="codesample"><table><tr><td scope="row"><pre>// Create an inner object with a variable x whose default<span></span></pre></td></tr><tr><td scope="row"><pre>// value is 3.<span></span></pre></td></tr><tr><td scope="row"><pre>function innerObj()<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>        this.x = 3;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>innerObj.prototype.clone = function() {<span></span></pre></td></tr><tr><td scope="row"><pre>    var temp = new innerObj();<span></span></pre></td></tr><tr><td scope="row"><pre>    for (myvar in this) {<span></span></pre></td></tr><tr><td scope="row"><pre>        // this object does not contain any objects, so<span></span></pre></td></tr><tr><td scope="row"><pre>        // use the lightweight copy code.<span></span></pre></td></tr><tr><td scope="row"><pre>        temp[myvar] = this[myvar];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return temp;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Create an outer object with a variable y whose default<span></span></pre></td></tr><tr><td scope="row"><pre>// value is 77.<span></span></pre></td></tr><tr><td scope="row"><pre>function outerObj()<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>        // The outer object contains an inner object.  Allocate it here.<span></span></pre></td></tr><tr><td scope="row"><pre>        this.inner = new innerObj();<span></span></pre></td></tr><tr><td scope="row"><pre>        this.y = 77;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre>outerObj.prototype.clone = function() {<span></span></pre></td></tr><tr><td scope="row"><pre>    var temp = new outerObj();<span></span></pre></td></tr><tr><td scope="row"><pre>    for (myvar in this) {<span></span></pre></td></tr><tr><td scope="row"><pre>        if (this[myvar].clone) {<span></span></pre></td></tr><tr><td scope="row"><pre>            // This variable contains an object with a<span></span></pre></td></tr><tr><td scope="row"><pre>            // clone operator.  Call it to create a copy.<span></span></pre></td></tr><tr><td scope="row"><pre>            temp[myvar] = this[myvar].clone();<span></span></pre></td></tr><tr><td scope="row"><pre>        } else {<span></span></pre></td></tr><tr><td scope="row"><pre>            // This variable contains a scalar value,<span></span></pre></td></tr><tr><td scope="row"><pre>            // a string value, or an object with no<span></span></pre></td></tr><tr><td scope="row"><pre>            // clone function.  Assign it directly.<span></span></pre></td></tr><tr><td scope="row"><pre>            temp[myvar] = this[myvar];<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return temp;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Allocate an outer object and assign non-default values to variables in<span></span></pre></td></tr><tr><td scope="row"><pre>// both the outer and inner objects.<span></span></pre></td></tr><tr><td scope="row"><pre>outer = new outerObj;<span></span></pre></td></tr><tr><td scope="row"><pre>outer.inner.x = 4;<span></span></pre></td></tr><tr><td scope="row"><pre>outer.y = 16;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Clone the outer object (which, in turn, clones the inner object).<span></span></pre></td></tr><tr><td scope="row"><pre>newouter = outer.clone();<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Verify that both values were copied.<span></span></pre></td></tr><tr><td scope="row"><pre>alert('inner x is '+newouter.inner.x); // prints 4<span></span></pre></td></tr><tr><td scope="row"><pre>alert('y is '+newouter.y); // prints 16<span></span></pre></td></tr></table></div>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../JSIntroduction/JSIntroduction.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../Advanced/Advanced.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-11-19<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/ScriptingAutomation/Conceptual/JSCodingGuide/OOJavaScript/OOJavaScript.html%3Fid%3DTP40006088-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/ScriptingAutomation/Conceptual/JSCodingGuide/OOJavaScript/OOJavaScript.html%3Fid%3DTP40006088-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/ScriptingAutomation/Conceptual/JSCodingGuide/OOJavaScript/OOJavaScript.html%3Fid%3DTP40006088-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
