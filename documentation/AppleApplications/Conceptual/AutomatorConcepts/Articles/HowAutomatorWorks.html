<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Automator Programming Guide: How Automator Works</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="How Automator Works"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001509" title="How Automator Works"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000418" target="_top">Apple Applications</a> &gt; <a href="../../../Automator-date.html#//apple_ref/doc/uid/TP30000440-TP30000418-TP40001673" target="_top">Automator</a> &gt; <a href="../index.html" target="_top">Automator Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="AutomatorOverview.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="AMDesignGuidelines.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/TP40001509-BAJIFDIE" title="How Automator Works"></a><hr /><H1>How Automator Works</H1><p>The following sections describe the development environment, runtime architecture, and class hierarchy for Automator actions.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="HowAutomatorWorks.html#//apple_ref/doc/uid/TP40001509-96846">The Development Components of Automator</a>
				
			<br/>
			
        
			
			
				<a href="HowAutomatorWorks.html#//apple_ref/doc/uid/TP40001509-96872-BAJIJICD">Loadable Bundle Architecture</a>
				
			<br/>
			
        
			
			
				<a href="HowAutomatorWorks.html#//apple_ref/doc/uid/TP40001509-99093">Threading Architecture</a>
				
			<br/>
			
        
			
			
				<a href="HowAutomatorWorks.html#//apple_ref/doc/uid/TP40001509-96904-BAJHEBEC">The Automator Classes</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001509-96846" title="The Development Components of Automator"></a><h2>The Development Components of Automator</h2><p>The Xcode<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_229"></a> development environment integrates a number of technologies to make action programming as efficient as possible:</p><ul class="ul"><li class="li"><p>Xcode project templates<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_230"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_231"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_232"></a>—Apple defines a project type for each of the languages used to implement actions: AppleScript, Objective-C, and shell script. Each project type contains all required files and resources, and supplies placeholder code and default configurations for the action-bundle project.</p></li><li class="li"><p>AppleScript Studio<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_233"></a>—A powerful tool that helps you to create Mac OS X applications that support the Aqua user interface guidelines and that can execute AppleScript scripts.</p></li><li class="li"><p>Interface Builder<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_234"></a>—A tool for creating graphical user interfaces from palettes of standard objects. Automator supplies its own palette<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_235"></a> (Cocoa-Automator) containing pop-up menus for files and folders. The action project template includes a preconfigured nib file.</p></li><li class="li"><p>Cocoa bindings<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_236"></a>—Actions by default are designed to use the Cocoa bindings mechanism to communicate data automatically between an action’s view and its internal parameters; an action’s nib file is configured to support bindings.</p></li><li class="li"><p>Objective-C frameworks<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_237"></a>—Support for Automator actions is implemented in Objective-C. Consequently, the Foundation, Application Kit, and Automator framework<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_238"></a>s—all Objective-C frameworks—are automatically imported into and linked with action projects.</p></li></ul><p>The final product of all these components, when an action is built, is a loadable bundle.</p><a name="//apple_ref/doc/uid/TP40001509-96872" title="Loadable Bundle Architecture"></a><a name="//apple_ref/doc/uid/TP40001509-96872-BAJIJICD" title="Loadable Bundle Architecture"></a><h2>Loadable Bundle Architecture</h2><p>The Automator<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_239"></a> application is based on a loadable bundle<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_240"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_241"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_242"></a> architecture. It loads loadable bundles called actions and executes the code they contain in the sequence determined by the current workflow, piping the flow of data from one action to the next.</p><p>Each action is packaged as a loadable bundle—or in the case of AppleScript-based actions, a potentially loadable bundle. A loadable bundle contains resources of various kinds and usually binary code, but it is not capable of executing that code on its own. The internal structure of a Cocoa bundle is in a form that an NSBundle object “understands.” Using an NSBundle<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_243"></a> object, an application or framework can load the resources and code of a loadable bundle at runtime and integrate them with what it already contains. Loadable bundles are essentially a plug-in architecture.</p><p>When it launches, Automator<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_244"></a> immediately scans the currently installed action bundles and extracts from each bundle’s information property list<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_245"></a> (<code>Info.plist<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_246"></a></code>) the information necessary to display it and prepare it for use (see <span class="content_text">Figure 1</span>). Automator actions (in the form of loadable bundles) are stored in standard file-system locations<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_247"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_248"></a>:</p><ul class="simple"><li><p><code>/System/Library/Automator</code> — Apple-provided actions</p></li><li><p><code>/Library/Automator</code> — third-party actions, general use</p></li><li><p><code>~/Library/Automator</code> — third-party actions, private use</p></li></ul><p>Automator also looks for actions that are stored inside the bundles of any registered applications. See <span class="content_text"><a href="DevelopAction.html#//apple_ref/doc/uid/TP40001511-99146">“Testing, Debugging, and Installing the Action”</a></span> for information on installing actions in the bundles of their related applications.</p><br/><div><a name="//apple_ref/doc/uid/TP40001509-98666-BAJDGFGA" title="Figure 1When launched, Automator gets information about available actions"></a><p><a name="//apple_ref/doc/uid/TP40001509-98666" title="Figure 1When launched, Automator gets information about available actions"></a><strong>Figure 1&nbsp;&nbsp;</strong>When launched, Automator gets information about available actions</p><img src = "Art/bundle_loading_arch1.gif" alt = "When launched, Automator gets information about available actions" width="851" height="482"></div><br/><p>When it launches, Automator also loads any Mach-O code it finds in action bundles—which in this case are Objective-C actions only— resolving external references in the process. If the action is based on Objective-C, an instance of AMBundleAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_249"></a> (or a subclass of that class) is unarchived from the nib. However, if an action is entirely driven by AppleScript or a shell script, Automator instead retains a reference to the bundle since there is no Mach-O code to load. When a user drags such an action into Automator’s workflow area<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_250"></a> for the first time, the application loads the action, unarchiving its nib file, and displays the action's view (see <span class="content_text">Figure 2</span>). </p><br/><div><a name="//apple_ref/doc/uid/TP40001509-98696-BAJFAFGF" title="Figure 2When user drags AppleScript-based action into workflow, Automator loads bundle"></a><p><a name="//apple_ref/doc/uid/TP40001509-98696" title="Figure 2When user drags AppleScript-based action into workflow, Automator loads bundle"></a><strong>Figure 2&nbsp;&nbsp;</strong>When user drags AppleScript-based action into workflow, Automator loads bundle</p><img src = "Art/bundle_loading_arch2.gif" alt = "When user drags AppleScript-based action into workflow, Automator loads bundle" width="844" height="482"></div><br/><div class="notebox"><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_19" title="Note"></a><p><strong>Note:</strong>&nbsp;An action bundle is loaded when the action is first used when Automator launches. Thereafter, the action remains loaded until the user quits Automator.</p></div><p>The architectural details hereafter differ slightly based on whether the workflow is created for the first time or is unarchived.</p><a name="//apple_ref/doc/uid/TP40001509-97230" title="A New Workflow"></a><a name="//apple_ref/doc/uid/TP40001509-97230-BAJHHDGF" title="A New Workflow"></a><h3>A New Workflow</h3><p>When the user creates a new workflow<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_251"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_252"></a> by dragging one or more actions into the workflow layout view, Automator does a couple of things: </p><ul class="spaceabove"><li class="li"><p>If the action is AppleScript-based it creates an instance of AMAppleScriptAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_253"></a> as the owner of the bundle; it also loads the script so AppleScript Studio can perform some initialization. If the action is based on a shell script, Automator creates an instance of AMShellScriptAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_254"></a> instead.</p></li><li class="li"><p>It gets the content view contained in the action’s bundle and displays it within an action view<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_255"></a> in the workflow area, setting the default values of text fields and controls as defined by the action’s <code>AMDefaultParameters<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_256"></a></code> property.</p></li></ul><p>Users modify the parameters<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_257"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_258"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_259"></a> of an action by choosing pop-up items, clicking buttons, entering text into text fields, and so on. When the workflow is ready, they click the run button to execute the workflow. With Automator<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_260"></a> acting as a coordinator, the application and each action perform the following steps in the workflow sequence<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_261"></a>:</p><ul class="spaceabove"><li class="li"><p>Automator invokes the <code>runWithInput:fromAction:error: <a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_262"></a></code> method of the action, passing it the output of the previous action as input. </p><p>The AMAppleScriptAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_263"></a> and AMShellScriptAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_264"></a> classes provide default implementation of this method for script-based actions<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_265"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_266"></a>. The AMAppleScriptAction implementation calls the <code>on run<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_267"></a></code> AppleScript handler.</p></li><li class="li"><p>The settings made in the user interface of the action are propagated as parameters<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_268"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_269"></a> to the action object via Cocoa bindings<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_270"></a>.</p></li><li class="li"><p>The action object<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_271"></a> (in most cases) takes the input and, based on the parameters, transforms it or does whatever its stated role is (such as importing it into an application or displaying output). </p></li><li class="li"><p>As its last step, the action returns the result of its work (its output). If it does not affect the data passed it as input, it simply returns it unchanged.</p></li></ul><p>While each action is busy, Automator displays a spinning progress indicator in the action view. If an error occurs in an action, the action view displays a red “X” and may display an error message. If the action successfully completes, its view displays a green check mark. When the last action has finished its task, the workflow execution is over.</p><a name="//apple_ref/doc/uid/TP40001509-97256" title="An Unarchived Workflow"></a><h3>An Unarchived Workflow</h3><p>When users save a workflow<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_272"></a> or copy one via the pasteboard (clipboard), the workflow and all of its actions are archived. Automator invokes the <code>writeToDictionary:<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_273"></a></code> method of each of the actions in the workflow, passing in a mutable dictionary of the action’s parameters and other information. The action may choose to modify the contents of the dictionary before returning from <code>writeToDictionary:</code>. Then the combined dictionaries of each action of the workflow are encoded and archived. </p><p>When Automator reads a workflow archive<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_274"></a> from disk or the pasteboard, it sends a <code>initWithDefinition:fromArchive:<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_275"></a></code> message to each action in the workflow. In the first parameter of the message is a dictionary from which the action can re-create its state, particularly the last-selected parameters. The second parameter tells the newly created action object whether its definition is coming from an archive.</p><p>Once all actions in the workflows have been reinitialized from the archive, the workflow is ready to use. Users can select parameters in actions and run the workflow. Things continue on at this point as described in <span class="content_text"><a href="HowAutomatorWorks.html#//apple_ref/doc/uid/TP40001509-97230">“A New Workflow.”</a></span></p><a name="//apple_ref/doc/uid/TP40001509-120851" title="Programming Implications of Loadable Bundles"></a><h3>Programming Implications of Loadable Bundles</h3><p>The loadable bundle architecture of Automator has some implications for action programming, especially when the development language is Objective-C. These implications concern bundles, nib file unarchiving, and namespaces.</p><a name="//apple_ref/doc/uid/TP40001509-121177" title="Bundle Access"></a><h4>Bundle Access</h4><p>One issue with bundles arises from a distinction between the main bundle of an application such as Automator and the bundles that are loaded by the application. If you ask for the main bundle in your action’s code—for example:</p><div class="codesample"><table><tr><td scope="row"><pre>NSBundle *theBundle = [NSBundle mainBundle];<span></span></pre></td></tr></table></div><p>you get the main bundle of the Automator application, not the bundle of the action calling <code>mainBundle</code>. For the action bundle, you must send a <code>bundle</code> message to the action object (which is usually <code>self</code> in the code implementing the action):</p><div class="codesample"><table><tr><td scope="row"><pre>NSBundle *theBundle = [self bundle];<span></span></pre></td></tr></table></div><p>The <code>bundle</code> method is declared by the AMBundleAction class, which all action objects inherit from, directly or indirectly (see <span class="content_text"><a href="HowAutomatorWorks.html#//apple_ref/doc/uid/TP40001509-96904">“The Automator Classes”</a></span>). </p><a name="//apple_ref/doc/uid/TP40001509-121191" title="Nib File Unarchiving"></a><h4>Nib File Unarchiving</h4><p>Cocoa programs frequently implement the <code>awakeFromNib</code> method (whose counterpart for AppleScript Studio programs is the <code>awake from nib</code> command handler). The <code>awakeFromNib</code> method is invoked when all objects in a program’s nib file have been unarchived. It gives the program an opportunity to perform any initialization that requires the presence of all unarchived objects. </p><p>However, the <code>awakeFromNib</code> method is invoked in an action when Automator is launched. At this time Automator reads in any binary code of the actions in standard Automator locations and it directly unarchives objects in the nib files that it <em>directly</em> owns. However, these objects don’t include the objects in the nib files of actions. The nib file of an action is not loaded and its objects are not unarchived until users drag the action into a workflow. If you want to perform initializations that require the presence of all objects and connections in an action’s nib file, implement the <code>opened</code> method instead of <code>awakeFromNib</code>. </p><a name="//apple_ref/doc/uid/TP40001509-121572" title="Namespaces"></a><h4>Namespaces</h4><p>An Objective-C class defines a namespace for the methods and instance variables it declares. Because of this, identically named methods and instance variables in other classes do not cause conflicts within a process. However the name of a class itself exists in a namespace occupied by all classes loaded by a process. In addition, all global symbols (such as functions and data types) share the same namespace within a process.</p><p>For Automator, with its loadable bundle (or plug-in) architecture, the potential for namespace collisions—and hence runtime exceptions—is significant. Automator can potentially load hundreds of actions from different sources and, for example, if two action classes have the same name or declare a string constant with the same name, there is the potential for namespace conflict when those actions are loaded by Automator.</p><p>To avoid namespace collisions, it is recommended that you assign prefixes to all classes and global types that are distinctive as possible. For example, if your company’s name is Acme, you might name a class AC_FilterImages.</p><a name="//apple_ref/doc/uid/TP40001509-99093" title="Threading Architecture"></a><h2>Threading Architecture</h2><p><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_276"></a><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_277"></a>To improve runtime stability and give AppleScript-based actions access to resources such as Standard Additions<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_278"></a>, Automator has a threading architecture that puts different types of program activity on separate threads. Automator<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_279"></a> starts a workflow on a secondary thread<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_280"></a> (that is, a thread other than the main thread<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_281"></a>). But as it cycles through the actions of the workflow, it runs each action on a different thread depending on whether the action is based on AppleScript or Objective-C:</p><ul class="ul"><li class="li"><p>If the action is based on AppleScript, it is executed on the main thread. The implementation permits users to cancel the execution of the action on this thread by clicking the stop button or pressing Command-. (period).</p></li><li class="li"><p>If the action is based on Objective-C or a shell script, it is executed on the secondary thread.</p></li></ul><p>This threading architecture imposes restrictions on both writers of AppleScript-based and Objective-C actions. If an AppleScript-based action uses the <code>do shell script<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_282"></a></code> command, the user interface is rendered unresponsive until the script completes; the only way users can cancel execution is to press Command-period. If Objective-C actions are to display windows, they must do so on the main thread using a method such as <code>performSelectorOnMainThread:withObject:waitUntilDone:</code>.</p><a name="//apple_ref/doc/uid/TP40001509-96904" title="The Automator Classes"></a><a name="//apple_ref/doc/uid/TP40001509-96904-BAJHEBEC" title="The Automator Classes"></a><h2>The Automator Classes</h2><p>Automator as a technology includes not only the application and its actions but the Automator framework<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_283"></a> (<code>Automator.framework</code>). The framework implements much of the common behavior of actions and also provides a public interface defined by four classes: AMAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_284"></a>, AMBundleAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_285"></a>, AMAppleScriptAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_286"></a>, and AMShellScriptAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_287"></a>. These classes are hierarchically related (in terms of inheritance) as shown in <span class="content_text">Figure 3</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40001509-97493-BAJFAIFA" title="Figure 3The Automator public classes"></a><p><a name="//apple_ref/doc/uid/TP40001509-97493" title="Figure 3The Automator public classes"></a><strong>Figure 3&nbsp;&nbsp;</strong>The Automator public classes</p><img src = "Art/automator_classes.gif" alt = "The Automator public classes" width="276" height="272"></div><br/><p>AMAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_288"></a> is an abstract class that specifies the interface and attributes essential to all actions. A major attribute of an action (as defined by AMAction) is its definition, a dictionary derived from the action properties specified in the bundle’s information property list. The designated initializer of AMAction includes the action’s definition in its signature: <code>initWithDefinition:fromArchive: <a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_289"></a></code>. The major method in an action’s programmatic interface (as defined by AMAction) is <code>runWithInput:fromAction:error:<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_290"></a></code>, which is briefly described in <span class="content_text"><a href="HowAutomatorWorks.html#//apple_ref/doc/uid/TP40001509-96872">“Loadable Bundle Architecture.”</a></span></p><p>The AMBundleAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_291"></a> class directly inherits from AMAction and provides a concrete implementation of it. AMBundleAction defines the interface and common behavior of actions that are loadable bundles. AMBundleAction objects have three essential properties:</p><ul class="ul"><li class="li"><p>An outlet connection to their associated view</p></li><li class="li"><p>A reference to their bundle</p></li><li class="li"><p>The parameters of the action—that is, the configuration choices users make in the action’s user interface (stored in an NSDictionary object).</p></li></ul><p>Bundled actions are designed to present a view, access the resources of the bundle, and access the parameters for the action. The implementation of the AMBundleAction class makes it possible for actions to be copied, pasted, and encoded for archiving.  Objective-C action objects are always instantiated from custom subclasses of AMBundleAction. </p><p>AMAppleScriptAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_292"></a> and AMShellScriptAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_293"></a> are subclasses of AMBundleAction. They extend loadable action bundles so that AppleScript scripts or shell scripts can drive the action’s logic instead of Objective-C code (although AppleScript, Objective-C, and even shell script code can be mixed in the implementation of an action). The sole outlet of AMAppleScriptAction is an OSAScript<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_294"></a> object representing the script; by default, this outlet is set to an object representing <code>main.applescript</code><a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_295"></a>. </p><p>You can create your own subclasses at the last two levels of the Automator class hierarchy—that is, AMBundleAction on down—to get objects with the characteristics and capabilities that you need. If you want to create loadable action bundles whose behavior is determined by scripting languages other than AppleScript, shell scripts, Perl, or Python, you would subclass AMBundleAction.</p><p>Conceptually, the two fundamental external factors for an action are the input object passed it by the previous action (if any) and the parameters specified by users through the controls and text fields of the action’s view. An instance of AMBundleAction<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_296"></a> accesses the input object in its implementation of <code>runWithInput:fromAction:error:</code> and obtains parameters directly from the user interface through the Cocoa bindings<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_297"></a> mechanism. For an AppleScript-based action (represented by an AMAppleScriptAction instance), the input object and parameters are even more explicit. They occur as the passed-in values in the <code>on run<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_298"></a></code> handler, as shown in <span class="content_text">Figure 4</span>.<a name="//apple_ref/doc/uid/TP40001509-DontLinkElementID_299"></a></p><br/><div><a name="//apple_ref/doc/uid/TP40001509-97775-BAJCIHAB" title="Figure 4A typical action script"></a><p><a name="//apple_ref/doc/uid/TP40001509-97775" title="Figure 4A typical action script"></a><strong>Figure 4&nbsp;&nbsp;</strong>A typical action script</p><img src = "Art/automator_sample_script.gif" alt = "A typical action script" width="694" height="602"></div><br/><p>For information that clarifies aspects of this scripting code, see <span class="content_text"><a href="ImplementScriptAction.html#//apple_ref/doc/uid/TP40001512-CJBJEJBE">“Implementing an AppleScript Action.”</a></span> </p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="AutomatorOverview.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="AMDesignGuidelines.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-12-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/HowAutomatorWorks.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/HowAutomatorWorks.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleApplications/Conceptual/AutomatorConcepts/Articles/HowAutomatorWorks.html%3Fid%3DTP40001450-3.5&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
