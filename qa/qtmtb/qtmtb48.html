<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QTMTB48: What is SetMovieDefaultDataRef?</title><meta name="keywords" content="Mac OS 8 QuickTime Movie toolbox SetMovieDefaultDataRef "><meta name="Description" content="Technical Q&amp;A QTMTB48: Q&amp;A defines the routine SetMovieDefaultDataRefand includes sample code that sets the default data referenceto be a handle in memory."><meta name="categories" content="QuickTime Movie Toolbox"><meta name="week-posted" content="Mar 10, 1997 - Mar 14, 1997"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002018" title="What is SetMovieDefaultDataRef?"></a> <!-- white background --><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxMovieBasics-date.html">Movie Basics</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QTMTB48</div>
<div id="pageheadsub">What is SetMovieDefaultDataRef?</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER>			<!-- -->						<!-- Document Body --><table cellspacing="0" cellpadding="0" border="0" WIDTH="600"><tr><td align="left" scope="row"><font size="+4">Q</font>  I can't find documentation for the <CODE>SetMovieDefaultDataRef</CODE> function. What does it do, and how do I use it?<br><font size="+4">A</font><CODE>SetMovieDefaultDataRef</CODE> is defined in Movies.h as:<BR><CODE>pascal OSErr SetMovieDefaultDataRef(Movie theMovie, Handle dataRef, OSType dataRefType);</CODE>                         <P>It allows you to control where data will be written to when added to a movie. For example, if a movie was loaded from a file, the default data reference isinitialized to be the file from which the movie was loaded. This example willset the default data reference to be a handle in memory:</P><pre>     OSErr ConvertGeneralMIDIToSoundTrack (void)     {          OSErr                              err = noErr;          StandardFileReply                  reply;          short                              refNum;          long                               logicalEOF;          Handle                             dataHandle = nil, tempHandle = nil;          Movie                              theMovie = nil, tempMovie = nil;          // Specify the General MIDI file to import          StandardGetFilePreview (nil, 0, nil, &amp;reply);          if (reply.sfGood)          {               // Open the data fork and suck everything into a handle               err = FSpOpenDF (&amp;reply.sfFile, fsRdPerm, &amp;refNum);               err = GetEOF (refNum, &amp;logicalEOF);               dataHandle = NewHandleClear (logicalEOF);               HLock (dataHandle);               err = FSRead (refNum, &amp;logicalEOF, *dataHandle);               HUnlock (dataHandle);               FSClose (refNum);               // Create a new movie in memory, set its default data reference               // to be a handle               tempMovie = NewMovie (newMovieActive);               tempHandle = NewHandleClear (4);               SetMovieDefaultDataRef (tempMovie, tempHandle,                    HandleDataHandlerSubType);               DisposeHandle (tempHandle);               // Paste the handled data into our movie               err = PasteHandleIntoMovie (dataHandle, 'Midi', tempMovie, 0, nil);               // Save the movie out to a flattened file               StandardPutFile (&quot;\pSave MIDI to:&quot;, &quot;\pMIDI movie&quot;, &amp;reply);               if (reply.sfGood)               {                    theMovie = FlattenMovieData (tempMovie,                         flattenAddMovieToDataFork, &amp;reply.sfFile, 'TVOD',                         smCurrentScript, createMovieFileDeleteCurFile);               }          }          return err;     }</pre><P>This method works fine as long as you have enough memory, and don't want to savethe movie to disk.  To put data into a file, call this function in order to pass in analias to the file as the data reference and <CODE>rAliasType</CODE> as the data reference type:</P><P><CODE>SetMovieDefaultDataRef (tempMovie, fileAlias, rAliasType);</CODE></P><!-- begin_date --><H4 ALIGN=center>[Mar 14 1997]</H4><!-- end_date --></td></tr></table></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qtmtb/qtmtb48.html%3Fid%3DDTS10002018-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qtmtb/qtmtb48.html%3Fid%3DDTS10002018-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qtmtb/qtmtb48.html%3Fid%3DDTS10002018-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>