<!-- legacy work start -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<!-- legacy work end -->


<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)

LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>SPBRecord (IM: S)  (deprecated)</Title>

<!-- legacy work start -->
        <META NAME="Generator" CONTENT="manual">
        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">
        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">
        <META NAME="IndexTitle" CONTENT="Inside Macintosh: Sound (Not Recommended)">
        <meta name="xcode-display" content="render">

        <LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->
        <script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
<!-- legacy work end -->

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<A NAME=HEADING160></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Sound-159.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-161.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Sound-2.html"><B>Sound</B></A> / <BR><DD><A HREF="Sound-137.html"><B>Chapter 3 - Sound Input Manager</B></A> / <A HREF="Sound-146.html"><B>Sound Input Manager Reference</B></A><BR><DL><DD><A HREF="Sound-152.html"><B>Sound Input Manager Routines</B></A> / <A HREF="Sound-159.html"><B>Recording Sounds Directly From Sound Input Devices</B></A></DL></DL></FONT><P>
<HR>

<!-- legacy work start -->
<script type="text/javascript"> placeWatermark()</script>
<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
<i>Inside Macintosh: Sound</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="../../../referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div>
<!-- legacy work end -->


<BLOCKQUOTE>
<A NAME=HEADING160-0></A>
<H3><A NAME=MARKER-11-286></A>SPBRecord<A NAME=MARKER-2-83></A></H3>
 <A NAME=MARKER-2-288></A><A NAME=MARKER-2-202></A>You can use the <CODE>SPBRecord</CODE> function to record audio data into memory, either synchronously or asynchronously.<P>
<PRE>
FUNCTION SPBRecord (inParamPtr: SPBPtr; asynchFlag: Boolean): 
                     OSErr;
</PRE>
<DL>
<DT><CODE>inParamPtr</CODE>
<DD> A pointer to a sound input parameter block.
<DT><CODE>asynchFlag</CODE>
<DD> A Boolean value that specifies whether the recording occurs asynchronously (<CODE>TRUE</CODE>) or synchronously (<CODE>FALSE</CODE>).
</DL>
 You specify values and receive return values in the sound input parameter block.<P>
<B> <CODE>
<TABLE BORDER="0" CELLPADDING=3><TD>--><TD>inRefNum<TD>LongInt<TD>A reference number of a sound input device.<TR>
<TD><--><TD>count<TD>LongInt<TD>The number of bytes of recording.<TR>
<TD><--><TD>milliseconds<TD>LongInt<TD>The number of milliseconds of recording.<TR>
<TD>--><TD>bufferLength<TD>LongInt<TD>The length of the buffer beginning at <CODE>bufferPtr</CODE>.<TR>
<TD>--><TD>bufferPtr<TD>Ptr<TD>A pointer to a buffer for sampled-sound data.<TR>
<TD>--><TD>completionRoutine<TD>ProcPtr<TD>A pointer to a completion routine.<TR>
<TD>--><TD>interruptRoutine<TD>ProcPtr<TD>A pointer to an interrupt routine.<TR>
<TD>--><TD>userLong<TD>LongInt<TD>Free for application's use.<TR>
<TD><--<TD>error<TD>OSErr<TD>The error value returned after recording.<TR>
<TD>--><TD>unused1<TD>LongInt<TD>Reserved.</TABLE>
</CODE></B><P>
<DL>
<H5>Field Description</H5>
<DT><CODE>inRefNum</CODE>
<DD> The device reference number of the sound input device, as obtained from the <CODE>SPBOpenDevice</CODE> function.
<DT><CODE>count</CODE>
<DD> On input, the number of bytes to record. If this field indicates a longer recording time than the <CODE>milliseconds</CODE> field, then the <CODE>milliseconds</CODE> field is ignored. On output, this field indicates the number of bytes actually recorded.
<DT><CODE>milliseconds</CODE>
<DD> On input, the number of milliseconds to record. If this field indicates a longer recording time than the <CODE>count</CODE> field, then the <CODE>count</CODE> field is ignored. On output, this field indicates the number of milliseconds actually recorded.
<DT><CODE>bufferLength</CODE>
<DD> The number of bytes in the buffer specified by the <CODE>bufferPtr</CODE> parameter. If this buffer length is too small to contain the amount of sampled-sound data specified in the <CODE>count</CODE> and <CODE>milliseconds</CODE> fields, then recording time is truncated so that the sampled-sound data fits in the buffer.
<DT><CODE>bufferPtr</CODE>
<DD> A pointer to the buffer for the sampled-sound data, or <CODE>NIL</CODE> if you wish to record sampled-sound data without saving it. On exit, this buffer contains the sampled-sound data, which is interleaved for stereo sound on a sample basis (or on a packet basis if the data is compressed). This buffer contains only sampled-sound data, so if you need a sampled sound header, you should set that up in a buffer before calling <CODE>SPBRecord</CODE> and then record into the buffer following the sound header.
<DT><CODE>completionRoutine</CODE>
<DD> A pointer to a completion routine. This routine is called when the recording terminates (either after you call the <CODE>SPBStopRecording</CODE> function or when the prescribed limit is reached). The completion routine is called only for asynchronous recording.
<DT><CODE>interruptRoutine</CODE>
<DD> A pointer to an interrupt routine. The interrupt routine specified in the <CODE>interruptRoutine</CODE> field is called by asynchronous recording devices when their internal buffers are full.
<DT><CODE>userLong</CODE>
<DD> A long integer that your application can use to pass data to your application's completion or interrupt routines.
<DT><CODE>error</CODE>
<DD> On exit, a value greater than 0 while recording unless an error occurs, in which case it contains a value less than 0 that indicates an operating system error. Your application can poll this field to check on the status of an asynchronous recording. If recording terminates without an error, this field contains 0.
<DT><CODE>unused1</CODE>
<DD> Reserved. You should set this field to 0 before calling <CODE>SPBRecord</CODE>.
</DL>
<A NAME=HEADING160-17></A>
<H5>DESCRIPTION</H5>
 The <CODE>SPBRecord</CODE> function starts recording into memory from a device specified in a sound input parameter block. The sound data recorded is stored in the buffer specified by the <CODE>bufferPtr</CODE> and <CODE>bufferLength</CODE> fields of the parameter block. Recording lasts the longer of the times specified by the <CODE>count</CODE> and <CODE>milliseconds</CODE> fields of the parameter block, or until the buffer is filled. Recording is asynchronous if the <CODE>asynchFlag</CODE> parameter is <CODE>TRUE</CODE> and the specified sound input device supports asynchronous recording.<P>
 If the <CODE>bufferPtr</CODE> field of the parameter block contains <CODE>NIL</CODE>, then the <CODE>count</CODE>, <CODE>milliseconds</CODE>, and <CODE>bufferLength</CODE> fields are ignored, and the recording continues indefinitely until you call the <CODE>SPBStopRecording</CODE> function. In this case, the audio data is not saved anywhere; this feature is useful only if you want to do something in your interrupt routine and do not want to save the audio data. However, if the recording is synchronous and <CODE>bufferPtr</CODE> is <CODE>NIL</CODE>, <CODE>SPBRecord</CODE> returns the result code <CODE>siNoBufferSpecified</CODE>.<P>
 The <CODE>SPBRecord</CODE> function returns the value that the <CODE>error</CODE> field of the parameter block contains when recording finishes.<P>
<A NAME=HEADING160-21></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 You can call the <CODE>SPBRecord</CODE> function at interrupt time.<P>
<A NAME=HEADING160-23></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>SPBRecord</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_SoundDispatch<TD>$03200014</TABLE>
<P>
<A NAME=HEADING160-25></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>siNoSoundInHardware<TD>-220<TD>No sound input hardware available<TR>
<TD>siBadSoundInDevice<TD>-221<TD>Invalid sound input device<TR>
<TD>siNoBufferSpecified<TD>-222<TD>No buffer specified<TR>
<TD>siDeviceBusyErr<TD>-227<TD>Sound input device is busy</TABLE>
</H5>
<A NAME=HEADING160-26></A>
<H5>SEE ALSO</H5>
 For an example of the use of the <CODE>SPBRecord</CODE> function, see <A HREF=Sound-143.html#MARKER-9-75>Listing 3-1</A>.<A NAME=MARKER-2-94></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Sound-159.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Sound-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Sound-336.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Sound-161.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Sound-3.html">&copy; Apple Computer, Inc.</A><br>2 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
