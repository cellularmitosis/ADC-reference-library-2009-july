<html><head><title>Mac OS X
 Manual Page For Test::Harness(3pm)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3pm/Test::Harness" title="Mac OS X
 Manual Page for Test::Harness(3pm)"><a name="//apple_ref/doc/man/3/Test::Harness" title="Mac OS X
 Manual Page for Test::Harness(3pm)"><!-- headerDoc=man; indexgroup=Section 3pm; uid="//apple_ref/doc/man/3pm/Test::Harness"; name=Test::Harness(3pm) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
Test::Harness(3pm)                    Perl Programmers Reference Guide                    Test::Harness(3pm)



<b>NAME</b>
       Test::Harness - Run Perl standard test scripts with statistics

<b>VERSION</b>
       Version 2.56

<b>SYNOPSIS</b>
         use Test::Harness;

         runtests(@test_files);

<b>DESCRIPTION</b>
       <b>STOP!</b> If all you want to do is write a test script, consider using Test::Simple.  Test::Harness is
       the module that reads the output from Test::Simple, Test::More and other modules based on
       Test::Builder.  You don't need to know about Test::Harness to use those modules.

       Test::Harness runs tests and expects output from the test in a certain format.  That format is called
       TAP, the Test Anything Protocol.  It is defined in Test::Harness::TAP.

       "Test::Harness::runtests(@tests)" runs all the testscripts named as arguments and checks standard
       output for the expected strings in TAP format.

       The <u>prove</u> utility is a thin wrapper around Test::Harness.

       <b>Taint</b> <b>mode</b>

       Test::Harness will honor the "-T" or "-t" in the #! line on your test files.  So if you begin a test
       with:

           #!perl -T

       the test will be run with taint mode on.

       <b>Configuration</b> <b>variables.</b>

       These variables can be used to configure the behavior of Test::Harness.  They are exported on
       request.

       $Test::Harness::Verbose
           The package variable $Test::Harness::Verbose is exportable and can be used to let "runtests()"
           display the standard output of the script without altering the behavior otherwise.  The <u>prove</u>
           utility's "-v" flag will set this.

       $Test::Harness::switches
           The package variable $Test::Harness::switches is exportable and can be used to set perl command
           line options used for running the test <!-- a -->script(s)<!-- /a -->. The default value is "-w". It overrides "HAR-<font color="#ffffff" class="whiteout">NESS_SWITCHES".&nbsp;"HARNESS_SWITCHES".</font>
           NESS_SWITCHES".

       $Test::Harness::Timer
           If set to true, and "Time::HiRes" is available, print elapsed seconds after each test file.

       <b>Failure</b>

       When tests fail, analyze the summary report:

         t/base..............ok
         t/nonumbers.........ok
         t/ok................ok
         t/test-harness......ok
         t/waterloo..........dubious
                 Test returned status 3 (wstat 768, 0x300)
         DIED. FAILED tests 1, 3, 5, 7, 9, 11, 13, 15, 17, 19
                 Failed 10/20 tests, 50.00% okay
         Failed Test  Stat Wstat Total Fail  Failed  List of Failed
         -----------------------------------------------------------------------<font color="#ffffff" class="whiteout">t/waterloo.t&nbsp;----------------------------------------------------------------------t/waterloo.t</font>
         t/waterloo.t    3   768    20   10  50.00%  1 3 5 7 9 11 13 15 17 19
         Failed 1/5 test scripts, 80.00% okay. 10/44 subtests failed, 77.27% okay.

       Everything passed but <u>t/waterloo.t</u>.  It failed 10 of 20 tests and exited with non-zero status indi-<font color="#ffffff" class="whiteout">cating&nbsp;indicating</font>
       cating something dubious happened.

       The columns in the summary report mean:

       <b>Failed</b> <b>Test</b>
           The test file which failed.

       <b>Stat</b>
           If the test exited with non-zero, this is its exit status.

       <b>Wstat</b>
           The wait status of the test.

       <b>Total</b>
           Total number of tests expected to run.

       <b>Fail</b>
           Number which failed, either from "not ok" or because they never ran.

       <b>Failed</b>
           Percentage of the total tests which failed.

       <b>List</b> <b>of</b> <b>Failed</b>
           A list of the tests which failed.  Successive failures may be abbreviated (ie. 15-20 to indicate
           that tests 15, 16, 17, 18, 19 and 20 failed).

       <b>Functions</b>

       Test::Harness currently only has one function, here it is.

       <b>runtests</b>
             my $allok = runtests(@test_files);

           This runs all the given <u>@test</u><b>_</b><u>files</u> and divines whether they passed or failed based on their out-<font color="#ffffff" class="whiteout">put&nbsp;output</font>
           put to STDOUT (details above).  It prints out each individual test which failed along with a sum-<font color="#ffffff" class="whiteout">mary&nbsp;summary</font>
           mary report and a how long it all took.

           It returns true if everything was ok.  Otherwise it will "die()" with one of the messages in the
           DIAGNOSTICS section.

<b>EXPORT</b>
       &amp;runtests is exported by Test::Harness by default.

       $verbose, $switches and $debug are exported upon request.

<b>DIAGNOSTICS</b>
       "All tests successful.\nFiles=%d,  Tests=%d, %s"
           If all tests are successful some statistics about the performance are printed.

       "FAILED tests %s\n\tFailed %d/%d tests, %.2f%% okay."
           For any single script that has failing subtests statistics like the above are printed.

       "Test returned status %d (wstat %d)"
           Scripts that return a non-zero exit status, both "$? &gt;&gt; 8" and $? are printed in a message simi-<font color="#ffffff" class="whiteout">lar&nbsp;similar</font>
           lar to the above.

       "Failed 1 test, %.2f%% okay. %s"
       "Failed %d/%d tests, %.2f%% okay. %s"
           If not all tests were successful, the script dies with one of the above messages.

       "FAILED--Further testing stopped: %s"
           If a single subtest decides that further testing will not make sense, the script dies with this
           message.

<b>ENVIRONMENT</b> <b>VARIABLES</b> <b>THAT</b> <b>TEST::HARNESS</b> <b>SETS</b>
       Test::Harness sets these before executing the individual tests.

       "HARNESS_ACTIVE"
           This is set to a true value.  It allows the tests to determine if they are being executed through
           the harness or by any other means.

       "HARNESS_VERSION"
           This is the version of Test::Harness.

<b>ENVIRONMENT</b> <b>VARIABLES</b> <b>THAT</b> <b>AFFECT</b> <b>TEST::HARNESS</b>
       "HARNESS_COLUMNS"
           This value will be used for the width of the terminal. If it is not set then it will default to
           "COLUMNS". If this is not set, it will default to 80. Note that users of Bourne-sh based shells
           will need to "export COLUMNS" for this module to use that variable.

       "HARNESS_COMPILE_TEST"
           When true it will make harness attempt to compile the test using "perlcc" before running it.

           <b>NOTE</b> This currently only works when sitting in the perl source directory!

       "HARNESS_DEBUG"
           If true, Test::Harness will print debugging information about itself as it runs the tests.  This
           is different from "HARNESS_VERBOSE", which prints the output from the test being run.  Setting
           $Test::Harness::Debug will override this, or you can use the "-d" switch in the <u>prove</u> utility.

       "HARNESS_FILELEAK_IN_DIR"
           When set to the name of a directory, harness will check after each test whether new files
           appeared in that directory, and report them as

             LEAKED FILES: scr.tmp 0 my.db

           If relative, directory name is with respect to the current directory at the moment <u>runtests()</u> was
           called.  Putting absolute path into "HARNESS_FILELEAK_IN_DIR" may give more predictable results.

       "HARNESS_IGNORE_EXITCODE"
           Makes harness ignore the exit status of child processes when defined.

       "HARNESS_NOTTY"
           When set to a true value, forces it to behave as though STDOUT were not a console.  You may need
           to set this if you don't want harness to output more frequent progress messages using carriage
           returns.  Some consoles may not handle carriage returns properly (which results in a somewhat
           messy output).

       "HARNESS_PERL"
           Usually your tests will be run by $^X, the currently-executing Perl.  However, you may want to
           have it run by a different executable, such as a threading perl, or a different version.

           If you're using the <u>prove</u> utility, you can use the "--perl" switch.

       "HARNESS_PERL_SWITCHES"
           Its value will be prepended to the switches used to invoke perl on each test.  For example, set-<font color="#ffffff" class="whiteout">ting&nbsp;setting</font>
           ting "HARNESS_PERL_SWITCHES" to "-W" will run all tests with all warnings enabled.

       "HARNESS_VERBOSE"
           If true, Test::Harness will output the verbose results of running its tests.  Setting $Test::Har-<font color="#ffffff" class="whiteout">ness::verbose&nbsp;$Test::Harness::verbose</font>
           ness::verbose will override this, or you can use the "-v" switch in the <u>prove</u> utility.

<b>EXAMPLE</b>
       Here's how Test::Harness tests itself

         $ cd ~/src/devel/Test-Harness
         $ perl -Mblib -e 'use Test::Harness qw(&amp;runtests $verbose);
           $verbose=0; runtests @ARGV;' t/*.t
         Using /home/schwern/src/devel/Test-Harness/blib
         t/base..............ok
         t/nonumbers.........ok
         t/ok................ok
         t/test-harness......ok
         All tests successful.
         Files=4, Tests=24, 2 wallclock secs ( 0.61 cusr + 0.41 csys = 1.02 CPU)

<b>SEE</b> <b>ALSO</b>
       The included <u>prove</u> utility for running test scripts from the command line, Test and Test::Simple for
       writing test scripts, Benchmark for the underlying timing routines, and Devel::Cover for test cover-<font color="#ffffff" class="whiteout">age&nbsp;coverage</font>
       age analysis.

<b>TODO</b>
       Provide a way of running tests quietly (ie. no printing) for automated validation of tests.  This
       will probably take the form of a version of <u>runtests()</u> which rather than printing its output returns
       raw data on the state of the tests.  (Partially done in Test::Harness::Straps)

       Document the format.

       Fix HARNESS_COMPILE_TEST without breaking its core usage.

       Figure a way to report test names in the failure summary.

       Rework the test summary so long test names are not truncated as badly.  (Partially done with new skip
       test styles)

       Add option for coverage analysis.

       Trap STDERR.

       Implement Straps <u>total</u><b>_</b><u>results()</u>

       Remember exit code

       Completely redo the print summary code.

       Implement Straps callbacks.  (experimentally implemented)

       Straps-&gt;<u>analyze</u><b>_</b><u>file()</u> not taint clean, don't know if it can be

       Fix that damned VMS nit.

       HARNESS_TODOFAIL to display TODO failures

       Add a test for verbose.

       Change internal list of test results to a hash.

       Fix stats display when there's an overrun.

       Fix so perls with spaces in the filename work.

       Keeping whittling away at <b>_</b><u>run</u><b>_</b><u>all</u><b>_</b><u>tests()</u>

       Clean up how the summary is printed.  Get rid of those damned formats.

<b>BUGS</b>
       HARNESS_COMPILE_TEST currently assumes it's run from the Perl source directory.

       Please use the CPAN bug ticketing system at &lt;<a href="http://rt.cpan.org/">http://rt.cpan.org/</a>.  You can also mail bugs, fixes and
       enhancements to "&lt;bug-test-harness" at "rt.cpan.org&gt;".

<b>AUTHORS</b>
       Either Tim Bunce or Andreas Koenig, we don't know. What we know for sure is, that it was inspired by
       Larry Wall's TEST script that came with perl distributions for ages. Numerous anonymous contributors
       exist.  Andreas Koenig held the torch for many years, and then Michael G Schwern.

       Current maintainer is Andy Lester "&lt;andy at petdance.com&gt;".

<b>COPYRIGHT</b>
       Copyright 2002-2005 by Michael G Schwern "&lt;schwern at pobox.com&gt;", Andy Lester "&lt;andy at pet-
       dance.com&gt;".

       This program is free software; you can redistribute it and/or modify it under the same terms as Perl
       itself.

       See &lt;<a href="http://www.perl.com/perl/misc/Artistic.html">http://www.perl.com/perl/misc/Artistic.html</a>.



perl v5.8.8                                      2001-09-21                               Test::Harness(3pm)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/Test__Harness.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/Test__Harness.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/Test__Harness.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
