<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>I/O Kit Device Driver Design Guidelines: Testing and Deploying Drivers</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Testing and Deploying Drivers"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000702" title="Testing and Deploying Drivers"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../HardwareDrivers/index.html#//apple_ref/doc/uid/TP30000440-TP40003576" target="_top">Hardware &amp; Drivers</a> &gt; <a href="../Introduction/Intro.html#//apple_ref/doc/uid/TP40002799-TPXREF101">I/O Kit Device Driver Design Guidelines</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../DebuggingDrivers/DebuggingDrivers.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../UBDeviceDriver/UBDeviceDriver.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000702-BCIEEHFG" title="Testing and Deploying Drivers"></a><h1>Testing and Deploying Drivers</h1><p>You’ve created your driver and thoroughly debugged it. Now you’re ready to test it and prepare it for installation on your customers’s computers. This chapter outlines testing strategies and describes how to use the Mac OS X Package Maker application to create an installable package.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="DeployingDrivers.html#//apple_ref/doc/uid/TP30000702-TPXREF101">Testing Strategies</a>
				
			<br/>
			
        
			
			
				<a href="DeployingDrivers.html#//apple_ref/doc/uid/TP30000702-TPXREF106">Packaging Drivers for Installation</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP30000702-TPXREF101" title="Testing Strategies"></a><h2>Testing Strategies</h2><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_313"></a>Now that you’ve debugged your driver and you know it’s working perfectly, you should test it on as many differently configured computers and as many different operating system releases as you plan to support (or expect your customers to have).</p><a name="//apple_ref/doc/uid/TP30000702-TPXREF102" title="Basic Quality Control"></a><h3>Basic Quality Control</h3><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_314"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_315"></a>The first step in testing your driver is to perform a basic quality-control pass. Ideally, many of these checks should be part of your day-to-day development methodology:</p><ul class="spaceabove"><li class="li"><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_316"></a>Are the permissions and ownership of the kernel extension correct? For security reasons, no component of a KEXT should be writable by any user other than the superuser. What this entails is that:</p><ul class="nested"><li class="nested li"><p>All files and folders in the KEXT, including the KEXT itself, must be owned by the root user (UID 0).</p></li><li class="nested li"><p>All files and folders in the KEXT, including the KEXT itself, must be owned by the wheel group (GID 0).</p></li><li class="nested li"><p>All folders in the KEXT<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_317"></a>, including the KEXT itself, must have permissions 0755 (octal) or <code>rwxr-xr-x</code> (as shown by <code>ls -l</code>).</p></li><li class="nested li"><p>All files in the KEXT must have permissions 0644 (octal) or <code>rw-r--r--</code> (as shown by <code>ls -l</code>). A KEXT is not the place to store a user-space executable. </p></li></ul><p>In your post-build and post-install scripts, you can set the correct ownership and permissions of kernel extensions using these shell script commands:</p><div class="codesample"><table><tr><td scope="row"><pre>/usr/sbin/chown -R root:wheel MyDriver.kext<span></span></pre></td></tr><tr><td scope="row"><pre>find MyDriver.kext -type d -exec /bin/chmod 0755 {} \;<span></span></pre></td></tr><tr><td scope="row"><pre>find MyDriver.kext -type f -exec /bin/chmod 0644 {} \;<span></span></pre></td></tr></table></div><p>You can also copy the driver as root to a temporary location to give the kernel extension the proper ownership and permissions.<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_318"></a></p></li><li class="li"><p>Have you tested the driver for memory leaks? Does it unload properly?</p><ul class="nested"><li class="nested li"><p>Load the driver and then try to unload it (using <code>kextunload</code>); if it does not successfully unload, then the driver has live objects that have not been released. You’ll need to track down the mismatched retain and release.</p></li><li class="nested li"><p>Load the driver and periodically run the <code>ioclasscount<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_319"></a></code> and <code>ioalloccount</code> tools on it. If you see growth in the count of instances or in a type of allocated memory, then your driver is leaking memory.</p></li><li class="nested li"><p>Make a list of every class your driver directly defines and every class your driver directly manipulates (such as OSString). Create a command-line script that calls <code>ioclasscount</code> on all these classes (you don’t have to call <code>ioclasscount</code> for each class, you can list all the classes on one line), set your system on a short sleep-wake cycle, and run the script every time your system sleeps and wakes. If you detect a leak (an increase in the count for a class), unload and reload your driver and perform the test again to make sure it’s your driver that’s leaking. In this way, you can find leaks that might otherwise take thousands of normal sleep-wake cycles to detect.</p></li></ul></li><li class="li"><p>Have you recently performed validation checks using <code>kextload -nt</code>? (See <span class="content_text"><a href="../DebuggingDrivers/DebuggingDrivers.html#//apple_ref/doc/uid/TP30000701-BBCFBJJI">“Debugging Drivers”</a></span> for details.) These checks may reveal undeclared dependencies and other errors.</p></li><li class="li"><p>Have you correctly set or incremented the version number for the kernel extension<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_320"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_321"></a>? This is especially important if you want an improved version of your driver to be selected during the matching process.</p></li></ul><p>When you are ready to deploy the driver, build<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_322"></a> it using the Development build style (in Project Builder) to get the full range of debugging symbols. Save a copy of the driver in case you or another developer might ever need a symboled version of it. Then, to get the final product, strip the symbols from the driver using the <code>strip<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_323"></a></code> tool. Note that you use the Development build style instead of the Deployment build style for the final build of the driver. The Deployment style introduces additional optimizations that do little to enhance driver performance and yet make it harder to match up symbols in the stripped and non-stripped versions of the binary.<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_324"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_325"></a></p><a name="//apple_ref/doc/uid/TP30000702-TPXREF103" title="Configuration Testing"></a><h3>Configuration Testing</h3><p>Configuration testing<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_326"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_327"></a> aims to test the operation of your driver within a range of factors that stress-test its performance under various conditions, possibly revealing a latent bug. These factors include the following:</p><ul class="spaceabove"><li class="li"><p><strong>Multiprocessor systems</strong>. With multiprocessor systems becoming more and more common, it is important to test your driver on such systems. Your driver code could be running on any processor at any moment. Consequently, testing your driver on a multiprocessor system—where preemption and rescheduling occur simultaneously on each processor—might reveal a race condition or a locking bug.</p></li><li class="li"><p><strong>Memory configurations</strong>. You should test your driver on systems ranging from those with 128 megabyte installed (the current minimum) up to those with 1 gigabyte or more installed (typical, for example, in video-production systems).</p></li><li class="li"><p><strong>Computer models</strong>. You should test your drivers on a wide variety of Power PC computers: G3 and G4, desktop and portable.</p></li><li class="li"><p><strong>Other hardware</strong>. You should also test your driver with varied and even extreme assortments of hardware attached. For example, if you’re testing a driver for a USB device, you might test it with a dozen or so other USB devices attached. </p></li><li class="li"><p><strong>Mac OS X releases</strong>. Obviously, you should also test your driver on a range of Mac OS X versions that are currently in use.</p></li></ul><a name="//apple_ref/doc/uid/TP30000702-TPXREF104" title="Power-Management Testing"></a><h3>Power-Management Testing</h3><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_328"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_329"></a>Many drivers implement some form of power management, responding to or initiating requests to sleep, power down, or power up. You should ensure this capability is thoroughly tested. One way to test power management is power cycling. Put a system with your driver installed on it asleep, then wake it up. Repeat this sequence many times (the more the better) to see if a bug in your power-management code surfaces.</p><p>If your driver is for a device that is “hot-swappable” (FireWire, USB, and PC Card), test the code in your driver that is responsible for handling device connection and (especially) device removal. You want to ensure that the driver stack is gracefully torn down when a device is disconnected. As with power-management testing, disconnect and reconnect the device many times to see if the sheer repetition of the event reveals a bug.<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_330"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_331"></a></p><a name="//apple_ref/doc/uid/TP30000702-TPXREF105" title="Other Testing Strategies and Goals"></a><h3>Other Testing Strategies and Goals</h3><p>Here are a few more suggestions to help you test your driver:</p><ul class="spaceabove"><li class="li"><p>If your driver controls a Human Interface (HI) device or accepts input of any kind (such as an audio driver), be sure to exercise all possible types of input, including fringe cases. For example, for a keyboard driver you might want to test various combinations involving the Command, Control, Option, Escape, Function, and other keys. For audio drivers (that control audio input), you might want to test how the driver performs across a range of sound frequencies. </p></li><li class="li"><p>Isolate and exercise layers of your driver. With a mass storage driver, for example, test how the driver performs at the file-system level with blocks of data that are above and below virtual-memory page size (4 kilobytes). Issue random sized read and write commands, and see how the driver behaves when a file-system check (<code>fsck</code>) is conducted.</p></li><li class="li"><p>Last, but definitely not least, always consider<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_332"></a> your driver from the viewpoint of security. If your driver relies upon a user-space daemon that is <code>setuid</code>, make sure that the executable isn’t world-writable. Verify that the installation process does not present opportunities for security infringements and, generally, that there is no way for a non-administrative user to gain control of the device.</p></li></ul><p>If possible, you can let your Apple developer technical support contact know you’re about to ship a driver. If you supply Apple with the <code>CFBundleIdentifier</code> and version that uniquely identifies your driver, Apple will know who to contact if a problem report appears that seems to point to your driver.<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_333"></a></p><a name="//apple_ref/doc/uid/TP30000702-TPXREF106" title="Packaging Drivers for Installation"></a><h2>Packaging Drivers for Installation</h2><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_334"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_335"></a>Before you send your driver out the door, you should package it so it’s easy for your customers to install. Mac OS X provides the Package Maker application (available in <code>/Developer/Applications</code> and a command-line version available in <code>/Developer/Applications/PackageMaker.app/Contents/MacOS/PackageMaker</code>) to create your package. The Package Maker application guides you through the creation of a package and creates the required files from information you enter in its editing windows, making the process almost automatic. The command-line tool requires you to supply the necessary files you’ve created yourself. For more detailed information on how to use Package Maker to create a package, see the Package Maker Help menu. For more information on using the command-line version, type <code>./PackageMaker -help</code> from the <code>/Developer/Applications/PackageMaker.app/Contents/MacOS</code> directory.</p><p>The following sections provide an overview of the components of a Package Maker package, describe what comprises a valid package, and outline how your package gets installed. If you use another package-making tool to create your package, make sure the resulting package contains all the required elements discussed in these sections.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_21" title="Note"></a><p><strong>Note:</strong>&nbsp;This chapter describes the Package Maker application available in Mac OS X version 10.2 and above. To create packages that can also be installed on earlier versions of Mac OS X, you should use an earlier version of Package Maker.</p></div><a name="//apple_ref/doc/uid/TP30000702-TPXREF107" title="Package Contents"></a><h3>Package Contents</h3><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_336"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_337"></a>A Package Maker package is an <code>Info.plist</code>-based NSBundle object that contains the information the Installer requires to install software on a Mac OS X system. Package contents are separated into required global resources and optional localizable resources. <span class="content_text"><a href="DeployingDrivers.html#//apple_ref/doc/uid/TP30000702-CIHBBJFE">Listing 8-1</a></span> shows the format of a package named MyPackage.</p><a name="//apple_ref/doc/uid/TP30000702-CIHBBJFE" title="Listing 8-1PackageMaker format for MyPackage"></a><p class="codesample"><strong>Listing 8-1&nbsp;&nbsp;</strong>PackageMaker format for MyPackage</p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_338"></a><div class="codesample"><table><tr><td scope="row"><pre>MyPackage.pkg<span></span></pre></td></tr><tr><td scope="row"><pre>    Contents<span></span></pre></td></tr><tr><td scope="row"><pre>        Info.plist<span></span></pre></td></tr><tr><td scope="row"><pre>        Archive.pax.gz<span></span></pre></td></tr><tr><td scope="row"><pre>        Archive.bom<span></span></pre></td></tr><tr><td scope="row"><pre>        Resources<span></span></pre></td></tr><tr><td scope="row"><pre>            /* Optional, localizable package-description information */<span></span></pre></td></tr><tr><td scope="row"><pre>            Description.plist<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            /* Optional, localizable documents */<span></span></pre></td></tr><tr><td scope="row"><pre>            License document<span></span></pre></td></tr><tr><td scope="row"><pre>            ReadMe document<span></span></pre></td></tr><tr><td scope="row"><pre>            Welcome document<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            /* Optional scripts */<span></span></pre></td></tr><tr><td scope="row"><pre>            preinstall script<span></span></pre></td></tr><tr><td scope="row"><pre>            postinstall script<span></span></pre></td></tr><tr><td scope="row"><pre>            preupgrade script<span></span></pre></td></tr><tr><td scope="row"><pre>            postupgrade script<span></span></pre></td></tr><tr><td scope="row"><pre>            preflight script<span></span></pre></td></tr><tr><td scope="row"><pre>            postflight script<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            /* Optional check tools */<span></span></pre></td></tr><tr><td scope="row"><pre>            InstallationCheck tool<span></span></pre></td></tr><tr><td scope="row"><pre>            VolumeCheck tool<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            /* Optional, localizable background image */<span></span></pre></td></tr><tr><td scope="row"><pre>            background<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            /* Optional language project folders. If present, these */<span></span></pre></td></tr><tr><td scope="row"><pre>            /* folders contain localized versions of Description.plist, */<span></span></pre></td></tr><tr><td scope="row"><pre>            /* License, ReadMe, Welcome, and background files. */<span></span></pre></td></tr><tr><td scope="row"><pre>            English.lproj<span></span></pre></td></tr><tr><td scope="row"><pre>            Japanese.lproj<span></span></pre></td></tr></table></div><p>Package Maker creates the package’s <code>Info.plist</code> file using the information you enter in the Info window. Information such as the default installation location and level of user authorization required allow you to customize the installation of your package’s contents.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_22" title="Note"></a><p><strong>Note:</strong>&nbsp;If your files must be installed in a non-user location, such as <code>/System/Library/Extensions</code> for KEXTs, you must create your package with admin or root authorization.</p></div><p>The <code>Archive.bom</code> and <code>Archive.pax.gz</code> files are required files Package Maker creates for you using information you enter in the Files window. The <code>Archive.bom</code> file is a bill-of-materials file that describes the contents of the package to the Installer. The <code>Archive.pax.gz</code> file is a compressed archive containing the contents of a package. (In earlier versions of Package Maker, these filenames incorporated the package name, as in <code>MyPackage.bom</code> and <code>MyPackage.pax.gz</code>.)</p><p>The Resources folder contains documents, scripts, and tools you provide for the Installer to use during installation. With the exception of the <code>Description.plist</code> file (which contains the information you enter in the Description window), Package Maker does not create these files for you. You have complete control over the contents of these files, but you do have to follow Package Maker’s naming conventions, or the Installer will not find and execute them.</p><p>You must name your localizable documents <code>License</code><em>.extension</em>, <code>ReadMe</code><em>.extension</em>, and <code>Welcome</code><em>.extension</em> where <em>extension</em> is <code>html</code>, <code>rtf</code>, <code>rtfd</code>, <code>txt</code>, or no extension at all. In Mac OS X version 10.2, you can customize the background image the Installer displays when it opens the package. You must name your background picture file <code>background.</code><em>extension</em>, where <em>extension</em> is <code>jpg</code>, <code>tif</code>, <code>tiff</code>, <code>gif</code>, <code>pict</code>, <code>eps</code>, or <code>pdf</code>. </p><p>The optional scripts must also follow Package Maker’s naming conventions. You can perform a wide range of tasks in these scripts but you should take care not to overburden them or the installation speed will suffer. For example, you could create folders in a preflight script, but it would be better to set up the necessary folders in the archive. As a general rule, you should try to create your package so that it provides everything your software needs, using the scripts sparingly to perform dynamic tasks during the install process. If you do include scripts to run during installation, be sure to make them executable.</p><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_339"></a>If you need to examine a computer’s configuration prior to installation to determine, for example, if there is sufficient memory to run the Installer, or if some other software is present, you can provide an InstallationCheck tool. The Installer runs this tool (if it is present) when it first opens a package. As with the optional scripts, you must follow Package Maker’s naming convention and you must make the tool executable. In addition, the InstallationCheck tool must return an integer error code. The error code is used as a bitfield that encodes information about the installation status that the Installer can interpret. The Installer uses some of the bits as an index into files of error messages, either predefined by the Installer or custom. If you choose to define your own set of error messages, you create a localizable <code>InstallationCheck.strings</code> file and place it in your localized <code>.lproj</code> folder.</p><p>The Installer generally gives the user a choice of volumes on which to install your package. If you need to disable one or more volume choices, you can provide a VolumeCheck tool (you must name the tool VolumeCheck and make it executable). The Installer runs this tool (if it is present) before it displays the Target Select window. Like InstallationCheck, VolumeCheck returns an integer result code that is treated as a bitfield. The Installer uses some bits to identify several properties about the status of VolumeCheck and others as an index into either a predefined or a custom error message file named <code>VolumeCheck.strings</code>.</p><p>A metapackage is simply a package of prebuilt packages. If, for example, you offer a suite of drivers, you can create a metapackage to contain them all and allow your customers to install the ones they choose. To create a metapackage, select New Meta Package from Package Maker’s File menu.</p><p>A metapackage has the same components as a single package, with the addition of a list of subpackages (each of which must be a valid package). For specific differences in the <code>Info.plist</code> keys, see Package Maker’s Package Format Notes.<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_340"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_341"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_342"></a></p><a name="//apple_ref/doc/uid/TP30000702-BCIBHHCB" title="Package Validation and Installation"></a><h3>Package Validation and Installation</h3><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_343"></a>Package Maker provides a validation tool you can run on your package to flag potential problems (to run it, select Validate Package in the Tools menu). You can run the tool on packages built with any version of Package Maker. The tool checks for the presence of required files and that the scripts are executable. A valid package must contain</p><ul class="spaceabove"><li class="li"><p>a <em>.bom</em> file</p></li><li class="li"><p>a <code>.pax.gz</code> file unless the package is a receipt or has the Alternate Source Location key or the Proxy Package Location key set (these keys are defined in Package Maker’s Package Format Notes)</p></li><li class="li"><p>an <code>Info.plist</code> file (for packages built with the newest version of Package Maker) or <code>.info</code> file (for packages built with older versions of Package Maker)</p></li><li class="li"><p>a <code>.sizes</code> file, if the package is built with an older version of Package Maker</p></li><li class="li"><p>executable scripts and tools, if scripts and tools are present</p></li></ul><p>A<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_344"></a> valid metapackage must contain</p><ul class="spaceabove"><li class="li"><p>a <code>.list</code> file, if the metapackage is built with an older version of Package Maker </p></li><li class="li"><p>a package list array in its <code>Info.plist</code> file, if the metapackage is built with the newer version of Package Maker</p></li><li class="li"><p>the subpackages listed in the package list array, if the metapackage is built with the newer version of Package Maker<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_345"></a></p></li></ul><p><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_346"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_347"></a>When the Installer installs a single package, it performs the following steps:</p><ol class="ol"><li class="li"><p>Run the InstallationCheck script (if present).</p></li><li class="li"><p>Display the Welcome screen.</p></li><li class="li"><p>Display the ReadMe screen.</p></li><li class="li"><p>Display the License screen.</p></li><li class="li"><p>Run the VolumeCheck script (if present) for each available volume.</p></li><li class="li"><p>Display the volume selection screen.</p></li><li class="li"><p>Wait for the user to select the target volume and click Install.</p></li><li class="li"><p>Run the preflight script, if present.</p></li><li class="li"><p>Run the preinstall script (or preupgrade script, if this is an upgrade), if present.</p></li><li class="li"><p>Copy the files to the target drive (if this is an upgrade, some files may be copied to an intermediate directory first).</p></li><li class="li"><p>Run the postinstall script (or postupgrade script, if this is an upgrade), if present.</p></li><li class="li"><p>If this is an upgrade, copy the files in the intermediate directory to their final destination.</p></li><li class="li"><p>Copy the receipt to the target drive’s Receipts folder.</p></li><li class="li"><p>Run the postflight script, if present.</p></li><li class="li"><p>Reboot or quit, depending on the package’s flags.</p></li></ol><p>The<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_348"></a> Installer performs a similar set of steps when installing a metapackage<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_349"></a>:</p><ol class="ol"><li class="li"><p>Run the InstallationCheck script, if present.</p></li><li class="li"><p>Display the Welcome screen.</p></li><li class="li"><p>Display the ReadMe screen.</p></li><li class="li"><p>Display the License screen.</p></li><li class="li"><p>Run the VolumeCheck script (if present) for each available volume.</p></li><li class="li"><p>Display the volume selection screen.</p></li><li class="li"><p>Wait for the user to select the target volume and click Install.</p></li><li class="li"><p>Perform the following steps for each subpackage</p><ol class="ol"><li class="ol ol"><p>Run preflight script, if present.</p></li><li class="ol ol"><p>Run the preinstall script (or preupgrade script, if this is an upgrade), if present.</p></li><li class="ol ol"><p>Copy the files to the target drive (if this is an upgrade, some files may be copied to an intermediate directory first).</p></li><li class="ol ol"><p>Run the postinstall script (or postupgrade script, if this is an upgrade), if present.</p></li><li class="ol ol"><p>If this is an upgrade, copy the files in the intermediate directory to their final destination.</p></li><li class="ol ol"><p>Run the postflight script, if present.</p></li></ol></li><li class="li"><p>Reboot or quit, depending on the metapackage’s flags.</p></li></ol><p>If you’ve used another tool to create your package, you should examine the installed files carefully to make sure everything is where you want it to be.<a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_350"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_351"></a><a name="//apple_ref/doc/uid/TP30000702-DontLinkElementID_352"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../DebuggingDrivers/DebuggingDrivers.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../UBDeviceDriver/UBDeviceDriver.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2002, 2007 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2007-03-06<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeviceDrivers/Conceptual/WritingDeviceDriver/DeployingDrivers/DeployingDrivers.html%3Fid%3DTP30000694-2.13&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeviceDrivers/Conceptual/WritingDeviceDriver/DeployingDrivers/DeployingDrivers.html%3Fid%3DTP30000694-2.13&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeviceDrivers/Conceptual/WritingDeviceDriver/DeployingDrivers/DeployingDrivers.html%3Fid%3DTP30000694-2.13&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>