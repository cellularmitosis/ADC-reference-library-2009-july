<html><head><title>Mac OS X
 Manual Page For register_config_handler(3)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3/register_config_handler" title="Mac OS X
 Manual Page for register_config_handler(3)"><!-- headerDoc=man; indexgroup=Section 3; uid="//apple_ref/doc/man/3/register_config_handler"; name=register_config_handler(3) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
READ_CONFIG(3)                                    Net-SNMP                                    <!-- a -->READ_CONFIG(3)<!-- /a -->



<b>NAME</b>
       register_config_handler,  register_premib_handler  unregister_config_handler,  register_mib_handlers,
       read_configs, read_premib_configs, config_perror, config_pwarn - read_config functions

<b>SYNOPSIS</b>
       <b>#include</b> <b>&lt;net-snmp/config_api.h&gt;</b>

       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_config_handler(const</b> <b>char</b> <b>*</b><u>filePrefix</u><b>,</b>
                            <b>const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_premib_handler(const</b> <b>char</b> <b>*</b><u>filePrefix</u><b>,</b>
                            <b>const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>void</b> <b>unregister_config_handler(const</b> <b>char</b> <b>*</b><u>filePrefix</u><b>,</b>
                            <b>const</b> <b>char</b> <b>*</b><u>token</u><b>);</b>

       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_app_config_handler(const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>struct</b> <b>config_line</b> <b>*</b>
         <b>register_app_premib_handler(const</b> <b>char</b> <b>*</b><u>token</u><b>,</b>
                            <b>void</b> <b>(*</b><u>parser</u><b>)(const</b> <b>char</b> <b>*,</b> <b>char</b> <b>*),</b>
                            <b>void</b> <b>(*</b><u>releaser</u><b>)(void),</b>
                            <b>const</b> <b>char</b> <b>*</b><u>usageLine</u><b>);</b>

       <b>void</b> <b>unregister_app_config_handler(const</b> <b>char</b> <b>*</b><u>token</u><b>);</b>

       <b>void</b> <b>read_config_print_usage(char</b> <b>*</b><u>lead</u><b>);</b>

       <b>void</b> <b>read_configs(void);</b>

       <b>void</b> <b>read_premib_configs(void);</b>

       <b>void</b> <b>config_pwarn(const</b> <b>char</b> <b>*</b><u>string</u><b>);</b>
       <b>void</b> <b>config_perror(const</b> <b>char</b> <b>*</b><u>string</u><b>);</b>


<b>DESCRIPTION</b>
       The functions are a fairly extensible system of parsing various configuration files at the  run  time
       of an application.  The configuration file flow is broken into the following phases:

           1.  Registration of handlers.

           2.  Reading of the configuration files for pre-MIB parsing requirements.

           3.  Reading and parsing of the textual MIB files.

           4.  Reading of the configuration files for configuration directives.

           5.  Optionally re-reading the configuration files at a future date.

       The idea is that the calling application is able to register <u>handlers</u> for certain <u>tokens</u> specified in
       certain types of <u>files.</u>  The <b>read_configs()</b> function can then be called to look  for  all  the  files
       that it has registrations for, find the first word on each line, and pass the remainder to the appro-<font color="#ffffff" class="whiteout">priately&nbsp;appropriately</font>
       priately registered handler.

<b>TOKEN</b> <b>HANDLERS</b>
       Handler functions should have the following signature:

              <b>void</b> <b>handler(const</b> <b>char</b> <b>*</b><u>token</u><b>,</b> <b>char</b> <b>*</b><u>line</u><b>);</b>

       The function will be called with two arguments, the first being the token that triggered the call  to
       this  function  (which would be one of the tokens that the function had been registered for), and the
       second being the remainder of the configuration file line beyond the white space following the token.

<b>RESOURCE</b> <b>FREEING</b> <b>HANDLERS</b>
       If  the parameter <u>releaser</u> passed to <b>register_config_handler</b> is non-NULL, then the function specified
       is called if and when the configuration files are re-read.  This function should free  any  resources
       allocated  by  the  token  handler function and reset its notion of the configuration to its default.
       The token handler function will then be called again.  No arguments are passed to the resource  free-<font color="#ffffff" class="whiteout">ing&nbsp;freeing</font>
       ing handler.

<b>REGISTERING</b> <b>A</b> <b>HANDLER</b>
       <b>register_config_handler()</b>
              The  <b>handler()</b>  function  above could be registered for the configuration file <u>snmp.conf,</u> with
              the token <u>genericToken</u> and the help string (discussed later) <u>"ARG1</u> <u>[ARG2]"</u> using the following
              call to the <b>register_config_handler()</b> function:

                     register_config_handler("snmp", "genericToken", handler, NULL, "ARG1 [ARG2]");

              This  would  register  the  <b>handler()</b> function so that it will get called every time the first
              word of a line in the <u>snmp.conf</u> configuration <!-- a -->file(s)<!-- /a --> matches  "genericToken"  (see  <b>read_con</b>-<font color="#ffffff" class="whiteout">figs()&nbsp;read_configs()</font>
              <b>figs()</b> below).

       <b>register_premib_handler()</b>
              The  <b>register_premib_handler()</b>  function  works  identically  to the <b>register_config_handler()</b>
              function but is intended for config file tokens that need to be read  in  before  the  textual
              MIBs  are  read  in,  probably  because  they will be used to configure the MIB parser.  It is
              rarely the case that anything but the SNMP library itself should need to use this function.

       <b>unregister_config_handler()</b>
              Removes the registered configuration handler for the <u>filePrefix</u> and <u>token</u>.


       <b>register_app_config_handler()</b>

       <b>register_app_premib_handler()</b>

       <b>unregister_app_config_handler()</b>
              These functions are  analagous  to  <b>register_config_handler()</b>,  <b>register_premib_handler()</b>  and
              <b>unregister_config_handler()</b>  but  don't  require the file type argument (which is filled in by
              the application).  It is intended that MIB modules written for the agent use  these  functions
              to allow the agent to have more control over which configuration files are read (typically the
              <u>snmpd.conf</u> files).

<b>HELP</b> <b>STRINGS</b>
       The <u>usageLine</u> parameter passed to <b>register_config_handler()</b> and similar calls,  is  used  to  display
       help information when the <b>read_config_print_usage()</b> function is called.  This function is used by all
       of the applications when the <b>-H</b> flag is passed on the command line.  It prints a summary  of  all  of
       the  configuration  file  lines, and the associated files, that the configuration system understands.
       The <u>usageLine</u> parameter should be a list of arguments expected after the token,  and  not  a  lengthy
       description  (which should go into a manual page instead).  The <u>lead</u> prefix will be prepended to each
       line that the function prints to stderr, where it displays its output.

       The <b>init_snmp()</b> function should be called before the <b>read_config_print_usage()</b> function is called, so
       that  the  library  can  register  its  configuration  file  directives  as  well  for  the <b>read_con</b>-<font color="#ffffff" class="whiteout">fig_print_usage()&nbsp;read_config_print_usage()</font>
       <b>fig_print_usage()</b> function to display.

<b>READING</b> <b>CONFIGURATION</b> <b>FILES</b>
       <b>init_snmp()</b>
              Once the relevant configuration token parsers have  been  registered,  <b>init_snmp()</b>  should  be
              called.   It  will  parse  the  configuration file tokens registered with <b>register_premib_han</b>-<font color="#ffffff" class="whiteout">dler(),&nbsp;register_premib_handler(),</font>
              <b>dler(),</b> read in the textual MIB files using <b>init_mib(),</b> and finally  parse  the  configuration
              file tokens registered with <b>register_config_handler()</b>.

       If  the <b>init_snmp()</b> function is used, none of the following functions need to be called by the appli-<font color="#ffffff" class="whiteout">cation:&nbsp;application:</font>
       cation:

       <b>register_mib_handlers()</b>
              The SNMP library's routine to register its configuration file handlers.

       <b>read_premib_configs()</b>
              The routine that parses the configuration files for tokens registered to be dealt with  before
              the textual MIBs are read in.  See <b>read_configs()</b> below.

       <b>read_configs()</b>
              Reads all the configuration files it can find in the <u>SNMPCONFPATH</u> environment variable (or its
              default value) for tokens and appropriately calls the handlers registered to it, or  prints  a
              "Unknown token" warning message.  It looks for any file that it has previously received a reg-<font color="#ffffff" class="whiteout">istration&nbsp;registration</font>
              istration request for.

<b>CONFIGURATION</b> <b>FILES</b> <b>READ</b>
       The configuration files read are found by using the colon separated <u>SNMPCONFPATH</u> environment variable
       (or   its  default  value,  which  will  be  /etc/snmp,  followed  by  /usr/share/snmp,  followed  by
       /usr/lib/snmp, followed by $HOME/.snmp) and reading in the files found that  match  both  the  prefix
       registered and the two suffixes <u>.conf</u> and <u>.local.conf.</u>  The idea behind the two different suffixes is
       that the first file can be shared (via rdist or an NFS mount) across a large number of  machines  and
       the second file can be used to configure local settings for one particular machine.  They do not need
       to be present, and will only be read if found.

<b>ERROR</b> <b>HANDLING</b> <b>FUNCTIONS</b>
       The two functions <b>config_pwarn()</b> and <b>config_perror()</b> both take an error string  as  an  argument  and
       print  it  to stderr along with the file and line number that caused the error.  A call to the second
       function will also force <b>read_configs()</b> to eventually return with an error code  indicating  to  it's
       calling function that it should abort the operation of the application.

<b>ENVIRONMENT</b> <b>VARIABLES</b>
       SNMPCONFPATH
                 A  colon  separated  list  of  directories  to search for configuration files in.  Default:
                 /etc/snmp:/usr/share/snmp:/usr/lib/snmp:$HOME/.snmp

<b>SEE</b> <b>ALSO</b>
       <a href="mib_api.3.html#//apple_ref/doc/man/3/mib_api"><b>mib_api</b>(3)</a>, <a href="snmp_api.3.html#//apple_ref/doc/man/3/snmp_api"><b>snmp_api</b>(3)</a>



4.2 Berkeley Distribution                        07 Mar 2002                                  <!-- a -->READ_CONFIG(3)<!-- /a -->
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/register_config_handler.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/register_config_handler.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/register_config_handler.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
