<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>Skinny3DSample - /Skinny3DSources &Alpha;/BoxModel.c</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxGraphicsImaging-date.html">Graphics & Imaging</a> &gt; <A HREF="javascript:location.replace('index.html');">Skinny3DSample</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/GraphicsImaging/index.html" target="_blank">Reference Library > Graphics & Imaging</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">Skinny3DSample</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/Skinny3DSources &Alpha;/BoxModel.c</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/Skinny3DSources ƒ/3DAppSpecific.c</option>
<option value="listing2.html">/Skinny3DSources ƒ/3DAppSpecific.h</option>
<option value="listing3.html">/Skinny3DSources ƒ/BoxModel.c</option>
<option value="listing4.html">/Skinny3DSources ƒ/BoxModel.h</option>
<option value="listing5.html">/Skinny3DSources ƒ/Cameras.c</option>
<option value="listing6.html">/Skinny3DSources ƒ/Cameras.h</option>
<option value="listing7.html">/Skinny3DSources ƒ/Lights.c</option>
<option value="listing8.html">/Skinny3DSources ƒ/Lights.h</option>
<option value="listing9.html">/Skinny3DSources ƒ/SkinnyMain.c</option>
<option value="listing10.html">/Skinny3DSources ƒ/SkinnyMain.h</option>
<option value="listing11.html">/ValueControls ƒ/ValueControls.c</option>
<option value="listing12.html">/ValueControls ƒ/ValueControls.h</option></select>
				</p>
				</form>
				<p><strong><a href="Skinny3DSample.zip">Download Sample</a></strong> (&#147;Skinny3DSample.zip&#148;, 64.7K)<BR>
<strong><a href="Skinny3DSample.dmg">Download Sample</a></strong> (&#147;Skinny3DSample.dmg&#148;, 127.8K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">// File BoxModel.c#include &lt;Memory.h&gt;#include &lt;OSUtils.h&gt;#include   &quot;BoxModel.h&quot;/*   contains the following:TQ3GroupObject   MakeBox(void);void      DisposeBoxModel(TQ3GroupObject model);VccPtr       BoxDataToVCC(TQ3Object theObj);void      VCCtoBoxData(VccPtr vcc, TQ3BoxData *boxData);*/static void  InitBoxData(TQ3BoxData *boxData);static void MakeFaceAttributes(TQ3BoxData *boxData);static void SetBoxResetValues(TQ3BoxData *boxData, VccPtr vcc);extern  Rect  gContrlRect;//----------------------------------------------------------------------------------static void  InitBoxData(TQ3BoxData *boxData){  float  height  =   6;  float  width   =   6;  float  depth  =  6;      Q3Point3D_Set(&amp;boxData-&gt;origin, -width/2, -height/2, -depth/2);  Q3Vector3D_Set(&amp;boxData-&gt;orientation, 0, height, 0);  Q3Vector3D_Set(&amp;boxData-&gt;majorAxis,  width, 0, 0);  Q3Vector3D_Set(&amp;boxData-&gt;minorAxis,  0, 0, depth);  boxData-&gt;boxAttributeSet  = NULL;  boxData-&gt;faceAttributeSet = NULL;}//----------------------------------------------------------------------------------static void MakeFaceAttributes(TQ3BoxData *boxData){  TQ3Status    status;  TQ3ColorRGB    faceColor;  TQ3ColorRGB    specColor;  TQ3ColorRGB    transColor;  float  ambientCoeff;  float  specularCntl;  long  i;  boxData-&gt;faceAttributeSet = (TQ3AttributeSet *)NewPtrClear(sizeof(TQ3AttributeSet) * 6);  if (boxData-&gt;faceAttributeSet == NULL)    return;  for (i = 0; i &lt; 6; i++)    boxData-&gt;faceAttributeSet[i] = NULL;    faceColor.r = 0.0;  faceColor.g = 1.0;  faceColor.b = 0.0;    specColor.r = 0.0;  specColor.g = 0.0;  specColor.b = 1.0;    transColor.r = 0.0;  transColor.g = 1.0;  transColor.b = 0.0;    ambientCoeff = 0.5;  specularCntl = 0.5;    for (i = 0; i &lt; 6; i++) {    boxData-&gt;faceAttributeSet[i] = Q3AttributeSet_New();    if (boxData-&gt;faceAttributeSet[i] != nil) {       status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],                kQ3AttributeTypeDiffuseColor, &amp;faceColor);       status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],               kQ3AttributeTypeSpecularColor, &amp;specColor);       status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],               kQ3AttributeTypeSpecularColor, &amp;transColor);       status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],               kQ3AttributeTypeAmbientCoefficient, &amp;ambientCoeff);       status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],               kQ3AttributeTypeSpecularControl, &amp;specularCntl);    }  }}//----------------------------------------------------------------------------------TQ3GroupObject MakeBox(void){  TQ3GroupObject    model;  TQ3GeometryObject   box;  TQ3GroupPosition    position;  TQ3BoxData      boxData;  TQ3Status      status;  long        i;    InitBoxData(&amp;boxData);  MakeFaceAttributes(&amp;boxData);    box    = Q3Box_New(&amp;boxData);        if (box == nil)    return nil;  model    = Q3OrderedDisplayGroup_New();   if (model == nil)  return nil;  position = Q3Group_AddObject(model, box);  if (position == nil) return nil;    if (boxData.boxAttributeSet != nil)    Q3Object_Dispose(boxData.boxAttributeSet);      if (boxData.faceAttributeSet != nil) {    for (i = 0; i &lt; 6; i++)       if (boxData.faceAttributeSet[i] != nil)        Q3Object_Dispose(boxData.faceAttributeSet[i]);    DisposePtr((Ptr)boxData.faceAttributeSet);  }  Q3Object_Dispose(box);  return model;}  //----------------------------------------------------------------------------------void DisposeBoxModel(TQ3GroupObject model){  Q3Group_EmptyObjects(model);  Q3Object_Dispose(model);}//----------------------------------------------------------------------------------VccPtr BoxDataToVCC(TQ3Object theObj){  TQ3BoxData      boxData;  TQ3AttributeSet  attrSet;  TQ3Status      status;  VccPtr       vcc;  TQ3ColorRGB    faceColor;  TQ3ColorRGB    specColor;  TQ3ColorRGB    transColor;  float      ambientCoeff;  float      specularCntl;  long      i;        status = Q3Box_GetData( theObj, &amp;boxData );  if (status == kQ3Failure)    return;    vcc = NewVCluster((long)kQ3GeometryTypeBox, &quot;\pBoxData&quot;, 30, &amp;gContrlRect);  if (vcc == nil) {    SysBeep(10); // ErrMsg(&quot;\pNewVCluster failed&quot;);    return nil;  }    AddValueCtl(vcc, &quot;\porigin.x&quot;, boxData.origin.x, -20.0, 20.0, 1.0); // [0]  AddValueCtl(vcc, &quot;\porigin.y&quot;, boxData.origin.y, -20.0, 20.0, 1.0);  AddValueCtl(vcc, &quot;\porigin.z&quot;, boxData.origin.z, -20.0, 20.0, 1.0);  AddSeparator(vcc);  AddValueCtl(vcc, &quot;\porientation.x&quot;, boxData.orientation.x, 0.0, 10.0, 0.5); // [4]  AddValueCtl(vcc, &quot;\porientation.y&quot;, boxData.orientation.y, 0.0, 10.0, 0.5);  AddValueCtl(vcc, &quot;\porientation.z&quot;, boxData.orientation.z, 0.0, 10.0, 0.5);  AddSeparator(vcc);  AddValueCtl(vcc, &quot;\pmajorAxis.x&quot;, boxData.majorAxis.x, 0.0, 10.0, 0.5); // [8]  AddValueCtl(vcc, &quot;\pmajorAxis.y&quot;, boxData.majorAxis.y, 0.0, 10.0, 0.5);  AddValueCtl(vcc, &quot;\pmajorAxis.z&quot;, boxData.majorAxis.z, 0.0, 10.0, 0.5);  AddSeparator(vcc);  AddValueCtl(vcc, &quot;\pminorAxis.x&quot;, boxData.minorAxis.x, 0.0, 10.0, 0.5); // [12]  AddValueCtl(vcc, &quot;\pminorAxis.y&quot;, boxData.minorAxis.y, 0.0, 10.0, 0.5);  AddValueCtl(vcc, &quot;\pminorAxis.z&quot;, boxData.minorAxis.z, 0.0, 10.0, 0.5);  AddSeparator(vcc);    attrSet = boxData.faceAttributeSet[0];  status = Q3AttributeSet_Get(attrSet, kQ3AttributeTypeDiffuseColor, &amp;faceColor);  status = Q3AttributeSet_Get(attrSet, kQ3AttributeTypeSpecularColor, &amp;specColor);  status = Q3AttributeSet_Get(attrSet, kQ3AttributeTypeSpecularColor, &amp;transColor);  status = Q3AttributeSet_Get(attrSet, kQ3AttributeTypeAmbientCoefficient, &amp;ambientCoeff);  status = Q3AttributeSet_Get(attrSet, kQ3AttributeTypeSpecularControl, &amp;specularCntl);    AddValueCtl(vcc, &quot;\pfaceColor.r&quot;, faceColor.r, 0.0, 1.0, 0.1); // [16]  AddValueCtl(vcc, &quot;\pfaceColor.g&quot;, faceColor.g, 0.0, 1.0, 0.1);  AddValueCtl(vcc, &quot;\pfaceColor.b&quot;, faceColor.b, 0.0, 1.0, 0.1);  AddSeparator(vcc);  AddValueCtl(vcc, &quot;\pspecColor.r&quot;, specColor.r, 0.0, 1.0, 0.1); // [20]  AddValueCtl(vcc, &quot;\pspecColor.g&quot;, specColor.g, 0.0, 1.0, 0.1);  AddValueCtl(vcc, &quot;\pspecColor.b&quot;, specColor.b, 0.0, 1.0, 0.1);  AddSeparator(vcc);  AddValueCtl(vcc, &quot;\ptransColor.r&quot;, transColor.r, 0.0, 1.0, 0.1); // [24]  AddValueCtl(vcc, &quot;\ptransColor.g&quot;, transColor.g, 0.0, 1.0, 0.1);  AddValueCtl(vcc, &quot;\ptransColor.b&quot;, transColor.b, 0.0, 1.0, 0.1);  AddSeparator(vcc);  AddValueCtl(vcc, &quot;\pambientCoefficient&quot;, ambientCoeff, 0.0, 1.0, 0.1); // [28]  AddValueCtl(vcc, &quot;\pspecularControl&quot;, specularCntl, 0.0, 25.0, 2.5);//  ErBoxData_Empty(&amp;boxData); // releases memory allocated in Q3Box_GetData//  Q3Box_EmptyData(&amp;boxData); // releases memory allocated in Q3Box_GetData// ** not in my shared library yet  if (boxData.faceAttributeSet != NULL)    for (i = 0; i &lt; 6; i++)      if (boxData.faceAttributeSet[i] != NULL)  InitBoxData(&amp;boxData); // to bring in the original reset values (not for attributes)  SetBoxResetValues(&amp;boxData, vcc);    return vcc;}//----------------------------------------------------------------------------------void  VCCtoBoxData(VccPtr vcc, TQ3BoxData *boxData){  TQ3Status    status;  TQ3ColorRGB    faceColor;  TQ3ColorRGB    specColor;  TQ3ColorRGB    transColor;  float      ambientCoeff;  float      specularCntl;  long      i;    boxData-&gt;origin.x     = GetCurrentValue(vcc, 0);  boxData-&gt;origin.y     = GetCurrentValue(vcc, 1);  boxData-&gt;origin.z     = GetCurrentValue(vcc, 2);  boxData-&gt;orientation.x   = GetCurrentValue(vcc, 4);  boxData-&gt;orientation.y   = GetCurrentValue(vcc, 5);  boxData-&gt;orientation.z   = GetCurrentValue(vcc, 6);  boxData-&gt;majorAxis.x   = GetCurrentValue(vcc, 8);  boxData-&gt;majorAxis.y  = GetCurrentValue(vcc, 9);  boxData-&gt;majorAxis.z   = GetCurrentValue(vcc, 10);  boxData-&gt;minorAxis.x   = GetCurrentValue(vcc, 12);  boxData-&gt;minorAxis.y   = GetCurrentValue(vcc, 13);  boxData-&gt;minorAxis.z   = GetCurrentValue(vcc, 14);  // separator  faceColor.r       =  GetCurrentValue(vcc, 16);  faceColor.g       =  GetCurrentValue(vcc, 17);  faceColor.b       =  GetCurrentValue(vcc, 18);    specColor.r       =  GetCurrentValue(vcc, 20);  specColor.g       =  GetCurrentValue(vcc, 21);  specColor.b       =  GetCurrentValue(vcc, 22);    transColor.r       =  GetCurrentValue(vcc, 24);  transColor.g       =  GetCurrentValue(vcc, 25);  transColor.b       =  GetCurrentValue(vcc, 26);    ambientCoeff      =  GetCurrentValue(vcc, 28);  specularCntl       =  GetCurrentValue(vcc, 29);  for (i = 0; i &lt; 6; i++) {    Q3AttributeSet_Empty(boxData-&gt;faceAttributeSet[i]);     status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],             kQ3AttributeTypeDiffuseColor, &amp;faceColor);     status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],             kQ3AttributeTypeSpecularColor, &amp;specColor);     status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],             kQ3AttributeTypeSpecularColor, &amp;transColor);     status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],             kQ3AttributeTypeAmbientCoefficient, &amp;ambientCoeff);     status = Q3AttributeSet_Add(boxData-&gt;faceAttributeSet[i],             kQ3AttributeTypeSpecularControl, &amp;specularCntl);  }}//----------------------------------------------------------------------------------void  SetBoxResetValues(TQ3BoxData *boxData, VccPtr vcc){  SetResetValue(vcc,  0, boxData-&gt;origin.x);  SetResetValue(vcc,  1, boxData-&gt;origin.y);  SetResetValue(vcc,  2, boxData-&gt;origin.z);  SetResetValue(vcc,  4, boxData-&gt;orientation.x);  SetResetValue(vcc,  5, boxData-&gt;orientation.y);  SetResetValue(vcc,  6, boxData-&gt;orientation.z);  SetResetValue(vcc,  8, boxData-&gt;majorAxis.x);  SetResetValue(vcc,  9, boxData-&gt;majorAxis.y);  SetResetValue(vcc, 10, boxData-&gt;majorAxis.z);  SetResetValue(vcc, 12, boxData-&gt;minorAxis.x);  SetResetValue(vcc, 13, boxData-&gt;minorAxis.y);  SetResetValue(vcc, 14, boxData-&gt;minorAxis.z);}</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/Skinny3DSample/listing3.html%3Fid%3DDTS10000104-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/Skinny3DSample/listing3.html%3Fid%3DDTS10000104-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/Skinny3DSample/listing3.html%3Fid%3DDTS10000104-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>