<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Creating Lights</TITLE></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><H1 CLASS="H2.Heading2"><A NAME="pgfId=3885"> </A>Creating Lights</H1><P CLASS="T1.Text1"><A NAME="pgfId=3887"> </A><A NAME="marker=3886"> </A>When you use any renderer more powerful than the wireframe renderer, you'll want to create and configure a set of lights to provide illumination for the object in the model. As you've seen, QuickDraw&nbsp;3D provides a number of types of lights, each of which can emit light of various colors and intensities. The function <TT CLASS="cv">MyNewLights</TT> defined in <A HREF="qd3dintroduction.d.htm#28431" CLASS="XRef">Listing&nbsp;6</A> creates a group of lights. It creates an ambient light, a point light, and a directional light. See the chapter <A HREF="qd3dlights.htm#19303" CLASS="XRef">&quot;Light Objects&quot;</A> for more details on creating lights.</P><P CLASS="L.Listing"><A NAME="pgfId=3898"> </A>Listing&nbsp;6<A NAME="28431"> </A>Creating a group of lights</P><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11043"> </A>TQ3GroupObject MyNewLights (void)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3GroupPosition&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myGroupPosition;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3GroupObject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myLightList;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3LightData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myLightData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3PointLightData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myPointLightData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3DirectionalLightData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myDirLightData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3LightObject&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myAmbientLight, myPointLight, myFillLight;<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3Point3D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pointLocation = { -10.0, 0.0, 10.0 };<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3Vector3D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fillDirection = { 10.0, 0.0, 10.0 };<BR>&nbsp;&nbsp;&nbsp;&nbsp;TQ3ColorRGB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WhiteLight = { 1.0, 1.0, 1.0 };<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11049"> </A>&nbsp;&nbsp;&nbsp;&nbsp;/*Set up light data for ambient light.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;myLightData.isOn = kQ3True;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myLightData.brightness = .2;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myLightData.color = WhiteLight;<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11055"> </A>&nbsp;&nbsp;&nbsp;&nbsp;/*Create ambient light.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;myAmbientLight = Q3AmbientLight_New(&amp;myLightData);<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (myAmbientLight == NULL)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11061"> </A>&nbsp;&nbsp;&nbsp;&nbsp;/*Create a point light.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;myLightData.brightness = 1.0;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPointLightData.lightData = myLightData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPointLightData.castsShadows = kQ3False;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPointLightData.attenuation = kQ3AttenuationTypeLinear;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPointLightData.location = pointLocation;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myPointLight = Q3PointLight_New(&amp;myPointLightData);<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (myPointLight == NULL)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11067"> </A>&nbsp;&nbsp;&nbsp;&nbsp;/*Create a directional light for fill.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;myLightData.brightness = .2;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myDirLightData.lightData = myLightData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myDirLightData.castsShadows = kQ3False;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myDirLightData.direction = fillDirection;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myFillLight = Q3DirectionalLight_New(&amp;myDirLightData);<BR></CODE><CODE CLASS="CvF.CodeFull"><A NAME="pgfId=11073"> </A>&nbsp;&nbsp;&nbsp;&nbsp;if (myFillLight == NULL)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;/*Create light group and add each of the lights to the group.*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;myLightList = Q3LightGroup_New();<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (myLightList == NULL)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myGroupPosition = Q3Group_AddObject(myLightList, myAmbientLight);<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3Object_Dispose(myAmbientLight);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*balance the reference count*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (myGroupPosition == 0)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myGroupPosition = Q3Group_AddObject(myLightList, myPointLight);<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3Object_Dispose(myPointLight);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*balance the reference count*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (myGroupPosition == 0)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR>&nbsp;&nbsp;&nbsp;&nbsp;myGroupPosition = Q3Group_AddObject(myLightList, myFillLight);<BR>&nbsp;&nbsp;&nbsp;&nbsp;Q3Object_Dispose(myFillLight);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*balance the reference count*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;if (myGroupPosition == 0)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto bail;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;return (myLightList);<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>bail:<BR>&nbsp;&nbsp;&nbsp;&nbsp;/*If any of the above failed, then return nothing!*/<BR>&nbsp;&nbsp;&nbsp;&nbsp;return (NULL);<BR>}<BR></CODE><P CLASS="T1.Text1"><A NAME="pgfId=5778"> </A><A NAME="marker=11075"> </A>The <TT CLASS="cv">MyNewLights</TT> function is straightforward. It fills out the fields of the relevant data structures (<TT CLASS="cv">TQ3LightData</TT>, <TT CLASS="cv">TQ3PointLightData</TT>, and <TT CLASS="cv">TQ3DirectionalLightData</TT>) and calls the appropriate functions to create new light objects using the information in those structures. If successful, it adds those light objects to a group of lights. The group of lights will be added to a view, as shown in the following section.</P><P CLASS="Note"><A NAME="pgfId=5788"> </A>The <TT CLASS="cv">MyNewLights</TT> function can leak memory. <A NAME="marker=5779"> </A></P><hr>&#169; 1997 Apple Computer, Inc.</DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>