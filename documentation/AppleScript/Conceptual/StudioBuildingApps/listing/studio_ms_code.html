<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Studio Programming Guide: Mail Search Tutorial, Full Script Listing</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Mail Search Tutorial, Full Script Listing"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001261" title="Mail Search Tutorial, Full Script Listing"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../chapter01/studio_intro_book.html#//apple_ref/doc/uid/20001248-TPXREF101">AppleScript Studio Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../requirements/scriptStudio_requirements.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../glossary/studio_glossary.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/20001261-TPXREF101" title="Mail Search Tutorial, Full Script Listing"></a><h1>Mail Search Tutorial, Full Script Listing</h1><p>The listings in this appendix provide the full source code for the Mail Search tutorial, from the script file <code>Mail Search.applescript</code>, which you can also obtain as part of the Mail Search sample application.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001261-DontLinkElementID_121" title="Important:"></a><p><strong>Important:</strong>&nbsp;The scripting terminology for the Mail application changed with Mac OS X version 10.2, so there are some differences between the Mail Search script file distributed with AppleScript Studio 1.2. and the listings shown in this chapter. The Mail Search application distributed with AppleScript Studio 1.2 will work with the newer version of Mail.</p><p></p></div><p>After installing AppleScript Studio, the sample applications are located in <code>/Developer/Examples/AppleScript Studio</code>.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001261-DontLinkElementID_122" title="Note"></a><p><strong>Note:</strong>&nbsp; In AppleScript Studio 1.0, the Mail Search sample application was known as “Watson”.</p></div><a name="//apple_ref/doc/uid/20001261-BAJDJHGF" title="Listing B-1Mail Search&acirc;&#128;&#153;s global variables and event handlers"></a><p class="codesample"><strong>Listing B-1&nbsp;&nbsp;</strong>Mail Search’s global variables and event handlers</p><div class="codesample"><table><tr><td scope="row"><pre>(* Mail Search.applescript *)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>(* ==== Globals ==== *)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>global controllers<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>(* ==== Properties ==== *)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>property windowCount : 0<span></span></pre></td></tr><tr><td scope="row"><pre>property statusPanelNibLoaded : false<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>(* ==== Event Handlers ==== *)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(window of theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to find()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end clicked<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on double clicked theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(window of theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to openMessages()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end double clicked<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on action theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(window of theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to find()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end action<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on became main theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to loadMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end became main<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on will open theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to makeController(theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        addController(theController)<span></span></pre></td></tr><tr><td scope="row"><pre>        tell theController to initialize()<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end will open<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on will close theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    removeController(theObject)<span></span></pre></td></tr><tr><td scope="row"><pre>end will close<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on will finish launching theObject<span></span></pre></td></tr><tr><td scope="row"><pre>    set controllers to {}<span></span></pre></td></tr><tr><td scope="row"><pre>end will finish launching<span></span></pre></td></tr></table></div>	<a name="//apple_ref/doc/uid/20001261-TPXREF148" title="Listing B-2The controller script definition"></a><p class="codesample"><strong>Listing B-2&nbsp;&nbsp;</strong>The controller script definition</p><div class="codesample"><table><tr><td scope="row"><pre>(* ==== Controller Handlers ==== *)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on makeController(forWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>    script<span></span></pre></td></tr><tr><td scope="row"><pre>        property theWindow : forWindow<span></span></pre></td></tr><tr><td scope="row"><pre>        property theStatusPanel : null<span></span></pre></td></tr><tr><td scope="row"><pre>        property foundMessages : {}<span></span></pre></td></tr><tr><td scope="row"><pre>        property mailboxesLoaded : false<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        -- Handlers<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on initialize()<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add a column to the mailboxes data source<span></span></pre></td></tr><tr><td scope="row"><pre>            tell scroll view "mailboxes" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>                make new data column at the end of the data columns of data source¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of outline view "mailboxes" with properties {name:"mailboxes"}<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add the columns to the messages data source<span></span></pre></td></tr><tr><td scope="row"><pre>            tell scroll view "messages" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>                make new data column at the end of the data columns of data source¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of table view "messages" with properties {name:"from"}<span></span></pre></td></tr><tr><td scope="row"><pre>                make new data column at the end of the data columns of data source¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of table view "messages" with properties {name:"subject"}<span></span></pre></td></tr><tr><td scope="row"><pre>                make new data column at the end of the data columns of data source¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of table view "messages" with properties {name:"mailbox"}<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            set windowCount to windowCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>        end initialize<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on loadMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre>            if not mailboxesLoaded then<span></span></pre></td></tr><tr><td scope="row"><pre>                -- Open the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                set theStatusPanel to makeStatusPanel(theWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>                tell theStatusPanel to openPanel("Looking for Mailboxes...")<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                -- Add the mailboxes<span></span></pre></td></tr><tr><td scope="row"><pre>                addMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                -- Close the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                tell theStatusPanel to closePanel()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                set mailboxesLoaded to true<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>        end loadMailboxes<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on find()<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Get what and where to find<span></span></pre></td></tr><tr><td scope="row"><pre>            set whatToFind to contents of text field "what" of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>            set whereToFind to title of current menu item of popup button "where"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Make sure that we have something to find<span></span></pre></td></tr><tr><td scope="row"><pre>            if (count of whatToFind) is greater than 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                -- Clear any previously found messages<span></span></pre></td></tr><tr><td scope="row"><pre>                clearMessages()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                -- Setup a status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                set theStatusPanel to makeStatusPanel(theWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>                tell theStatusPanel to openPanel("Determining the number¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of messages...")<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                try<span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Determine the mailboxes to search<span></span></pre></td></tr><tr><td scope="row"><pre>                    set mailboxesToSearch to selectedMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Determine the total number of messages to search<span></span></pre></td></tr><tr><td scope="row"><pre>                    set totalCount of theStatusPanel¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        to countMessages(mailboxesToSearch)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Adjust the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell theStatusPanel to adjustPanel()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Find the messages<span></span></pre></td></tr><tr><td scope="row"><pre>                    set foundMessages to findMessages(mailboxesToSearch,¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        whereToFind, whatToFind)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Change the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell theStatusPanel to changePanel("Adding found messages...")<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Add the found messages to the result table<span></span></pre></td></tr><tr><td scope="row"><pre>                    addMessages(foundMessages)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    -- Close the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell theStatusPanel to closePanel()<span></span></pre></td></tr><tr><td scope="row"><pre>                on error errorText<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell theStatusPanel to closePanel()<span></span></pre></td></tr><tr><td scope="row"><pre>                    display alert "AppleScript Error" as critical attached¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        to theWindow message errorText<span></span></pre></td></tr><tr><td scope="row"><pre>                end try<span></span></pre></td></tr><tr><td scope="row"><pre>            else<span></span></pre></td></tr><tr><td scope="row"><pre>                display alert "Missing Value" as critical attached¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    to theWindow message "You need to enter a value to search for."<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>        end find<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on addMailbox(accountItem, accountName, mailboxIndex, mailboxName)<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add a new item<span></span></pre></td></tr><tr><td scope="row"><pre>            set mailboxItem to make new data item at the end of the data items¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of accountItem<span></span></pre></td></tr><tr><td scope="row"><pre>            set name of data cell 1 of mailboxItem to "mailboxes"<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of data cell 1 of mailboxItem to mailboxName<span></span></pre></td></tr><tr><td scope="row"><pre>            set associated object of mailboxItem to mailboxIndex<span></span></pre></td></tr><tr><td scope="row"><pre>        end addMailbox<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on addAccount(a, accountIndex, accountName)<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add a new item<span></span></pre></td></tr><tr><td scope="row"><pre>            set accountItem to make new data item at the end of the data items¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of data source of outline view "mailboxes"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of scroll view "mailboxes" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>            set name of data cell 1 of accountItem to "mailboxes"<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of data cell 1 of accountItem to accountName<span></span></pre></td></tr><tr><td scope="row"><pre>            set associated object of accountItem to accountIndex<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add the mail boxes<span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                set mailboxIndex to 0<span></span></pre></td></tr><tr><td scope="row"><pre>                repeat with m in (get mailboxes of a)<span></span></pre></td></tr><tr><td scope="row"><pre>                    try<span></span></pre></td></tr><tr><td scope="row"><pre>                        set mailboxIndex to mailboxIndex + 1<span></span></pre></td></tr><tr><td scope="row"><pre>                        my addMailbox(accountItem, accountName, mailboxIndex,¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            mailbox name of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                    end try<span></span></pre></td></tr><tr><td scope="row"><pre>                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre>        end addAccount<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on addMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                set accountIndex to 0<span></span></pre></td></tr><tr><td scope="row"><pre>                repeat with a in (get accounts)<span></span></pre></td></tr><tr><td scope="row"><pre>                    try<span></span></pre></td></tr><tr><td scope="row"><pre>                        set accountIndex to accountIndex + 1<span></span></pre></td></tr><tr><td scope="row"><pre>                        my addAccount(a, accountIndex, account name of a)<span></span></pre></td></tr><tr><td scope="row"><pre>                    end try<span></span></pre></td></tr><tr><td scope="row"><pre>                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre>        end addMailboxes<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on mailboxesForIndex(mailboxIndex)<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Initialize the result<span></span></pre></td></tr><tr><td scope="row"><pre>            set theMailboxes to {}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            set theIndex to 0<span></span></pre></td></tr><tr><td scope="row"><pre>            set theAccountIndex to 0<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Determine if the selected item is an account or a mailbox<span></span></pre></td></tr><tr><td scope="row"><pre>            tell outline view "mailboxes" of scroll view "mailboxes"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>                set theItem to item for row mailboxIndex<span></span></pre></td></tr><tr><td scope="row"><pre>                set theName to contents of data cell 1 of theItem<span></span></pre></td></tr><tr><td scope="row"><pre>                set theIndex to associated object of theItem<span></span></pre></td></tr><tr><td scope="row"><pre>                if has parent data item of theItem then<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theAccountIndex to the associated object¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        of the parent data item of theItem<span></span></pre></td></tr><tr><td scope="row"><pre>                end if<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                if theAccountIndex > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theMailboxes to {mailbox theIndex of account theAccountIndex}<span></span></pre></td></tr><tr><td scope="row"><pre>                else<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theMailboxes to theMailboxes &amp; every mailbox¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        of account theIndex<span></span></pre></td></tr><tr><td scope="row"><pre>                end if<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Return the result<span></span></pre></td></tr><tr><td scope="row"><pre>            return theMailboxes<span></span></pre></td></tr><tr><td scope="row"><pre>        end mailboxesForIndex<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on selectedMailboxes()<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Initialize the result<span></span></pre></td></tr><tr><td scope="row"><pre>            set mailboxesSelected to {}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Get the currently selected mailboxes in the outline view<span></span></pre></td></tr><tr><td scope="row"><pre>            set mailboxIndicies to selected rows of outline view "mailboxes"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of scroll view "mailboxes" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Get the actual mailboxes from Mail<span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                if (count of mailboxIndicies) is equal to 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                    repeat with a in (get accounts)<span></span></pre></td></tr><tr><td scope="row"><pre>                        set mailboxesSelected to mailboxesSelected &amp;¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            every mailbox of a<span></span></pre></td></tr><tr><td scope="row"><pre>                    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                else<span></span></pre></td></tr><tr><td scope="row"><pre>                    repeat with i in mailboxIndicies<span></span></pre></td></tr><tr><td scope="row"><pre>                        set mailboxesSelected to mailboxesSelected¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp; my mailboxesForIndex(i)<span></span></pre></td></tr><tr><td scope="row"><pre>                    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                end if<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Return the result<span></span></pre></td></tr><tr><td scope="row"><pre>            return mailboxesSelected<span></span></pre></td></tr><tr><td scope="row"><pre>        end selectedMailboxes<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on addMessage(messageFrom, messageSubject, messageMailbox)<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add a new row<span></span></pre></td></tr><tr><td scope="row"><pre>            set theRow to make new data row at the end of the data rows¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of data source of table view "messages" of scroll view "messages"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                    of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add "From" cell<span></span></pre></td></tr><tr><td scope="row"><pre>            set name of data cell 1 of theRow to "from"<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of data cell 1 of theRow to messageFrom<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add "Subject" cell<span></span></pre></td></tr><tr><td scope="row"><pre>            set name of data cell 2 of theRow to "subject"<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of data cell 2 of theRow to messageSubject<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Add "Mailbox" cell<span></span></pre></td></tr><tr><td scope="row"><pre>            set name of data cell 3 of theRow to "mailbox"<span></span></pre></td></tr><tr><td scope="row"><pre>            set contents of data cell 3 of theRow to messageMailbox<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- set the associated object of theRow to m<span></span></pre></td></tr><tr><td scope="row"><pre>        end addMessage<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on addMessages(foundMessages)<span></span></pre></td></tr><tr><td scope="row"><pre>            set update views of data source of table view "messages"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of scroll view "messages" of split view 1 of theWindow to false<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                repeat with m in foundMessages<span></span></pre></td></tr><tr><td scope="row"><pre>                    try<span></span></pre></td></tr><tr><td scope="row"><pre>                        set messageMailbox to account name of account 1<span></span></pre></td></tr><tr><td scope="row"><pre>                            of container of m &amp; "/" &amp; mailbox name of container of m¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        my addMessage(sender of m, subject of m, messageMailbox)<span></span></pre></td></tr><tr><td scope="row"><pre>                    end try<span></span></pre></td></tr><tr><td scope="row"><pre>                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            set update views of data source of table view "messages"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of scroll view "messages" of split view 1 of theWindow to true<span></span></pre></td></tr><tr><td scope="row"><pre>        end addMessages<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on findMessages(mailboxesToSearch, whereToFind, whatToFind)<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Initialize the result<span></span></pre></td></tr><tr><td scope="row"><pre>            set messagesFound to {}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                -- Search through each of the mail boxes<span></span></pre></td></tr><tr><td scope="row"><pre>                repeat with b in (get mailboxesToSearch)<span></span></pre></td></tr><tr><td scope="row"><pre>                    try<span></span></pre></td></tr><tr><td scope="row"><pre>                        -- Search through each of the messages of the mail box<span></span></pre></td></tr><tr><td scope="row"><pre>                        repeat with m in (get messages of b)<span></span></pre></td></tr><tr><td scope="row"><pre>                            try<span></span></pre></td></tr><tr><td scope="row"><pre>                                if whereToFind is equal to "Subject" then<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if whatToFind is in the subject of m then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        copy m to end of messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                else if whereToFind is equal to "From" then<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if whatToFind is in sender of m then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        copy m to end of messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                else if whereToFind is equal to "To" then<span></span></pre></td></tr><tr><td scope="row"><pre>                                    set foundRecipient to false<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                                    -- Recipients<span></span></pre></td></tr><tr><td scope="row"><pre>                                    repeat with r in (get recipients of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                                        if whatToFind is in address of r¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                            or whatToFind is in display name of r then<span></span></pre></td></tr><tr><td scope="row"><pre>                                            set foundRecipient to true<span></span></pre></td></tr><tr><td scope="row"><pre>                                        end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                                    -- To Recipients<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if not foundRecipient then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        repeat with r in (get to recipients of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                                            if whatToFind is in address of r¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    or whatToFind is in display name¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    of r then<span></span></pre></td></tr><tr><td scope="row"><pre>                                                set foundRecipient to true<span></span></pre></td></tr><tr><td scope="row"><pre>                                            end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                                    -- cc Recipients<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if not foundRicipient then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        repeat with r in (get cc recipients of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                                            if whatToFind is in address of r¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                                    or whatToFind is in display name¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                                        of r then<span></span></pre></td></tr><tr><td scope="row"><pre>                                                set foundRecipient to true<span></span></pre></td></tr><tr><td scope="row"><pre>                                            end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                                    -- bcc Recipients<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if not foundRicipient then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        repeat with r in (get bcc recipients of m)<span></span></pre></td></tr><tr><td scope="row"><pre>                                            if whatToFind is in address of r¬<span></span></pre></td></tr><tr><td scope="row"><pre>                                            or whatToFind is in display name of r then<span></span></pre></td></tr><tr><td scope="row"><pre>                                                set foundRecipient to true<span></span></pre></td></tr><tr><td scope="row"><pre>                                            end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                                    if foundRecipient then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        copy m to end of messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                else if whereToFind is equal to "Contents" then<span></span></pre></td></tr><tr><td scope="row"><pre>                                    if whatToFind is in the content of m then<span></span></pre></td></tr><tr><td scope="row"><pre>                                        copy m to end of messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>                                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                                end if<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                                -- Update the status panel<span></span></pre></td></tr><tr><td scope="row"><pre>                                tell theStatusPanel to incrementPanel()<span></span></pre></td></tr><tr><td scope="row"><pre>                            end try<span></span></pre></td></tr><tr><td scope="row"><pre>                        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>                    end try<span></span></pre></td></tr><tr><td scope="row"><pre>                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            -- Return the result<span></span></pre></td></tr><tr><td scope="row"><pre>            return messagesFound<span></span></pre></td></tr><tr><td scope="row"><pre>        end findMessages<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on clearMessages()<span></span></pre></td></tr><tr><td scope="row"><pre>            tell scroll view "messages" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>                tell data source of table view "messages" to delete every data row<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre>        end clearMessages<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on countMessages(mailboxesToSearch)<span></span></pre></td></tr><tr><td scope="row"><pre>            set messageCount to 0<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                repeat with b in (get mailboxesToSearch)<span></span></pre></td></tr><tr><td scope="row"><pre>                    try<span></span></pre></td></tr><tr><td scope="row"><pre>                        set messageCount to messageCount + (count of every message¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            of b)<span></span></pre></td></tr><tr><td scope="row"><pre>                    end try<span></span></pre></td></tr><tr><td scope="row"><pre>                end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            return messageCount<span></span></pre></td></tr><tr><td scope="row"><pre>        end countMessages<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on openMessages()<span></span></pre></td></tr><tr><td scope="row"><pre>            -- Since Mail.app currently can't open a selected message then we<span></span></pre></td></tr><tr><td scope="row"><pre>            --  will just open it in our own window<span></span></pre></td></tr><tr><td scope="row"><pre>            openMessageWindow()<span></span></pre></td></tr><tr><td scope="row"><pre>        end openMessages<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on openMessageWindow()<span></span></pre></td></tr><tr><td scope="row"><pre>            set clickedRow to clicked row of table view "messages"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                of scroll view "messages" of split view 1 of theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>            if clickedRow is greater than or equal to 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                set theAccount to ""<span></span></pre></td></tr><tr><td scope="row"><pre>                set theMailbox to ""<span></span></pre></td></tr><tr><td scope="row"><pre>                set theSubject to ""<span></span></pre></td></tr><tr><td scope="row"><pre>                set theDateReceived to ""<span></span></pre></td></tr><tr><td scope="row"><pre>                set theContents to ""<span></span></pre></td></tr><tr><td scope="row"><pre>                set theSender to ""<span></span></pre></td></tr><tr><td scope="row"><pre>                set theRecipients to ""<span></span></pre></td></tr><tr><td scope="row"><pre>                set theCCRecipients to ""<span></span></pre></td></tr><tr><td scope="row"><pre>                set theReplyTo to ""<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                tell application "Mail"<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theMessage to Abstract object clickedRow of foundMessages<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    set theAccount to account name of account of container¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theMailbox to mailbox name of container of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theSubject to subject of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                    -- set theDateReceived to date received of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theContents to content of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theSender to sender of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theRecipients to address of every recipient of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theCCRecipients to address of every cc recipient of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                    set theReplyTo to reply to of theMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                end tell<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                set messageWindow to makeMessageWindow()<span></span></pre></td></tr><tr><td scope="row"><pre>                tell messageWindow<span></span></pre></td></tr><tr><td scope="row"><pre>                    set messageContents to "Account: " &amp; theAccount &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>                    set messageContents to messageContents &amp; "Mailbox: "¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        &amp; theMailbox &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>                    if length of theSender > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                        set messageContents to messageContents &amp; "From: "¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp; theSender &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                    if length of theDateReceived as string > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                        set messageContents to messageContents &amp; "Date: "¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp; (theDateReceived as string) &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                    if length of theRecipients > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                        set messageContents to messageContents &amp; "To: "¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp; theRecipients &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                    if length of theCCRecipients > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                        set messageContents to messageContents &amp; "Cc: "¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp; theCCRecipients &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                    if length of theSubject > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                        set messageContents to messageContents &amp; "Subject: "¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp; theSubject &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                    if length of theReplyTo > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>                        set messageContents to messageContents &amp; "Reply-To: "¬<span></span></pre></td></tr><tr><td scope="row"><pre>                            &amp; theReplyTo &amp; return &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>                    end if<span></span></pre></td></tr><tr><td scope="row"><pre>                    set messageContents to messageContents &amp; theContents<span></span></pre></td></tr><tr><td scope="row"><pre>                    set contents of text view "message" of scroll view "message"¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        to messageContents<span></span></pre></td></tr><tr><td scope="row"><pre>                    set title to theSubject<span></span></pre></td></tr><tr><td scope="row"><pre>                    set visible to true<span></span></pre></td></tr><tr><td scope="row"><pre>                end tell<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>        end openMessageWindow<span></span></pre></td></tr><tr><td scope="row"><pre>    end script<span></span></pre></td></tr><tr><td scope="row"><pre>end makeController<span></span></pre></td></tr></table></div>	<a name="//apple_ref/doc/uid/20001261-TPXREF149" title="Listing B-3Handlers for working with controller script objects"></a><p class="codesample"><strong>Listing B-3&nbsp;&nbsp;</strong>Handlers for working with controller script objects</p><div class="codesample"><table><tr><td scope="row"><pre>on addController(theController)<span></span></pre></td></tr><tr><td scope="row"><pre>    set controllers to controllers &amp; {theController}<span></span></pre></td></tr><tr><td scope="row"><pre>end addController<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on removeController(forWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>    set theController to controllerForWindow(forWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>    if theController is not equal to null then<span></span></pre></td></tr><tr><td scope="row"><pre>        deleteItemInList(theController, controllers)<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end removeController<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on controllerForWindow(aWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>    repeat with c in controllers<span></span></pre></td></tr><tr><td scope="row"><pre>        if theWindow of c is equal to aWindow then<span></span></pre></td></tr><tr><td scope="row"><pre>            set theController to c<span></span></pre></td></tr><tr><td scope="row"><pre>        end if<span></span></pre></td></tr><tr><td scope="row"><pre>    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    return theController<span></span></pre></td></tr><tr><td scope="row"><pre>end controllerForWindow<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001261-TPXREF150" title="Listing B-4The message window handler"></a><p class="codesample"><strong>Listing B-4&nbsp;&nbsp;</strong>The message window handler</p><div class="codesample"><table><tr><td scope="row"><pre>(* ==== Message Window Handlers ==== *)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on makeMessageWindow()<span></span></pre></td></tr><tr><td scope="row"><pre>    load nib "Message"<span></span></pre></td></tr><tr><td scope="row"><pre>    set windowCount to windowCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>    set windowName to "message " &amp; windowCount<span></span></pre></td></tr><tr><td scope="row"><pre>    set name of window "message" to windowName<span></span></pre></td></tr><tr><td scope="row"><pre>    return window windowName<span></span></pre></td></tr><tr><td scope="row"><pre>end makeMessageWindow<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001261-TPXREF151" title="Listing B-5The status dialog script definition"></a><p class="codesample"><strong>Listing B-5&nbsp;&nbsp;</strong>The status dialog script definition</p><div class="codesample"><table><tr><td scope="row"><pre>(* ==== Status Panel Handlers ==== *)<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on makeStatusPanel(forWindow)<span></span></pre></td></tr><tr><td scope="row"><pre>    script<span></span></pre></td></tr><tr><td scope="row"><pre>        property theWindow : forWindow<span></span></pre></td></tr><tr><td scope="row"><pre>        property initialized : false<span></span></pre></td></tr><tr><td scope="row"><pre>        property totalCount : 0<span></span></pre></td></tr><tr><td scope="row"><pre>        property currentCount : 0<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        -- Handlers<span></span></pre></td></tr><tr><td scope="row"><pre>        on openPanel(statusMessage)<span></span></pre></td></tr><tr><td scope="row"><pre>            if initialized is false then<span></span></pre></td></tr><tr><td scope="row"><pre>                if not statusPanelNibLoaded then<span></span></pre></td></tr><tr><td scope="row"><pre>                    load nib "StatusPanel"<span></span></pre></td></tr><tr><td scope="row"><pre>                    set statusPanelNibLoaded to true<span></span></pre></td></tr><tr><td scope="row"><pre>                end if<span></span></pre></td></tr><tr><td scope="row"><pre>                tell window "status"<span></span></pre></td></tr><tr><td scope="row"><pre>                    set indeterminate of progress indicator "progress" to true<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell progress indicator "progress" to start<span></span></pre></td></tr><tr><td scope="row"><pre>                    set contents of text field "statusMessage" to statusMessage<span></span></pre></td></tr><tr><td scope="row"><pre>                end tell<span></span></pre></td></tr><tr><td scope="row"><pre>                set initialized to true<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            display panel window "status" attached to theWindow<span></span></pre></td></tr><tr><td scope="row"><pre>        end openPanel<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on changePanel(statusMessage)<span></span></pre></td></tr><tr><td scope="row"><pre>            tell window "status"<span></span></pre></td></tr><tr><td scope="row"><pre>                set indeterminate of progress indicator "progress" to true<span></span></pre></td></tr><tr><td scope="row"><pre>                tell progress indicator "progress" to start<span></span></pre></td></tr><tr><td scope="row"><pre>                set contents of text field "statusMessage" to statusMessage<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre>        end changePanel<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on adjustPanel()<span></span></pre></td></tr><tr><td scope="row"><pre>            tell progress indicator "progress" of window "status"<span></span></pre></td></tr><tr><td scope="row"><pre>                set indeterminate to false<span></span></pre></td></tr><tr><td scope="row"><pre>                set minimum value to currentCount<span></span></pre></td></tr><tr><td scope="row"><pre>                set maximum value to totalCount<span></span></pre></td></tr><tr><td scope="row"><pre>                set contents to 0<span></span></pre></td></tr><tr><td scope="row"><pre>            end tell<span></span></pre></td></tr><tr><td scope="row"><pre>            incrementPanel()<span></span></pre></td></tr><tr><td scope="row"><pre>        end adjustPanel<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on incrementPanel()<span></span></pre></td></tr><tr><td scope="row"><pre>            set currentCount to currentCount + 1<span></span></pre></td></tr><tr><td scope="row"><pre>            if currentCount ≤ totalCount then<span></span></pre></td></tr><tr><td scope="row"><pre>                tell window "status"<span></span></pre></td></tr><tr><td scope="row"><pre>                    tell progress indicator "progress" to increment by 1<span></span></pre></td></tr><tr><td scope="row"><pre>                    set contents of text field "statusMessage" to "Message "¬<span></span></pre></td></tr><tr><td scope="row"><pre>                        &amp; currentCount &amp; " of " &amp; totalCount<span></span></pre></td></tr><tr><td scope="row"><pre>                end tell<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>        end incrementPanel<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        on closePanel()<span></span></pre></td></tr><tr><td scope="row"><pre>            close panel window "status"<span></span></pre></td></tr><tr><td scope="row"><pre>        end closePanel<span></span></pre></td></tr><tr><td scope="row"><pre>    end script<span></span></pre></td></tr><tr><td scope="row"><pre>end makeStatusPanel<span></span></pre></td></tr></table></div>	<a name="//apple_ref/doc/uid/20001261-TPXREF152" title="Listing B-6The delete items in list utility"></a><p class="codesample"><strong>Listing B-6&nbsp;&nbsp;</strong>The delete items in list utility</p><div class="codesample"><table><tr><td scope="row"><pre>(* To be provided *)<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001261-TPXREF153" title="Mail Search Copyright Notice"></a><h2>Mail Search Copyright Notice</h2><p>(* © Copyright 2001, 2002 Apple Computer, Inc. All rights reserved. IMPORTANT:  This Apple software is supplied to you by Apple Computer, Inc. (“Apple”) in consideration of your agreement to the following terms, and your use, installation, modification or redistribution of this Apple software constitutes acceptance of these terms.  If you do not agree with these terms, please do not use, install, modify or redistribute this Apple software. In consideration of your agreement to abide by the following terms, and subject to these terms, Apple grants you a personal, non-exclusive license, under Apple’s copyrights in this original Apple software (the “Apple Software”), to use, reproduce, modify and redistribute the Apple Software, with or without modifications, in source and/or binary forms; provided that if you redistribute the Apple Software in its entirety and without modifications, you must retain this notice and the following text and disclaimers in all such redistributions of the Apple Software.  Neither the name, trademarks, service marks or logos of Apple Computer, Inc. may be used to endorse or promote products derived from the Apple Software without specific prior written permission from Apple.  Except as expressly stated in this notice, no other rights or licenses, express or implied, are granted by Apple herein, including but not limited to any patent rights that may be infringed by your derivative works or by other works in which the Apple Software may be incorporated. The Apple Software is provided by Apple on an "AS IS" basis.  APPLE MAKES NO WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION THE IMPLIED WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE, REGARDING THE APPLE SOFTWARE OR ITS USE AND OPERATION ALONE OR IN COMBINATION WITH YOUR PRODUCTS. IN NO EVENT SHALL APPLE BE LIABLE FOR ANY SPECIAL, INDIRECT, INCIDENTAL OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) ARISING IN ANY WAY OUT OF THE USE, REPRODUCTION, MODIFICATION AND/OR DISTRIBUTION OF THE APPLE SOFTWARE, HOWEVER CAUSED AND WHETHER UNDER THEORY OF CONTRACT, TORT (INCLUDING NEGLIGENCE), STRICT LIABILITY OR OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. *)</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../requirements/scriptStudio_requirements.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../glossary/studio_glossary.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-04-04<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/listing/studio_ms_code.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/listing/studio_ms_code.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/StudioBuildingApps/listing/studio_ms_code.html%3Fid%3DTP30000889-2.3&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>