<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>NewSubscriberDialog(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING78></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-77.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-79.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-23.html"><B>Chapter 2 - Edition Manager</B></A> / <A HREF="IAC-48.html"><B>Edition Manager Reference</B></A><BR><DL><DD><A HREF="IAC-52.html"><B>Edition Manager Routines</B></A> / <A HREF="IAC-76.html"><B>Displaying Dialog Boxes</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING78-0></A>
<H3><A NAME=MARKER-9-452></A>NewSubscriberDialog</H3>
 When a user chooses the Subscribe To menu command, your application should call the <CODE>NewSubscriberDialog</CODE> function to allow the user to choose an edition to subscribe to. <A NAME=MARKER-2-56></A><P>
<PRE>
FUNCTION NewSubscriberDialog 
                     (VAR reply: NewSubscriberReply): OSErr;
</PRE>
<DL>
<DT><CODE>reply</CODE>
<DD> The new subscriber reply record. You specify a location to use as the default edition container in the <CODE>container</CODE> field of this record. You also specify in the <CODE>formatsMask</CODE> field which edition format types <CODE>NewSubscriberDialog</CODE> should display. The <CODE>NewSubscriberDialog</CODE> function returns information concerning the user's choice in the <CODE>canceled</CODE> and <CODE>container</CODE> fields of this record.<A NAME=MARKER-9-127></A>
</DL>
<PRE>
TYPE NewSubscriberReply = 
   RECORD
      canceled:      Boolean;             {user canceled }
                                          { dialog box}
      formatsMask:   SignedByte;          {formats required}
      container:     EditionContainerSpec;{edition selected}
   END;
</PRE>
<DL>
<H5>Field Description</H5>
<DT><CODE>canceled</CODE>
<DD> The <CODE>NewSubscriberDialog</CODE> function returns in this field a value that indicates whether the user canceled the dialog box. The function returns <CODE>TRUE</CODE> in the <CODE>canceled</CODE> field if the user canceled the dialog box. Otherwise, the function returns <CODE>FALSE</CODE> in this field and returns in the <CODE>container</CODE> field the edition container for the new subscriber.
<DT><CODE>formatsMask</CODE>
<DD> The <CODE>formatsMask</CODE> field indicates which edition format type (text, graphics, and sound) to display within the subscriber dialog box. You can set the <CODE>formatsMask</CODE> field to the following constants: <CODE>kTEXTformatMask</CODE> (1), <CODE>kPICTformatMask</CODE> (2), or <CODE>ksndFormatMask</CODE> (4). To support a combination of formats, add the constants together. For example, a <CODE>formatsMask</CODE> of 3 displays both graphics and text edition format types in the subscriber   dialog box.<A NAME=MARKER-2-284></A><A NAME=MARKER-2-58></A><A NAME=MARKER-2-285></A>
<DT><CODE>container</CODE>
<DD> The edition container of the last edition published or subscribed to. You provide in this parameter the location and filename to use as the default edition to subscribe to. If the user clicks the Subscribe button, <CODE>NewSubscriberDialog</CODE> returns <CODE>FALSE</CODE> in the <CODE>canceled</CODE> field and returns the selected edition container for the new subscriber in the <CODE>container</CODE> field. 
</DL>
<A NAME=HEADING78-8></A>
<H5> DESCRIPTION</H5>
 The <CODE>NewSubscriberDialog</CODE> function displays the subscriber dialog box on the user's screen. The <CODE>NewSubscriberDialog</CODE> function (which is based on the <CODE>CustomGetFile</CODE> procedure described in the chapter "Standard File Package" in <I><A HREF="../Files/Files-2.html">Inside Macintosh: Files</A></I>) switches to the volume reference number and directory ID and selects the filename of the edition container that you specified in the <CODE>container</CODE> field of the <CODE>reply</CODE> parameter. Use the <CODE>GetLastEditionContainerUsed</CODE> function to get the edition container of the last edition that was either published or subscribed to, then set the <CODE>container</CODE> field to this edition container. This allows the user to publish and then easily subscribe.<P>
 Note that if an edition does not contain either <CODE>'PICT'</CODE>, <CODE>'TEXT'</CODE>, or <CODE>'snd '</CODE> data, the <CODE>NewSubscriberDialog</CODE> function does not list the edition file in the new subscriber dialog box (unless you install an opener that can recognize the edition's data in response to the <CODE>eoCanSubscribe</CODE> verb).<A NAME=MARKER-2-123></A><P>
<A NAME=HEADING78-11></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>editionMgrInitErr<TD>-450<TD>Manager not initialized or could not load package<TR>
<TD>badSubPartErr<TD>-454<TD>Bad edition container spec</TABLE>
</H5>
<A NAME=HEADING78-12></A>
<H5>SEE ALSO</H5>
 For an illustration of the new subscriber dialog box, see <A HREF=IAC-33.html#MARKER-9-192>Figure 2-12 on page 2-37</A>. For an example of the use of <CODE>NewSubscriberDialog</CODE>, see <A HREF=IAC-33.html#MARKER-9-205>Listing 2-6</A> beginning on <A HREF=IAC-33.html#MARKER-9-205>page 2-40</A>. For a description of the edition container record, see <A HREF=IAC-50.html#MARKER-9-386>page 2-71</A>. For information on edition openers, see <A HREF=IAC-40.html#MARKER-9-349>"Subscribing to Non-Edition Files" beginning on page 2-62</A>. <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-77.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-79.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
