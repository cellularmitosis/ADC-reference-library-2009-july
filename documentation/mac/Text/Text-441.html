<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>FixTSMDocument(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING441></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-440.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-442.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-409.html"><B>Chapter 7 - Text Services Manager</B></A> / <A HREF="Text-425.html"><B>Text Services Manager Reference</B></A><BR><DL><DD><A HREF="Text-426.html"><B>Text Services Manager Routines for Client Applications</B></A> / <A HREF="Text-440.html"><B>Confirming Active Input in a TSM Document</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING441-0></A>
<H3><A NAME=MARKER-9-262></A>FixTSMDocument</H3>
 <A NAME=MARKER-2-289></A>The <CODE>FixTSMDocument</CODE> function informs the Text Services Manager that input in the active input area of a specified TSM document has been interrupted, and that the text service component must confirm the text and terminate user input.<A NAME=MARKER-2-264></A><P>
<PRE>
FUNCTION FixTSMDocument (idocID: TSMDocumentID): OSErr;
</PRE>
<DL>
<DT><CODE>idocID</CODE>
<DD> The identification number of a TSM document created by a prior call to the <CODE>NewTSMDocument</CODE> function (see <A HREF=Text-431.html#MARKER-9-231>page 7-50</A>).
</DL>
<A NAME=HEADING441-4></A>
<H5>DESCRIPTION</H5>
 Typically, an inline input text service component removes confirmed input from the active input area each time the user presses the Return key, and passes the confirmed text to your application through an Apple event.<P>
 In certain situations, however, your client application may need to inform the text service component that there has been an interruption in user input for a specific TSM document. In this case you call the <CODE>FixTSMDocument</CODE> function to give the input method text service component the opportunity to confirm any input in progress.<P>
 For instance, if the user clicks in the close box of the window in which active input is taking place, call <CODE>FixTSMDocument</CODE> before you close the window. The text service component will pass you the current contents (both converted and unconverted) of the active input area as confirmed text.<P>
 For simple activating and deactivating of your application's window, it is not necessary to confirm the text in the active inline area. The input method saves the text and restores it when your window is reactivated.<P>
<A NAME=HEADING441-9></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>No error<TR>
<TD>tsmInvalidDocIDErr<TD>The document is not a valid TSM document<TR>
<TD>tsmDocNotActiveErr<TD>The TSM document is not active<TR>
<TD>tsmTSNotOpenErr<TD>The default input method is not open</TABLE>
</H5>
<A NAME=HEADING441-10></A>
<H5>SEE ALSO</H5>
 For sample code that uses the <CODE>FixTSMDocument</CODE> function, see <A HREF=Text-418.html#MARKER-9-145>Listing 7-5 on page 7-23</A>.<A NAME=MARKER-2-265></A>  <A NAME=MARKER-2-266></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-440.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-442.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
