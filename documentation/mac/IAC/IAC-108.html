<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>The Classification of Apple Event Objects(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING108></A>


<!-- Top of Header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- Bottom of Header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-107.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-109.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-94.html"><B>Chapter 3 - Introduction to Apple Events</B></A> / <A HREF="IAC-106.html"><B>Working With Object Specifier Records</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING108-0></A>
<H2><A NAME=MARKER-9-247></A>The Classification of Apple Event Objects</H2>
 <A NAME=MARKER-9-53></A><A NAME=MARKER-9-249></A>To create or resolve object specifier records, your application should use the classification of Apple event objects defined by the <I>Apple Event Registry: Standard Suites.</I> This section summarizes the concepts that underlie that classification system. You should have a copy of the <I>Apple Event Registry: Standard Suites</I> available for reference purposes while you read this section.<P>
 You do not need to write your application in an object-oriented programming language in order to support Apple event objects in your application. However, you must understand the classification system described in this section in order to classify Apple event objects in your application and to write routines that can locate them on the basis of information contained in object specifier records.<P>
<A NAME=HEADING108-3></A>
<H3>Object Classes</H3>
 <A NAME=MARKER-2-25></A><A NAME=MARKER-9-251></A>Except for the concept of inheritance, Apple event objects are different from the objects used in object-oriented programming languages. Apple event objects are distinct items in a server application or any of its documents that can be specified by an object specifier record in an Apple event sent by a client application. Apple event objects are often, but not always, items that a user can differentiate and manipulate within an application, such as words, paragraphs, shapes, windows, or style formats. Every Apple event object can be classified according to its object class, which defines both its characteristics and its behavior. The object classes listed in the <I>Apple Event Registry: Standard Suites</I> provide a method of describing Apple event objects that all applications can understand. Object classes permit more flexibility than simple descriptor types; for example, a word can be defined as a simple string, or it can be defined as an Apple event object with specific characteristics such as font or style.<P>
<DL>
<DT><B>Note</B>
<DD>The definition of an object class only specifies conventions that determine how applications should handle Apple event objects that belong to that class. Your application must make sure that it uses the conventions correctly; they are not enforced by the Apple Event Manager.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 Each object class is identified by a four-character object class ID, which can also be represented by a constant. Constants for object classes always begin with the letter <CODE>c</CODE>. <P>
 The definition of an object class specifies its <B>superclass</B>, which is the object class from which a <B>subclass</B> (the class being defined) inherits some of its characteristics. Characteristics can also be inherited from special object classes, called <B>abstract superclasses,</B> that are used only in definitions of object classes and do not refer to real Apple event objects. The pattern of inheritance among object classes is called the <B>object class inheritance hierarchy.</B> <A HREF=#MARKER-9-255>Figure 3-15</A> shows a portion of this hierarchy. The abstract superclass <CODE>cObject</CODE> is at the top of the hierarchy and is therefore the only object class that has no superclass. At the next level are <CODE>cText</CODE>, which is a regular object class, and <CODE>cOpenableObject</CODE>, which is an abstract superclass. Both are subclasses of <CODE>cObject</CODE> and superclasses for their own subclasses. The object classes <CODE>cWord</CODE>, <CODE>cItem</CODE>, and <CODE>cChar</CODE> are all subclasses of <CODE>cText</CODE>. Similarly, <CODE>cWindow</CODE>, <CODE>cDocument</CODE>, and <CODE>cFile</CODE> are subclasses of <CODE>cOpenableObject</CODE>. Every object class inherits all the characteristics of its superclass and can also add characteristics of its own.<A NAME=MARKER-2-118></A><A NAME=MARKER-2-128></A><A NAME=MARKER-2-4></A><P>
<B>Figure 3-15  <A NAME=MARKER-9-255></A>Superclasses and subclasses</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-11.jpg"><P>
 Here are some of the object classes defined for the Core suite:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Class<TH>Class ID<TH>Description<TR>
<TD>cChar<TD>'cha '<TD>Text characters<TR>
<TD>cDocument<TD>'docu'<TD>Macintosh documents<TR>
<TD>cFile<TD>'cfil'<TD>Macintosh files<TR>
<TD>cSelection<TD>'csel'<TD>User or application selections<TR>
<TD>cText<TD>'ctxt'<TD>Series of characters<TR>
<TD>cWindow<TD>'cwin'<TD>Standard Macintosh windows</TABLE>
<P>
 Here are some of the object classes defined for the Text suite:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Class<TH>Class ID<TH>Description<TR>
<TD>cChar<TD>'cha '<TD>Text characters<TR>
<TD>cLine<TD>'clin'<TD>Lines of text<TR>
<TD>cParagraph<TD>'cpar'<TD>Paragraphs<TR>
<TD>cText<TD>'ctxt'<TD>Series of characters<TR>
<TD>cTextFlow<TD>'cflo'<TD>Text flows<TR>
<TD>cWord<TD>'cwor'<TD>Words</TABLE>
<P>
 <A NAME=MARKER-2-10></A>As you can see, some object classes, such as <CODE>cChar</CODE> and <CODE>cText</CODE>, are defined in more than one suite. For example, the definition of the <CODE>cText</CODE> object class in the Text suite is an <B>extension</B> of the <CODE>cText</CODE> object class defined in the Core suite; it duplicates all the characteristics of the Core suite object class and adds some of its own. Like a word in a dictionary, one object class ID can have several related definitions. You can choose to support the definition that best suits your application; or, if necessary, you can create extensions of your own.<A NAME=MARKER-2-5></A> The extension of an object class is different from inheritance between object classes. An extension of a standard object class provides additional ways of describing an Apple event object of that class, whereas the object class inheritance hierarchy determines the pattern of characteristics shared by different object classes. <P>
 The definition of an object class always specifies a default descriptor type. Suppose, for example, that a client application sends a Get Data, Cut, or Copy event that specifies an Apple event object but does not specify a descriptor type for the returned data. In this case, the server application returns a descriptor record of the default descriptor type for the object class of the specified Apple event object. For example, the default descriptor type for Apple event objects of class <CODE>cWord</CODE> is <CODE>typeIntlText</CODE>, a descriptor type that specifies an undelimited string of characters in a specific language and script system. The client application can also request that the data be returned in a descriptor record of some other data type.<P>
 The definition of an object class includes three lists of characteristics: properties, element classes, and Apple events that support the object class. (The next section describes properties and element classes.) Any or all of these characteristics may be inherited from a superclass. An Apple event is listed for an object class if its parameters can specify objects of that class. The definition for <CODE>cWindow</CODE>, for example, lists 12 Apple events, including the Open, Close, and Move events, whose parameters can include object specifier records that specify windows. The <CODE>cWindow</CODE> class inherits all of these Apple events from its abstract superclass, <CODE>cOpenableObject</CODE>.<A NAME=MARKER-2-258></A><P>
 The <I>Apple Event Registry: Standard Suites</I> also defines <B>primitive object classes,</B> which describe Apple event objects that contain a single value. For example, the <CODE>cBoolean</CODE>, <CODE>cLongInteger</CODE>, and <CODE>cAlias</CODE> object classes are all primitive object classes. The object class ID for a primitive object class is the same as the four-character value of its descriptor type. Primitive object classes contain no properties; they contain only the value of the data. <A NAME=MARKER-2-305></A> <A NAME=MARKER-2-59></A><P>
<A NAME=HEADING108-16></A>
<H3>Properties and Elements</H3>
 <A NAME=MARKER-2-392></A><A NAME=MARKER-9-203></A><A NAME=MARKER-9-263></A>The properties listed for an object class can be used to identify characteristics of Apple event objects that belong to that class. Each property is identified by a four-character property ID, which can also be represented by a constant. Constants for properties always begin with the letter <CODE>p</CODE>.<P>
 Here are constants and property IDs for some properties:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Property<TH>Property ID<TH>Description<TR>
<TD>pName<TD>'pnam'<TD>Name of an Apple event object<TR>
<TD>pBounds<TD>'pbnd'<TD>Coordinates of a window<TR>
<TD>pVisible<TD>'pvis'<TD>Indicates whether a window is visible<TR>
<TD>pIsModal<TD>'pmod'<TD>Indicates whether a window is modal<TR>
<TD>pClass<TD>'pcls'<TD>Class ID of an Apple event object<TR>
<TD>pFont<TD>'font'<TD>Font<TR>
<TD>pTextStyle<TD>'txst'<TD>Text style<TR>
<TD>pColor<TD>'colr'<TD>Text color<TR>
<TD>pTextPointSize<TD>'ptps'<TD>Point size<TR>
<TD>pScriptTag<TD>'psct'<TD>Script system identifier<TR>
<TD>pFillColor<TD>'flcl'<TD>Fill color</TABLE>
<P>
 The property of an Apple event object is itself defined as a single Apple event object whose container is the object to which the property belongs. For example, the <CODE>pFont</CODE> property of a word is defined by the name of a font, such as New York; the string that identifies the font is an Apple event object of class <CODE>cText</CODE>. <P>
 The constant <CODE>cProperty</CODE> specifies the object class for any object specifier record that identifies a property. <P>
<PRE>
CONST cProperty = 'prop';
</PRE>
 An object specifier record for a property specifies <CODE>cProperty</CODE> as the object class ID, the Apple event object to which the property belongs as the container, <CODE>formPropertyID</CODE> as the key form, and a constant such as <CODE>pFont</CODE> as the key data. <A NAME=MARKER-9-84></A> <A NAME=MARKER-2-229></A><A NAME=MARKER-2-201></A> <P>
 The <B>elements</B> of a specific Apple event object are the other Apple event objects it contains, excluding those that define its properties. An object specifier record for an element specifies the Apple event object in which the element is located as the container and can specify any key form except <CODE>formPropertyID</CODE>. Each object class definition in the <I>Apple Event Registry: Standard Suites</I> includes a list of <B>element</B> <B>classes,</B> which are the object classes of the elements that an Apple event object can contain. <P>
 An Apple event object contains exactly one of each of its properties, whereas it can contain no elements or many elements of the same element class. In general, a property of an object describes something about that object; a property can be examined or changed but never deleted. An element can be one or more discrete objects contained in another object and can usually be deleted. <P>
 For example, because a paragraph can contain one or more words, one of the element classes listed for the object class <CODE>cParagraph</CODE> is the object class <CODE>cWord</CODE>. Individual words can be deleted from a paragraph. However, even though a word in a paragraph can be in a different font from the words around it, a paragraph can have only one <CODE>pFont</CODE> property. This property is defined as the font of the first character in the paragraph and consists of the name of a font. The paragraph's <CODE>pFont</CODE> property can be changed but not removed.<P>
 The properties and element classes listed for each object class definition in the <I>Apple Event Registry: Standard Suites</I> can be inherited from a superclass, or they can originate with a subclass. <A HREF=#MARKER-9-267>Figure 3-16</A> illustrates the object class inheritance hierarchy for the object class <CODE>cWindow</CODE> in the Core suite. Boldface terms in the figure represent those properties, element classes, or Apple events that are not inherited. The object class <CODE>cWindow</CODE> includes all the properties and Apple events of its superclass, <CODE>cOpenableObject</CODE>, which in turn includes all the properties and Apple events of its superclass, <CODE>cObject</CODE>. The object class <CODE>cWindow</CODE> also includes 11 properties and one element class that originate with <CODE>cWindow</CODE> and are not inherited. <P>
 The <CODE>pClass</CODE> property--the property that specifies the four-character class ID--originates with <CODE>cObject</CODE>. Because the definitions of all object classes are ultimately derived from <CODE>cObject</CODE>, <CODE>pClass</CODE> is inherited by all object classes. The definition for <CODE>cObject</CODE> also lists ten Apple events, which include common events such as Get Data, Move, and Delete Element. Because <CODE>cObject</CODE> is at the top of the object class inheritance hierarchy, these ten Apple events can use object specifier records that describe Apple event objects of any object class as a direct parameter. Like all abstract superclasses, <CODE>cObject</CODE> does not correspond to a real Apple event object, so its definition does not list any element classes. Unlike any other object class, <CODE>cObject</CODE> is at the top of the object class inheritance hierarchy and therefore does not have a superclass. <P>
<B>Figure 3-16  <A NAME=MARKER-9-267></A>The object class inheritance hierarchy for the object class <CODE>cWindow</CODE></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-12.jpg"><P>
 <A NAME=MARKER-9-16></A>The chain of containers that determine the location of one or more Apple event objects is called the <B>container hierarchy.</B> The container hierarchy, which specifies the location of real Apple event objects, is different from the object class inheritance hierarchy, which is an abstract concept that determines which properties, element classes, and Apple events an object class inherits from its superclass. For example, the container hierarchy for an Apple event object of class <CODE>cWord</CODE> can vary from one word to another, because various combinations of other Apple event objects, such as a document, a paragraph, a delimited string, or another word, can contain a word. <A NAME=MARKER-2-269></A><P>
 Applications that support Apple event objects must be able to identify the order of several elements of the same class that are contained within another Apple event object. For example, each word in a paragraph should have an identifiable order, such as the 5th word or the 12th word. This allows other applications to identify Apple event objects by describing their absolute position within a container. <P>
 <A HREF=#MARKER-9-270>Figure 3-17</A> shows an Apple event object of object class <CODE>cWord</CODE>--the word "Sales"--contained in another Apple event object of object class <CODE>cParagraph</CODE>. (Both these object classes are defined in the Text suite.) The figure shows only a portion of the container hierarchy for the word, since a complete description of the word would also include the containers that specify the location of the paragraph. <P>
 Your application must take account of the definitions in the <I>Apple Event Registry: Standard Suites</I> for any object classes you want to support. For example, the definition for the object class <CODE>cText</CODE> lists paragraphs, lines, words, and characters as Apple event objects that can be contained in Apple event objects of class <CODE>cText</CODE>. To support Apple events that refer to elements of object class <CODE>cText</CODE>, your application should associate the <CODE>cText</CODE> object class with paragraphs, lines, words, and characters in its documents. The list of properties defined for class <CODE>cText</CODE> includes the properties <CODE>pColor</CODE>, <CODE>pFont</CODE>, <CODE>pPointSize</CODE>, <CODE>pScriptTag</CODE>, and <CODE>pTextStyles</CODE>. If you want to support Apple events that distinguish a boldface 12-point word of object class <CODE>cText</CODE> from an italic 14-point word, for example, your application must associate the point size and style of text in its documents with the properties <CODE>pPointSize</CODE> and <CODE>pTextStyles</CODE> defined for class <CODE>cText</CODE>. <P>
<B>Figure 3-17  <A NAME=MARKER-9-270></A>An Apple event object of class <CODE>cWord</CODE> contained in an Apple event object of class <CODE>cParagraph</CODE><A NAME=MARKER-21-41></A><A NAME=MARKER-2-42></A><A NAME=MARKER-2-273></A><A NAME=MARKER-9-3></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-13.jpg"><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-107.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-109.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
