<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>Tabs LDEF - /Windows.c</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; <A HREF="javascript:location.replace('index.html');">Tabs LDEF</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxUserExperience-date.html" target="_blank">Carbon > User Experience</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">Tabs LDEF</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/Windows.c</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/AppleEvents.c</option>
<option value="listing2.html">/BareBones.c</option>
<option value="listing3.html">/BareBones.h</option>
<option value="listing4.html">/Events.c</option>
<option value="listing5.html">/Initialize.c</option>
<option value="listing6.html">/Lists.c</option>
<option value="listing7.html">/Menus.c</option>
<option value="listing8.html">/PatchListLDEF.c</option>
<option value="listing9.html">/Prototypes.h</option>
<option value="listing10.html">/Tabs LDEF/Tabs LDEF.c</option>
<option value="listing11.html">/Utilities.c</option>
<option value="listing12.html">/Windows.c</option></select>
				</p>
				</form>
				<p><strong><a href="Tabs_LDEF.zip">Download Sample</a></strong> (&#147;Tabs_LDEF.zip&#148;, 45.2K)<BR>
<strong><a href="Tabs_LDEF.dmg">Download Sample</a></strong> (&#147;Tabs_LDEF.dmg&#148;, 105.0K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*  File:    Windows.c  Contains:  Handle application's windows  Written by: Chris White    Copyright:  Copyright &copy; 1995-1999 by Apple Computer, Inc., All Rights Reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        8/10/1999  Karl Groethe  Updated for Metrowerks Codewarror Pro 2.1        */#pragma segment Core#include &lt;Sound.h&gt;// System Includes#ifndef __TYPES__  #include &lt;Types.h&gt;#endif#ifndef __WINDOWS__  #include &lt;Windows.h&gt;#endif#ifndef __QUICKDRAW__  #include &lt;Quickdraw.h&gt;#endif#ifndef __RESOURCES__  #include &lt;Resources.h&gt;#endif#ifndef __FONTS__  #include &lt;Fonts.h&gt;#endif#ifndef __ERRORS__  #include &lt;Errors.h&gt;#endif// Application Includes#ifndef __BAREBONES__  #include &quot;BareBones.h&quot;#endif#ifndef __PROTOTYPES__  #include &quot;Prototypes.h&quot;#endif// Static prototypesstatic OSErr  CreateContentList ( WindowRef theWindow, tContentsProcPtr contentsProc, void* refCon );static OSErr  AddListContents ( ListRef theList, void* refCon );OSErr      PatchListLDEF ( ListRef theList );//// This is called to create the application's window.//void CreateWindow ( void ){  OSErr    theErr;  WindowRef  theWindow;    theErr = CreateListWindow ( &amp;theWindow, AddListContents, nil );  if ( theErr )    AlertUser ( kGenericErrorStr, theErr, &quot;\p&quot; );    return;}//// This will close the application's window, dispose of any storage we've hung// off the window, and then dispose of the window itself.//WindowRef DestroyWindow ( WindowRef windowRef ){  if ( windowRef )  {    ListRef theList;        theList = (ListRef) GetWRefCon ( windowRef );    if ( theList )      LDispose ( theList );        DisposeWindow ( windowRef );      }    return nil;}//// Creates a window with a list in the centre. contentsProc is a routine// pointer to intitialize the list. It's passed the refCon to assist.//OSErr CreateListWindow ( WindowRef* windowRef, tContentsProcPtr contentsProc, void* refCon ){  OSErr    theErr;  WindowRef  theWindow;      theWindow = GetNewCWindow ( kDisplayWindow, nil, (WindowRef) -1 );  if ( theWindow == nil )    return (ResError ( )) ? ResError ( ) : resNotFound;    SetPortWindowPort ( theWindow );  TextFont ( kFontIDGeneva );  TextFace ( normal );  TextSize ( 9 );     theErr = CreateContentList ( theWindow, contentsProc, refCon );  if ( theErr )  goto CleanupAndBail;    SelectWindow ( theWindow );  ShowWindow ( theWindow );    *windowRef = theWindow;    return noErr;  CleanupAndBail:    // Don't forget to free any storage we've used so far  DestroyWindow ( theWindow );    return theErr;}//// This is passed into the CreateDocumentWindow routine// to add the contents to the newly created list.//static OSErr AddListContents ( ListRef theList, void* refCon ){  #pragma unused(refCon)  AddToList ( theList, &quot;\pApple Extras\t-\tfolder\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pApplications\t-\tfolder\tWed, Dec 18, 1995, 12:04 pm&quot; );  AddToList ( theList, &quot;\pClean System Folder\t-\tfolder\tThu, Dec 7, 1995, 1:46 pm&quot; );  AddToList ( theList, &quot;\pCommunications\t-\tfolder\tWed, Dec 6, 1995, 2:21 pm&quot; );  AddToList ( theList, &quot;\pCopland Stuff\t-\tfolder\tTue, Aug 29, 1995, 1:14 pm&quot; );  AddToList ( theList, &quot;\pDevelopment\t-\tfolder\tWed, Dec 13, 1995, 4:27 pm&quot; );  AddToList ( theList, &quot;\pDocumentation\t-\tfolder\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pDTS\t-\tfolder\tWed, Dec 18, 1995, 1:07 pm&quot; );  AddToList ( theList, &quot;\pMisc\t-\tfolder\tMon, Dec 16, 1995, 8:56 pm&quot; );  AddToList ( theList, &quot;\pProjects\t-\tfolder\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pStress\t-\tfolder\tTue, Aug 29, 1995, 1:14 pm&quot; );  AddToList ( theList, &quot;\pSystem Folder\t-\tfolder\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pSystem Installers\t-\tfolder\tWed, Dec 6, 1995, 2:21 pm&quot; );  AddToList ( theList, &quot;\pSystem Picker\t-\tapplication program\tMon, Dec 16, 1995, 8:56 pm&quot; );  AddToList ( theList, &quot;\pTools\t-\tfolder\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pAppleScript(tm) Utilities\t-\tfolder\tThu, Dec 7, 1995, 12:46 pm&quot; );  AddToList ( theList, &quot;\pDebuggers\t-\tfolder\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pDebugging Modern Memory Manager\t-\tfolder\tMon, Dec 16, 1995, 8:56 pm&quot; );  AddToList ( theList, &quot;\pDebugging OD Part Editors\t33K\tSimpleText document\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pDocumentation Viewers\t-\tfolder\tMon, Dec 16, 1995, 12:56 pm&quot; );  AddToList ( theList, &quot;\pPartMaker 4.3\t-\tfolder\tMon, Dec 16, 1995, 8:56 pm&quot; );  AddToList ( theList, &quot;\pReference\t-\tfolder\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pResource Editors\t5,049K\tfolder\tWed, Dec 6, 1995, 2:21 pm&quot; );  AddToList ( theList, &quot;\pSDK\t-\tfolder\tThu, Dec 19, 1995, 12:07 pm&quot; );  AddToList ( theList, &quot;\pSoundMgr3.2Dev.sea\t198K\tapplication program\tThu, Dec 19, 1995, 12:07 pm&quot; );      return noErr;  } // AddContents//// This is called to create the List Manager list, and initialize it.//static OSErr CreateContentList ( WindowRef theWindow, tContentsProcPtr contentsProc, void* refCon ){  OSErr    theErr;  ListHandle  theList;  Point    cellSize = {0, 0};  Cell    firstCell = {0, 0};  Rect     dataRect = {0, 0, 0, 1};  Rect    viewRect;      // The width of a cell needs to be 32767 so any hiliting  // doesn't stop short of the window width after it's been resized.    viewRect = theWindow-&gt;portRect;  InsetRect ( &amp;viewRect, 20, 20 );  viewRect.right -= 15;        // minus scrollbar width  theList = LNew ( &amp;viewRect, &amp;dataRect, cellSize, kLDEFID, theWindow,             false, false, false, true );  #ifndef USE_LDEF    theErr = PatchListLDEF ( theList );    if ( theErr )      return theErr;  #endif    if ( theList )  {    static short  theOffsets[] = { 4, 0, 100, 134, 200 };        (*theList)-&gt;refCon = (long) &amp;theOffsets;    (*theList)-&gt;selFlags = lOnlyOne;    SetWRefCon ( theWindow, (long) theList );        // Since the calling routine is always in the same architecture type as    // the callback routine, we don't need to worry about any Mixed Mode    // complications. We just treat it as a straight forward routine pointer.    if ( contentsProc )    {      theErr = (*contentsProc) ( theList, refCon );      if ( theErr )        return theErr;    }        LSetSelect ( true, firstCell, theList );        // Now the list has been fully prepared, turn the drawing mode on    LSetDrawingMode ( true, theList );  }    return noErr;  } // CreateContentListvoid DoActivate ( EventRecord* theEvent ){  Boolean    bActiveFlag = theEvent-&gt;modifiers &amp; resumeFlag;  GrafPtr    savePort;  WindowRef  theWindow = (WindowRef) theEvent-&gt;message;      GetPort ( &amp;savePort );  SetPortWindowPort ( theWindow );  LActivate ( bActiveFlag, (ListRef) GetWRefCon ( theWindow ) );  SetPort ( savePort );    return;}void DoUpdate ( EventRecord* theEvent ){  GrafPtr      savePort;  CGrafPtr    thePort;  WindowRef    theWindow = (WindowRef) theEvent-&gt;message;  ListRef      theList = nil;  Rect      theRect;        thePort = GetWindowPort ( theWindow );    GetPort ( &amp;savePort );  SetPortWindowPort ( theWindow );  BeginUpdate ( theWindow );          // visRgn temporarily = updateRgn  EraseRect ( &amp;thePort-&gt;portRect );    theList = (ListRef) GetWRefCon ( theWindow );  if ( theList )  {    PenNormal ( );    GetListRect ( theList, &amp;theRect );    InsetRect ( &amp;theRect, -1, -1 );    FrameRect ( &amp;theRect );        LUpdate ( thePort-&gt;visRgn, theList );  }    EndUpdate ( theWindow );          // restore normal visRgn of grafport  SetPort ( savePort );    return;}void DoContentClick ( WindowRef theWindow, EventRecord* theEvent ){  WindowRef  frontWindow;    // If a movable modal is active, ignore click in an inactive   // window, otherwise select it or handle the content click.    frontWindow = FrontWindow ( );  if ( theWindow != frontWindow )  {    if ( IsMovableModal ( frontWindow ) )      SysBeep ( 30 );    else      SelectWindow ( theWindow );  }  else  {    GrafPtr    savePort;        GetPort ( &amp;savePort );    SetPortWindowPort ( theWindow );    HandleListClick ( theWindow, theEvent );    SetPort ( savePort );  }    return;  } // DoContentClickvoid DoDragWindow ( WindowRef theWindow, EventRecord* theEvent ){  WindowRef  frontWindow;      // If a movable modal is active, ignore click in an inactive   // title bar, otherwise let the Window Manager handle it.    frontWindow = FrontWindow ( );  if ( theWindow != frontWindow &amp;&amp; IsMovableModal ( frontWindow ) )    SysBeep ( 30 );  else                  {    RgnHandle  theRgn;    Rect    dragRect;        theRgn = GetGrayRgn ( );    dragRect = (*theRgn)-&gt;rgnBBox;    DragWindow ( theWindow, theEvent-&gt;where, &amp;dragRect );  }    return;}</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/Tabs_LDEF/listing12.html%3Fid%3DDTS10000621-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/Tabs_LDEF/listing12.html%3Fid%3DDTS10000621-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/Tabs_LDEF/listing12.html%3Fid%3DDTS10000621-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>