<html><head><title>Mac OS X
 Manual Page For B::Deparse(3pm)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3pm/B::Deparse" title="Mac OS X
 Manual Page for B::Deparse(3pm)"><a name="//apple_ref/doc/man/3/B::Deparse" title="Mac OS X
 Manual Page for B::Deparse(3pm)"><!-- headerDoc=man; indexgroup=Section 3pm; uid="//apple_ref/doc/man/3pm/B::Deparse"; name=B::Deparse(3pm) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
B::Deparse(3pm)                       Perl Programmers Reference Guide                       B::Deparse(3pm)



<b>NAME</b>
       B::Deparse - Perl compiler backend to produce perl code

<b>SYNOPSIS</b>
       <b>perl</b> <b>-MO=Deparse</b>[<b>,-d</b>][<b>,-f</b><u>FILE</u>][<b>,-p</b>][<b>,-q</b>][<b>,-l</b>]
               [<b>,-s</b><u>LETTERS</u>][<b>,-x</b><u>LEVEL</u>] <u>prog.pl</u>

<b>DESCRIPTION</b>
       B::Deparse is a backend module for the Perl compiler that generates perl source code, based on the
       internal compiled structure that perl itself creates after parsing a program. The output of
       B::Deparse won't be exactly the same as the original source, since perl doesn't keep track of com-<font color="#ffffff" class="whiteout">ments&nbsp;comments</font>
       ments or whitespace, and there isn't a one-to-one correspondence between perl's syntactical construc-<font color="#ffffff" class="whiteout">tions&nbsp;constructions</font>
       tions and their compiled form, but it will often be close. When you use the <b>-p</b> option, the output
       also includes parentheses even when they are not required by precedence, which can make it easy to
       see if perl is parsing your expressions the way you intended.

       While B::Deparse goes to some lengths to try to figure out what your original program was doing, some
       parts of the language can still trip it up; it still fails even on some parts of Perl's own test
       suite. If you encounter a failure other than the most common ones described in the BUGS section
       below, you can help contribute to B::Deparse's ongoing development by submitting a bug report with a
       small example.

<b>OPTIONS</b>
       As with all compiler backend options, these must follow directly after the '-MO=Deparse', separated
       by a comma but not any white space.

       <b>-d</b>  Output data values (when they appear as constants) using Data::Dumper.  Without this option,
           B::Deparse will use some simple routines of its own for the same purpose. Currently, Data::Dumper
           is better for some kinds of data (such as complex structures with sharing and self-reference)
           while the built-in routines are better for others (such as odd floating-point values).

       <b>-f</b><u>FILE</u>
           Normally, B::Deparse deparses the main code of a program, and all the subs defined in the same
           file. To include subs defined in other files, pass the <b>-f</b> option with the filename. You can pass
           the <b>-f</b> option several times, to include more than one secondary file.  (Most of the time you
           don't want to use it at all.)  You can also use this option to include subs which are defined in
           the scope of a <b>#line</b> directive with two parameters.

       <b>-l</b>  Add '#line' declarations to the output based on the line and file locations of the original code.

       <b>-p</b>  Print extra parentheses. Without this option, B::Deparse includes parentheses in its output only
           when they are needed, based on the structure of your program. With <b>-p</b>, it uses parentheses
           (almost) whenever they would be legal. This can be useful if you are used to LISP, or if you want
           to see how perl parses your input. If you say

               if ($var &amp; 0x7f == 65) {print "Gimme an A!"}
               print ($which ? $a : $b), "\n";
               $name = $ENV{USER} or "Bob";

           "B::Deparse,-p" will print

               if (($var &amp; 0)) {
                   print('Gimme an A!')
               };
               (print(($which ? $a : $b)), '???');
               (($name = $ENV{'USER'}) or '???')

           which probably isn't what you intended (the '???' is a sign that perl optimized away a constant
           value).

       <b>-P</b>  Disable prototype checking. With this option, all function calls are deparsed as if no prototype
           was defined for them. In other words,

               perl -MO=Deparse,-P -e 'sub foo (\@) { 1 } foo @x'

           will print

               sub foo (\@) {
                   1;
               }
               &amp;foo(\@x);

           making clear how the parameters are actually passed to "foo".

       <b>-q</b>  Expand double-quoted strings into the corresponding combinations of concatenation, uc, ucfirst,
           lc, lcfirst, quotemeta, and join. For instance, print

               print "Hello, $world, @ladies, \u$gentlemen\E, \u\L$me!";

           as

               print 'Hello, ' . $world . ', ' . join($", @ladies) . ', '
                     . ucfirst($gentlemen) . ', ' . ucfirst(lc $me . '!');

           Note that the expanded form represents the way perl handles such constructions internally -- this
           option actually turns off the reverse translation that B::Deparse usually does. On the other
           hand, note that "$x = "$y"" is not the same as "$x = $y": the former makes the value of $y into a
           string before doing the assignment.

       <b>-s</b><u>LETTERS</u>
           Tweak the style of B::Deparse's output. The letters should follow directly after the 's', with no
           space or punctuation. The following options are available:

           <b>C</b>   Cuddle "elsif", "else", and "continue" blocks. For example, print

                   if (...) {
                        ...
                   } else {
                        ...
                   }

               instead of

                   if (...) {
                        ...
                   }
                   else {
                        ...
                   }

               The default is not to cuddle.

           <b>i</b><u>NUMBER</u>
               Indent lines by multiples of <u>NUMBER</u> columns. The default is 4 columns.

           <b>T</b>   Use tabs for each 8 columns of indent. The default is to use only spaces.  For instance, if
               the style options are <b>-si4T</b>, a line that's indented 3 times will be preceded by one tab and
               four spaces; if the options were <b>-si8T</b>, the same line would be preceded by three tabs.

           <b>v</b><u>STRING</u><b>.</b>
               Print <u>STRING</u> for the value of a constant that can't be determined because it was optimized
               away (mnemonic: this happens when a constant is used in <b>v</b>oid context). The end of the string
               is marked by a period.  The string should be a valid perl expression, generally a constant.
               Note that unless it's a number, it probably needs to be quoted, and on a command line quotes
               need to be protected from the shell. Some conventional values include 0, 1, 42, '', 'foo',
               and 'Useless use of constant omitted' (which may need to be <b>-sv"'Useless</b> <b>use</b> <b>of</b> <b>constant</b>
               <b>omitted'."</b>  or something similar depending on your shell). The default is '???'.  If you're
               using B::Deparse on a module or other file that's require'd, you shouldn't use a value that
               evaluates to false, since the customary true constant at the end of a module will be in void
               context when the file is compiled as a main program.

       <b>-x</b><u>LEVEL</u>
           Expand conventional syntax constructions into equivalent ones that expose their internal opera-<font color="#ffffff" class="whiteout">tion.&nbsp;operation.</font>
           tion. <u>LEVEL</u> should be a digit, with higher values meaning more expansion. As with <b>-q</b>, this actu-<font color="#ffffff" class="whiteout">ally&nbsp;actually</font>
           ally involves turning off special cases in B::Deparse's normal operations.

           If <u>LEVEL</u> is at least 3, "for" loops will be translated into equivalent while loops with continue
           blocks; for instance

               for ($i = 0; $i &lt; 10; ++$i) {
                   print $i;
               }

           turns into

               $i = 0;
               while ($i &lt; 10) {
                   print $i;
               } continue {
                   ++$i
               }

           Note that in a few cases this translation can't be perfectly carried back into the source code --
           if the loop's initializer declares a my variable, for instance, it won't have the correct scope
           outside of the loop.

           If <u>LEVEL</u> is at least 5, "use" declarations will be translated into "BEGIN" blocks containing
           calls to "require" and "import"; for instance,

               use strict 'refs';

           turns into

               sub BEGIN {
                   require strict;
                   do {
                       'strict'-&gt;import('refs')
                   };
               }

           If <u>LEVEL</u> is at least 7, "if" statements will be translated into equivalent expressions using
           "&amp;&amp;", "?:" and "do {}"; for instance

               print 'hi' if $nice;
               if ($nice) {
                   print 'hi';
               }
               if ($nice) {
                   print 'hi';
               } else {
                   print 'bye';
               }

           turns into

               $nice and print 'hi';
               $nice and do { print 'hi' };
               $nice ? do { print 'hi' } : do { print 'bye' };

           Long sequences of elsifs will turn into nested ternary operators, which B::Deparse doesn't know
           how to indent nicely.

<b>USING</b> <b>B::Deparse</b> <b>AS</b> <b>A</b> <b>MODULE</b>
       <b>Synopsis</b>

           use B::Deparse;
           $deparse = B::Deparse-&gt;new("-p", "-sC");
           $body = $deparse-&gt;coderef2text(\&amp;func);
           eval "sub func $body"; # the inverse operation

       <b>Description</b>

       B::Deparse can also be used on a sub-by-sub basis from other perl programs.

       <b>new</b>

           $deparse = B::Deparse-&gt;new(OPTIONS)

       Create an object to store the state of a deparsing operation and any options. The options are the
       same as those that can be given on the command line (see "OPTIONS"); options that are separated by
       commas after <b>-MO=Deparse</b> should be given as separate strings. Some options, like <b>-u</b>, don't make sense
       for a single subroutine, so don't pass them.

       <b>ambient_pragmas</b>

           $deparse-&gt;ambient_pragmas(strict =&gt; 'all', '$[' =&gt; $[);

       The compilation of a subroutine can be affected by a few compiler directives, <b>pragmas</b>. These are:

          use strict;

          use warnings;

          Assigning to the special variable $[

          use integer;

          use bytes;

          use utf8;

          use re;

       Ordinarily, if you use B::Deparse on a subroutine which has been compiled in the presence of one or
       more of these pragmas, the output will include statements to turn on the appropriate directives. So
       if you then compile the code returned by coderef2text, it will behave the same way as the subroutine
       which you deparsed.

       However, you may know that you intend to use the results in a particular context, where some pragmas
       are already in scope. In this case, you use the <b>ambient_pragmas</b> method to describe the assumptions
       you wish to make.

       Not all of the options currently have any useful effect. See "BUGS" for more details.

       The parameters it accepts are:

       strict
           Takes a string, possibly containing several values separated by whitespace. The special values
           "all" and "none" mean what you'd expect.

               $deparse-&gt;ambient_pragmas(strict =&gt; 'subs refs');

       $[  Takes a number, the value of the array base $[.

       bytes
       utf8
       integer
           If the value is true, then the appropriate pragma is assumed to be in the ambient scope, other-<font color="#ffffff" class="whiteout">wise&nbsp;otherwise</font>
           wise not.

       re  Takes a string, possibly containing a whitespace-separated list of values. The values "all" and
           "none" are special. It's also permissible to pass an array reference here.

               $deparser-&gt;ambient_pragmas(re =&gt; 'eval');

       warnings
           Takes a string, possibly containing a whitespace-separated list of values. The values "all" and
           "none" are special, again. It's also permissible to pass an array reference here.

               $deparser-&gt;ambient_pragmas(warnings =&gt; [qw[void io]]);

           If one of the values is the string "FATAL", then all the warnings in that list will be considered
           fatal, just as with the <b>warnings</b> pragma itself. Should you need to specify that some warnings are
           fatal, and others are merely enabled, you can pass the <b>warnings</b> parameter twice:

               $deparser-&gt;ambient_pragmas(
                   warnings =&gt; 'all',
                   warnings =&gt; [FATAL =&gt; qw/void io/],
               );

           See perllexwarn for more information about lexical warnings.

       hint_bits
       warning_bits
           These two parameters are used to specify the ambient pragmas in the format used by the special
           variables $^H and ${^WARNING_BITS}.

           They exist principally so that you can write code like:

               { my ($hint_bits, $warning_bits);
               BEGIN {($hint_bits, $warning_bits) = ($^H, ${^WARNING_BITS})}
               $deparser-&gt;ambient_pragmas (
                   hint_bits    =&gt; $hint_bits,
                   warning_bits =&gt; $warning_bits,
                   '$['         =&gt; 0 + $[
               ); }

           which specifies that the ambient pragmas are exactly those which are in scope at the point of
           calling.

       <b>coderef2text</b>

           $body = $deparse-&gt;coderef2text(\&amp;func)
           $body = $deparse-&gt;coderef2text(sub ($$) { ... })

       Return source code for the body of a subroutine (a block, optionally preceded by a prototype in
       parens), given a reference to the sub. Because a subroutine can have no names, or more than one name,
       this method doesn't return a complete subroutine definition -- if you want to eval the result, you
       should prepend "sub subname ", or "sub " for an anonymous function constructor. Unless the sub was
       defined in the main:: package, the code will include a package declaration.

<b>BUGS</b>
          The only pragmas to be completely supported are: "use warnings", "use strict 'refs'", "use
           bytes", and "use integer". ($[, which behaves like a pragma, is also supported.)

           Excepting those listed above, we're currently unable to guarantee that B::Deparse will produce a
           pragma at the correct point in the program.  (Specifically, pragmas at the beginning of a block
           often appear right before the start of the block instead.)  Since the effects of pragmas are
           often lexically scoped, this can mean that the pragma holds sway over a different portion of the
           program than in the input file.

          In fact, the above is a specific instance of a more general problem: we can't guarantee to pro-<font color="#ffffff" class="whiteout">duce&nbsp;produce</font>
           duce BEGIN blocks or "use" declarations in exactly the right place. So if you use a module which
           affects compilation (such as by over-riding keywords, overloading constants or whatever) then the
           output code might not work as intended.

           This is the most serious outstanding problem, and will require some help from the Perl core to
           fix.

          If a keyword is over-ridden, and your program explicitly calls the built-in version by using
           CORE::keyword, the output of B::Deparse will not reflect this. If you run the resulting code, it
           will call the over-ridden version rather than the built-in one. (Maybe there should be an option
           to <b>always</b> print keyword calls as "CORE::name".)

          Some constants don't print correctly either with or without <b>-d</b>.  For instance, neither B::Deparse
           nor Data::Dumper know how to print dual-valued scalars correctly, as in:

               use constant E2BIG =&gt; ($!=7); $y = E2BIG; print $y, 0+$y;

          An input file that uses source filtering probably won't be deparsed into runnable code, because
           it will still include the <b>use</b> declaration for the source filtering module, even though the code
           that is produced is already ordinary Perl which shouldn't be filtered again.

          Optimised away statements are rendered as '???'. This includes statements that have a compile-<font color="#ffffff" class="whiteout">time&nbsp;compiletime</font>
           time side-effect, such as the obscure

               my $x if 0;

           which is not, consequently, deparsed correctly.

          There are probably many more bugs on non-ASCII platforms (EBCDIC).

<b>AUTHOR</b>
       Stephen McCamant &lt;smcc@CSUA.Berkeley.EDU&gt;, based on an earlier version by Malcolm Beattie &lt;mbeat-
       tie@sable.ox.ac.uk&gt;, with contributions from Gisle Aas, James Duncan, Albert Dvornik, Robin Houston,
       Dave Mitchell, Hugo van der Sanden, Gurusamy Sarathy, Nick Ing-Simmons, and Rafael Garcia-Suarez.



perl v5.8.8                                      2001-09-21                                  B::Deparse(3pm)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/B__Deparse.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/B__Deparse.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/B__Deparse.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
