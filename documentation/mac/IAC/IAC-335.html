<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Saving Script Data(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING335></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-334.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-336.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-331.html"><B>Chapter 10 - Scripting Components</B></A> / <A HREF="IAC-333.html"><B>Using Scripting Component Routines</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING335-0></A>
<H2><A NAME=MARKER-9-98></A>Saving Script Data</H2>
 After creating a new script (or after modifying a previously saved script), a user may want to save it. <P>
<DL>
<DT><B>IMPORTANT</B>
<DD>Your application should usually save scripts as script data rather       than source data, so that it can reload and execute the data without compiling it.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 Before saving script data, your application can use the <CODE>OSAStore</CODE> function to obtain a handle to the data. The <CODE>OSAStore</CODE> function takes four input parameters: a component instance that identifies a connection with a scripting component, a script ID for the script data to be stored, a desired descriptor type for the descriptor record to be returned, and a parameter that contains mode flags for use by individual scripting components. It returns a descriptor record for the script data in the fifth parameter.<P>
 The sections that follow describe the storage formats used by <CODE>OSAStore</CODE> and the resource and file types for script data.<P>
<A NAME=HEADING335-5></A>
<H3><A NAME=MARKER-9-100></A>Storage Formats for Script Data</H3>
 <A NAME=MARKER-2-101></A>The descriptor record returned by <CODE>OSAStore</CODE> can be either a generic storage descriptor record or a component-specific storage descriptor record:<P>
<UL>
<LI>A <B>generic storage descriptor record</B> is a special kind of descriptor record of type <CODE>typeOSAGenericStorage</CODE> that can be used to store script data created by any scripting component.<A NAME=MARKER-9-78></A>
<LI>A <B>component-specific storage descriptor record</B> is a descriptor record whose descriptor type is the scripting component subtype value for the scripting component that created the script data. <A NAME=MARKER-2-103></A><P>
</UL>
 <A HREF=#MARKER-9-104>Figure 10-1</A> illustrates the logical arrangement of a generic storage descriptor record. The descriptor type for a generic storage descriptor record is always <CODE>typeOSAGenericStorage</CODE>, and the data referred to by the descriptor record's handle is always followed by a trailer containing the subtype value for the scripting component that created the script data. <P>
<B>Figure 10-1  A generic storage descriptor record<A NAME=MARKER-9-104></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SC-L-05.jpg"><P>
 <A HREF=#MARKER-9-105>Figure 10-2</A> illustrates the logical arrangement of a component-specific storage descriptor record. The descriptor type for a component-specific storage descriptor record is the subtype value for the scripting component that created the script data, and the data referred to by the descriptor record's handle consists of the script data only, with no trailer.<P>
<B>Figure 10-2  <A NAME=MARKER-9-105></A>A component-specific storage descriptor record</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/SC-L-06.jpg"><P>
 In most cases it is safest to request a handle to script data in the form of a generic storage descriptor record, regardless of the scripting component subtype you pass to the <CODE>OSAStore</CODE> function.<P>
 <A NAME=MARKER-2-106></A>If the presence of the trailer in a generic storage descriptor record does not interfere with the script data, that data may be used for a wide variety of purposes. For example, if an application uses script IDs to refer to XCMDs, it can call <CODE>OSAStore</CODE> with a desired type of <CODE>typeOSAGenericStorage</CODE>. The data for the resulting descriptor record consists of the XCMD data followed by a trailer indicating that the script data was created by a scripting component that executes XCMDs. Because the trailer does not interfere with the use of the data, the data may actually be used as an XCMD. Thus, an application can save XCMDs as script data and load and execute them after it has opened a connection with the generic scripting component.<P>
 However, in some cases adding a trailer to script data may interfere with script execution. For example, suppose the data for a generic storage descriptor record consists of sound data. If a scripting component attempts to play the data from beginning to end as sound data, the trailer will interfere with the resulting sound. In this case, an application must open an explicit connection with a scripting component that can play sounds before saving the data, and then call <CODE>OSAStore</CODE> with a desired type that consists of the subtype for that scripting component. <A NAME=MARKER-2-107></A><P>
<A NAME=HEADING335-18></A>
<H3>Resource and File Types for Script Data</H3>
 When the <CODE>OSAStore</CODE> function returns a descriptor record of the specified type, your application can save the descriptor record's data as a resource of type <CODE>'scpt'</CODE> or write it to the data fork of a document. <A NAME=MARKER-2-108></A><P>
 The generic scripting component subtype, the generic storage descriptor type, and the resource type for stored script data all have the same value, though they serve different purposes.<P>
<PRE>
CONST
   kOSAGenericScriptingComponentSubtype = 'scpt';   
   kOSAScriptResourceType = kOSAGenericScriptingComponentSubtype;
   typeOSAGenericStorage = kOSAScriptResourceType;
</PRE>
 If you want to save script data as a compiled script file or as a script application, save it as a resource of type <CODE>'scpt'</CODE>. The Script Editor application uses resource ID 128, but you can use any valid resource ID. Save the script comment that accompanies the script data as resources of type <CODE>'TEXT'</CODE> <CODE>and</CODE> <CODE>'styl'</CODE> with resource ID 1128. <A NAME=MARKER-2-215></A>(See <A HREF=IAC-290.html#MARKER-9-14>Figure 7-1 on page 7-6</A> for an example of a script comment.) Each script file can contain only one script and one script comment. The file type for a compiled script file should be <CODE>'osas'</CODE>. <A NAME=MARKER-2-110></A><P>
 A script application has the file type <CODE>'APPL'</CODE>. If a script application has the creator signature <CODE>'aplt'</CODE>, a user can initiate execution of the script it contains by opening it from the Finder. If a script application has the creator signature <CODE>'dplt'</CODE> and contains a user-defined handler for the Open Documents event, a user can initiate execution of the handler by dragging a document or folder icon over the script application's icon. <A NAME=MARKER-2-111></A><A NAME=MARKER-2-112></A>For more information about the file formats used for script files, see <A HREF=IAC-290.html#MARKER-9-11>"Script Editors and Script Files" on page 7-6</A>.<A NAME=MARKER-2-113></A> <A NAME=MARKER-2-114></A><P>
 Script applications must include a <CODE>'SIZE'</CODE> resource and two <CODE>'CODE'</CODE> resources with resource IDs 0 and 1. These resources should be identical to those in the sample script application files provided by Apple Computer, Inc. (except that you can change the size of the memory partition). The <CODE>'CODE'</CODE> resources contain bootstrap code that instantiates the script application component. The <B>script application component,</B> which is registered with the Component Manager at startup, provides the code that loads the script to be run and passes the resulting script ID to the appropriate component.<P>
 When the user opens a script application from the Finder, the Finder sends the script application an Open Application event. If the scripting component that created the script supports <CODE>OSAExecuteEvent</CODE>, the script application component passes the Open Application event and the script ID for the script to <CODE>OSAExecuteEvent</CODE>. If the scripting component doesn't support <CODE>OSAExecuteEvent</CODE>, the script application component passes the script ID to <CODE>OSAExecute</CODE>. <A NAME=MARKER-9-82></A> <A NAME=MARKER-2-116></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-334.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-336.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
