<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"        "http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd"><HTML><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note HW24: Little PowerBook in Slumberland</title>                                       <meta name="categories" content="Hardware"><meta name="week-posted" content="Sep 28, 1992 - Oct 2, 1992"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002493" title="Little PowerBook in Slumberland"></a><a name="top"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxHardwareDrivers-date.html">Hardware & Drivers</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/HardwareDrivers/index.html" target="_blank">Reference Library > Hardware & Drivers</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note HW24</div>
<div id="pageheadsub">Little PowerBook in Slumberland</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->                     <P id = "menutext">         <A HREF="#Section1">The Power Manager</A><BR><BR>  <A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">The purpose of this Note is to describe the ramifications of resting, sleeping,and power-saving modes in the PowerBook family of Macintosh computers, how theymay affect your application, and the appropriate ways to defeat them, whenappropriate. It also describes some nonintuitive ramifications of working witha battery-powered computer.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Oct 01 1992]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR><!-- begin_content --><a name="Section1"></a><h2>The Power Manager</h2><p>In each PowerBook is a separate processor called the Power Manager. Itsfunction is to monitor and control the power consumption and battery chargingof the system. In doing this, it turns on and off various hardware subsystems,changes or stops the CPU's clock speed, watches the battery voltage, and, whencharging, sets the bulk charge or trickle charge modes of the battery chargingcircuit. As you can see, the power draw of the system is a dynamically changingvalue, depending on which subsystems are currently in use, the speed of theprocessor, and whether or not charger circuit power is available. The PowerManager is designed to optimize for the maximum battery life and controls thevarious operating modes in response to user preferences that allow the user tooverride or push back in time the onset of these modes.</p><b>The Many Faces of the Power Manager</b><p>The PowerBook 100 (just like the original portable) has four operating modes:normal, rest, sleep, and shutdown.</p><p>The PowerBook 140 has four operating modes: normal, rest (power cycling),sleep, and shutdown.</p><p>The PowerBook 170 has five operating modes: normal, powersaver, rest (powercycling), sleep, and shutdown.</p><h3>* Normal Mode:</h3><p>In the normal operating mode the CPU is running at its full clock speed. Thereis no interface associated with running in this mode.</p><p>PowerBook 100 and 140: 16 MHz</p><p>PowerBook 170: 25 MHz</p><h3>* Powersaver Mode:</h3><p>PowerBook 100 and 140: This mode is not available.</p><p>PowerBook 170: This mode can be turned on and off from the Battery deskaccessory. When powersaver mode is on, the clock speed is reduced from itsnormal 25 MHz to a less power consumptive 16 MHz.</p><h3>* Rest Mode:</h3><p>After a period of inactivity, the Power Manager will put the system into a restmode.</p><p>Activity is defined as:</p><ul type="circle">	<li>Any call to Read or Write (any I/O activity)</li>	<li>Having an ADB Completion Routine called (moving the mouse or hitting a key on the keyboard, for instance)</li>	<li>Any call to Post Event</li>	<li>Any call to OSEventAvail</li>	<li>Any sound generation</li>	<li>Any call to SetCursor with a new cursor (setting the same cursor does nothing)</li></ul><p>Rest will also not be entered if the cursor is set to the system Watchcursor.</p><p>PowerBook 100: After 15 seconds of inactivity the Power Manager slows theprocessor clock down to an effective 1 MHz by inserting wait states. </p><p>A program can reset the 15-second countdown by calling IdleUpdate and can turnthe countdown off and on with DisableIdle and EnableIdle. IdleUpdate is thepreferred method. From the Finder the user can disable rest mode byOption-clicking the text in the Portable control panel device that says"Minutes Until Automatic Sleep." This brings up a dialog box that allows you toset "Rest" and "Don't Rest." Permanently disabling rest mode <i>will</i> reduceyour battery's available operating time between charging.</p><p>PowerBook 140 and 170: This mode is implemented by using a power-saving methodcalled power cycling. Power cycling reduces the CPU power draw by up to 90percent during idle periods. Power cycling will start after 2 seconds whenthere is no user or input/output activity (screen updates do not count as I/Oactivity) as outlined above in rest mode. The CPU is then turned off. After ashort break ,on the order of 1/2 to 3/4 second, the CPU power is restored. Thesystem checks to see if any activity conditions have been met; if so, powercycling is stopped. If there is no activity, the power cycling time increases asmall amount, up to a few seconds. The CPU will stay off for the power cyclingduration or until an interrupt comes in.</p><p>Power cycling works as follows. The registers of the 68030 and the 68882 aresaved, and power to them is turned off if no input activity is detected. Thepower cycle consists of turning the power to the CPU off and stopping the CPUclock, and then restoring power to the CPU after the varying wait period. Whenpower is back on, the CPU registers are restored and the CPU monitors thesystem for activity.</p><h3>* Sleep Mode:</h3><p>PowerBook 100, 140, and 170: This mode stops processing by bringing the CPUclock to 0 MHz and turning off power to all subsystems except RAM memory andthe Power Manager. Before entering and after leaving sleep mode, the systemcalls entries in the Sleep Queue to allow drivers and other processes toprepare for loss of power and the resetting of devices after power isrestored.</p><p>Sleep mode can be prevented by checking the box labeled "Stay awake whenplugged in" in the Portable control panel device and having the charger adapterof the PowerBook plugged in.</p><h3>* Shutdown Mode:</h3><p>PowerBook 100: Shutdown mode for the 100 is identical to sleep mode except thatthe operating system software must reboot before continuing. </p><p>PowerBook 140 and 170: Shutdown mode for 140 and 170 is the same as turning thepower off on any other (nontransportable) Macintosh. All subsystems are offexcept that there is a vary small drain on the battery to maintain parameterRAM settings.</p><b>Defeating the Rest Mode Is Not Recommended</b><p>Regardless of the power source, the PowerBook is designed always to draw itspower needs from the battery, not directly from an AC outlet. Because of thispower architecture, the battery charge is constantly fluctuating. If thehardware power needs are met, the remaining voltage from the power adapter willtrickle charge the battery. It is important to keep in mind that depending onuse, the PowerBook may require the entire available power, not allowing for thebattery to charge at all. For the PowerBook to recharge fully, the unit must bein either sleep or shutdown mode. One of the primary considerations in thedesign of the PowerBook 170 was power conservation. If the unit is running withthe rest mode defeated, there is a possibility that charging will take longerthan you might expect or you will actually drain your, or your customers,battery or your customers. This is because the Power Adapter is intended forbattery charging and cannot accommodate the needs of a 68030 processor runningat 100 percent speed and a hard disk running 100 percent of the time.</p><P><A HREF="#top">Back to top</A></P><a name="References"></a><h2>References</h2><P><i>Inside Macintosh</i>, Volume VI, Power Manager</p><P>Macintosh PowerBook Family Developer Notes</p><P><A HREF="#top">Back to top</A></P><P><A NAME=Downloads></A></P>                  <H2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (52K)</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/hw_24.pdf">Download</A></P>               </TD>            </TR></table><BR><P><A HREF="#top">Back to top</A></P></TD></TR></TABLE></CENTER><!-- end_content --><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/hw/hw_24.html%3Fid%3DDTS10002493-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/hw/hw_24.html%3Fid%3DDTS10002493-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/hw/hw_24.html%3Fid%3DDTS10002493-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>