<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MyContextReplyProc</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING96></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->




<!-- Main Body -->

<CENTER>
<P>
<A HREF="AppleGuide-95b.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="AppleGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="AppleGuide-240.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="AppleGuide-97.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="AppleGuide-2.html"><B>Apple Guide Complete</B></A> / <A HREF="AppleGuide-55.html"><B>Part 3 - Integrating Guide Files</B></A><BR><DD><A HREF="AppleGuide-56.html"><B>Chapter 9 - Apple Guide API</B></A> / <A HREF="AppleGuide-94.html"><B>Application-Defined Routines</B></A><BR><DL><DD><A HREF="AppleGuide-95b.html"><B>Responding to Context Checks</A></B> / </DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING96-0></A>
<H3>MyContextReplyProc</H3>
 A context check handler checks the condition associated with a context check and returns the result. <P>
 Here is the syntax of a context check handler function:<P>
<PRE>
pascal OSErr MyContextReplyProc
                     (Ptr pInputData, Size inputDataSize,
                     Ptr *ppOutputData,
                     Size *pOutputDataSize,
                     AGAppInfoHdl hAppInfo);
</PRE>
<DL>
<DT><CODE>pInputData</CODE>
<DD> A pointer to the input data. Apple Guide places any parameters specified by the context check in the data area pointed to by this parameter. Apple Guide concatenates the parameters in a byte array (word-aligned); your context check handler function retrieves the data through this parameter. You can cast <CODE>pInputData</CODE> to a pointer to a data structure that describes the parameters specified by your &lt;Define Context Check&gt; command.
<DT><CODE>inputDataSize</CODE>
<DD> The size of the input data in bytes.
<DT><CODE>ppOutputData</CODE>
<DD> Your context check handler function should return, through this parameter, a pointer to a short integer. The short integer should contain the result of the context check, 1 for true and 0 for false. 
<DT><CODE>pOutputDataSize</CODE>
<DD> Your context check handler function should return, through this parameter, the size of the output data in bytes, usually <CODE>sizeof(short)</CODE>.
<DT><CODE>hAppInfo</CODE>
<DD> A handle to a structure of type <CODE>AGAppInfo</CODE>. 
</DL>
<PRE>
            typedef struct AGAppInfo
            {
               AEEventID   eventId;       /*event ID*/
               long        refCon;        /*app's refCon*/
               void        *contextObj;   /*private*/
            }
</PRE>
<DL>
<DT>
<DD> Apple Guide places the event ID and reference constant (specified in the call to <CODE>AGInstallContextHandler</CODE>) into the <CODE>eventId</CODE> and <CODE>refCon</CODE> fields of this structure. The <CODE>eventId</CODE> field corresponds to the value of the <I>codeResSpec</I> parameter in the &lt;Define Context Check&gt; command for this context check. You can use the <CODE>refCon</CODE> field for any purpose. The <CODE>contextObj</CODE> field is used by Apple Guide and your application should not use or change this field.
</DL>
<A NAME=HEADING96-11></A>
<H5>DESCRIPTION</H5>
 Your <CODE>MyContextReplyProc</CODE> function should perform the context check and return the result of the context check through the <CODE>ppOutputData</CODE> parameter.<P>
<A NAME=HEADING96-13></A>
<H5>EXAMPLES</H5>
 Here's an example of a context check installed by the SurfWriter application. The SurfWriter application defines these context checks in its guide file using the &lt;Define Context Check&gt; command:<P>
 &lt;DCC&gt; &quot;SWDictionaryIsOpen&quot;, 'SWdd', 'WAVE', short:1, LPSTRING<BR>&lt;DCC&gt; &quot;SWThesaurusIsOpen&quot;, 'SWdd', 'WAVE', short:2, LPSTRING<P>
 Here's how SurfWriter Guide uses one of these context checks to dynamically adjust the display of its panels:<P>
 &lt;Panel&gt;  &quot;Dictionary:intro&quot;<BR>&lt;Skip If&gt; SWDictionaryIsOpen(&quot;Standard&quot;)<BR>      &lt;Panel&gt;  &quot;Dictionary:open&quot;<BR>&lt;Panel&gt;  &quot;Dictionary:lookupWord&quot;<P>
 The SurfWriter application installs its context check handler using the AG<CODE>InstallContextHandler</CODE> function.<P>
<PRE>
/*gEventID = 'SWdd'*/
myErr = AGInstallContextHandler(SWIsOpenContextCheck, 
                                 gEventID, 
                                 &amp;gRefCon, &amp;gResultRefNum);
</PRE>
 This is how it defines its context check handler function. (A context check in an external module receives the same parameters, but it has a single entry point, main.)<P>
<PRE>
pascal OSErr SWIsOpenContextCheck
                     (Ptr inputDataPtr, Size inputDataSize, 
                      Ptr *ppOutputData, Size *pOutputSize, 
                      AGAppInfoHdl hAppInfo)
{
   Boolean  isOpen   =  false;
   OSErr    myErr    =  noErr;
   /*app-defined structure contains two fields, a short and a string*/
   MyContextCheckParams    myCCParams;

   myCCParams = *((MyContextCheckParams *) inputDataPtr);

   switch (myCCParams.selector)
   {
   case 1:     /*check whether a specified dictionary is open*/
      isOpen = MyCheckDictionary(myCCParams);
      break;
   case 2:     /*check whether a specified thesaurus is open*/
      isOpen = MyCheckThesaurus(myCCParams);
      break;
   default: 
      break;
   }
   /*return result of context check (true or false) in the */
   /* ppOutputData parameter*/
   myErr = MySetContextResult(&amp;isOpen, sizeof(Boolean), 
                               ppOutputData, pOutputSize);
   /*if error occurs, return appropriate function result */
   /* indicating error*/
   return(myErr);
}
OSErr MySetContextResult(void *theData, Size theSize, 
                          Ptr *outMessage, Size *outSize)
{
   Ptr    p;
   
/*the context check routine must return a pointer to a short */
/* in the ppOutputData parameter */
/* (Apple Guide will dispose of the pointer on return)*/
/*(1 = true, 0 = false) indicates the result of the context check*/
/*The routine must also return the size of the ppOutputData */
/* in the pOutputSize parameter*/
   if (p = NewPtr(theSize))
   {
      BlockMove(theData, p, theSize);
      *outSize = theSize;
      *outMessage = p;
      return(noErr);
   }
   else
      return(MemError());
}
</PRE>
<A NAME=HEADING96-23></A>
<H5>RESULT CODES</H5>
 The <CODE>MyContextReplyProc</CODE> function should return <CODE>noErr</CODE> if successful, or an appropriate result code otherwise.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="AppleGuide-95b.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="AppleGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="AppleGuide-240.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="AppleGuide-97.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="AppleGuide-3.html">&copy; Apple Computer, Inc.</A><br>12 JUL 1996</center></font><P>
<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->
</BODY>
</HTML>  
