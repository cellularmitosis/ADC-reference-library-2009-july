<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>GetPPPStatus - /MoreFinderEvents.h</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxNetworking-date.html">Networking</a> &gt; <A HREF="javascript:location.replace('index.html');">GetPPPStatus</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Networking/index.html" target="_blank">Reference Library > Networking</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">GetPPPStatus</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/MoreFinderEvents.h</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/AEHelpers.c</option>
<option value="listing2.html">/AEHelpers.h</option>
<option value="listing3.html">/FinderRegistry.h</option>
<option value="listing4.html">/GetPPPStatus.c</option>
<option value="listing5.html">/MoreFinderEvents.c</option>
<option value="listing6.html">/MoreFinderEvents.h</option>
<option value="listing7.html">/OpenTptPPP.h</option>
<option value="listing8.html">/RAScriptingAdditions.h</option>
<option value="listing9.html">/TrapUtils.c</option>
<option value="listing10.html">/TrapUtils.h</option></select>
				</p>
				</form>
				<p><strong><a href="GetPPPStatus.zip">Download Sample</a></strong> (&#147;GetPPPStatus.zip&#148;, 51.4K)<BR>
<strong><a href="GetPPPStatus.dmg">Download Sample</a></strong> (&#147;GetPPPStatus.dmg&#148;, 116.4K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*  File:    MoreFinderEvents.h  Contains:  Functions to help you build and sending Apple events to the Finder.  Written by: Andy Bachorski    Copyright:  Copyright &copy; 1996-1999 by Apple Computer, Inc., All Rights Reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        7/22/1999  Karl Groethe  Updated for Metrowerks Codewarror Pro 2.1        */#ifndef MOREFINDEREVENTS#define MOREFINDEREVENTS//  System includes#include &lt;Aliases.h&gt;#include &lt;AppleScript.h&gt;#include &lt;Components.h&gt;#include &lt;Folders.h&gt;#include &lt;Icons.h&gt;#include &lt;OSA.h&gt;enum {  kFinderFileType      = 'FNDR',  kFinderCreatorType    = 'MACS'};#ifdef __cplusplusextern &quot;C&quot; {#endifpascal OSErr MFESetSelectionToNone( const AEIdleUPP idleProcUPP );/*  Sets the Finder's selection to nothing by sending it an empty list.*/// *****************************************************************************pascal OSErr MFEChangeFolderViewNewSuite( const FSSpecPtr fssPtr,                      const long viewStyle,                      const AEIdleUPP idleProcUPP );/*  Given an FSSpec to a folder and a view constant value from the view by list  defined in AERegistry.h, send an Apple event to the system 7.5.x Finder asking  it to set the view of the folder's window to the specified style.  Requires that the folder's window be open, otherwise an error is returned  in the reply event.    If your application will receive update event (i.e., it has windows), you must  supply a more complete idle function than the simple idle function included  with this library. It should pass any updated, activate, null, or osEvt events  received to your application's do event routine.*/// *****************************************************************************pascal OSErr MFEChangeFolderViewOldSuite( const FSSpecPtr fssPtr,                      const long viewStyle,                      const AEIdleUPP idleProcUPP );/*  Given an FSSpec to a folder and a view constant value from the view by list  defined in AERegistry.h, send an Apple event to the system 7.1.1/7.1.2 Finder  asking it to set the view of the folder's window to the specified style.    If your application will receive update event (i.e., it has windows), you must  supply a more complete idle function than the simple idle function included  with this library. It should pass any updated, activate, null, or osEvt events  received to your application's do event routine.*/// *****************************************************************************pascal OSErr MFEChangeFolderView( const FSSpecPtr fssPtr,                  const long viewStyle,                  const AEIdleUPP idleProcUPP );/*  Given an FSSpec to a folder and a view constant value from the view by list  defined in AERegistry.h, send an Apple event to the Finder asking it to set  the view of the folder's window to the specified style.  Requires that the folder's window be open, otherwise an error is returned  in the reply event.    If your application will receive update event (i.e., it has windows), you must  supply a more complete idle function than the simple idle function included  with this library. It should pass any updated, activate, null, or osEvt events  received to your application's do event routine.*/// *****************************************************************************pascal OSErr MFEAddCustomIconToItem( const FSSpecPtr fssPtr,                   const Handle theIconSuite,                   const IconSelectorValue iconSelector,                   const AEIdleUPP idleProcUPP );/*    MFEAddCustomIconToItem adds a custom icon, via the Finder, to the item   specified by the fssPtr.   If an UPP to an idle function is provided in the idleProcUPP parameter,  AESend is called with a send mode of kAEWaitReply. If idleProcUPP is set  to nil, kAENoReply will be used for the send mode.  fssPtr      input:  The item to add the custom icon to.  theIconSuite  input:  The handle to the icon suite to install.  iconSelector  input:  An IconSelectorValue specifying which icon types              to add.  idleProcUPP    input:  A UniversalProcPtr for an idle function, or nil.    Result Codes  _____________  noErr            0    No error    paramErr          -50    The value of target or alias parameter, or of both,                    is NIL or odd, or the alias record is corrupt  eLenErr            -92    Buffer too big to send    memFullErr          -108  Not enough room in heap zone    procNotFound        -600  No eligible process with specified descriptor  connectionInvalid      -609  Nonexistent signature or session ID    noUserInteractionAllowed  -610  Background application sends event                    requiring authentication    noPortErr          -903  Client hasn't set 'SIZE' resource to indicate                    awareness of high-level events    destPortErr          -906  Server hasn't set 'SIZE' resource to indicate                    awareness of high-level events, or else is not present    sessClosedErr        -917  The kAEDontReconnect flag in the sendMode parameter                    was set and the server quit, then restarted    errAECoercionFail       -1700  Data could not be coerced to the                     requested Apple event data type    errAEWrongDataType      -1703  Wrong Apple event data type    errAENotAEDesc        -1704  Not a valid descriptor record    errAEBadListItem      -1705  Operation involving a list item failed    errAEEventNotHandled    -1708  Event wasn't handled by an Apple event handler    errAEUnknownSendMode    -1710  Invalid sending mode was passed    errAEWaitCanceled      -1711  User canceled out of wait loop for reply or receipt    errAETimeout        -1712  Apple event timed out    errAEUnknownAddressType    -1716  Unknown Apple event address type    Any error code returned by the event handler of the target application.  ____________*/// *****************************************************************************pascal OSErr MFEGetItemIcon( const FSSpecPtr fssPtr,               const AEIdleUPP idleProcUPP,                   Handle   *theIconSuite );/*    MFEAddCustomIconToItem adds a custom icon, via the Finder, to the item   specified by the fssPtr.   If an UPP to an idle function is provided in the idleProcUPP parameter,  AESend is called with a send mode of kAEWaitReply. If idleProcUPP is set  to nil, kAENoReply will be used for the send mode.  fssPtr      input:  The item to add the custom icon to.  theIconSuite  input:  The handle to the icon suite to install.  iconSelector  input:  An IconSelectorValue specifying which icon types              to add.  idleProcUPP    input:  A UniversalProcPtr for an idle function, or nil.    Result Codes  _____________  noErr            0    No error    paramErr          -50    The value of target or alias parameter, or of both,                    is NIL or odd, or the alias record is corrupt  eLenErr            -92    Buffer too big to send    memFullErr          -108  Not enough room in heap zone    procNotFound        -600  No eligible process with specified descriptor  connectionInvalid      -609  Nonexistent signature or session ID    noUserInteractionAllowed  -610  Background application sends event                    requiring authentication    noPortErr          -903  Client hasn't set 'SIZE' resource to indicate                    awareness of high-level events    destPortErr          -906  Server hasn't set 'SIZE' resource to indicate                    awareness of high-level events, or else is not present    sessClosedErr        -917  The kAEDontReconnect flag in the sendMode parameter                    was set and the server quit, then restarted    errAECoercionFail       -1700  Data could not be coerced to the                     requested Apple event data type    errAEWrongDataType      -1703  Wrong Apple event data type    errAENotAEDesc        -1704  Not a valid descriptor record    errAEBadListItem      -1705  Operation involving a list item failed    errAEEventNotHandled    -1708  Event wasn't handled by an Apple event handler    errAEUnknownSendMode    -1710  Invalid sending mode was passed    errAEWaitCanceled      -1711  User canceled out of wait loop for reply or receipt    errAETimeout        -1712  Apple event timed out    errAEUnknownAddressType    -1716  Unknown Apple event address type    Any error code returned by the event handler of the target application.  ____________*/// *****************************************************************************pascal OSErr MFEGetEveryItemOnDesktop( const AEIdleUPP idleProcUPP,                       AEDescList *objectList );/*  The MFEGetEveryItemOnDesktop function asks the Finder for a list of object  descriptors for every item on the desktop (includes files, folders, and  volumes).  If an UPP to an idle function is provided in the idleProcUPP parameter,  AESend is called with a send mode of kAEWaitReply. If idleProcUPP is set  to nil, kAENoReply will be used for the send mode.  idleProcUPP    input:  A UniversalProcPtr for an idle function, or nil.  objectList    input:  A null AEDesc.  iconSelector  output:  A list containing object descriptors,              or a null AEDesc if an error is encountered.    Result Codes  _____________  noErr            0    No error  paramErr          -50    The value of target or alias parameter, or of both,                    is NIL or odd, or the alias record is corrupt  eLenErr            -92    Buffer too big to send  memFullErr          -108  Not enough room in heap zone  procNotFound        -600  No eligible process with specified descriptor  connectionInvalid      -609  Nonexistent signature or session ID  noUserInteractionAllowed  -610  Background application sends event                    requiring authentication  noPortErr          -903  Client hasn't set 'SIZE' resource to indicate                    awareness of high-level events  destPortErr          -906  Server hasn't set 'SIZE' resource to indicate                    awareness of high-level events, or else is not present  sessClosedErr        -917  The kAEDontReconnect flag in the sendMode parameter                    was set and the server quit, then restarted  errAECoercionFail       -1700  Data could not be coerced to the                    requested Apple event data type    errAEWrongDataType      -1703  Wrong Apple event data type    errAENotAEDesc        -1704  Not a valid descriptor record  errAEBadListItem      -1705  Operation involving a list item failed  errAEEventNotHandled    -1708  Event wasn't handled by an Apple event handler  errAEUnknownSendMode    -1710  Invalid sending mode was passed  errAEWaitCanceled      -1711  User canceled out of wait loop for reply or receipt  errAETimeout        -1712  Apple event timed out  errAEUnknownAddressType    -1716  Unknown Apple event address type  Any error code returned by the event handler of the target application.  ____________*/// *****************************************************************************pascal  OSErr  MFEUpdateItemFSS( const FSSpecPtr fssPtr );/*  Given an FSSpec to an item (file, folder, what ever), send an Apple event to  the Finder asking it to update it's display of the item. For files, shows  things like icon changes. For folders, shows things like new files that have  been added.*/// *****************************************************************************pascal  OSErr  MFEUpdateItemAlias( const AliasHandle aliasHandle );/*  Given an alias to an item (file, folder, what ever), send an Apple event to  the Finder asking it to update it's display of the item. For files, shows  things like icon changes. For folders, shows things like new files that have  been added.*/// *****************************************************************************pascal  OSErr MFEOpenFile( const AEIdleUPP idleProcUPP,                 FSSpec *fssPtr );/*  Given an FSSpec to a file, send an open document event to the  Finder, passing the FSSpec as the direct parameter.*/#ifdef __cplusplus}#endif#ifndef COMPILING_MORE_FINDER_EVENTS#undef pascal#endif#endif//MOREFINDEREVENTS</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/GetPPPStatus/listing6.html%3Fid%3DDTS10000236-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/GetPPPStatus/listing6.html%3Fid%3DDTS10000236-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/GetPPPStatus/listing6.html%3Fid%3DDTS10000236-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>