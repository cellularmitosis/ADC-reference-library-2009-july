<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Recording the Selection of Text Objects(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING323></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-322.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-324.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-316.html"><B>Chapter 9 - Recording Apple Events</B></A> / <A HREF="IAC-321.html"><B>What to Record</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING323-0></A>
<H2>Recording the Selection of Text Objects</H2>
 When your application needs to record a selection that the user has made by dragging through a range of text, it should send itself a Select event that selects a range of characters. For example, a Select event with this direct parameter selects characters 80 through 764:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cChar<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRange<TR>
<TD>  keyAEKeyData<TD>  typeRangeDescriptor<TD>  (see indented record)<TR>
<TD>    keyAERangeStart<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cChar<TR>
<TD>      keyAEContainer<TD>      typeCurrentContainer<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      80<TR>
<TD>    keyAERangeStop<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cChar<TR>
<TD>      keyAEContainer<TD>      typeCurrentContainer<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      764</TABLE>
<P>
 It is sufficient to record such a text selection as a range of characters. However, recording selections in other units can make the corresponding scripts easier to read. If you decide to record text selections in other units, keep these guidelines in mind:<P>
<UL>
<LI>Use the largest whole unit that completely describes the selection.
<LI>Do not mix units.
<LI>Use units appropriate to the method of selection.
<LI>Use logical units rather than units that vary with reformatting.
<LI>Don't try to guess the user's intentions.<P>
</UL>
 The rest of this section provides examples of how to apply these guidelines.<P>
 If you do record text selections in units other than characters, record each selection in terms of the largest whole unit that completely describes the selection. For example, suppose the user selects characters 115 through 170 by dragging. Further, suppose the selected characters are exactly the same as words 33 through 50 and also the same as paragraph 2. In this case your application should send itself a Select event with this direct parameter:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cParagraph<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formAbsolutePosition<TR>
<TD>  keyAEKeyData<TD>  typeLongInteger<TD>  2</TABLE>
<P>
 However, if the selected characters don't match a larger unit exactly--for example, if paragraph 2 is larger than the selection or the selection is a portion of two paragraphs-- use the largest unit available, in this case words. <P>
 For example, a Select event with this direct parameter selects word 33 through word 45: 
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cText<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRange<TR>
<TD>  keyAEKeyData<TD>  typeRangeDescriptor<TD>  (see indented record)<TR>
<TD>    keyAERangeStart<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cWord<TR>
<TD>      keyAEContainer<TD>      typeCurrentContainer<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      33<TR>
<TD>    keyAERangeStop<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cWord<TR>
<TD>      keyAEContainer<TD>      typeCurrentContainer<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      45</TABLE>
<P>
 Do not mix units. You should not send Apple events that define selections like character 2 of word 3 of line 5 of paragraph 2 in document "MyDocument." Instead, define selections as simply as possible; for example, character 45 in the document "MyDocument."<P>
 When the user selects text by double-clicking it, your application should send a Select event that specifies words. For example, your application should send a Select event with this direct parameter when the user double-clicks word 5:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cWord<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formAbsolutePosition<TR>
<TD>  keyAEKeyData<TD>  typeLongInteger<TD>  5</TABLE>
 <P>
 If the user double-clicks word 5 and then extends the selection through word 9, your application should send a Select event with this direct parameter:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cText<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRange<TR>
<TD>  keyAEKeyData<TD>  typeRangeDescriptor<TD>  (see indented record)<TR>
<TD>    keyAERangeStart<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cWord<TR>
<TD>      keyAEContainer<TD>      typeCurrentContainer<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      5<TR>
<TD>    keyAERangeStop<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cWord<TR>
<TD>      keyAEContainer<TD>      typeCurrentContainer<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      9</TABLE>
<P>
 If your application supports selection of a paragraph, for example by clicking the left margin, triple-clicking, or some other action, your application should send a Select event that selects the paragraph. For example, a Select event with this direct parameter selects paragraph 2:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cParagraph<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formAbsolutePosition<TR>
<TD>  keyAEKeyData<TD>  typeLongInteger<TD>  2</TABLE>
<P>
 If your application supports the selection of other units (for instance, cells, rows, and columns in a spreadsheet; embedded graphics in a word processor; or buttons) and if users can select a range of such units, your application should record using those units when appropriate. For example, a Select event with this direct parameter selects row 5 through row 23:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cRow<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formRange<TR>
<TD>  keyAEKeyData<TD>  typeRangeDescriptor<TD>  (see indented record)<TR>
<TD>    keyAERangeStart<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cRow<TR>
<TD>      keyAEContainer<TD>      typeCurrentContainer<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      5<TR>
<TD>    keyAERangeStop<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cRow<TR>
<TD>      keyAEContainer<TD>      typeCurrentContainer<TD>      No data<TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formAbsolutePosition<TR>
<TD>      keyAEKeyData<TD>      typeLongInteger<TD>      23</TABLE>
<P>
 A Select event with this direct parameter selects the second <CODE>'PICT'</CODE> image:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cPICT<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formAbsolutePosition<TR>
<TD>  keyAEKeyData<TD>  typeLongInteger<TD>  2</TABLE>
<BR>When the user chooses a Select All command, your application should send a Select event with this direct parameter to select the contents of the document:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyDirectObject<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cProperty<TR>
<TD>  keyAEContainer<TD>  typeNull<TD>  No data<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formPropertyID<TR>
<TD>  keyAEKeyData<TD>  typeLongInteger<TD>  pContents</TABLE>
<P>
 Units that vary with reformatting, such as lines and pages in a text document, are not as useful as logical units that describe the data more precisely. Whenever possible, use logical units such as character, word, paragraph, section, and so on.<P>
 Don't try to guess the user's intentions. For example, if a selection can be described as either "word 14" or as "the third bold word in paragraph 3," use the simpler description. If you guess the user's intentions, you will be wrong often enough to cause the user to distrust the recording process.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-322.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-324.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
