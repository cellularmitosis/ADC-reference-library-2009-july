<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Key Data for a Unique ID(IM:IC)</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" ="A" NAME="HEADING238"></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-237.html"><IMG ALIGN="BOTTOM" SRC="prev.gif" BORDER="none" HSPACE="20" ALT="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN="BOTTOM" SRC="content.gif" BORDER="none" HSPACE="20" ALT="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN="BOTTOM" SRC="index.gif" BORDER="none" HSPACE="20" ALT="Book Index"></A> <A HREF="IAC-239.html"><IMG ALIGN="BOTTOM" SRC="next.gif" BORDER="none" HSPACE="20" ALT="Next"></A> </CENTER><P>
<FONT SIZE="-1"><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-233.html"><B>Descriptor Records Used in Object Specifier Records</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME="HEADING238-0"></A>
<H2>Key Data for a Unique ID</H2>
 The key data for <CODE>formUniqueID</CODE> consists of a value that identifies an object. This ID must be unique either within the container, at a minimum, or unique across the application. A unique ID can be specified by a descriptor record of any appropriate type; for example, type <CODE>typeInteger</CODE>. <A NAME="MARKER-2-109"></A><P>
<A NAME="HEADING238-2"></A>
<H3>Key Data for Absolute Position</H3>
 The key data for <CODE>formAbsolutePosition</CODE> consists of an integer that specifies either an offset or an ordinal position. For descriptor type <CODE>typeLongInteger</CODE>, the data is either a positive integer, indicating the offset of the requested element from the beginning of the container, or a negative integer, indicating its offset from the end of the container. The first object specifier record shown in <DFN><A HREF="IAC-235.html#MARKER-9-99">Figure 6-2 on page 6-9</A></DFN> specifies <CODE>formAbsolutePosition</CODE> with key data that consists of the positive integer 1.<P>
 For descriptor type <CODE>typeAbsoluteOrdinal</CODE>, the data consists of one of these constants:<CODE><A NAME="MARKER-2-110"></A></CODE> <CODE><A NAME="MARKER-2-383"></A></CODE>
<TABLE BORDER="0" CELLPADDING="3"><TH ALIGN="LEFT">Constant<TH>Meaning<TR>
<TD>kAEFirst<TD>The first element in the specified container <A NAME="MARKER-9-73"></A><TR>
<TD>kAEMiddle<TD>The element in the middle of the specified container <A NAME="MARKER-2-25"></A><TR>
<TD>kAELast<TD>The last element in the specified container <A NAME="MARKER-2-26"></A><TR>
<TD>kAEAny<TD>A single element chosen at random from the specified container<A NAME="MARKER-9-305"></A><TR>
<TD>kAEAll<TD>All the elements in the specified container <A NAME="MARKER-2-386"></A></TABLE>
<P>
 If an object specifier record specifies <CODE>kAEMiddle</CODE> and the number of elements in the container is even, the Apple Event Manager rounds down; for example, the second word would be the "middle" word in a range of four words.<P>
<A NAME="HEADING238-6"></A>
<H3><A NAME="MARKER-9-112"></A>Key Data for Relative Position</H3>
 The key data for <CODE>formRelativePosition</CODE> is specified by a descriptor record of type <CODE>typeEnumerated</CODE> whose data consists of one of these constants: <A NAME="MARKER-2-113"></A>
<TABLE BORDER="0" CELLPADDING="3"><TH ALIGN="LEFT">Constant<TH>Meaning<TR>
<TD>kAENext<TD>The Apple event object after the specified container <A NAME="MARKER-2-338"></A><TR>
<TD>kAEPrevious<TD>The Apple event object before the specified container <A NAME="MARKER-2-30"></A></TABLE>
<P>
 The "container" can be a single Apple event object or a group of Apple event objects; the requested elements are located immediately before or immediately after it, not inside it. <P>
 If your application can locate objects of the same class by absolute position, it can easily locate the same objects by relative position. For example, all applications that support <CODE>formAbsolutePosition</CODE> can easily locate the table immediately after a container specified as another table named "Summary of Sales." <P>
 Some applications may also be able to locate an object of one class before or after an object of another class. For example, a word processor might be able to locate the paragraph immediately after a container specified as a table named "Summary of Sales."<P>
<A NAME="HEADING238-11"></A>
<H3><A NAME="MARKER-9-114"></A>Key Data for a Test</H3>
 The key data for <CODE>formTest</CODE> is specified by either a comparison descriptor record or a logical descriptor record. If your application provides an object-counting function and an object-comparison function in addition to the appropriate object accessor functions, the Apple Event Manager can handle <CODE>formTest</CODE> for you. Some applications may perform tests more efficiently by translating them into the application's own query language. For information about handling tests yourself, see <A HREF="IAC-246.html#MARKER-9-186">"Handling Whose Tests,"</A> which begins on <A HREF="IAC-246.html#MARKER-9-186">page 6-47</A>.  <A NAME="MARKER-2-115"></A> <A NAME="MARKER-2-169"></A><P>
 The container for objects that pass a test can be one or more Apple event objects. The objects specified are those in the container that pass the test specified by the key data. For example, an object specifier record can describe "the first row in which the First Name column equals 'John' and the Last Name column equals 'Chapman' in the table 'MyAddresses' of the database 'SurfDB.'" To resolve such an object specifier record, the Apple Event Manager must evaluate a logical expression that applies the logical operator <CODE>AND</CODE> to two separate comparisons for each row: a comparison of the First Name column to the word "John" and a comparison of the Last Name column to the word "Chapman." <P>
 The Apple Event Manager evaluates comparisons and logical expressions on the basis of the information in comparison descriptor records and logical descriptor records. A <B>comparison descriptor record</B> is a coerced AE record of type <CODE>typeCompDescriptor</CODE> that specifies an Apple event object and either another Apple event object or data for the Apple Event Manager to compare to the first object. The Apple Event Manager can also use the information in a comparison descriptor record to compare elements in a container, one at a time, either to an Apple event object or to data. The data for a comparison descriptor record consists of three keyword-specified descriptor records with the descriptor types and data shown in <A HREF="#MARKER-9-31">Table 6-2</A>.<A NAME="MARKER-2-390"></A>
<TABLE BORDER="0" CELLPADDING="3">
<CAPTION><A NAME="MARKER-9-31"></A>Keyword-specified descriptor records for <CODE>typeCompDescriptor<A NAME="MARKER-9-218"></A></CODE></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAECompOperator<TD>typeType<TD>kAEGreaterThan <A NAME="MARKER-2-35"></A><BR>kAEGreaterThanEquals<BR>kAEEquals<BR>kAELessThan<BR>kAELessThanEquals<BR>kAEBeginsWith<BR>kAEEndsWith<BR>kAEContains<TR>
<TD>keyAEObject1<TD>typeObjectSpecifier<TD>Object specifier data <A NAME="MARKER-2-34"></A><TR>
<TD>&nbsp;<TD>typeObjectBeingExamined<TD>Value of data handle is <CODE>NIL </CODE><TR>
<TD>keyAEObject2<TD>typeObjectSpecifier<TD>Object specifier data for object to be compared <A NAME="MARKER-2-36"></A><TR>
<TD>&nbsp;<TD>typeObjectBeingExamined<TD>Value of data handle is <CODE>NIL</CODE><TR>
<TD>&nbsp;<TD>any other type (<CODE>AEDesc</CODE>)<TD>Data to be compared <A NAME="MARKER-2-300"></A></TABLE>
<P>
 The keyword <CODE>keyAEObject1</CODE> identifies a descriptor record for the element that is currently being compared to the object or data specified by the descriptor record for the keyword <CODE>keyAEObject2</CODE>. Either object can be described by a descriptor record of type <CODE>typeObjectSpecifier</CODE> or <CODE>typeObjectBeingExamined</CODE>. A descriptor record of <CODE>typeObjectBeingExamined</CODE> acts as a placeholder for each of the successive elements in a container when the Apple Event Manager tests those elements one at a time. The keyword <CODE>keyAEObject2</CODE> can also be used with a descriptor record of any other descriptor type whose data is to be compared to each element in a container.<P>
 You don't have to support all the available comparison operators for all Apple event objects; for example, the "begins with" operator probably doesn't make sense for objects of type <CODE>cRectangle</CODE>. It is up to you to decide which comparison operators are appropriate for your application to support, and how to interpret them. <BR>If necessary, you can define your own custom comparison operators. If you think you need to do this, check with the Apple Event Registrar first to find out whether existing definitions of comparison operators or definitions still under development can be adapted to the needs of your application.<P>
 A <B>logical descriptor record</B> is a coerced AE record of type <CODE>typeLogicalDescriptor</CODE> that specifies a logical expression--that is, an expression that the Apple Event Manager evaluates to either <CODE>TRUE</CODE> or <CODE>FALSE</CODE>. The logical expression is constructed from a logical operator (one of the Boolean operators <CODE>AND</CODE>, <CODE>OR</CODE>, or <CODE>NOT</CODE>) and a list of logical terms to which the operator is applied. Each logical term in the list can be either another logical descriptor record or a comparison descriptor record. The Apple Event Manager short-circuits its evaluation of a logical expression as soon as one part of the expression fails a test. For example, if while testing a logical expression such as A <CODE>AND</CODE> B <CODE>AND</CODE> C the Apple Event Manager discovers that A <CODE>AND</CODE> B is not true, it will evaluate the expression to <CODE>FALSE</CODE> without testing C.<P>
 The data for a logical descriptor record consists of two keyword-specified descriptor records with the descriptor types and data shown in <A HREF="#MARKER-9-38">Table 6-3</A>.<A NAME="MARKER-2-118"></A>
<TABLE BORDER="0" CELLPADDING="3">
<CAPTION><A NAME="MARKER-9-38"></A>Keyword-specified descriptor records for <CODE>typeLogicalDescriptor</CODE></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAELogicalOperator<TD>typeEnumerated<TD>kAEAND<BR>kAEOR<BR>kAENOT<TR>
<TD>keyAELogicalTerms<TD><CODE>typeAEList</CODE><TD>One or more comparison or logical descriptor records<A NAME="MARKER-2-39"></A></TABLE>
<P>
 If the logical operator is <CODE>AND</CODE> or <CODE>OR</CODE>, the list can contain any number of logical terms, and the logical operator is applied to all the terms in the list. For example, the logical descriptor data shown in <A HREF="#MARKER-9-121">Figure 6-4 on page 6-22</A> consists of the logical operator <CODE>AND</CODE> and a list of logical terms that contains two comparison descriptor records. The entire logical descriptor record corresponds to the logical expression "the First Name column equals 'John' <CODE>AND</CODE> the Last Name column equals 'Chapman.'" If the logical operator is <CODE>NOT</CODE>, the list must contain a single term. <P>
 <A HREF="#MARKER-9-120">Figure 6-3</A> shows four object specifier records that specify the container hierarchy for the first row in the table "MyAddresses" of the database "SurfDB" that meets a test. The object specifier record at the top of <A HREF="#MARKER-9-120">Figure 6-3</A> specifies the first row contained in the set of rows that form its container. The container for the first row is specified by an object specifier record for a set of rows that meet a test. The two object specifier records at the bottom of <A HREF="#MARKER-9-120">Figure 6-3</A> specify the table named "MyAddresses," which contains the rows to be tested, in the database named "SurfDB." <A NAME="MARKER-9-141"></A><P>
<B>Figure 6-3  <A NAME="MARKER-9-120"></A>The container hierarchy for the first row in a table that meets a test</B><P>
<IMG ALIGN="BOTTOM" SRC="graphics/AE-L-19.jpg"><P>
 The object specifier record in <A HREF="#MARKER-9-120">Figure 6-3</A> for a set of rows that meet a test specifies <CODE>formTest</CODE>. The corresponding key data consists of the logical descriptor record shown in <A HREF="#MARKER-9-121">Figure 6-4</A>, which applies the logical operator <CODE>AND</CODE> to two logical terms: a comparison descriptor record that specifies all the rows in the container (the table "MyAddresses") in which the column named "First Name" equals "John," and another comparison descriptor record that specifies all the rows in which the column named "Last Name" equals "Chapman." A row in the table "MyAddresses" passes the test only if both comparison descriptor records evaluate as <CODE>TRUE</CODE>.<P>
<B>Figure 6-4  <A NAME="MARKER-9-121"></A>A logical descriptor record that specifies a test</B><P>
<IMG ALIGN="BOTTOM" SRC="graphics/AE-L-20.jpg"><P>
 The keyword-specified descriptor records with the keyword <CODE>keyAEObject1</CODE> in <BR><A HREF="#MARKER-9-121">Figure 6-4</A> each consist of an object specifier record that identifies a column by name. The row for each column is specified by a descriptor record of <CODE>typeObjectBeingExamined</CODE>, which acts as a placeholder for each row as the Apple Event Manager tests successive rows in the table. The Apple event object specified by each of these object specifier records consists of a column in the row. The Apple Event Manager (with the help of an object-comparison function) compares the contents of the column in successive rows to the string identified by the keyword <CODE>keyAEObject2</CODE> using the comparison operator identified by the keyword <CODE>keyAECompOperator</CODE>.<A NAME="MARKER-2-122"></A> <A NAME="MARKER-2-57"></A><CODE> <A NAME="MARKER-9-178"></A></CODE><P>
<A NAME="HEADING238-27"></A>
<H3><A NAME="MARKER-9-125"></A>Key Data for a Range</H3>
 <A NAME="MARKER-2-126"></A>The key data for <CODE>formRange</CODE> is specified by a <B>range descriptor record,</B> which is a coerced AE record of type <CODE>typeRangeDescriptor</CODE> that identifies two Apple event objects marking the beginning and end of a range of elements. The data for a range descriptor record consists of two keyword-specified descriptor records with the descriptor types and data shown in <A HREF="#MARKER-9-40">Table 6-4</A>. <A NAME="MARKER-2-127"></A>
<TABLE BORDER="0" CELLPADDING="3">
<CAPTION><A NAME="MARKER-9-40"></A>Keyword-specified descriptor records in a descriptor record of type <CODE>typeRangeDescriptor</CODE><A NAME="MARKER-2-114"></A></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAERangeStart<TD>typeObjectSpecifier<TD>An object specifier record for the first Apple event object in the desired range<TR>
<TD>keyAERangeStop<TD>typeObjectSpecifier<TD>An object specifier record for the last Apple event object in the desired range<A NAME="MARKER-2-200"></A></TABLE>
<P>
 The elements that identify the beginning and end of the range, which are known as <B>boundary objects,</B> do not have to belong to the same object class as the elements in the range itself. If the boundary objects belong to the same object class as the elements in the range, the boundary objects are included in the range. For example, the range of tables specified by boundary elements that are also tables would include the two boundary tables. <A NAME="MARKER-2-128"></A><P>
 The container for boundary objects is usually the same as the container for the entire range, in which case the container for a boundary object can be specified by a placeholder--that is, a descriptor record of type <CODE>typeCurrentContainer</CODE> whose data handle has the value <CODE>NIL</CODE>. <A NAME="MARKER-2-129"></A><P>
 When <CODE>AEResolve</CODE> calls an object accessor function to locate a range of objects, the Apple Event Manager replaces the descriptor record of type <CODE>typeCurrentContainer</CODE> with a token for the container of each boundary object. When using <CODE>AEResolve</CODE> to resolve the object specifier record, your application doesn't need to examine the contents of this token, because the Apple Event Manager keeps track of it. If your application attempts to resolve some or all of the object specifier record without calling <CODE>AEResolve</CODE>, the application may need to examine the token before it can locate the boundary objects. The token provided by the Apple Event Manager for a boundary object's container is a descriptor record of type <CODE>typeToken</CODE> whose data handle refers to a structure of type <CODE>ccntTokenRecord</CODE>.<P>
<PRE>
TYPE ccntTokenRecord = 
RECORD
   tokenClass:    DescType;      {class ID of container }
                                 { represented by token}
   token:         AEDesc;        {token for current container}
END;
</PRE>
 This data type is of interest only if you attempt to resolve an object specifier record for a range without calling <CODE>AEResolve</CODE>. Otherwise, the Apple Event Manager keeps track of the container. <A NAME="MARKER-2-130"></A> <A NAME="MARKER-2-131"></A><P>
</BLOCKQUOTE>
<HR>
<CENTER>
<A HREF="IAC-237.html"><IMG ALIGN="BOTTOM" SRC="prev.gif" BORDER="none" HSPACE="20" ALT="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN="BOTTOM" SRC="content.gif" BORDER="none" HSPACE="20" ALT="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN="BOTTOM" SRC="index.gif" BORDER="none" HSPACE="20" ALT="Book Index"></A> <A HREF="IAC-239.html"><IMG ALIGN="BOTTOM" SRC="next.gif" BORDER="none" HSPACE="20" ALT="Next"></A> </CENTER><P>
<CENTER><FONT SIZE="-1"><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><BR>7 JUL 1996</CENTER></FONT><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
