<html><head><title>Mac OS X
 Manual Page For Test::Harness::Straps(3pm)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3pm/Test::Harness::Straps" title="Mac OS X
 Manual Page for Test::Harness::Straps(3pm)"><a name="//apple_ref/doc/man/3/Test::Harness::Straps" title="Mac OS X
 Manual Page for Test::Harness::Straps(3pm)"><!-- headerDoc=man; indexgroup=Section 3pm; uid="//apple_ref/doc/man/3pm/Test::Harness::Straps"; name=Test::Harness::Straps(3pm) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
Test::Harness::Straps(3pm)            Perl Programmers Reference Guide            Test::Harness::Straps(3pm)



<b>NAME</b>
       Test::Harness::Straps - detailed analysis of test results

<b>SYNOPSIS</b>
         use Test::Harness::Straps;

         my $strap = Test::Harness::Straps-&gt;new;

         # Various ways to interpret a test
         my %results = $strap-&gt;analyze($name, \@test_output);
         my %results = $strap-&gt;analyze_fh($name, $test_filehandle);
         my %results = $strap-&gt;analyze_file($test_file);

         # UNIMPLEMENTED
         my %total = $strap-&gt;total_results;

         # Altering the behavior of the strap  UNIMPLEMENTED
         my $verbose_output = $strap-&gt;dump_verbose();
         $strap-&gt;dump_verbose_fh($output_filehandle);

<b>DESCRIPTION</b>
       <b>THIS</b> <b>IS</b> <b>ALPHA</b> <b>SOFTWARE</b> in that the interface is subject to change in incompatible ways.  It is other-<font color="#ffffff" class="whiteout">wise&nbsp;otherwise</font>
       wise stable.

       Test::Harness is limited to printing out its results.  This makes analysis of the test results diffi-<font color="#ffffff" class="whiteout">cult&nbsp;difficult</font>
       cult for anything but a human.  To make it easier for programs to work with test results, we provide
       Test::Harness::Straps.  Instead of printing the results, straps provide them as raw data.  You can
       also configure how the tests are to be run.

       The interface is currently incomplete.  <u>Please</u> contact the author if you'd like a feature added or
       something change or just have comments.

<b>CONSTRUCTION</b>
       <u>new()</u>

         my $strap = Test::Harness::Straps-&gt;new;

       Initialize a new strap.

       <b>$strap-&gt;_init</b>

         $strap-&gt;_init;

       Initialize the internal state of a strap to make it ready for parsing.

<b>ANALYSIS</b>
       <b>$strap-&gt;analyze(</b> <b>$name,</b> <b>\@output_lines</b> <b>)</b>

           my %results = $strap-&gt;analyze($name, \@test_output);

       Analyzes the output of a single test, assigning it the given $name for use in the total report.
       Returns the %results of the test.  See Results.

       @test_output should be the raw output from the test, including newlines.

       <b>$strap-&gt;analyze_fh(</b> <b>$name</b>, $test_filehandle )

           my %results = $strap-&gt;analyze_fh($name, $test_filehandle);

       Like "analyze", but it reads from the given filehandle.

       <b>$strap-&gt;analyze_file(</b> <b>$test_file</b> <b>)</b>

           my %results = $strap-&gt;analyze_file($test_file);

       Like "analyze", but it runs the given $test_file and parses its results.  It will also use that name
       for the total report.

       <b>$strap-&gt;_command_line(</b> <b>$file</b> <b>)</b>

       Returns the full command line that will be run to test <u>$file</u>.

       <b>$strap-&gt;_</b><u>command()</u>

       Returns the command that runs the test.  Combine this with "_switches()" to build a command line.

       Typically this is $^X, but you can set $ENV{HARNESS_PERL} to use a different Perl than what you're
       running the harness under.  This might be to run a threaded Perl, for example.

       You can also overload this method if you've built your own strap subclass, such as a PHP interpreter
       for a PHP-based strap.

       <b>$strap-&gt;_switches(</b> <b>$file</b> <b>)</b>

       Formats and returns the switches necessary to run the test.

       <b>$strap-&gt;_cleaned_switches(</b> <b>@switches_from_user</b> <b>)</b>

       Returns only defined, non-blank, trimmed switches from the parms passed.

       <b>$strap-&gt;_INC2PERL5LIB</b>

         local $ENV{PERL5LIB} = $self-&gt;_INC2PERL5LIB;

       Takes the current value of @INC and turns it into something suitable for putting onto "PERL5LIB".

       <b>$strap-&gt;_</b><u>filtered</u><b>_</b><u>INC()</u>

         my @filtered_inc = $self-&gt;_filtered_INC;

       Shortens @INC by removing redundant and unnecessary entries.  Necessary for OSes with limited command
       line lengths, like VMS.

       <b>$strap-&gt;_</b><u>restore</u><b>_</b><u>PERL5LIB()</u>

         $self-&gt;_restore_PERL5LIB;

       This restores the original value of the "PERL5LIB" environment variable.  Necessary on VMS, otherwise
       a no-op.

<b>Parsing</b>
       Methods for identifying what sort of line you're looking at.

       <b>"_is_diagnostic"</b>

           my $is_diagnostic = $strap-&gt;_is_diagnostic($line, \$comment);

       Checks if the given line is a comment.  If so, it will place it into $comment (sans #).

       <b>"_is_header"</b>

         my $is_header = $strap-&gt;_is_header($line);

       Checks if the given line is a header (1..M) line.  If so, it places how many tests there will be in
       "$strap-&gt;{max}", a list of which tests are todo in "$strap-&gt;{todo}" and if the whole test was skipped
       "$strap-&gt;{skip_all}" contains the reason.

       <b>"_is_bail_out"</b>

         my $is_bail_out = $strap-&gt;_is_bail_out($line, \$reason);

       Checks if the line is a "Bail out!".  Places the reason for bailing (if any) in $reason.

       <b>"_reset_file_state"</b>

         $strap-&gt;_reset_file_state;

       Resets things like "$strap-&gt;{max}" , "$strap-&gt;{skip_all}", etc. so it's ready to parse the next file.

<b>Results</b>
       The %results returned from "analyze()" contain the following information:

         passing           true if the whole test is considered a pass
                           (or skipped), false if its a failure

         exit              the exit code of the test run, if from a file
         wait              the wait code of the test run, if from a file

         max               total tests which should have been run
         seen              total tests actually seen
         skip_all          if the whole test was skipped, this will
                             contain the reason.

         ok                number of tests which passed
                             (including todo and skips)

         todo              number of todo tests seen
         bonus             number of todo tests which
                             unexpectedly passed

         skip              number of tests skipped

       So a successful test should have max == seen == ok.

       There is one final item, the details.

         details           an array ref reporting the result of
                           each test looks like this:

           $results{details}[$test_num - 1] =
                   { ok          =&gt; is the test considered ok?
                     actual_ok   =&gt; did it literally say 'ok'?
                     name        =&gt; name of the test (if any)
                     diagnostics =&gt; test diagnostics (if any)
                     type        =&gt; 'skip' or 'todo' (if any)
                     reason      =&gt; reason for the above (if any)
                   };

       Element 0 of the details is test #1.  I tried it with element 1 being #1 and 0 being empty, this is
       less awkward.

<b>EXAMPLES</b>
       See <u>examples/mini</u><b>_</b><u>harness.plx</u> for an example of use.

<b>AUTHOR</b>
       Michael G Schwern "&lt;schwern@pobox.com&gt;", currently maintained by Andy Lester "&lt;andy@petdance.com&gt;".

<b>SEE</b> <b>ALSO</b>
       Test::Harness



perl v5.8.8                                      2001-09-21                       Test::Harness::Straps(3pm)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/Test__Harness__Straps.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/Test__Harness__Straps.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/Test__Harness__Straps.3pm.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
