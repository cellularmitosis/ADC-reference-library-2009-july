<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Supporting Printing in Your Carbon Application: Printing Concepts for Carbon Developers</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Printing Concepts for Carbon Developers"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP30000045" title="Printing Concepts for Carbon Developers"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000420" target="_top">Carbon</a> &gt; <a href="../../../Printing-date.html#//apple_ref/doc/uid/TP30000440-TP30000420-TP30000455" target="_top">Printing</a> &gt; <a href="../cpm_chap1/cpm_intro.html#//apple_ref/doc/uid/TP30000044-DontLinkElementID_1">Supporting Printing in Your Carbon Application</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../cpm_chap1/cpm_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../cpm_chap3/cpm_tasks.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_2" title="Printing Concepts for Carbon Developers"></a><h1><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TP9" title="Printing Concepts for Carbon Developers"></a>Printing Concepts for Carbon Developers</h1><p>The Carbon Printing Manager<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_42"></a> is a collection of system software functions that your application can use to print to any type of supported printer. When printing, your application calls the same Carbon Printing Manager functions regardless of the type of printer selected by the user. An application that uses the Carbon Printing Manager can print in Mac OS 8 and 9 with existing printer drivers and in Mac OS X with new printer drivers. </p><p>This chapter provides an overview of the key concepts you need to support printing with the Carbon Printing Manager. It includes the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-CJBHAJFE">“Overview of Printing Terminology”</a></span> defines the more frequently used printing terms.</p></li><li class="li"><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF15">“High-Level Printing Tasks”</a></span> lists the high-level tasks that a Carbon application must to do support printing.</p></li><li class="li"><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF13">“Printing Objects”</a></span> provides information about the data types you use to keep track of user selections and other data related to a print job.</p></li><li class="li"><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF14">“Printing Functions”</a></span> gives an overview of the key functions needed by your application to support printing.</p></li><li class="li"><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-CJBIECAJ">“The Print Loop”</a></span> describes the code that sends a print job to a printer queue.</p></li><li class="li"><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-BACJGBCD">“Sequence, Scope, and Usage”</a></span> provides guidelines for using printing functions.</p></li><li class="li"><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF11">“Page and Paper Rectangles”</a></span> discusses the page and paper boundaries.</p></li><li class="li"><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF16">“If You’ve Used the Old Printing Manager”</a></span> summarizes the differences between the old Printing Manager and the Carbon Printing Manager.</p></li></ul><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBHAJFE" title="Overview of Printing Terminology"></a><h2>Overview of Printing Terminology</h2><p>There are several terms that you’ll see repeatedly in the Carbon Printing Manager documentation: page format, print settings, formatting printer, default printer, and print job.</p><p>Page format<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_43"></a> describes how pages of a document should be printed, and includes such information as paper size and orientation. Although an application can programmatically set up the page format, most applications allow users to set options that control the page format in the Page Setup dialog. </p><p>The default page format settings are determined by the formatting printer. The <strong>formatting printer</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_44"></a> is the one that is displayed in the “Format for” pop-up menu in the Page Setup dialog. The default formatting printer is the generic Any Printer, as shown in the Page Setup dialog in <span class="content_text">Figure 2-1</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_3" title="Figure 1-1The Page Setup Dialog"></a><p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBCJFAH" title="Figure 1-1The Page Setup Dialog"></a><strong>Figure 1-1&nbsp;&nbsp;</strong>The Page Setup Dialog</p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_45"></a><img src = "../art/formatfor.gif" alt = "The Page Setup Dialog" width="388" height="273"></div><br/><p><strong>Print settings</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_46"></a> control the execution of a print job on a specific printer, and include such information as the number of copies, which pages to print, and the number of pages per sheet. As with the page format, an application can programmatically set print settings but usually allows users to open the Print dialog and make print settings instead. <span class="content_text">Figure 2-2</span> shows the Copies &amp; Pages pane of the Print dialog<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_47"></a>.</p><br/><div><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_4" title="Figure 1-2The Copies &amp;amp; Pages pane of the Print dialog"></a><p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBJFIGG" title="Figure 1-2The Copies &amp;amp; Pages pane of the Print dialog"></a><strong>Figure 1-2&nbsp;&nbsp;</strong>The Copies &amp; Pages pane of the Print dialog</p><img src = "../art/print_dialog01.gif" alt = "The Copies &amp; Pages pane of the Print dialog" width="455" height="310"></div><br/><p>The default print settings, as well as any constraints on those values, are determined by the printer module for the default printer. Before the Print dialog opens, the <strong>default printer</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_48"></a> in Mac OS X is the printer that is currently selected in Print Center. In Mac OS 9, it is the printer that is currently selected in the Chooser. <span class="content_text">Figure 2-3</span> shows Print Center with the default printer set to a printer named Kangaroo. </p><br/><div><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_5" title="Figure 1-3Print Center with the default printer set to Kangaroo"></a><p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBEBCHE" title="Figure 1-3Print Center with the default printer set to Kangaroo"></a><strong>Figure 1-3&nbsp;&nbsp;</strong>Print Center with the default printer set to Kangaroo</p><img src = "../art/printer_list.gif" alt = "Print Center with the default printer set to Kangaroo" width="396" height="204"></div><br/><p>A <strong>print job</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_49"></a> consists of two items: </p><ul class="ul"><li class="li"><p>the drawing commands that describe a document</p></li><li class="li"><p>the settings that control printing the document and keep track of it once the job has been added to a printer’s queue</p></li></ul><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF15" title="High-Level Printing Tasks"></a><h2>High-Level Printing Tasks</h2><p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_50"></a>The high-level tasks needed to print in a Carbon application are</p><ul class="ul"><li class="li"><p>setting up the page format</p></li><li class="li"><p>setting up the print settings</p></li><li class="li"><p>printing the job</p></li></ul><p>As you’ll see later in this chapter, Carbon Printing Manager data structures and functions are grouped to support these tasks. </p><p>The way you implement the high-level printing tasks depends on whether the printing tasks are driven by the Page Setup and Print dialogs. In most document-based applications, such as a text editing or drawing application, high-level printing tasks are driven by user interaction with these dialogs. The user can choose Page Setup and Print from the File menu and change settings. A document prints when the user clicks Print in the Print dialog. </p><p>An application can also support printing without requiring a user to open either the Page Setup or Print dialogs. This is common for applications that provide an option for the user to print one copy using default settings. In this case, an application can programmatically set up the page format and print settings, eliminating the need for the user to make settings in either of the printing dialogs<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_51"></a>. You’ll see how to do this in <span class="content_text"><a href="../cpm_chap3/cpm_tasks.html#//apple_ref/doc/uid/TP30000978-TP30000046-BAJECEEI">“Printing One Copy.”</a></span></p><p>Another situation in which your application could bypass the printing dialogs is to provide support for the user to save a document as a portable document format (PDF) file. The default spool file format in Mac OS X is PDF. As a result, it is straightforward for those applications that support printing in Mac OS X (version 10.1 and later) to also support saving a document as a PDF file. You’ll see how to implement this in <span class="content_text"><a href="../cpm_chap3/cpm_tasks.html#//apple_ref/doc/uid/TP30000978-TP30000046-BAJGEBID">“Saving a Document as a PDF File.”</a></span> </p><p>Let’s take a look at what an application needs to do to implement high-level printing tasks in each situation: printing driven by printing dialogs and printing that does not require a user to interact with the printing dialogs.</p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF27" title="When Printing Dialogs Are Required"></a><h3>When Printing Dialogs Are Required</h3><p>If your application lets the user choose Page Setup and Print from the File menu, you need to perform the following to implement each of the high-level printing tasks.</p><p><strong>Setting up the page format.</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_52"></a> The user has the option to choose Page Setup from the File menu and make settings in the Page Setup dialog, but the user is not required to do so. Regardless of whether the user opens the Page Setup dialog, your application must make sure that a document has appropriate page format settings by setting default values. </p><p>If the user opens the Page Setup dialog, your application sets the page format values to defaults and then displays the Page Setup dialog. When the users closes the Page Setup dialog by clicking the OK button, your application should save the page format settings so it can retrieve the settings when the user prints the document. Your application should be able to retrieve the page format even if the document is not printed until the next time the user launches the application.</p><p>If the user opens the Print dialog, your application needs to check for valid page format settings. If there aren’t any, your application sets the page format default values before the Print dialog opens.</p><p><strong>Setting up the print settings.</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_53"></a> Your application needs to set default print settings for the current printer before it opens the Print dialog. When the user clicks Print in the Print dialog your application must invoke the next high-level printing task, which is printing the job.</p><p><strong>Printing the job.</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_54"></a> Your application must determine the number of pages to print, then draw the pages in the range specified by the user.</p><p><span class="content_text"><a href="../cpm_chap3/cpm_tasks.html#//apple_ref/doc/uid/TP30000978-TP30000046-TP9">“Chapter 3, Printing Tasks,”</a></span> provides detailed information and sample code that shows how to implement each high-level printing task when your application uses the Page Setup and Print dialogs. </p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF28" title="When Printing Dialogs Are Not Required "></a><h3>When Printing Dialogs Are Not Required </h3><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_55"></a><p>If your application does not require a user to open either the Page Setup or Print dialogs, it performs the high-level printing tasks sequentially, without interruption. The tasks should be implemented as described here.</p><p><strong>Setting up the page format.</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_56"></a> Your application must make sure that a document has appropriate page format settings. </p><p><strong>Setting up print settings.</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_57"></a> Your application must make sure that a document has appropriate print settings, and that the destination (typically the default printer, but it could be a PDF file or other destination) is set. </p><p><strong>Printing the job.</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_58"></a> Your application must determine the number of pages to print and then draw each page so they are sent to the printer queue or PDF file. Creating a PDF requires that your application set the print destination as a PDF file. This feature is available only in Mac OS X, version 10.1 and later.</p><p>In some cases when an application doesn’t require printing dialogs, it also doesn’t need the printing system to display a printing status dialog. If you want to suppress the printing status dialog, your application needs to use the “No Status Dialog” versions of four of the Carbon Printing functions<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_59"></a>. You’ll see what those functions are and how to call them in <span class="content_text"><a href="../cpm_chap3/cpm_tasks.html#//apple_ref/doc/uid/TP30000978-TP30000046-BAJGEBID">“Saving a Document as a PDF File.”</a></span><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_60"></a></p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF13" title="Printing Objects"></a><h2>Printing Objects</h2><p>The main <a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_61"></a>Carbon Printing Manager objects used to implement the high-level printing tasks are the page format (<code>PMPageFormat)</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_62"></a>, print settings (<code>PMPrintSettings</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_63"></a>), and printing session (<code>PMPrintSession</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_64"></a>) objects. The Carbon Printing Manager hides the underlying implementation of these objects, so you can’t access the contents directly. Instead, you must use Carbon Printing Manager functions to access the internal data stored in these objects. See <span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF14">“Printing Functions”</a></span> for information on the functions most commonly used with these objects. See the <em>Carbon Printing Manager Reference</em> for information on all the printing objects available.</p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF21" title="Page Format Object"></a><h3>Page Format Object</h3><p>The page format object<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_65"></a> (<code>PMPageFormat</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_66"></a>) stores information about how pages of a document should be formatted, such as paper size and orientation. You use the function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreatePageFormat" target="_top">PMCreatePageFormat</a></code> to allocate a page format object and the function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionDefaultPageFormat" target="_top">PMSessionDefaultPageFormat</a></code> to assign default values. Optionally, you can also use the functions <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetPageFormatExtendedData" target="_top">PMSetPageFormatExtendedData</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_67"></a> and <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetPageFormatExtendedData" target="_top">PMGetPageFormatExtendedData</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_68"></a> to store into and retrieve application-specific data from the page format object. </p><p>When the user saves a document, your application should flatten the page format object associated with that document and then save the flattened data with the document. When the user opens the document later, your application can unflatten the page format data and restore it as a page format object. This allows users to resume using their style preferences for printing their documents.</p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF22" title="Print Settings Object"></a><h3>Print Settings Object</h3><p>The print settings object<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_69"></a> (<code>PMPrintSettings</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_70"></a>) stores information from the Print dialog, such as page range and number of copies. You allocate a print settings object by calling the function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreatePrintSettings" target="_top">PMCreatePrintSettings</a></code> and assign default values by calling the function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionDefaultPrintSettings" target="_top">PMSessionDefaultPrintSettings</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_71"></a>. </p><p>Apple recommends that you do not reuse this information if the user prints the document again. The information supplied by the user in the Print dialog should pertain to the document only during a single printing of the document, so there is no need to save the print settings object. The next time the user chooses to print the document, your application should create a new print settings object whose values are set to the defaults.</p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBFAGAJ" title="Printing Session Object"></a><h3>Printing Session Object</h3><p>A printing session object<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_72"></a> (<code>PMPrintSession</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_73"></a>) stores information the printing system uses for a print job. You create a printing session object using the function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreateSession" target="_top">PMCreateSession</a></code>. A printing session object contains information that’s needed by the page format and print settings objects, such as default page format and print settings values. For this reason, some Carbon Printing Manager functions can be called only after you have created a printing session object. For example, setting defaults for or validating page format and print settings objects can only be done after you have created a printing session object. </p><p>In Mac OS X, Carbon applications can create more than one printing session object. This means your application can execute more than one print loop at a time. In Mac OS 8 and 9, you are limited to using one printing session object at any given time.<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_74"></a></p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF14" title="Printing Functions"></a><h2>Printing Functions</h2><p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_75"></a>This section provides an overview of the functions you use to work with the three main printing objects—page format, print settings, and printing session. The <em>Inside Mac OS X: Carbon Printing Manager Reference</em> provides a complete reference for the functions available to support printing in your application. </p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF19" title="Functions Used With a Page Format Object"></a><h3>Functions Used With a Page Format Object</h3><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-CHDBDFEA">Table 2-1</a></span> shows some of the accessors and other functions<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_76"></a> available to work with a page format object, which is used to store information displayed in the Page Setup dialog. Applications typically store page format information with a document, and also maintain the information between calls to display the Page Setup dialog, because users expect changes made in the Page Setup dialog to persist with a specific document. The table describes the functions used to create a page format object, set it to default values, validate it against information in the current printing session object, extract information from it, and so on.</p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_6" title="Table 1-1Functions for working with a page format object "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CHDBDFEA" title="Table 1-1Functions for working with a page format object "></a><strong>Table 1-1&nbsp;&nbsp;</strong>Functions for working with a page format object </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Function</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreatePageFormat" target="_top">PMCreatePageFormat</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_77"></a></p></td><td ><p>Allocates a new page format object. Increments the reference count to 1.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMRelease" target="_top">PMRelease</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_78"></a></p></td><td ><p>Decrements the reference count for a printing object (such as an instance of page format data type). When an object’s reference count reaches 0, the object is deallocated.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionDefaultPageFormat" target="_top">PMSessionDefaultPageFormat</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_79"></a></p></td><td ><p>Assigns default parameter values to an existing page format object. The default values are obtained from the specified printing session object, and specify the page format for the generic (“Any printer”) printer.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionValidatePageFormat" target="_top">PMSessionValidatePageFormat</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_80"></a></p></td><td ><p>Validates a page format object against the specified printing session object. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMFlattenPageFormat" target="_top">PMFlattenPageFormat</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_81"></a></p></td><td ><p>Flattens a page format object for storage in a user document or other location.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMUnflattenPageFormat" target="_top">PMUnflattenPageFormat</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_82"></a></p></td><td ><p>Creates a page format object from a flattened representation produced previously by <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMFlattenPageFormat" target="_top">PMFlattenPageFormat</a></code>. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetPageFormatExtendedData" target="_top">PMGetPageFormatExtendedData</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_83"></a><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_84"></a></p></td><td ><p>Obtains extended page format data for the application.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetPageFormatExtendedData" target="_top">PMSetPageFormatExtendedData</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_85"></a></p></td><td ><p>Sets extended page format data for the application.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetAdjustedPageRect" target="_top">PMGetAdjustedPageRect</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_86"></a></p></td><td ><p>Obtains the page size, taking into account orientation, application drawing resolution, and scaling settings. Outside of this page rectangle all drawing operations are clipped.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetUnadjustedPageRect" target="_top">PMGetUnadjustedPageRect</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_87"></a></p></td><td ><p>Obtains the page size, but does not take into account adjustments for orientation, application drawing resolution, and scaling settings. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetAdjustedPaperRect" target="_top">PMGetAdjustedPaperRect</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_88"></a></p></td><td ><p>Obtains the paper size, taking into account orientation, application drawing resolution, and scaling settings. This is the full sheet of paper, including the margins beyond the page rectangle.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetUnadjustedPaperRect" target="_top">PMGetUnadjustedPaperRect</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_89"></a></p></td><td ><p>Obtains the paper size, but does not take into account orientation, application drawing resolution, and scaling settings.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetScale" target="_top">PMGetScale</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_90"></a><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_91"></a></p></td><td ><p>Obtains the scaling factor currently applied to the page and paper rectangles. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetScale" target="_top">PMSetScale</a></code></p></td><td ><p>Sets the scaling factor currently applied to the page and paper rectangles.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetOrientation" target="_top">PMGetOrientation</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_92"></a></p></td><td ><p>Obtains the current setting for page orientation.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetOrientation" target="_top">PMSetOrientation</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_93"></a></p></td><td ><p>Sets the current setting for page orientation.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSetResolution" target="_top">PMSetResolution</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_94"></a></p></td><td ><p>Sets the application drawing resolution.</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF20" title="Functions Used With a Print Settings Object"></a><h3>Functions Used With a Print Settings Object</h3><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-CHDGJJHE">Table 2-2</a></span> shows some of the accessor functions<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_95"></a> available to work with a print settings object, which is used to store information displayed in the Print dialog. Applications typically don’t store print settings information because users expect the Print dialog to show default values. The table describes functions used to create a print settings object, set it to default values, validate it against information in the current printing session object, extract information from it, and so on.</p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_7" title="Table 1-2Functions for working with a print settings object "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CHDGJJHE" title="Table 1-2Functions for working with a print settings object "></a><strong>Table 1-2&nbsp;&nbsp;</strong>Functions for working with a print settings object </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Function</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreatePrintSettings" target="_top">PMCreatePrintSettings</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_96"></a></p></td><td ><p>Allocates a new print settings object. Increments the reference count to 1.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMRelease" target="_top">PMRelease</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_97"></a></p></td><td ><p>Decrements the reference count for a printing object (such as an instance of print settings data type). When an object’s reference count reaches 0, the object is deallocated.</p></td></tr><tr><td  scope="row"><p><code>PMSessionDefaultPrintSettings</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_98"></a></p></td><td ><p>Assigns default parameter values to an existing print settings object. The default values are obtained from the specified printing session object.</p></td></tr><tr><td  scope="row"><p><code>PMSessionValidatePrintSettings</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_99"></a></p></td><td ><p>Validates a print settings object against the specified printing session object.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMFlattenPrintSettings" target="_top">PMFlattenPrintSettings</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_100"></a></p></td><td ><p>Flattens a print settings object for storage in a user document or other location. (Apple recommends that you do not save print settings.)</p></td></tr><tr><td  scope="row"><p><code>PMUnflattenPrintSettings</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_101"></a></p></td><td ><p>Creates a print settings object from a flattened representation produced previously by <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMFlattenPrintSettings" target="_top">PMFlattenPrintSettings</a></code>. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetPrintSettingsExtendedData" target="_top">PMGetPrintSettingsExtendedData</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_102"></a></p></td><td ><p>Obtains extended print settings data for the application.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetPrintSettingsExtendedData" target="_top">PMSetPrintSettingsExtendedData</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_103"></a></p></td><td ><p>Sets extended print settings data for the application.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetCopies" target="_top">PMGetCopies</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_104"></a></p></td><td ><p>Obtains the number of copies that the user has requested to be printed.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetCopies" target="_top">PMSetCopies</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_105"></a></p></td><td ><p>Sets the number of copies that the user has requested to be printed.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetFirstPage" target="_top">PMSetFirstPage</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_106"></a></p></td><td ><p>Sets the default page number of the first page to be printed, as displayed in the Print dialog.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetFirstPage" target="_top">PMGetFirstPage</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_107"></a></p></td><td ><p>Obtains the page number entered by the user in the From field of the Print dialog</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetLastPage" target="_top">PMSetLastPage</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_108"></a></p></td><td ><p>Sets the default page number of the last page to be printed, as displayed in the Print dialog.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetLastPage" target="_top">PMGetLastPage</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_109"></a></p></td><td ><p>Obtains the page number entered by the user in the To field of the Print dialog</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSetPageRange" target="_top">PMSetPageRange</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_110"></a></p></td><td ><p>Sets the valid range of pages that can be printed. In Mac OS X, these values appear as the default values in the To and From fields of the Print dialog. In Mac OS 8 and 9, this function has no effect on the values that appear in the To and From fields.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetPageRange" target="_top">PMGetPageRange</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_111"></a></p></td><td ><p>Obtains the valid range of pages than can be printed. </p></td></tr></table></div><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF18" title="Functions Used With a Printing Session Object"></a><h3>Functions Used With a Printing Session Object</h3><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-BGBJCEFE">Table 2-3</a></span> shows some of the accessors and other functions<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_112"></a> available to work with a printing session object, which contains information the printing system uses for a specific print job. An application typically creates a printing session object as needed (such as before displaying the Page Setup or Print dialog) and releases it when it is no longer needed (such as when the Page Setup dialog is dismissed by the user or when the print loop has completed).<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_113"></a></p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_8" title="Table 1-3Functions for working with a printing session object "></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/TP30000978-TP30000045-BGBJCEFE" title="Table 1-3Functions for working with a printing session object "></a><strong>Table 1-3&nbsp;&nbsp;</strong>Functions for working with a printing session object </caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Function</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Description</p></th></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreateSession" target="_top">PMCreateSession</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_114"></a></p></td><td ><p>Allocates a printing session object and initializes with values for the current print job. Increments the reference count to 1. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMRelease" target="_top">PMRelease</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_115"></a></p></td><td ><p>Decrements the reference count for a printing object (such as an instance of a printing session object). When an object’s reference count reaches 0, the object is deallocated.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/CarbonPrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSessionBeginDocument" target="_top">PMSessionBeginDocument</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_116"></a></p></td><td ><p>Begins a print job. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionEndDocument" target="_top">PMSessionEndDocument</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_117"></a></p></td><td ><p>Ends the print job that was started with <code><a href="../../../Reference/CarbonPrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSessionBeginDocument" target="_top">PMSessionBeginDocument</a></code>. </p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionBeginPage" target="_top">PMSessionBeginPage</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_118"></a></p></td><td ><p>Informs the printing system that the drawing that follows is part of a new page.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionEndPage" target="_top">PMSessionEndPage</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_119"></a></p></td><td ><p>Completes drawing the current page.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionGetCurrentPrinter" target="_top">PMSessionGetCurrentPrinter</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_120"></a></p></td><td ><p>Obtains a reference to the printer object (<code>PMPrinter</code>) for the current printer (not the formatting printer).</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionGetDataFromSession" target="_top">PMSessionGetDataFromSession</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_121"></a><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_122"></a></p></td><td ><p>Obtains the data the application previously stored in a printing session object.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionSetDataInSession" target="_top">PMSessionSetDataInSession</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_123"></a></p></td><td ><p>Sets the data the application previously stored in a printing session object.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSessionGetGraphicsContext" target="_top">PMSessionGetGraphicsContext</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_124"></a></p></td><td ><p>Obtains the graphics context associated with the current page.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionPageSetupDialog" target="_top">PMSessionPageSetupDialog</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_125"></a></p></td><td ><p>Displays the Page Setup dialog and records the user’s selections in a page format object.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionPrintDialog" target="_top">PMSessionPrintDialog</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_126"></a></p></td><td ><p>Displays the Print dialog and records the user’s selections in a print settings object.</p></td></tr><tr><td  scope="row"><p><code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionUseSheets" target="_top">PMSessionUseSheets</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_127"></a></p></td><td ><p>Specifies that a printing dialog be displayed as a sheet (that is, attached to the window of the document being printed). Sheets are displayed only in Mac OS X. This function returns the result <code>kPMNotImplemented</code> in Mac OS 8 and 9.</p></td></tr></table></div><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBIECAJ" title="The Print Loop"></a><h2>The Print Loop</h2><p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_128"></a>The <strong>print loop</strong> is your application’s code that calls all the necessary functions to print a selected page range of a document. It is called a print loop because it loops to print each page in the range. The print loop and the Print dialog must use the same printing session object. </p><p>The pseudocode<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_129"></a> in <span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-CJBBJFFH">Listing 2-1</a></span> shows the calls a typical print loop might make, with the calls divided among Carbon Printing Manager functions, other Carbon functions, and application-defined functions. Not all error handling is shown, but the print loop should check for errors after each call that may return one.</p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_9" title="Listing 1-1Pseudocode for a print loop function"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBBJFFH" title="Listing 1-1Pseudocode for a print loop function"></a><strong>Listing 1-1&nbsp;&nbsp;</strong>Pseudocode for a print loop function</p><div class="codesample"><table><tr><td scope="row"><pre>AppPagesInDoc (application-defined function to verify a valid page range)<span></span></pre></td></tr><tr><td scope="row"><pre>PMGetFirstPage (gets the number of the first page to be printed)<span></span></pre></td></tr><tr><td scope="row"><pre>PMGetLastPage (gets the number of the last page to be printed)<span></span></pre></td></tr><tr><td scope="row"><pre>(now know how many pages to print in the print loop)<span></span></pre></td></tr><tr><td scope="row"><pre>PMSetLastPage (sets the last page in the print job; used for status dialog)<span></span></pre></td></tr><tr><td scope="row"><pre>PMSessionBeginDocument (begin a new print job)<span></span></pre></td></tr><tr><td scope="row"><pre>    (for each page to be printed)<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionError (check for an error before starting a new page;<span></span></pre></td></tr><tr><td scope="row"><pre>                    if error, break out of loop)<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionBeginPage (prepare to print the current page)<span></span></pre></td></tr><tr><td scope="row"><pre>        PMSessionGetGraphicsContext (get the printing port)<span></span></pre></td></tr><tr><td scope="row"><pre>        SetPort (set current drawing port to the printing port)<span></span></pre></td></tr><tr><td scope="row"><pre>        AppDrawPage (application-defined function to draw one page)<span></span></pre></td></tr><tr><td scope="row"><pre>        SetPort (restore saved port)<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionEndPage (finish printing the current page)<span></span></pre></td></tr><tr><td scope="row"><pre>PMSessionEndDocument (end the print job)<span></span></pre></td></tr><tr><td scope="row"><pre>AppPostPrintingErrors (application-defined function to display<span></span></pre></td></tr><tr><td scope="row"><pre>                                error message, if any, to the user)<span></span></pre></td></tr><tr><td scope="row"><pre>PMRelease (release the print settings and printing session objects)<span></span></pre></td></tr></table></div><p>You’ll notice that very few of the functions called in the print loop are application-defined functions—most are Carbon Printing Manager functions or other Carbon functions. Your application supplies functions only to determine the maximum number of pages in its document, to draw the pages to be printed, and to display error messages (if any). See <span class="content_text"><a href="../cpm_chap3/cpm_tasks.html#//apple_ref/doc/uid/TP30000978-TP30000046-TPXREF10">“Writing the Print Loop”</a></span> for more information.<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_130"></a></p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-BACJGBCD" title="Sequence, Scope, and Usage"></a><h2>Sequence, Scope, and Usage</h2><p>The Carbon Printing Manager enforces a sequence<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_131"></a> of steps in the print loop, and defines a valid scope<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_132"></a> for each printing function. This means that your application must call certain functions before calling others. Functions used out of sequence return the result code <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/kPMOutOfScope" target="_top">kPMOutOfScope</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_133"></a>.</p><p>Here are the basic rules for sequence, scope, and usage:</p><ul class="ul"><li class="li"><p>If you create an object, you must release it. You can pass any Carbon Printing Manager object to the function <code>PMRelease</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_134"></a> to release it.</p></li><li class="li"><p>A printing session object is created after a successful call to <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreateSession" target="_top">PMCreateSession</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_135"></a> and is released by calling <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMRelease" target="_top">PMRelease</a></code>. Some Carbon Printing Manager functions must only be called between these two calls. </p></li><li class="li"><p>Any function whose name begins with <code>PMSession</code> can only be called between the creation and release of a printing session object<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_136"></a>.</p></li><li class="li"><p>Any function whose name includes <code><!--a-->Begin<!--/a--></code> (such as <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionBeginPage" target="_top">PMSessionBeginPage</a></code>) must be called before the corresponding <code>End</code> function (such as <code>PMSessionEndPage</code>). </p></li><li class="li"><p>An <code>End</code> function must be called if the corresponding <code><!--a-->Begin<!--/a--></code> function returns <code>noErr</code>, even if errors occur within the scope of the <code><!--a-->Begin<!--/a--></code> and <code>End</code> functions.</p></li><li class="li"><p>You can call the functions <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionBeginPage" target="_top">PMSessionBeginPage</a></code> and <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionEndPage" target="_top">PMSessionEndPage</a></code> only within the scope of calls to <code><a href="../../../Reference/CarbonPrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSessionBeginDocument" target="_top">PMSessionBeginDocument</a></code> and <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionEndDocument" target="_top">PMSessionEndDocument</a></code>.</p></li><li class="li"><p>The function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSessionGetGraphicsContext" target="_top">PMSessionGetGraphicsContext</a></code> can be called only with the scope of calls to <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionBeginPage" target="_top">PMSessionBeginPage</a></code> and <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionEndPage" target="_top">PMSessionEndPage</a></code>. </p></li><li class="li"><p>If you want to use sheets, you must call the function <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionUseSheets" target="_top">PMSessionUseSheets</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_137"></a> before you call the functions <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionPageSetupDialog" target="_top">PMSessionPageSetupDialog</a></code> or <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionPrintDialog" target="_top">PMSessionPrintDialog</a></code>. (Sheets are available only in Mac OS X.)</p></li></ul><p><span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-CJBJCEDC">Listing 2-2</a></span> shows a typical calling sequence for code that sets print settings and sends a print job to a printer. The call to <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMRelease" target="_top">PMRelease</a></code> applies to the printing session object created by the function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreateSession" target="_top">PMCreateSession</a></code>. </p><p>In general, functions may be called in any order with respect to other functions at the same or lower scope level (represented in <span class="content_text">Listing 2-2</span> by indentation). For example, you can call <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSessionGetGraphicsContext" target="_top">PMSessionGetGraphicsContext</a></code> only within the scope of a call to <code><a href="../../../Reference/CarbonPrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionBeginPage" target="_top">PMSessionBeginPage</a></code>, which in turn must be within the scope of a call to <code><a href="../../../Reference/CarbonPrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSessionBeginDocument" target="_top">PMSessionBeginDocument</a></code>. But within the scope of a call to <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreateSession" target="_top">PMCreateSession</a></code>, you can call <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionDefaultPageFormat" target="_top">PMSessionDefaultPageFormat</a></code> and <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMSessionDefaultPrintSettings" target="_top">PMSessionDefaultPrintSettings</a></code> in any order.</p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_10" title="Listing 1-2Typical calling sequence for code that adjusts print settings and then prints a document"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBJCEDC" title="Listing 1-2Typical calling sequence for code that adjusts print settings and then prints a document"></a><strong>Listing 1-2&nbsp;&nbsp;</strong>Typical calling sequence for code that adjusts print settings and then prints a document</p><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_138"></a><div class="codesample"><table><tr><td scope="row"><pre>PMCreateSession<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionDefaultPrintSettings<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionValidatePrintSettings<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionDefaultPageFormat<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionValidatePageFormat<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionUseSheets<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionPrintDialog<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionBeginDocument<span></span></pre></td></tr><tr><td scope="row"><pre>        PMSessionBeginPage<span></span></pre></td></tr><tr><td scope="row"><pre>            PMSessionGetGraphicsContext<span></span></pre></td></tr><tr><td scope="row"><pre>        PMSessionEndPage<span></span></pre></td></tr><tr><td scope="row"><pre>    PMSessionEndDocument<span></span></pre></td></tr><tr><td scope="row"><pre>PMRelease<span></span></pre></td></tr></table></div><p>The following list shows some of the printing functions that do not need to be called between the creation and release of a printing session object. Many of these functions are used in the sample code in <span class="content_text"><a href="../cpm_chap3/cpm_tasks.html#//apple_ref/doc/uid/TP30000978-TP30000046-TP9">“Printing Tasks.”</a></span> Note however, that the functions with an asterisk (*) must be called before a call to the function <code><a href="../../../Reference/CarbonPrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSessionBeginDocument" target="_top">PMSessionBeginDocument</a></code> or before you display the Print dialog.</p><div class="codesample"><table><tr><td scope="row"><pre>PMCreatePageFormat*<span></span></pre></td></tr><tr><td scope="row"><pre>PMCreatePrintSettings*<span></span></pre></td></tr><tr><td scope="row"><pre>PMFlattenPageFormat*<span></span></pre></td></tr><tr><td scope="row"><pre>PMUnflattenPageFormat*<span></span></pre></td></tr><tr><td scope="row"><pre>PMGetPageFormatExtendedData*<span></span></pre></td></tr><tr><td scope="row"><pre>PMSetPageFormatExtendedData*<span></span></pre></td></tr><tr><td scope="row"><pre>PMGetUnadjustedPaperRect<span></span></pre></td></tr><tr><td scope="row"><pre>PMGetUnadjustedPageRect<span></span></pre></td></tr><tr><td scope="row"><pre>PMGetOrientation<span></span></pre></td></tr><tr><td scope="row"><pre>PMSetOrientation*<span></span></pre></td></tr><tr><td scope="row"><pre>PMFlattenPrintSettings<span></span></pre></td></tr><tr><td scope="row"><pre>PMUnflattenPrintSettings*<span></span></pre></td></tr><tr><td scope="row"><pre>PMGetPageRange<span></span></pre></td></tr><tr><td scope="row"><pre>PMSetPageRange*<span></span></pre></td></tr><tr><td scope="row"><pre>PMGetResolution<span></span></pre></td></tr><tr><td scope="row"><pre>PMSetResolution*<span></span></pre></td></tr></table></div><p>The functions <code>PMGetAdjustedPaperRect</code> and <code>PMGetAdjustedPageRect</code> also do not need to be called between the creation and release of a printing session object, but it is currently required that you call <code>PMSessionValidatePageFormat</code> before you call either function. Validating a page format object causes the printing system to calculate the adjusted page and paper rectangles. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_11" title="Note"></a><p><strong>Note:</strong>&nbsp;When a user makes any change that can affect the adjusted rectangles, such as changes to the orientation, scaling, or resolution, the changes are recorded in the page format object but the adjusted rectangles may not be immediately calculated. The adjusted rectangles may only be calculated when you call the function <code>PMSessionValidatePageFormat</code>.</p></div><p>You can find out more about each function, including when to use it, in the <em>Inside Mac OS X: Carbon Printing Manager Reference</em>.</p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF11" title="Page and Paper Rectangles"></a><h2>Page and Paper Rectangles</h2><p>The page and paper rectangles define the paper sheet size<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_139"></a> and imageable area<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_140"></a> for your application's printed page. If you are new to Mac OS X, you should read this section. (Mac OS X uses the same definitions for these rectangles as those used for the old Printing Manager in Mac OS 9.) This section provides the information you need to write a function that draws a single page of a document for your application. It describes the page and paper rectangles and the relationship between them, the adjusted page and paper rectangles, and the margins for the imageable area of the sheet.</p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF23" title="Page Rectangle"></a><h3>Page Rectangle</h3><p>The page rectangle<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_141"></a> is the area of the page to which an application can draw. The coordinates for the upper-left corner of the page rectangle are (0,0), as shown in <span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF17">Figure 2-4</a></span>. The coordinates of the lower-right corner specify the maximum page height and width attainable on the given printer for this page format. Anything drawn outside of the page rectangle is clipped. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_12" title="Note"></a><p><strong>Note:</strong>&nbsp;The printing system records all drawing commands, even if they draw to the area outside the page rectangle. At print time items outside the page rectangle might be clipped by the printing system.</p></div><p>The width and height of the drawing area are determined by a number of factors—the user’s settings for orientation<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_142"></a> and scaling<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_143"></a> as well as the resolution your application sets by calling the function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/PMSetResolution" target="_top">PMSetResolution</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_144"></a>. In all cases, the size of the drawing area<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_145"></a> is limited by the lower-right corner of the page rectangle. <span class="content_text">Figure 2-4</span> shows the page rectangle for generic letter-size paper, at 72 dpi, 100% scaling, and portrait orientation. </p><br/><div><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_13" title="Figure 1-4Page and paper rectangles"></a><p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF17" title="Figure 1-4Page and paper rectangles"></a><strong>Figure 1-4&nbsp;&nbsp;</strong>Page and paper rectangles</p><img src = "../art/rectangles.gif" alt = "Page and paper rectangles" width="314" height="229"></div><br/><p>Your application should always use the page rectangle sizes provided by the printer and should not attempt to change them or add new ones. If your application offers page sizes other than those provided by the printer, you risk compatibility problems.</p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF24" title="Paper Rectangle"></a><h3>Paper Rectangle</h3><p>The paper rectangle<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_146"></a> gives the paper sheet size<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_147"></a>, defined relative to the page rectangle, with the same coordinate system. Thus, the upper-left coordinates of the paper rectangle are typically negative, and the lower-right coordinates are greater than those of the page rectangle. <span class="content_text"><a href="cpm_concepts.html#//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF17">Figure 2-4</a></span> shows the relationship of these two rectangles. The difference between the page and paper rectangles defines the area of the sheet that can't be printed on, sometimes referred to as the <strong>hardware margin</strong><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_148"></a>. Assuming a resolution of 72 dpi, the hardware margin in <span class="content_text">Figure 2-4</span> is .25” (6.3 mm) in both dimensions. </p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF26" title="Adjusted Page and Paper Rectangles"></a><h3>Adjusted Page and Paper Rectangles</h3><p>The adjusted page<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_149"></a> and paper rectangle<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_150"></a>s are more important to your application than the unadjusted ones, as they define the drawing area after orientation, scaling, and resolution are applied. The printing system interprets your application’s drawing relative to these coordinates, but the unadjusted rectangles also provide a reference for the application in case information (such as a print preview) needs to be displayed to the user.</p><p>By default, all rectangles specify the page and paper sizes in dots-per-inch (dpi) with a default resolution of 72 dpi. If there are no orientation or scaling changes, and the application resolution is 72 dpi, the adjusted and unadjusted page and paper rectangles are equal. When scaling, orientation, and resolution are taken into account, the adjusted rectangles can define a drawing area quite different from the original unadjusted rectangles.</p><p>Scaling increases the amount of content your application can draw to a page when the user specifies a percentage less than 100% and decreases the amount of content your application can draw to a page when the percentage is greater than 100%. For example, if the user specifies 50% scaling, the page and paper rectangles increase in size by a factor of 2 in each dimension relative to the content, as shown in <span class="content_text">Figure 2-5</span>. While it may not be intuitive for the page and paper rectangles to increase in size when scaling is decreased, increasing the size of the rectangles effectively shrinks the content. The converse is true. If the user specifies 200% scaling, the page and paper rectangles decrease in size by half in each dimension relative to the content, effectively increasing the content size by 200% in each direction.</p><br/><div><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_14" title="Figure 1-5100% scaling compared to 50% scaling"></a><p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-CJBFIHFA" title="Figure 1-5100% scaling compared to 50% scaling"></a><strong>Figure 1-5&nbsp;&nbsp;</strong>100% scaling compared to 50% scaling</p><img src = "../art/scaling.gif" alt = "100% scaling compared to 50% scaling" width="351" height="227"></div><br/><p>If the user chooses landscape mode, the adjusted page and paper rectangles become, for most paper sizes, wider than they are tall. Because some papers are naturally wider than they are tall (envelopes, for example), it's best not to calculate page orientation based on the difference between the height and width of the page. Instead, use the function <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMGetOrientation" target="_top">PMGetOrientation</a></code>. In most cases your application shouldn’t need the orientation, just the dimensions of the adjusted page and paper rectangles.</p><p>When your application sets the drawing resolution to a value other than 72 dpi, the adjusted page and paper rectangles change accordingly. For example, setting the resolution to 600 dpi enlarges both rectangles by a factor of 8.3 in both dimensions—a previous page rectangle width of 576 units changes to 4800 units.</p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF25" title="Application Margins"></a><h3>Application Margins</h3><p>The default margins<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_151"></a> set by your application don’t need to coincide with the page rectangle. Applications typically provide default margins within the page rectangle. For example, the margins for an application might be as much as 1.5" (38mm) even though the margins for the page rectangle are much smaller, such as .25" (6.3mm). An application may allow the user to specify application margins that allow content to fall outside the printable area for a given printer. </p><a name="//apple_ref/doc/uid/TP30000978-TP30000045-TPXREF16" title="If You&acirc;&#128;&#153;ve Used the Old Printing Manager"></a><h2>If You’ve Used the Old Printing Manager</h2><p>If you’ve previously used the old Printing Manager<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_152"></a>, you’ll find that the Mac OS X printing architecture and most of the underlying concepts are slightly different from what you’ve used in Mac OS 9 and earlier. This section outlines the main differences. If you have developed applications for Mac OS 9, you should read this section to find out how the old concepts relate to the new ones. If you want to convert an existing Mac OS 9 application to use the Carbon Printing Manager<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_153"></a>, make sure you also read <span class="content_text"><a href="../cpm_chap4/cpm_adopt.html#//apple_ref/doc/uid/TP30000978-TP30000047-TP9">“Adopting the Carbon Printing Manager.”</a></span> If you are not modifying an existing application, you can skip this section. </p><p>A key aspect of the Mac OS X printing system is its robust support for Carbon applications. Because the Carbon Printing Manager is supported in Mac OS 8 and 9 as well as Mac OS X, a Carbon application is able to print as expected in both environments. For example, when running in Mac OS 8 and 9, the application utilizes the traditional user interface and drivers. In Mac OS X, the application automatically takes advantage of the new printing system’s more consistent set of printing dialogs and its flexible printing architecture. </p><p>Prior to Mac OS X, printing was supported by the old Printing Manager interface. This interface is not used by Carbon applications. The Carbon Printing Manager interface is defined in the header files <code>PMApplication.h</code>, <code>PMCore.h</code>, and <code>PMDefinitions.h</code>. </p><p>If you need to convert existing printing code<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_154"></a> to use the Carbon Printing Manager, you should be aware of the following changes. You can find more details about converting your code in <span class="content_text"><a href="../cpm_chap4/cpm_adopt.html#//apple_ref/doc/uid/TP30000978-TP30000047-TP9">“Adopting the Carbon Printing Manager.”</a></span></p><ul class="ul"><li class="li"><p>The old Printing Manager print record<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_155"></a> (<code>TPrint</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_156"></a>) is replaced by two opaque objects: a print settings object (<code>PMPrintSettings</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_157"></a>) and a page format object (<code>PMPageFormat</code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_158"></a>). You create these objects using the <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreatePrintSettings" target="_top">PMCreatePrintSettings</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_159"></a> and <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/PMCreatePageFormat" target="_top">PMCreatePageFormat</a></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_160"></a> functions, each of which returns a reference that you can pass to other Carbon Printing Manager functions to obtain information stored in the objects.</p></li><li class="li"><p>Your application must not make assumptions about the size or content of the print settings and page format objects. Your application can attach extended data to both objects using Carbon Printing Manager functions, but applications must not assume a specific size when storing or retrieving flattened versions of these objects with documents.</p></li><li class="li"><p>The Carbon Printing Manager provides functions for flattening and restoring the print settings and page format objects. In most cases, your application should store only the flattened page format object. If older versions of your application store a print record (created by the old Printing Manager) with a saved document, you may continue to do so for backward compatibility. However, some information may be lost when converting a page format object into a old print record (or vice versa), due to limitations of the print record structure in the old Printing Manager.</p></li><li class="li"><p>In Mac OS X, Carbon applications can create multiple printing session objects and run more than one print loop at a time. Each print loop<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_161"></a> is independent of other print loops. In Mac OS 8 and 9, applications are limited to a single printing session object, and therefore one print loop at a time.</p></li><li class="li"><p>The Carbon Printing Manager enforces an order in which some functions should be called. Any function used out of order returns the result code <code><a href="../../../../GraphicsImaging/Reference/CorePrintRef/Reference/reference.html#//apple_ref/doc/c_ref/kPMOutOfScope" target="_top">kPMOutOfScope</a></code>.</p></li><li class="li"><p>The style dialog box<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_162"></a> is now called the Page Setup dialog, and the job dialog box<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_163"></a> is now called the Print dialog.</p></li><li class="li"><p>If your application requires customizing the Page Setup or Print dialogs, you should consider creating a printing dialog extension<a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_164"></a> (PDE). If you want your application’s custom dialog to be displayed as a sheet in Mac OS X, you must create a printing dialog extension. For more information, see <em><a href="../../../../Printing/Conceptual/ExtPrintingDialogs/index.html#//apple_ref/doc/uid/TP30000979" target="_top">Extending Printing Dialogs</a></em>.</p></li><li class="li"><p>Low-level driver functions such as <code><!--a-->PrLoadDriver<!--/a--></code><a name="//apple_ref/doc/uid/TP30000045-DontLinkElementID_165"></a> are not supported.</p></li></ul>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../cpm_chap1/cpm_intro.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../cpm_chap3/cpm_tasks.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2001, 2004 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2004-08-31<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/CPM_Concepts/cpm_chap2/cpm_concepts.html%3Fid%3DTP30000978-2.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/CPM_Concepts/cpm_chap2/cpm_concepts.html%3Fid%3DTP30000978-2.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/CPM_Concepts/cpm_chap2/cpm_concepts.html%3Fid%3DTP30000978-2.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>