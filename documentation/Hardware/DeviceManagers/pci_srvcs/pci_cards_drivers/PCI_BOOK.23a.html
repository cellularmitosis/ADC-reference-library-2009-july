<HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><script language="JavaScript" src="frametest.js"></script><TITLE> Fast Path Mode</TITLE></HEAD><BODY BGCOLOR="#ffffff"><DIV><a name="top"></a><!-- start of banner --><!--#include virtual="/includes/framesetheader" --><!-- end of banner --><!-- start of path --><font face="Geneva,Helvetica,Arial" size="1"><b><br>PATH<spacer type="horizontal" size="5">&nbsp;</b><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Documentation</a> &gt; <!-- a href="" target="_top" -->Hardware<!-- /a -->  <b>&gt; </b><a href="../../devicemgrs.html" target="_top">Device Managers and Drivers</a> <b>&gt; </b><a href="../pci_srvcs.html" target="_top">PCI Card Services</a> <b>&gt; </b>Designing PCI Cards and Drivers for Power Macintosh Computers</font><br><br><!-- end of path --><A HREF="PCI_BOOK.219.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.239.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.23b.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><HR></DIV><H1 CLASS="H1.Heading1"><A NAME="pgfId=3690"> </A><A NAME="21363"> </A>Fast Path Mode</H1><P CLASS="T1.Text1"><A NAME="pgfId=3692"> </A><A NAME="marker=3691"> </A>Fast Path is an optional optimization wherein the driver supplies the client with a precomputed packet header for a given destination. The client caches the header and copies it directly into packets addressed to that destination before passing them to the driver. The client first requests a header by sending the driver an <TT CLASS="cv">M_IOCTL</TT> message with its <TT CLASS="cv">ioc_cmd</TT> field set to <TT CLASS="cv">DL_IOC_HDR_INFO</TT> and its chained data block containing the <TT CLASS="cv">dl_unitdata_req_t</TT> structure that the client would normally use to send packets to that particular destination. If the driver does not support fast path, it simply responds with an <TT CLASS="cv">N_IOCNAK</TT> message. STREAMS drivers respond with <TT CLASS="cv">NAK</TT> to any <TT CLASS="cv">IOCTL</TT> they can't handle.</P><P CLASS="T1.Text1"><A NAME="pgfId=3693"> </A>If the driver supports fast path, it responds with an <TT CLASS="cv">M_IOCACK</TT> message with the chained data block containing the precomputed header. In the case of 802.2 packets, the length field of the precomputed header is set to 0. The client prepends the header to outgoing packets and passes them to the driver as <TT CLASS="cv">M_DATA</TT> messages. The driver then sends the packet as is, filling in the 802.2 length field if necessary.</P><DIV><blockquote><H4 CLASS="NoteHead"><A NAME="pgfId=14623"> </A>Note</H4><P CLASS="Note"><A NAME="pgfId=3694"> </A>The data block returned in the <TT CLASS="cv">M_IOCACK</TT> should not be modified by the client, and it should always be copied with <TT CLASS="cv">copyb</TT> rather than <TT CLASS="cv">dupb</TT>, since the driver may modify it before sending the packet. </P></blockquote></DIV><HR>&#169 1999 Apple Computer, Inc. &#150 (Last Updated 26 March 99)<P><A HREF="PCI_BOOK.219.html"><img src="images/up.gif" border="0" width="36" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.239.html"><img src="images/previous.gif" border="0" width="66" height="16"></A><nobr>&nbsp;</nobr><A HREF="PCI_BOOK.23b.html"><img src="images/next.gif" border="0" width="49" height="16"></A><!-- insert Show/Hide frames --><a href="javascript:testFrame()"><script><!--document.write(frameLink);//--></script><!-- end Show/Hide frames --></A><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></body></HTML>