<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Adding Menu Items to the Help Menu (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING155></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-154.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-156.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-138.html"><B>Chapter 3 - Help Manager</B></A> / <A HREF="MoreToolbox-143.html"><B>Using the Help Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING155-0></A>
<H2><A NAME=MARKER-9-396></A><A NAME=MARKER-21-397></A>Adding Menu Items to the Help Menu</H2>
 <A NAME=MARKER-9-154></A>The Help menu is specific to each application, just as the File and Edit menus are. The Help menu items defined by the Help Manager should be common to all applications, but you can add your own menu items for help-related information.<A NAME=MARKER-2-54></A><P>
 If you provide your users with help information in addition to help balloons, you should append a command to the Help menu for this information. The Help menu gives users one consistent place to obtain help information.<P>
 When adding your own items to the Help menu, include the name of your application in the command so that users can easily determine which application the help command relates to. For example, <A HREF=#MARKER-9-400>Figure 3-22</A> shows the Help menu with an item appended to it by the active application.<P>
<B>Figure 3-22  <A NAME=MARKER-9-400></A><A NAME=MARKER-21-401></A>The Help menu with an appended menu item</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/HM-S-22.jpg">
 You add items to the Help menu by using the <CODE>HMGetHelpMenuHandle</CODE> function and by providing an <CODE>'hmnu'</CODE> resource and specifying the <CODE>kHMHelpMenuID</CODE> constant as the resource ID.<A NAME=MARKER-2-152></A><A NAME=MARKER-2-153></A><P>
 The <CODE>HMGetHelpMenuHandle</CODE> function returns a copy of the handle to the Help menu. Do not use the Menu Manager function <CODE>GetMenuHandle</CODE> to get a handle to the Help menu, because <CODE>GetMenuHandle</CODE> returns a handle to the global Help menu, not the <BR>Help menu that is specific to your application. Once you have a handle to the Help menu that is specific to your application, you can add items to it using the <CODE>AppendMenu</CODE> procedure or other Menu Manager routines. For example, this code adds the menu item displayed in <A HREF=#MARKER-9-400>Figure 3-22</A>.<P>
<PRE>
VAR
   mh:   MenuHandle;
   err:  OSErr;

BEGIN
   err := HMGetHelpMenuHandle(mh);
   IF err = noErr THEN
      IF mh &lt;&gt; NIL THEN
         BEGIN
            AppendMenu(mh, 'SurfWriter Help...');
         END;
   DrawMenuBar;
END;
</PRE>
 Be sure to use an <CODE>'hmnu'</CODE> resource to provide help balloons for items you've added to the Help menu. Use the <CODE>kHMHelpMenuID</CODE> constant (-16490) to specify the <CODE>'hmnu'</CODE> resource ID. After the header component of the <CODE>'hmnu'</CODE> resource, provide a missing-items component and then the components for your appended items. You don't provide a menu-title component here; instead, the Help Manager automatically creates the help balloons for the Help menu title and the standard Help menu items. The Help Manager also automatically adds a divider line between the end of the standard Help menu items and your appended items. <P>
 <A HREF=#MARKER-9-404>Listing 3-19</A> shows an <CODE>'hmnu'</CODE> resource for the appended menu item shown in <BR><A HREF=#MARKER-9-400>Figure 3-22</A>.<P>
<B>Listing 3-19  <A NAME=MARKER-9-404></A><A NAME=MARKER-21-405></A>Rez input for specifying help balloons for items in the Help menu</B><P>
<PRE>
resource 'hmnu' (kHMHelpMenuID, &quot;Help&quot;, purgeable) {
   HelpMgrVersion, 0, 0, 0,   /*header component*/
   HMSkipItem {               /*missing-items component*/
      /*no missing items, so skip to first appended menu-item */
      /* component*/
      },
   {     /*first menu-item component: SurfWriter Help command*/
      HMStringResItem { /*use an 'STR#' for help messages*/
      146, 1,  /*'STR#' res ID, index when item is enabled*/
      146, 2,  /*'STR#' res ID, index when item is dimmed*/
      146, 3,  /*'STR#' res ID, index when item is checked*/
      0,   0   /*item can't be marked*/
      },
   }
};
resource 'STR#' (146, &quot;My help menu items' strings&quot;) { 
   { /*array StringArray: six elements*/
   /*[1] enabled SurfWriter Help command help text*/
   &quot;Offers tutorial help for the SurfWriter text processor.&quot;;
   /*[2] dimmed SurfWriter Help command help text*/
   &quot;Offers tutorial help for the SurfWriter text processor. &quot;
      &quot;Not available until you open a SurfWriter document.&quot;;
   /*[3] checked SurfWriter Help command help text*/
   &quot;Closes tutorial help for the SurfWriter text processor.&quot;;
   }
};
</PRE>
 As previously explained in <A HREF=MoreToolbox-147.html#MARKER-9-157>"Providing Help Balloons for Menus" beginning on page 3-24</A>, the <CODE>'hmnu'</CODE> resource allows you to specify help balloons for four states of a menu item: enabled, dimmed, enabled and checked, and enabled and marked with a symbol other than a checkmark. You cannot specify a help balloon for a Help menu item that system software dims when an alert box or a modal dialog box appears, because you don't have access to the missing-items component of the Help menu. When an alert box or a modal dialog box appears, the Help Manager displays a default help balloon for all dimmed Help menu items.<A NAME=MARKER-2-155></A><A NAME=MARKER-2-214></A><P>
 The Help Manager automatically processes the event when a user chooses any of the standard menu items in the Help menu. The Help Manager automatically enables and disables help when the user chooses Show Balloons or Hide Balloons from the Help menu. The setting of help is global and affects all applications. <P>
 The <CODE>MenuSelect</CODE> and <CODE>MenuKey</CODE> functions return a result with the menu ID in the high word and the menu item in the low word. Both functions return the <CODE>kHMHelpMenuID</CODE> constant (-16490) in the high word when the user chooses an appended item from the Help menu. The menu item number of the appended item is returned in the low word of the function result. The <CODE>DoMenuCommand</CODE> procedure shown in <A HREF=#MARKER-9-408>Listing 3-20</A> handles mouse clicks for those items defined by the application to appear in the Help menu.<P>
<B>Listing 3-20  <A NAME=MARKER-9-408></A>Responding to the user's choice in a menu command</B><P>
<PRE>
PROCEDURE DoMenuCommand (menuResult: LongInt);
VAR         
   menuID, menuItem: Integer;
BEGIN
   menuID := HiWrd(menuResult);     {get menu ID}
   menuItem := LoWrd(menuResult);   {get menu item number}
   CASE menuID OF
      mApple:        DoAppleMenuCommand(menuItem);
      mFile:         DoFileMenuCommand(menuItem);
      mEdit:         DoEditMenuCommand(menuItem);
      mFont:         DoFontMenuCommand(menuItem);
      kHMHelpMenuID: DoHelpMenuCommand(menuItem);
   END;
   HiliteMenu(0);
END;
</PRE>
 <A NAME=MARKER-2-160></A>In the future, Apple may choose to add other items to the Help menu. To determine the number of items in the Help menu, call the <CODE>CountMItems</CODE> function, which is described in the chapter "Menu Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I>.<A NAME=MARKER-9-104></A><A NAME=MARKER-2-162></A> <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-154.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-156.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
