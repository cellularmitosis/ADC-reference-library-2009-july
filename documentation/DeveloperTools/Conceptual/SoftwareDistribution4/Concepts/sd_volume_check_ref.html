<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Software Distribution Legacy Guide (Legacy): Checking the Installation Volume With VolumeCheck</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Checking the Installation Volume With VolumeCheck"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001944" title="Checking the Installation Volume With VolumeCheck"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../../LegacyTechnologies/Tools-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000463" target="_top">Tools</a> &gt; <a href="../index.html" target="_top">Software Distribution Legacy Guide (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="sd_install_check_ref.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="sd_pre_post_processing.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/20001944-TPXREF9" title="Checking the Installation Volume With VolumeCheck"></a><hr /><H1>Checking the Installation Volume With VolumeCheck</H1><p>You can prevent users from installing your software on volumes that do not meet certain criteria. To do so, you supply an executable file, named <code>VolumeCheck</code>, in your installation package that determines whether a volume should be allowed as a possible installation destination.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001944-DontLinkElementID_71" title="Important:"></a><p><strong>Important:</strong>&nbsp;Starting in Mac OS  X version 10.3, installer applications may present the user with a security warning before a VolumeCheck tool is executed. </p><p></p></div><p>For another possible approach to specifying volume requirements, see <span class="content_text"><a href="sd_spec_install_req.html#//apple_ref/doc/uid/20001949-TPXREF4">“Specifying Installation Requirements.”</a></span></p>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1024310-TPXREF6">VolumeCheck Overview</a>
				
			<br/>
			
        
			
			
				<a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1010617-CHEGAGIH">File Placement for Volume Checking</a>
				
			<br/>
			
        
			
			
				<a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1002920-TPXREF7">Arguments and Environment Variables</a>
				
			<br/>
			
        
			
			
				<a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1010814-CHEFBDAB">Return Value for the VolumeCheck Executable</a>
				
			<br/>
			
        
			
			
				<a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1009215-CHEJDJHJ">VolumeCheck Message Strings</a>
				
			<br/>
			
        
			
			
				<a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1004069-TPXREF21">VolumeCheck Example</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001944-1024310" title="VolumeCheck Overview"></a><a name="//apple_ref/doc/uid/20001944-1024310-TPXREF6" title="VolumeCheck Overview"></a><h2>VolumeCheck Overview</h2><p>The Installer application looks for the VolumeCheck executable file in the <code>Resources</code> directory of the package. If found, the file is executed before Installer asks the user to choose an installation volume (and possibly a specific directory). This takes place after the user has already performed any required preliminary steps, such as authenticating or accepting a license agreement. See <span class="content_text"><a href="sd_install_process.html#//apple_ref/doc/uid/20001765-TPXREF5">“The Installation Process”</a></span> for a look at the larger picture of what happens during an installation. </p><div class="importantbox"><a name="//apple_ref/doc/uid/20001944-DontLinkElementID_72" title="Important:"></a><p><strong>Important:</strong>&nbsp;The VolumeCheck tool or script must have its executable bit set. This is done automatically when the package is built with PackageMaker.</p><p></p></div><div class="notebox"><a name="//apple_ref/doc/uid/20001944-DontLinkElementID_73" title="Note"></a><p><strong>Note:</strong>&nbsp;Most executable files used for volume checking are likely to be shell scripts. Such scripts can use any shell, as long as it starts with a standard <code>#!</code> comment to identify the shell.</p></div><p>Installer runs VolumeCheck once for each currently mounted volume. VolumeCheck can use any criteria to accept or reject a volume. VolumeCheck returns a value that tells Installer whether or not to allow the volume as an installation destination. For details on this value, see <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1010814">“Return Value for the VolumeCheck Executable.”</a></span> If a volume is disallowed, Installer displays its icon with a badge that indicates the volume can’t be used for this installation. If the user attempts to select the volume anyway, you can supply a message that explains why that volume is not suitable.</p><p>When VolumeCheck returns a value that indicates that a volume should be disallowed, the return value also indicates what message to display if the user clicks the icon for that volume. Installer obtains the message from a <code>VolumeCheck.strings</code> file you supply in the installation package. If you supply <code>VolumeCheck.strings</code> files for multiple locales, Installer displays the appropriate version based on the user’s current Languages preference. If you do not supply a message, Installer supplies a default message.</p><p>The following sections describe</p><ul class="ul"><li class="li"><p>where the <code>VolumeCheck</code> file and message files are placed in the installation package</p></li><li class="li"><p>the arguments and environment variables available to VolumeCheck</p></li><li class="li"><p>the return values VolumeCheck uses to specify an action and a message</p></li><li class="li"><p>the default messages supplied by Installer</p></li><li class="li"><p>the format of messages in a message file</p></li><li class="li"><p>a sample <code>VolumeCheck</code> script file</p></li></ul><p>In addition, see <span class="content_text"><a href="sd_trouble_shooting.html#//apple_ref/doc/uid/20001946-1010598">“Working With Script Files”</a></span> for tips on using executables with PackageMaker and Installer.</p><a name="//apple_ref/doc/uid/20001944-1010617" title="File Placement for Volume Checking"></a><a name="//apple_ref/doc/uid/20001944-1010617-CHEGAGIH" title="File Placement for Volume Checking"></a><h2>File Placement for Volume Checking</h2><p>Each file executed as part of an installation, including <code>VolumeCheck</code>, should be placed in the <code>Resources</code> directory of the package and must have its execution bit set. If you place the file correctly and build the package with PackageMaker, it will automatically set the execution bit for the file. However, you may need to set explicit permissions for the executable file—for more information, see <span class="content_text"><a href="sd_permissions_author.html#//apple_ref/doc/uid/20001769-TPXREF2">“Authorization, File Ownership, and Permissions.”</a></span></p><p>Any <code>VolumeCheck.strings</code> message files you provide should also be placed in the <code>Resources</code> directory, within a localized resource directory with the appropriate name. For example, the items labeled <code>-1-</code> through <code>-5-</code> in <span class="content_text">Listing 1</span> show the file placement in a test package, where the strings files are localized for English and French. For information on which localized folder names you can use, see <span class="content_text"><a href="sd_pkg_anatomy.html#//apple_ref/doc/uid/20001767-1020608">“Localized Folder Names.”</a></span></p><div class="warningbox"><img src="../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/20001944-DontLinkElementID_74" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;If no <code>VolumeCheck.strings</code> files are placed in localized directories or no localized version is found for the user’s current language selection, Installer should look for a default version at the highest level in the <code>Resources</code> directory. Due to a bug, however, only string files in localized resource directories are currently used.</p><p></p><div class="clear"></div></div><a name="//apple_ref/doc/uid/20001944-1017065-CHDJEAJJ" title="Listing 1Location of VolumeCheck executable and strings files in a package"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001944-1017065" title="Listing 1Location of VolumeCheck executable and strings files in a package"></a><strong>Listing 1&nbsp;&nbsp;</strong>Location of VolumeCheck executable and strings files in a package</p><div class="codesample"><table><tr><td scope="row"><pre>Test.pkg<span></span></pre></td></tr><tr><td scope="row"><pre>    Contents<span></span></pre></td></tr><tr><td scope="row"><pre>        Archive.bom<span></span></pre></td></tr><tr><td scope="row"><pre>        Archive.pax.gz<span></span></pre></td></tr><tr><td scope="row"><pre>        Info.plist<span></span></pre></td></tr><tr><td scope="row"><pre>        Resources<span></span></pre></td></tr><tr><td scope="row"><pre>            Description.plist<span></span></pre></td></tr><tr><td scope="row"><pre>            VolumeCheck             -1-<span></span></pre></td></tr><tr><td scope="row"><pre>            English.lproj           -2-<span></span></pre></td></tr><tr><td scope="row"><pre>                VolumeCheck.strings -3-<span></span></pre></td></tr><tr><td scope="row"><pre>            French.lproj            -4-<span></span></pre></td></tr><tr><td scope="row"><pre>                VolumeCheck.strings -5-<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/20001944-1002920" title="Arguments and Environment Variables"></a><a name="//apple_ref/doc/uid/20001944-1002920-TPXREF7" title="Arguments and Environment Variables"></a><h2>Arguments and Environment Variables</h2><p>When Installer executes the <code>VolumeCheck</code> file, it provides one argument:</p><ul class="ul"><li class="li"><p><code>$1</code>: The full path to the volume to evaluate. For example:</p><p><code>/Volumes/Mac_OS_X_Work</code></p></li></ul><p>Installer also makes one environment variable available:</p><ul class="ul"><li class="li"><p><code>$PACKAGE_PATH</code>: The full path to the installation package. For example:</p><p><code>/Volumes/Projects/Testing/Simple_Carbon_App.pkg</code></p><p>VolumeCheck can use this path to obtain resources within the package.</p></li></ul><a name="//apple_ref/doc/uid/20001944-1010814" title="Return Value for the VolumeCheck Executable"></a><a name="//apple_ref/doc/uid/20001944-1010814-CHEFBDAB" title="Return Value for the VolumeCheck Executable"></a><h2>Return Value for the VolumeCheck Executable</h2><p>VolumeCheck returns a value that Installer interprets as a pair of bit fields, as shown in <span class="content_text">Figure 1</span>. Bit 5 of the return value determines the action—that is, whether to allow or disallow the volume as a destination for the installation.</p><br/><div><a name="//apple_ref/doc/uid/20001944-1010239-CHDIDBHJ" title="Figure 1Bit fields in the value returned by VolumeCheck"></a><p><a name="//apple_ref/doc/uid/20001944-1010239" title="Figure 1Bit fields in the value returned by VolumeCheck"></a><strong>Figure 1&nbsp;&nbsp;</strong>Bit fields in the value returned by VolumeCheck</p><img src = "art/sd_volcheck_bitfield.gif" alt = "Bit fields in the value returned by VolumeCheck" width="234" height="103"></div><br/><p>If a volume is disallowed, Installer displays the icon for that volume with a badge that indicates it can’t be used for this installation. It also saves the value from the second bit field, consisting of bits 0–4. If the user later clicks the icon for the disallowed volume, Installer displays a message in the following format: </p><div class="codesample"><table><tr><td scope="row"><pre>You cannot install this software on this disk. &lt;message><span></span></pre></td></tr></table></div><p>Installer uses the value from the second bit field to obtain the string <code>&lt;message></code> from the <code>VolumeCheck.strings</code> file. The strings file currently must be in a localized directory, as described in <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1010617">“File Placement for Volume Checking.”</a></span> If no strings file is provided or if the specified message cannot be found, Installer provides a default message. Possible bit field values are shown in <span class="content_text">Table 2</span>. Default string values are shown in <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1011359-CHEIFHGH">Table 3</a></span>. A sample strings file is shown in <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1011743-CHEFBAIB">Listing 2</a></span>.</p><div class="importantbox"><a name="//apple_ref/doc/uid/20001944-DontLinkElementID_75" title="Important:"></a><p><strong>Important:</strong>&nbsp;Bits 6 and 7 are reserved for future use and must be zero. As a general rule, set all unused bits to 0.</p><p></p></div><p><span class="content_text">Table 1</span> describes how Installer interprets the action bit (bit 5) in the value returned by VolumeCheck:</p><a name="//apple_ref/doc/uid/20001944-1012437-CHEECIEF" title="Table 1Actions specified by value in bit 5"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/20001944-1012437" title="Table 1Actions specified by value in bit 5"></a><strong>Table 1&nbsp;&nbsp;</strong>Actions specified by value in bit 5</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Bit value</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Action</p></th></tr><tr><td  scope="row"><p>0</p></td><td ><p>Allow installation on the volume</p></td></tr><tr><td  scope="row"><p>1</p></td><td ><p>Disallow installation and add a badge to the icon for the volume</p></td></tr></table></div><p><span class="content_text">Table 2</span> describes how Installer interprets the message bits (bits 0 through 4) in the value returned by VolumeCheck. The five bits allow for a value between 0 and 31.</p><a name="//apple_ref/doc/uid/20001944-1012476-CHEHCJHD" title="Table 2Values for bits 0 through 4 and resulting messages"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/20001944-1012476" title="Table 2Values for bits 0 through 4 and resulting messages"></a><strong>Table 2&nbsp;&nbsp;</strong>Values for bits 0 through 4 and resulting messages</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Numeric value</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Message</p></th></tr><tr><td  scope="row"><p>0</p></td><td ><p>Should not be 0 unless the action bit is also 0</p></td></tr><tr><td  scope="row"><p>1–2</p></td><td ><p>Specifies a default string provided by Installer, as shown in <span class="content_text">Table 3</span></p></td></tr><tr><td  scope="row"><p>3–15</p></td><td ><p>Reserved for future use by Installer</p></td></tr><tr><td  scope="row"><p>16–31</p></td><td ><p>Specifies a message string in a <code>VolumeCheck.strings</code> file in the package, as shown in <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1011413">“Strings Files for the VolumeCheck Executable”</a></span>;</p><p> if the value does not have a matching message string, Installer displays the value itself to the user; for example:</p><p>You cannot install this software on this disk. 31</p></td></tr></table></div><p>If the package contains strings files for multiple locales, Installer displays the appropriate version based on the user’s current Languages preference. For a sample strings file, see <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1011413">“Strings Files for the VolumeCheck Executable.”</a></span></p><a name="//apple_ref/doc/uid/20001944-1009215" title="VolumeCheck Message Strings"></a><a name="//apple_ref/doc/uid/20001944-1009215-CHEJDJHJ" title="VolumeCheck Message Strings"></a><h2>VolumeCheck Message Strings</h2><p>As described in <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1010814">“Return Value for the VolumeCheck Executable,”</a></span> if a user clicks an icon for a disallowed volume, Installer displays a message based on a bit-field value specified previously by VolumeCheck. The message begins with “You cannot install this software on this disk.” It is followed by the specified message string from the file <code>VolumeCheck.strings</code>, which may be stored in a localized resource directory in the installation package. If the package does not supply a strings file or if the file doesn’t contain the specified message, Installer displays a default message.</p><a name="//apple_ref/doc/uid/20001944-1011343" title="Default Messages Provided by Installer"></a><a name="//apple_ref/doc/uid/20001944-1011343-TPXREF8" title="Default Messages Provided by Installer"></a><h3>Default Messages Provided by Installer</h3><p>Based on the value VolumeCheck returns in the message bit field (bits 0–4), Installer provides the default message strings described in <span class="content_text">Table 3</span>. These messages are concatenated with the string “You cannot install this software on this disk. “</p><a name="//apple_ref/doc/uid/20001944-1011359-CHEIFHGH" title="Table 3Installer default messages for VolumeCheck"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><a name="//apple_ref/doc/uid/20001944-1011359" title="Table 3Installer default messages for VolumeCheck"></a><strong>Table 3&nbsp;&nbsp;</strong>Installer default messages for VolumeCheck</caption><tr><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Numeric value</p></th><th scope="col" align="left" style="font-weight: bold" bgcolor="#CCCCCC"><p>Message string</p></th></tr><tr><td  scope="row"><p>0</p></td><td ><p>You are not allowed to install the software on this disk for an unknown reason.</p></td></tr><tr><td  scope="row"><p>1</p></td><td ><p>Could not find specified message for index 1.</p></td></tr><tr><td  scope="row"><p>2</p></td><td ><p>An error was encountered while running the VolumeCheck tool for package &lt;package name>.</p></td></tr><tr><td  scope="row"><p>3–15</p></td><td ><p>Could not find specified message for index &lt;value></p></td></tr></table></div><a name="//apple_ref/doc/uid/20001944-1011413" title="Strings Files for the VolumeCheck Executable"></a><a name="//apple_ref/doc/uid/20001944-1011413-CHEBIICJ" title="Strings Files for the VolumeCheck Executable"></a><h3>Strings Files for the VolumeCheck Executable</h3><p>To display a message when a user clicks the icon for a disallowed volume, you provide one or more files named <code>VolumeCheck.strings</code> and place them in the appropriate localized directory within the package’s <code>Resources</code> directory. <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1010617">“File Placement for Volume Checking”</a></span> describes the placement of strings files in the package.</p><p>A strings file contains messages in the following format:</p><div class="codesample"><table><tr><td scope="row"><pre>"number string" = "message string";<span></span></pre></td></tr></table></div><p>where <code>"number string"</code> represents a numeric value between 16 and 31, as described in <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1012476-CHEHCJHD">Table 2</a></span> and <code>"message string"</code> is the string to display. Strings always end with a semicolon. An English strings file with two messages might look like the one in <span class="content_text">Listing 2</span>.</p><a name="//apple_ref/doc/uid/20001944-1011743-CHEFBAIB" title="Listing 2A sample VolumeCheck.strings file"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001944-1011743" title="Listing 2A sample VolumeCheck.strings file"></a><strong>Listing 2&nbsp;&nbsp;</strong>A sample VolumeCheck.strings file</p><div class="codesample"><table><tr><td scope="row"><pre>"16" = "Can't install on volumes named Jaguar.";<span></span></pre></td></tr><tr><td scope="row"><pre>"17" = "Can’t install on volumes named Puma.";<span></span></pre></td></tr></table></div><p>For example, if the message index returned to the Installer is 48 (or a bit value of <code>110000</code>, indicating the volume should be disallowed and the message index is 16), the message displayed to the user is</p><div class="codesample"><table><tr><td scope="row"><pre>You cannot install this software on this disk. Can't install on volumes named Jaguar.<span></span></pre></td></tr></table></div><p>The bit fields in the VolumeCheck return value are described in detail in <span class="content_text"><a href="sd_volume_check_ref.html#//apple_ref/doc/uid/20001944-1010814">“Return Value for the VolumeCheck Executable”</a></span></p><a name="//apple_ref/doc/uid/20001944-1004069" title="VolumeCheck Example"></a><a name="//apple_ref/doc/uid/20001944-1004069-TPXREF21" title="VolumeCheck Example"></a><h2>VolumeCheck Example</h2><p><span class="content_text">Listing 3</span> shows a simple VolumeCheck script. This script checks the volume name and disallows any volumes named <code>Jaguar</code>, but a VolumeCheck script is free to perform checking of arbitrary complexity. You can examine output from VolumeCheck in the Console application (available in <code>/Applications/Utilities</code>). Alternatively, you can redirect output to a log file, using script statements like the following: <code>echo "Full volume path is: $path" >> /tmp/scripts.log</code></p><div class="notebox"><a name="//apple_ref/doc/uid/20001944-DontLinkElementID_76" title="Note"></a><p><strong>Note:</strong>&nbsp;Although this script has been tested, you should use care in cutting and pasting it from this document. For more information, see <span class="content_text"><a href="sd_trouble_shooting.html#//apple_ref/doc/uid/20001946-TPXREF8">“Troubleshooting Packages and Installation.”</a></span></p></div><p>The first line in this script (<code>#!/bin/bash</code>) indicates that the script uses the <code>bash</code> shell, located in <code>/bin</code>. Other lines that begin with the <code>#</code> character are comments.</p><a name="//apple_ref/doc/uid/20001944-1004405-CHEHJCFJ" title="Listing 3A VolumeCheck script that checks the volume name"></a><p class="codesample"><a name="//apple_ref/doc/uid/20001944-1004405" title="Listing 3A VolumeCheck script that checks the volume name"></a><strong>Listing 3&nbsp;&nbsp;</strong>A VolumeCheck script that checks the volume name</p><div class="codesample"><table><tr><td scope="row"><pre>#!/bin/bash<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># Argument 1 (the only argument to VolumeCheck) is the full path to a volume<span></span></pre></td></tr><tr><td scope="row"><pre>#   in Installer's Target Select panel that a user can choose to<span></span></pre></td></tr><tr><td scope="row"><pre>#   install the software on.<span></span></pre></td></tr><tr><td scope="row"><pre># The path is of the form "/" or /Volume/{volume name}<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># For convenience, this script echoes the path and name of each volume.<span></span></pre></td></tr><tr><td scope="row"><pre>path=$1<span></span></pre></td></tr><tr><td scope="row"><pre>echo "Full volume path is: $path"<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># Get the volume name from the full path.<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre>path=${path##/*/}<span></span></pre></td></tr><tr><td scope="row"><pre>echo "Volume name is: $path"<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># You can perform testing of arbitrary complexity here.<span></span></pre></td></tr><tr><td scope="row"><pre># This script just disallows installing on volumes named "Jaguar".<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># Note: If $path were not enclosed in quotes in the next statement,<span></span></pre></td></tr><tr><td scope="row"><pre>#       the script would get an error if the volume name included a space.<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre>if ([ "$path" = "Jaguar" ]) then<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># If the volume has the disallowed name, return a value that tells Installer<span></span></pre></td></tr><tr><td scope="row"><pre># not to allow installation on the volume.<span></span></pre></td></tr><tr><td scope="row"><pre># The value should also specify a string from the VolumeCheck.strings file<span></span></pre></td></tr><tr><td scope="row"><pre># to display if the user clicks the volume icon.<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># To do this, supply an error return value of 32.<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># Sets the action bit (bit 5) to 1, to disallow the volume.<span></span></pre></td></tr><tr><td scope="row"><pre>let retval=(1&lt;&lt;5)<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># Sets the message value bits (bits 0 to 4) to 16,<span></span></pre></td></tr><tr><td scope="row"><pre># specifying the message associated with "16" in the strings file.<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre>let retval=(retval|16)<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre>else<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre># The volume name is OK, so allow it as a possible destination.<span></span></pre></td></tr><tr><td scope="row"><pre>#<span></span></pre></td></tr><tr><td scope="row"><pre>retval=0<span></span></pre></td></tr><tr><td scope="row"><pre>fi<span></span></pre></td></tr><tr><td scope="row"><pre>exit $retval<span></span></pre></td></tr></table></div>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="sd_install_check_ref.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="sd_pre_post_processing.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2006 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2006-07-24<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/DeveloperTools/Conceptual/SoftwareDistribution4/Concepts/sd_volume_check_ref.html%3Fid%3DTP40004615-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/DeveloperTools/Conceptual/SoftwareDistribution4/Concepts/sd_volume_check_ref.html%3Fid%3DTP40004615-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/DeveloperTools/Conceptual/SoftwareDistribution4/Concepts/sd_volume_check_ref.html%3Fid%3DTP40004615-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
