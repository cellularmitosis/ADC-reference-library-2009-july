<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>OutlineMetrics(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING233></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-232.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-234.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-181.html"><B>Chapter 4 - Font Manager</B></A> / <A HREF="Text-209.html"><B>Font Manager Reference</B></A><BR><DL><DD><A HREF="Text-220.html"><B>Routines</B></A> / <A HREF="Text-231.html"><B>Getting the Characteristics of a Font</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING233-0></A>
<H3><A NAME=MARKER-9-371></A>OutlineMetrics</H3>
 <A NAME=MARKER-2-294></A>The <CODE>OutlineMetrics</CODE> function gets font measurements for a block of text to be drawn in a specified outline font. <P>
<PRE>
FUNCTION OutlineMetrics (byteCount: Integer; textPtr: UNIV Ptr;
                         numer,denom: Point;
                         VAR yMax: Integer; VAR yMin: Integer;
                         awArray: FixedPtr; lsbArray: FixedPtr;
                         boundsArray: RectPtr): OSErr; 
</PRE>
<DL>
<DT><CODE>byteCount</CODE>
<DD> The number of bytes in the block of text that you want measured.
<DT><CODE>textPtr</CODE>
<DD> A pointer to the block of text that you want measured.
<DT><CODE>numer</CODE>
<DD> The numerators of the vertical and horizontal scaling factors. The <CODE>numer</CODE> parameter is of type <CODE>Point</CODE>, and contains two integers: the first is the numerator of the ratio for vertical scaling, and the second is the numerator of the ratio for horizontal scaling. The Font Manager applies these scaling factors to the current font in order to calculate the measurements for glyphs in the block of text. <A NAME=MARKER-2-762></A><A NAME=MARKER-2-300></A>
<DT><CODE>denom</CODE>
<DD> The denominators of the vertical and horizontal scaling factors. The <CODE>denom</CODE> parameter is of type <CODE>Point</CODE>, and contains two integers: the first is the denominator of the ratio for vertical scaling, and the second is the denominator of the ratio for horizontal scaling. The Font Manager applies these scaling factors to the current font in order to calculate the measurements for glyphs in the block of text.<A NAME=MARKER-2-421></A> 
<DT><CODE>yMax</CODE>
<DD> On output, this is the maximum y-value for the text. Pass <CODE>NIL</CODE> in this parameter if you don't want this value returned.
<DT><CODE>yMin</CODE>
<DD> On output, this is the minimum y-value for the text. Pass <CODE>NIL</CODE> in this parameter if you don't want this value returned.
<DT><CODE>awArray</CODE>
<DD> A pointer to an array that, on output, is filled with the advance width measurements for the glyphs being measured. These measurements are in pixels, based on the point size and font scaling factors of the current font. There is an entry in this array for each glyph that is being measured.<A NAME=MARKER-2-853></A> 
<DT>
<DD> The <CODE>awArray</CODE> parameter is of type <CODE>FixedPtr</CODE>. The <A NAME=MARKER-2-177></A><CODE>FixedPtr</CODE> data type is a pointer to an array, and each entry in the array is of type <CODE>Fixed</CODE>, which is 4 bytes in length. Multiply <CODE>byteCount</CODE> by 4 to calculate the memory you need in bytes.
<DT>
<DD> If the <CODE>FractEnable</CODE> global variable has been set to <CODE>TRUE</CODE> through the <CODE>SetFractEnable</CODE> procedure, the values in <CODE>awArray</CODE> have fractional character widths. If <CODE>FractEnable</CODE> has been set to <CODE>FALSE</CODE>, the Font Manager returns integer values for the advance widths, with 0 in the decimal part of the values. 
<DT><CODE>lsbArray</CODE>
<DD> A pointer to an array that is, on output, filled with the left-side bearing measurements for the glyphs being measured. The measurements are in pixels, based on the point size of the current font. There is an entry in this array for each glyph that is being measured.<A NAME=MARKER-2-201></A> 
<DT>
<DD> The <CODE>lsbArray</CODE> parameter is of type <CODE>FixedPtr</CODE>. The <CODE>FixedPtr</CODE> data type is a pointer to an array, and each entry in the array is of type <CODE>Fixed</CODE>, which is 4 bytes in length. Multiply <CODE>byteCount</CODE> by 4 to calculate the memory you need in bytes.
<DT>
<DD> Left-side bearing values are not rounded.
<DT><CODE>boundsArray</CODE>
<DD> A pointer to an array that is, on output, filled with the bounding boxes for the glyphs being measured. Bounding boxes are the smallest rectangles that fit around the pixels of the glyph. There is an entry in this array for each glyph that is being measured. 
<DT>
<DD> The coordinate system used to describe the bounding boxes is in pixel units, centered at the glyph origin, and with a vertical positive direction upwards, which is the opposite of the QuickDraw vertical orientation.
<DT>
<DD> The <CODE>boundsArray</CODE> parameter is of type <CODE>RectPtr</CODE>. The <A NAME=MARKER-2-186></A><CODE>RectPtr</CODE> data type is a pointer to QuickDraw's <CODE>Rect</CODE> data type, which is 8 bytes in length. Multiply <CODE>byteCount</CODE> by 8 to calculate the memory you need in bytes. Allocate the memory needed for the array and pass a pointer to the array in the <CODE>boundsArray</CODE> parameter.
</DL>
<A NAME=HEADING233-18></A>
<H5>DESCRIPTION</H5>
 The <CODE>OutlineMetrics</CODE> function computes the maximum y-value, minimum y-value, advance widths, left-side bearings, and bounding boxes for a block of text. It uses the font, size, and style specified in the current graphics port. You can use these measurements when laying out text. You may need to adjust line spacing to accommodate exceptionally large glyphs.<P>
 The <CODE>OutlineMetrics</CODE> function works for outline fonts only and is the preferred method for measuring text that is drawn with an outline font.<P>
 When you are using <CODE>OutlineMetrics</CODE> to compute advance width values, left-side bearing values, or bounding boxes, you need to bear in mind that when a text block contains 2-byte characters, not every byte in the <CODE>awArray</CODE>, <CODE>lsbArray</CODE>, and <CODE>boundsArray</CODE> structures is used. Each of these arrays is indexed by the glyph index; thus, if you have five characters in a string and two of them are 2-byte characters, only the first five entries in each array contains a value. Call the <CODE>CharByte</CODE> function (described in the chapter "Script Manager" in this book) to determine how many characters there are in the text block, and ignore the unused array entries (which occur at the end of each array). <P>
 If you don't want <CODE>OutlineMetrics</CODE> to compute one of these three values, pass <CODE>NIL</CODE> in the applicable parameter. Otherwise, allocate the amount of memory needed for the array and pass a pointer to it in this parameter.<P>
<A NAME=HEADING233-23></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and selector for the <CODE>OutlineMetrics</CODE> procedure are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_FontDispatch<TD>$7008</TABLE>
<P>
<A NAME=HEADING233-25></A>
<H5>SEE ALSO</H5>
 The terms used for measuring text, including advance width, left-side bearing, and bounding box, are described in the section <A HREF=Text-186.html#MARKER-9-58>"Font Measurements,"</A> which begins on <A HREF=Text-186.html#MARKER-9-58>page 4-8</A>. Scaling of fonts and the use of the font scaling factors are described in the section <A HREF=Text-196.html#MARKER-9-147>"How the Font Manager Scales Fonts,"</A> which begins on <A HREF=Text-196.html#MARKER-9-147>page 4-19</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-232.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-234.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
