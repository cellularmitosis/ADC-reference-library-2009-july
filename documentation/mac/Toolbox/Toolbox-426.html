<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>ModalDialog(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING426></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-425.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-427.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-370.html"><B>Chapter 6 - Dialog Manager</B></A> / <A HREF="Toolbox-386.html"><B>Dialog Manager Reference</B></A><BR><DL><DD><A HREF="Toolbox-389.html"><B>Dialog Manager Routines</B></A> / <A HREF="Toolbox-425.html"><B>Handling Events in Dialog Boxes </B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING426-0></A>
<H3><A NAME=MARKER-9-551></A>ModalDialog</H3>
 <A NAME=MARKER-11-552></A><A NAME=MARKER-2-553></A>To handle events when you display a modal dialog box, use the <CODE>ModalDialog</CODE> procedure.<P>
<PRE>
PROCEDURE ModalDialog (filterProc: ModalFilterProcPtr; 
                        VAR itemHit: Integer);
</PRE>
<DL>
<DT><CODE>filterProc</CODE>
<DD> A pointer to an event filter function.
<DT><CODE>itemHit</CODE>
<DD> <DFN>A </DFN>number representing the position of the selected item in the item list resource for the active modal dialog box.
</DL>
<A NAME=HEADING426-5></A>
<H5>DESCRIPTION</H5>
 Call the <CODE>ModalDialog</CODE> procedure immediately after displaying a modal dialog box. The <CODE>ModalDialog</CODE> procedure assumes that a modal dialog box is displayed as the current port, and <CODE>ModalDialog</CODE> repeatedly handles events inside that port until an event involving an enabled dialog box item--such as a click in a radio button, for example--occurs. If the event is a mouse-down event outside the content region of the dialog box, <CODE>ModalDialog</CODE> emits the system alert sound and gets the next event. After receiving an event involving an enabled item, <CODE>ModalDialog</CODE> returns its item number in the <CODE>itemHit</CODE> parameter. Your application should then do whatever is appropriate in response to an event in that item. Your application should continue calling <CODE>ModalDialog</CODE> until the user selects the OK or Cancel button. <P>
 For events inside the dialog box, <CODE>ModalDialog</CODE> passes the event to the event filter function pointed to in the <CODE>filterProc</CODE> parameter before handling the event. When the event filter returns <CODE>FALSE</CODE>, <CODE>ModalDialog</CODE> handles the event. If the event filter function handles the event, the event filter function returns <CODE>TRUE</CODE>, and <CODE>ModalDialog</CODE> performs no more event handling.<P>
 If you set the <CODE>filterProc</CODE> parameter to <CODE>NIL</CODE>, the standard event filter function is executed. The standard event filter function returns <CODE>TRUE</CODE> and causes <CODE>ModalDialog</CODE> to return item number <DFN>1</DFN>, which is the number of the default button, when the user presses the Return key or the Enter key. However, your application should provide a simple event filter function that<P>
<UL>
<LI>returns <CODE>TRUE</CODE> and the item number for the default button if the user presses the Return or Enter key
<LI>returns <CODE>TRUE</CODE> and the item number for the Cancel button if the user presses the Esc key or the Command-period key combination
<LI>updates your windows in response to update events (this allows background applications to receive update events) and return <CODE>FALSE</CODE> 
<LI>returns <CODE>FALSE</CODE> for all events that your event filter function doesn't handle<P>
</UL>
 You can use the same event filter function in most or all of your alert and modal <BR>dialog boxes.<P>
 You can also use the event filter function specified in the <CODE>filterProc</CODE> parameter to test for and respond to keyboard equivalents and more complex events--for instance, the user dragging the cursor within an application-defined item.<P>
 To handle events, <CODE>ModalDialog</CODE> calls the <CODE>IsDialogEvent</CODE> function. If the result of <CODE>IsDialogEvent</CODE> is <CODE>TRUE</CODE>, then <CODE>ModalDialog</CODE> calls the <CODE>DialogSelect</CODE> function to handle the event. Unless the event filter function returns <CODE>TRUE</CODE>, <CODE>ModalDialog</CODE> handles the event as follows:<P>
<UL>
<LI>In response to an activate or update event for the dialog box, <CODE>ModalDialog</CODE> activates or updates its window.
<LI>If the user presses the mouse button while the cursor is in an editable text item, <CODE>ModalDialog</CODE> responds to the mouse activity as appropriate--that is, either by displaying an insertion point or by selecting text. If a key-down event occurs and there's an editable text item, <CODE>ModalDialog</CODE> uses TextEdit to handle text entry and editing automatically. If the editable text item is enabled, <CODE>ModalDialog</CODE> returns its item number after it receives either the mouse-down or key-down event. Normally, editable text items are disabled, and you use the <CODE>GetDialogItemText</CODE> procedure to read the information in the items only after the user clicks the OK button.
<LI>If the user presses the mouse button while the cursor is in a control, <CODE>ModalDialog</CODE> calls the Control Manager function <CODE>TrackControl</CODE>. If the user releases the mouse button while the cursor is in an enabled control, <CODE>ModalDialog</CODE> returns the control's item number. Your application should respond appropriately--for example, by performing a command after the user clicks the OK button.
<LI>If the user presses the mouse button while the cursor is in any other enabled item in the dialog box, <CODE>ModalDialog</CODE> returns the item's number, and your application should respond appropriately. Generally, only controls should be enabled. If your application creates a control more complex than a button, radio button, or checkbox, your application must handle events inside that item with your event filter function.
<LI>If the user presses the mouse button while the cursor is in a disabled item or in no item, or if any other event occurs, <CODE>ModalDialog</CODE> does nothing.<P>
</UL>
<A NAME=HEADING426-21></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Do not use <CODE>ModalDialog</CODE> for movable modal dialog boxes (that is, those created with the <CODE>movableDBoxProc</CODE> window definition ID) or for modeless dialog boxes (that is, those created with the <CODE>noGrowDocProc</CODE> window definition ID). If you want the Dialog Manager to assist you in handling events for movable modal and modeless dialog boxes, use the <CODE>IsDialogEvent</CODE> and <CODE>DialogSelect</CODE> functions instead.<P>
 The <CODE>ModalDialog</CODE> procedure calls the Event Manager function <CODE>GetNextEvent</CODE> with a mask that excludes disk-inserted events. To receive disk-inserted events, your event filter function can call the Event Manager procedure <CODE>SetSystemEventMask</CODE>.<P>
 When <CODE>ModalDialog</CODE> calls <CODE>TrackControl</CODE>, it does not allow you to specify the action procedure necessary for anything more complex than a button, radio button, or checkbox. If you need a more complex control (for example, one that measures how long the user holds down the mouse button or how far the user has moved an indicator), you can create your own control, a picture, or an application-defined item that draws a control- like object in your dialog box. You must then provide an event filter function that appropriately handles events in that item.<P>
<A NAME=HEADING426-25></A>
<H5>SEE ALSO</H5>
 <A HREF=Toolbox-385.html#MARKER-9-337>Listing 6-26 on page 6-83</A> illustrates the use of <CODE>ModalDialog</CODE>. <A HREF=Toolbox-385.html#MARKER-9-312>"Responding to Events in Editable Text Items" beginning on page 6-79</A> describes how <CODE>ModalDialog</CODE> uses TextEdit to handle text entry and editing in editable text items. The <CODE>IsDialogEvent</CODE> and <CODE>DialogSelect</CODE> functions (which your application may use instead of <CODE>ModalDialog</CODE> for modeless and movable modal dialog boxes) are described on <A HREF=Toolbox-427.html#MARKER-9-555>page 6-131</A> and <A HREF=Toolbox-428.html#MARKER-9-560>page 6-132</A>, respectively. See the description of <CODE>MyEventFilter</CODE> on <A HREF=Toolbox-434.html#MARKER-9-578>page 6-138</A> for information about the event filter function your application should specify in the <CODE>filterProc</CODE> parameter.<P>
 The <CODE>GetNextEvent</CODE> and <CODE>SetSystemEventMask</CODE> routines are described in the chapter "Event Manager" in this book. See that chapter as well for a discussion of disk-inserted events. See <A HREF=Toolbox-385.html#MARKER-9-298>"Responding to Events in Controls" on page 6-78</A> for a description of how your application should respond to events inside of controls; the <CODE>TrackControl</CODE> function is fully described in the chapter "Control Manager" in this book. Also see that chapter for information about creating your own nonstandard controls. TextEdit is described in the chapter "TextEdit" of <I>Inside Macintosh: Text.</I><A NAME=MARKER-2-554></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-425.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-427.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
