<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Programming With Navigation Services in Mac OS 9 (Legacy): Navigation Services Tasks</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Navigation Services Tasks"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	<meta name="ROBOTS" content="NOINDEX"/>
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000930-CH202" title="Navigation Services Tasks"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../LegacyTechnologies/index.html#//apple_ref/doc/uid/TP30000440-TP30000470" target="_top">Legacy Documents</a> &gt; <a href="../../../../LegacyTechnologies/MacOS9Earlier-date.html#//apple_ref/doc/uid/TP30000440-TP30000470-TP30000540" target="_top">Mac OS 9 &amp; Earlier</a> &gt; <a href="../ns_intro/ns_intro.html#//apple_ref/doc/uid/TP40000930-CH204-DontLinkElementID_43">Programming With Navigation Services in Mac OS 9 (Legacy)</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../ns_about/about_ns.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../ns_rev_hx/ns_rev_hx.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        <script type="text/javascript" language="JavaScript">placeWatermark()</script>
<div id="legacyOuterWrapper"><div align="center" id="watermark">
<div class="legacybox">
<h1>Legacy Document<span class="closebutton"><a href="javascript:closeWatermark()"><img src="../../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>
        <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_46" title="Navigation Services Tasks"></a><h1><a name="//apple_ref/doc/uid/TP40000930-CH202-BCGJBGAC" title="Navigation Services Tasks"></a>Navigation Services Tasks</h1><p>This chapter describes how you can use Navigation Services for tasks like opening and saving files and choosing file objects, and how you can implement custom features in Navigation Services dialog boxes. You should read this chapter to learn how to incorporate Navigation Services into your application.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_12">Basic Tasks</a>
				
			<br/>
			
        
			
			
				<a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_24">Advanced Tasks</a>
				
			<br/>
			
        
			
			
				<a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJBCJJJ">Creating Application-Defined Functions</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_12" title="Basic Tasks"></a><h2>Basic Tasks</h2><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_126"></a><p>Navigation Services is designed to provide a simple, flexible way for applications to open and save files. The primary way to open files is to call the <code>NavGetFile</code> function. The primary way to save files is to call the <code>NavPutFile</code> function.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_13" title="Opening Files"></a><h3>Opening Files</h3><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_127"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_128"></a><p>The function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_129"></a><code>NavGetFile</code> displays an Open dialog box that prompts the user to select one or more files to open, as shown in <span class="content_text">Figure 3-1</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_47" title="Figure 2-1Open dialog box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDEFEH" title="Figure 2-1Open dialog box"></a><strong>Figure 2-1&nbsp;&nbsp;</strong>Open dialog box</p><img src = "../art/ns_s_24.gif" alt = "Open dialog box" width="399" height="230"></div><br/><p>For a description of the elements of an Open dialog box, see <span class="content_text"><a href="../ns_about/about_ns.html#//apple_ref/doc/uid/TP40000930-CH201-CHCDDFJF">“User Interface.”</a></span></p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_48" title="Note"></a><p><strong>Note:</strong>&nbsp; You are strongly encouraged to make all Navigation Services dialog boxes movable by providing an event-handling function. For more information, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCJEAA">“Handling Events.”</a></span></p></div><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJCEAHJ" title="Providing File Opening Options"></a><h4>Providing File Opening Options</h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_130"></a><p>The Open dialog box’s <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_131"></a>Show pop-up menu allows the user to choose the file types displayed by the browser list. The list of available file types is built from information provided by your application when it calls the <code>NavGetFile</code> function and by the Translation Manager. If you don’t want the Show pop-up menu button to be displayed, specify the <code>kNavNoTypePopup</code> constant in the <code>dialogOptionFlags</code> field of a structure of type <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_132"></a><code>NavDialogOptions</code> when you pass this structure in the <code>dialogOptions</code> parameter of a file-opening function such as <code>NavGetFile</code>.</p><p>Navigation Services uses the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_133"></a>Translation Manager to produce a list of file types that your application is capable of translating and displays the list to the user through an <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_134"></a>expanded Show pop-up menu. <span class="content_text">Figure 3-2</span> shows an example of a Show pop-up menu with file translation options. </p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_49" title="Figure 2-2A Show pop-up menu with file translation option"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BCGGHACI" title="Figure 2-2A Show pop-up menu with file translation option"></a><strong>Figure 2-2&nbsp;&nbsp;</strong>A Show pop-up menu with file translation option</p><img src = "../art/ns_s_26.gif" alt = "A Show pop-up menu with file translation option" width="233" height="126"></div><br/><p>The first section of the Show menu contains an item called “<a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_135"></a>All Readable Documents.” If the user selects this item, the browser list displays all files of the types shown in the second and third sections of the menu.</p><p>The second section of the Show menu contains an item called “All &lt;app name> Documents” followed by your application’s “native” file types. <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_136"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_137"></a>Native file types are those types you provide in the <code>typeList</code> parameter of the file-opening function. This parameter uses the same format as an <code>'open'</code><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_138"></a> resource and may be loaded from a resource or passed in as a <code>NavTypeList</code> structure created on the fly. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_50" title="Note"></a><p><strong>Note:</strong>&nbsp;Navigation Services does not automatically load an <code>'open'</code> resource. Your application must pass a pointer to it in the <code>typeList</code> parameter of the file-opening function.</p></div><p>Your application must also contain a <code>'kind'</code><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_139"></a> resource with entries for each type of file that you want to include in the <code>typeList</code> parameter. If you don’t provide an entry for a file type, Navigation Services returns a result of <code>kNavMissingKindStringErr</code> (-5699). For more information on <code>'kind'</code> resources, see <em>Inside Macintosh: More Macintosh Toolbox</em>.</p><p>Listing a file type in the <code>typeList</code> parameter generally limits you to displaying only those files created by your application. If you specify the <code>kNavNoTypePopup</code> constant in the <code>dialogOptionFlags</code> field of the <code>NavDialogOptions</code> structure you pass in the <code>dialogOptions</code> parameter, or if the user selects All Readable Items from the Show menu, Navigation Services will ignore the application signature specified in the <code>typeList</code> parameter and display all documents of the specified types. If you choose not to specify file types in the <code>typeList</code> parameter, you can show all files of a particular type in the browser list by using an application-defined filter function. Using a filter function would, for example, allow you to show all text files, regardless of which application created them. For more information on filter functions, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCHDJA">“Filtering File Objects.”</a></span></p><p>The third section of the expanded Show pop-up menu contains a list of translatable file types provided by the Translation Manager. Typical names for these entries describe an application document type, such as “MoviePlayer document” in <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BCGGHACI">Figure 3-2</a></span>. Navigation Services automatically opens and translates file types recognized by the Translation Manager unless you supply the <code>kNavDontAutoTranslate</code> constant in the <code>dialogOptionFlags</code> field of the <code>NavDialogOptions</code> structure you pass in the <code>dialogOptions</code> parameter. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_51" title="Note"></a><p><strong>Note:</strong>&nbsp;The translatable files section does not appear if you supply the <code>kNavDontAddTranslateItems</code> constant in the <code>dialogOptionFlags</code> field of the <code>NavDialogOptions</code> structure you pass in the <code>dialogOptions</code> parameter.</p></div><p>The last section of the pop-up menu is reserved for the “<a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_140"></a>All Documents” menu item. This item appears if your application supplies the <code>kNavAllFilesInPopup</code> constant in the <code>dialogOptionFlags</code> field of the <code>NavDialogOptions</code> structure you pass in the <code>dialogOptions</code> parameter. This option allows the display of all files, regardless of your application’s ability to translate or open them directly. A resource editing application, for example, might take advantage of this option.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDCCIJ" title="Translating Files on Open"></a><h4>Translating Files on Open</h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_141"></a><p>If the user selects a file type that is not passed in the <code>typeList</code> parameter, the chosen file must be translated. If the user opens a file called “Doc1” that requires translation, Navigation Services creates a new file called “Doc1 (converted)” with the appropriate file type, in the same directory as the original file. The <code>NavGetFile</code> function automatically performs the translation before returning. However, you can disable this feature by supplying the <code>kNavDontAutoTranslate</code> constant in the <code>dialogOptionFlags</code> field of the structure of type <code>NavDialogOptions</code> you pass in the <code>dialogOptions</code> parameter of the file-opening function. If you disable automatic translation, it is left to your application to call the function <code>NavTranslateFile</code> as needed. </p><p>You can obtain translation information from the structure of type <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_142"></a><code>NavReplyRecord</code> that you passed in the <code>reply</code> parameter of the file-opening function. When the file-opening function returns, the <code>fileTranslation</code> field of the <code>NavReplyRecord</code> structure points to an array of translation records. This array contains one translation record for each file selection identified in the <code>selection</code> field of the <code>NavReplyRecord</code> structure. If you disable automatic translation, you can use the translation records to provide your own translation.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_52" title="Note"></a><p><strong>Note:</strong>&nbsp;If a file described in the <code>selection</code> field of the <code>NavReplyRecord</code> structure does not require translation, its corresponding translation record will be empty.</p></div><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJCHBFD" title="A Sample File-Opening Function"></a><h4>A Sample File-Opening Function</h4><p><span class="content_text">Listing 3-1</span> shows a sample function illustrating one way to call the function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_143"></a><code>NavGetFile</code>. This listing shows how to get default options, modify the options, use an <code>'open'</code> resource, and open multiple files.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_53" title="Note"></a><p><strong>Note:</strong>&nbsp;This listing and other code samples in this document show how to handle an Apple event descriptor of type <code>'typeFSS'</code><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_144"></a>. Your application should not assume that Navigation Services returns descriptors of any particular type.</p></div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_54" title="Listing 2-1A sample file-opening function"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJCDGBI" title="Listing 2-1A sample file-opening function"></a><strong>Listing 2-1&nbsp;&nbsp;</strong>A sample file-opening function</p><div class="codesample"><table><tr><td scope="row"><pre>OSErr MyOpenDocument(const FSSpecPtr defaultLocationfssPtr)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NavDialogOptions    dialogOptions;<span></span></pre></td></tr><tr><td scope="row"><pre>    AEDesc              defaultLocation;<span></span></pre></td></tr><tr><td scope="row"><pre>    NavEventUPP         eventProc = NewNavEventProc(myEventProc);<span></span></pre></td></tr><tr><td scope="row"><pre>    NavObjectFilterUPP  filterProc =<span></span></pre></td></tr><tr><td scope="row"><pre>                        NewNavObjectFilterProc(myFilterProc);<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr               anErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    //  Specify default options for dialog box<span></span></pre></td></tr><tr><td scope="row"><pre>    anErr = NavGetDefaultDialogOptions(&amp;dialogOptions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (anErr == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        //  Adjust the options to fit our needs<span></span></pre></td></tr><tr><td scope="row"><pre>        //  Set default location option<span></span></pre></td></tr><tr><td scope="row"><pre>        dialogOptions.dialogOptionFlags |= kNavSelectDefaultLocation;<span></span></pre></td></tr><tr><td scope="row"><pre>        //  Clear preview option<span></span></pre></td></tr><tr><td scope="row"><pre>        dialogOptions.dialogOptionFlags ^= kNavAllowPreviews;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        // make descriptor for default location<span></span></pre></td></tr><tr><td scope="row"><pre>        anErr = AECreateDesc(typeFSS, defaultLocationfssPtr,<span></span></pre></td></tr><tr><td scope="row"><pre>                             sizeof(*defaultLocationfssPtr),<span></span></pre></td></tr><tr><td scope="row"><pre>                             &amp;defaultLocation );<span></span></pre></td></tr><tr><td scope="row"><pre>        if (anErr == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>            // Get 'open' resource. A nil handle being returned is OK,<span></span></pre></td></tr><tr><td scope="row"><pre>            // this simply means no automatic file filtering.<span></span></pre></td></tr><tr><td scope="row"><pre>            NavTypeListHandle typeList = (NavTypeListHandle)GetResource(<span></span></pre></td></tr><tr><td scope="row"><pre>                                        'open', 128);<span></span></pre></td></tr><tr><td scope="row"><pre>            NavReplyRecord reply;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            // Call NavGetFile() with specified options and<span></span></pre></td></tr><tr><td scope="row"><pre>            // declare our app-defined functions and type list<span></span></pre></td></tr><tr><td scope="row"><pre>            anErr = NavGetFile (&amp;defaultLocation, &amp;reply, &amp;dialogOptions,<span></span></pre></td></tr><tr><td scope="row"><pre>                                eventProc, nil, filterProc,<span></span></pre></td></tr><tr><td scope="row"><pre>                                typeList, nil);<span></span></pre></td></tr><tr><td scope="row"><pre>            if (anErr == noErr &amp;&amp; reply.validRecord)<span></span></pre></td></tr><tr><td scope="row"><pre>            {<span></span></pre></td></tr><tr><td scope="row"><pre>                //  Deal with multiple file selection<span></span></pre></td></tr><tr><td scope="row"><pre>                long    count;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                anErr = AECountItems(&amp;(reply.selection), &amp;count);<span></span></pre></td></tr><tr><td scope="row"><pre>                // Set up index for file list<span></span></pre></td></tr><tr><td scope="row"><pre>                if (anErr == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>                {<span></span></pre></td></tr><tr><td scope="row"><pre>                    longindex;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                    for (index = 1; index &lt;= count; index++)<span></span></pre></td></tr><tr><td scope="row"><pre>                    {<span></span></pre></td></tr><tr><td scope="row"><pre>                        AEKeyword   theKeyword;<span></span></pre></td></tr><tr><td scope="row"><pre>                        DescType    actualType;<span></span></pre></td></tr><tr><td scope="row"><pre>                        Size        actualSize;<span></span></pre></td></tr><tr><td scope="row"><pre>                        FSSpec      documentFSSpec;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                        // Get a pointer to selected file<span></span></pre></td></tr><tr><td scope="row"><pre>                        anErr = AEGetNthPtr(&amp;(reply.selection), index,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            typeFSS, &amp;theKeyword,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            &amp;actualType,&amp;documentFSSpec,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            sizeof(documentFSSpec),<span></span></pre></td></tr><tr><td scope="row"><pre>                                            &amp;actualSize);<span></span></pre></td></tr><tr><td scope="row"><pre>                        if (anErr == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>                        {<span></span></pre></td></tr><tr><td scope="row"><pre>                            anErr = DoOpenFile(&amp;documentFSSpec);<span></span></pre></td></tr><tr><td scope="row"><pre>                        }<span></span></pre></td></tr><tr><td scope="row"><pre>                    }<span></span></pre></td></tr><tr><td scope="row"><pre>                }<span></span></pre></td></tr><tr><td scope="row"><pre>                //  Dispose of NavReplyRecord, resources, descriptors<span></span></pre></td></tr><tr><td scope="row"><pre>                anErr = NavDisposeReply(&amp;reply);<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            if (typeList != NULL)<span></span></pre></td></tr><tr><td scope="row"><pre>            {<span></span></pre></td></tr><tr><td scope="row"><pre>                ReleaseResource( (Handle)typeList);<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            (void) AEDisposeDesc(&amp;defaultLocation);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    DisposeRoutineDescriptor(eventProc);<span></span></pre></td></tr><tr><td scope="row"><pre>    DisposeRoutineDescriptor(filterProc);<span></span></pre></td></tr><tr><td scope="row"><pre>    return anErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_14" title="Choosing File Objects"></a><h3>Choosing File Objects</h3><p>Navigation Services provides functions that prompt the user to select <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_145"></a>file objects (files, folders, or volumes) or create a new folder.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_15" title="Choosing a File"></a><h4>Choosing a File</h4><p>The function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_146"></a><code>NavChooseFile</code> displays a dialog box that prompts the user to choose a file for some action other than opening. The file could be a preference file, dictionary, or other specialized file. <span class="content_text">Figure 3-3</span>shows an example of this dialog box.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_55" title="Figure 2-3Choose a File dialog box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BCGFCGGC" title="Figure 2-3Choose a File dialog box"></a><strong>Figure 2-3&nbsp;&nbsp;</strong>Choose a File dialog box</p><img src = "../art/ns_s_10.gif" alt = "Choose a File dialog box" width="322" height="216"></div><br/><p>Since this is a simplified function, no built-in translation is available and no Show menu is available. By default, Navigation Services performs no filtering on the files it displays in the browser list. You need to provide file types in the <code>typeList</code> parameter or implement an application-defined filter function if you want to affect the file types displayed in the browser list. The <code>NavChooseFile</code> function ignores the <code>componentSignature</code> field of the <code>NavTypeList</code> structure, so all files of the types specified in the <code>typeList</code> parameter will be shown, regardless of their application signature. For more information on filtering options, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCHDJA">“Filtering File Objects.”</a></span></p><p>You can provide a message or “banner” in the Choose File dialog box by supplying a string in the <code>message</code> field of the structure of type <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> parameter of the <code>NavChooseFile</code> function. This string is displayed below the browser list. If you do not supply a string, no message is displayed.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_16" title=" Choosing a Folder"></a><h4> Choosing a Folder</h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_147"></a><p>The function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_148"></a><code>NavChooseFolder</code> displays a dialog box that prompts the user to choose a folder, as shown in <span class="content_text">Figure 3-4</span>. This could be useful when performing installations, for example.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_56" title="Figure 2-4Choose a Folder dialog box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BCGIBEGF" title="Figure 2-4Choose a Folder dialog box"></a><strong>Figure 2-4&nbsp;&nbsp;</strong>Choose a Folder dialog box</p><img src = "../art/ns_s_04.gif" alt = "Choose a Folder dialog box" width="432" height="190"></div><br/><p>The browser list in a Choose a Folder dialog box displays folders and volumes only.</p><p>One possible source of confusion to users who wish to use <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_149"></a>keyboard equivalents in a list-based file system browser is the purpose of the Enter or Return keys: do they select a folder or do they open it? Navigation Services resolves this issue by mapping the Return and Enter keys to the Open button, which is used to navigate into folders. After navigating to the desired location, the user clicks the Choose button to select the folder.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_57" title="Note"></a><p><strong>Note:</strong>&nbsp;If the user navigates to the desktop, deselects the current selection by shift-clicking and presses the Choose button, <code>NavChooseFolder</code> identifies the desktop as the folder chosen.</p></div><p>You can provide a message or “banner” in the Choose a Folder dialog box by supplying a string in the <code>message</code> field of the structure of type <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> parameter of the <code>NavChooseFolder</code> function. This string is displayed below the browser list. In <span class="content_text">Figure 3-4</span>, for example, the application supplies the string, “Please select a folder.” If you do not supply a string, no message is displayed.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_17" title=" Choosing a Volume"></a><h4> Choosing a Volume</h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_150"></a><p>The function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_151"></a><code>NavChooseVolume</code> displays a dialog box that prompts the user to choose a volume, as shown in <span class="content_text">Figure 3-5</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_58" title="Figure 2-5Choose a Volume dialog box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BCGJIJEB" title="Figure 2-5Choose a Volume dialog box"></a><strong>Figure 2-5&nbsp;&nbsp;</strong>Choose a Volume dialog box</p><img src = "../art/ns_s_08.gif" alt = "Choose a Volume dialog box" width="322" height="216"></div><br/><p>This function is useful when you want the user to select a volume or storage device.</p><p>You can provide a message or “banner” in the Choose a Volume dialog box by supplying a string in the <code>message</code> field of the structure of type <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> parameter of the <code>NavChooseVolume</code> function. This string is displayed below the browser list. For example, a disk repair utility might supply a message like “Please choose a volume to repair.” If you do not supply a string, no message is displayed.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_18" title=" Choosing File System Objects"></a><h4> Choosing File System Objects</h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_152"></a><p>The function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_153"></a><code>NavChooseObject</code> displays a dialog box that prompts the user to select a file object, as shown in <span class="content_text">Figure 3-6</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_59" title="Figure 2-6Choose Object dialog box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDICFG" title="Figure 2-6Choose Object dialog box"></a><strong>Figure 2-6&nbsp;&nbsp;</strong>Choose Object dialog box</p><img src = "../art/ns_s_25.gif" alt = "Choose Object dialog box" width="358" height="218"></div><br/><p>This function is useful when you need the user to select an object that might be one of several different types. If you need to have the user select an object of a specific type, you should use the function appropriate to that type. For example, if you know the object is a file, use the function <code>NavChooseFile</code>. </p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_60" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code>NavChooseObject</code> function does not allow the user to choose zones, servers, or any other network object.</p></div><p>You can provide a message or “banner” in the Choose Object dialog box by supplying a string in the <code>message</code> field of the structure of type <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> parameter of the <code>NavChooseObject</code> function. This string is displayed below the browser list. In <span class="content_text">&lt;xRefNoLink>Figure 3-6</span>, for example, the application supplies the string, “Please choose a file object.” If you do not supply a string, no message is displayed.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_19" title=" Creating a New Folder"></a><h4> Creating a New Folder</h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_154"></a><p>The function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_155"></a><code>NavNewFolder</code> displays a dialog box that prompts the user to create a new folder, as shown in <span class="content_text">Figure 3-7</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_61" title="Figure 2-7New Folder dialog box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BCGJJGDF" title="Figure 2-7New Folder dialog box"></a><strong>Figure 2-7&nbsp;&nbsp;</strong>New Folder dialog box</p><img src = "../art/ns_s_11.gif" alt = "New Folder dialog box" width="322" height="214"></div><br/><p>You can provide a message or “banner” in the New Folder dialog box by supplying a string in the <code>message</code> field of the structure of type <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> parameter of the <code>NavNewFolder</code> function. This string is displayed below the browser list. For example, the Sampler installer might provide a message like “Create a folder to install Sampler.” If you do not supply a string, no message is displayed.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJBHBGF" title="Saving Files"></a><h3>Saving Files</h3><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_156"></a><p>The function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_157"></a><code>NavPutFile</code> displays a Save dialog box, as shown in <span class="content_text">Figure 3-8</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_62" title="Figure 2-8Save dialog box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDIDCC" title="Figure 2-8Save dialog box"></a><strong>Figure 2-8&nbsp;&nbsp;</strong>Save dialog box</p><img src = "../art/ns_s_03.gif" alt = "Save dialog box" width="430" height="344"></div><br/><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_63" title="Note"></a><p><strong>Note:</strong>&nbsp;You are strongly encouraged to make all Navigation Services dialog boxes movable by providing updates via an event-handling function. For more information, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCJEAA">“Handling Events.”</a></span></p></div><p>Users can create a new folder for saving a document by using the New Folder button.</p><p>When the user selects a folder, the default button title toggles from Save to Open. When the user selects the editable text field (by clicking or keyboard selection), the default button title reverts to Save. </p><p>Save dialog boxes display a <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_158"></a>focus ring to indicate whether the browser list or the editable text field has <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_159"></a>keyboard focus (that is, the area that receives all keystrokes.) When no filename is displayed in the editable text field, the Save button is disabled.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_64" title="Important:"></a><p><strong>Important:</strong>&nbsp;Always call the function <code>NavCompleteSave</code> after calling the <code>NavPutFile</code> function, even if your application doesn’t need automatic translations. Future versions of Navigation Services may provide additional features to your application when it calls the <code>NavCompleteSave</code> function.</p><p></p></div><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJBIAEA" title="Providing File Format Options"></a><h4>Providing File Format Options</h4><p>The <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_160"></a><code>NavPutFile</code> function provides the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_161"></a>Format pop-up menu button to allow users to choose how a new document or a copy of a document is to be saved. <span class="content_text">Figure 3-9</span> shows an example of this menu.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_65" title="Figure 2-9Format pop-up menu"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BCGIDBHH" title="Figure 2-9Format pop-up menu"></a><strong>Figure 2-9&nbsp;&nbsp;</strong>Format pop-up menu</p><img src = "../art/ns_s_13.gif" alt = "Format pop-up menu" width="200" height="79"></div><br/><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_66" title="Note"></a><p><strong>Note:</strong>&nbsp;If you specify the <code>kNavNoTypePopup</code> constant in the dialogOptionFlags field of the structure <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> field of the <code>NavPutFile</code> function, the Format button does not appear in the Save dialog box.</p></div><p>The first item in the Format pop-up menu is defined by the document type specified by your application in the <code>fileType</code> and <code>fileCreator</code> parameters of the<code>NavPutFile</code> function. The name of the menu item is obtained from the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_162"></a>Translation Manager. After setting this item, Navigation Services calls the Translation Manager to determine whether to display subsequent menu items describing alternative file types. For more information, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCDGHG">“Translating Files on Save.”</a></span></p><p>The last item in the menu is the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_163"></a>Stationery Option command. This displays the Stationery Option dialog box, shown in <span class="content_text">Figure 3-10</span>, which lets the user specify whether a new document or a copy of a document should be saved as a document or as stationery.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_67" title="Figure 2-10Stationery Option dialog box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDIAJA" title="Figure 2-10Stationery Option dialog box"></a><strong>Figure 2-10&nbsp;&nbsp;</strong>Stationery Option dialog box</p><img src = "../art/ns_s_12.gif" alt = "Stationery Option dialog box" width="175" height="115"></div><br/><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_68" title="Note"></a><p><strong>Note:</strong>&nbsp;If you clear the <code>kNavAllowStationery </code>constant in the <code>dialogOptionFlags</code> field of the structure <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> field of the <code>NavPutFile</code> function, the Stationery Option menu item does not appear.</p></div><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJCDGHG" title="Translating Files on Save"></a><h4>Translating Files on Save</h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_164"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_165"></a><p>Your application supplies its default file type and creator for saved files to the function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_166"></a><code>NavPutFile</code>. Navigation Services uses this information to build a pop-up menu of available translation choices obtained from the Translation Manager. If the user selects an output file type that is different from the native type, Navigation Services prepares a translation specification and supplies a handle to it in the <code>fileTranslation</code> field of a structure of type <code>NavReplyRecord</code>. If you choose to provide your own translation, Navigation Services informs you that translation is required by setting the translationNeeded field of the <code>NavReplyRecord</code>structure to <code>true</code>. </p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_69" title="Important:"></a><p><strong>Important:</strong>&nbsp;The function <code>NavTranslateFile</code> is intended to be used only while opening files. Always call the function <code>NavCompleteSave</code> to provide automatic translation and complete a save operation.</p><p></p></div><p>When saving a document for the first time, your application should wait until the user closes the document before calling the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_167"></a><code>NavCompleteSave</code> function. This allows your application to save the file in a native format as the user works with the file. When saving a copy of a document, your application should call the <code>NavCompleteSave</code> function immediately after returning from the<code> NavPutFile</code> function.</p><p>The <code>NavCompleteSave</code> function provides any necessary translation. If you wish to turn off <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_168"></a>automatic translation during a save operation, set the value of the translationNeeded field of the <code>NavReplyRecord</code>structure to <code>false </code>before you call the <code>NavCompleteSave</code> function.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_70" title="Note"></a><p><strong>Note:</strong>&nbsp;You do not need to set the value of the translationNeeded field of the <code>NavReplyRecord</code>structure to <code>false</code> if the user creates a new document that requires translation, but closes it without saving any data.</p></div><p>Once the save is completed, your application must dispose of the <code>NavReplyRecord</code> structure by calling the function <code>NavDisposeReply</code>. </p><p>By default, the <code>NavPutFile</code> function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_169"></a>saves translations as a copy of the original file. Your application can direct Navigation Services to replace the original with the translation by passing the kNavTranslateInPlace constant, described in Translation Option Constants, in the <code>howToTranslate</code> parameter of the <code>NavCompleteSave</code> function.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJEBAHH" title="A Sample File-Saving Function"></a><h4>A Sample File-Saving Function</h4><p><span class="content_text">Listing 3-2</span> illustrates how to save files by using the function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_170"></a><code>NavPutFile</code>. The sample listing also shows how to set options and register your event-handling function. Note that this function uses a <code>DoSafeSave</code> function to ensure that the save is completed without error before an existing file is deleted.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_71" title="Listing 2-2A sample file-saving function"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDHHAA" title="Listing 2-2A sample file-saving function"></a><strong>Listing 2-2&nbsp;&nbsp;</strong>A sample file-saving function</p><div class="codesample"><table><tr><td scope="row"><pre>OSErr MySaveDocument(WindowPtr theDocument)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr                   anErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>    NavReplyRecord                  reply;<span></span></pre></td></tr><tr><td scope="row"><pre>    NavDialogOptions                    dialogOptions;<span></span></pre></td></tr><tr><td scope="row"><pre>    OSType                  fileTypeToSave = 'TEXT';<span></span></pre></td></tr><tr><td scope="row"><pre>    OSType                  creatorType = 'xAPP';<span></span></pre></td></tr><tr><td scope="row"><pre>    NavEventUPP             eventProc = NewNavEventProc(myEventProc);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    anErr = NavGetDefaultDialogOptions(&amp;dialogOptions);<span></span></pre></td></tr><tr><td scope="row"><pre>    if (anErr == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        //  One way to get the name for the file to be saved.<span></span></pre></td></tr><tr><td scope="row"><pre>        GetWTitle(theDocument, dialogOptions.savedFileName);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        anErr = NavPutFile( nil, &amp;reply, &amp;dialogOptions, eventProc,<span></span></pre></td></tr><tr><td scope="row"><pre>                            fileTypeToSave, creatorType, nil);<span></span></pre></td></tr><tr><td scope="row"><pre>        if (anErr == noErr   &amp;&amp;  reply.validRecord)<span></span></pre></td></tr><tr><td scope="row"><pre>        {<span></span></pre></td></tr><tr><td scope="row"><pre>            AEKeyword           theKeyword;<span></span></pre></td></tr><tr><td scope="row"><pre>            DescType            actualType;<span></span></pre></td></tr><tr><td scope="row"><pre>            Size            actualSize;<span></span></pre></td></tr><tr><td scope="row"><pre>            FSSpec          documentFSSpec;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            anErr = AEGetNthPtr(&amp;(reply.selection), 1, typeFSS,<span></span></pre></td></tr><tr><td scope="row"><pre>                                &amp;theKeyword, &amp;actualType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                &amp;documentFSSpec, sizeof(documentFSSpec),<span></span></pre></td></tr><tr><td scope="row"><pre>                                &amp;actualSize );<span></span></pre></td></tr><tr><td scope="row"><pre>            if (anErr == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>            {<span></span></pre></td></tr><tr><td scope="row"><pre>                if (reply.replacing)<span></span></pre></td></tr><tr><td scope="row"><pre>                {<span></span></pre></td></tr><tr><td scope="row"><pre>                    // Make sure you save a temporary file<span></span></pre></td></tr><tr><td scope="row"><pre>                    // so you can check for problems before replacing<span></span></pre></td></tr><tr><td scope="row"><pre>                    // an existing file. Once the save is confirmed,<span></span></pre></td></tr><tr><td scope="row"><pre>                    // swap the files and delete the original.<span></span></pre></td></tr><tr><td scope="row"><pre>                    anErr = DoSafeSave(&amp;documentFSSpec, creatorType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                        fileTypeToSave, theDocument);<span></span></pre></td></tr><tr><td scope="row"><pre>                }<span></span></pre></td></tr><tr><td scope="row"><pre>                else<span></span></pre></td></tr><tr><td scope="row"><pre>                {<span></span></pre></td></tr><tr><td scope="row"><pre>                    anErr = WriteNewFile(&amp;documentFSSpec, creatorType,<span></span></pre></td></tr><tr><td scope="row"><pre>                                         fileTypeToSave, theDocument);<span></span></pre></td></tr><tr><td scope="row"><pre>                }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>                if ( anErr == noErr)<span></span></pre></td></tr><tr><td scope="row"><pre>                {<span></span></pre></td></tr><tr><td scope="row"><pre>                    // Always call NavCompleteSave() to complete<span></span></pre></td></tr><tr><td scope="row"><pre>                    anErr = NavCompleteSave(&amp;reply,<span></span></pre></td></tr><tr><td scope="row"><pre>                                            kNavTranslateInPlace);<span></span></pre></td></tr><tr><td scope="row"><pre>                }<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            (void) NavDisposeReply(&amp;reply);<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>        DisposeRoutineDescriptor(eventProc);<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    return anErr;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_20" title="Saving Changes"></a><h3>Saving Changes</h3><p>Navigation Services allows you to display a standard alert box for <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_171"></a>saving changes or quitting an application, and to customize this alert box for other uses.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_72" title="Note"></a><p><strong>Note:</strong>&nbsp;You are strongly encouraged to make all Navigation Services dialog boxes movable by providing updates via an event-handling function. For more information, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCJEAA">“Handling Events.”</a></span></p></div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_21" title="Displaying a Standard Save Changes Alert Box"></a><h4>Displaying a Standard Save Changes Alert Box</h4><p>To display a standard Save Changes alert box, your application passes its name and the document title to the function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_172"></a><code>NavAskSaveChanges</code>, which displays the alert box shown in <span class="content_text">Figure 3-11</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_73" title="Figure 2-11Standard Save Changes alert box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJBGEIC" title="Figure 2-11Standard Save Changes alert box"></a><strong>Figure 2-11&nbsp;&nbsp;</strong>Standard Save Changes alert box</p><img src = "../art/ns_s_20.gif" alt = "Standard Save Changes alert box" width="280" height="92"></div><br/><p>After the user closes the Save Changes alert box, Navigation Services tells your application which button the user clicked by returning one of the <code>NavAskSaveChangesResult</code> constants, as described in Save Changes Action Constants.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_22" title="Customizing the Save Changes Alert Box"></a><h4>Customizing the Save Changes Alert Box</h4><p>You can display a <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_173"></a>customized Save Changes alert box by using the function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_174"></a><code>NavCustomAskSaveChanges</code>. <span class="content_text">Figure 3-12</span>shows an example of a customized Save Changes alert box.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_74" title="Figure 2-12Custom Save Changes alert box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJEBAHI" title="Figure 2-12Custom Save Changes alert box"></a><strong>Figure 2-12&nbsp;&nbsp;</strong>Custom Save Changes alert box</p><img src = "../art/ns_s_18.gif" alt = "Custom Save Changes alert box" width="292" height="99"></div><br/><p>You must provide the message to be displayed in a custom Save Changes alert box by specifying a string in the message field of a <code>NavDialogOptions</code> structure. </p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_23" title="Displaying a Discard Changes Alert Box"></a><h4>Displaying a Discard Changes Alert Box</h4><p>If your application has a <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_175"></a>Revert to Saved or similar item in its File menu, Navigation Services provides an alert box to handle this situation, as shown in <span class="content_text">Figure 3-13</span>. This alert box is created by calling the function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_176"></a><code>NavAskDiscardChanges</code>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_75" title="Figure 2-13Discard Changes alert box"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJIAGIE" title="Figure 2-13Discard Changes alert box"></a><strong>Figure 2-13&nbsp;&nbsp;</strong>Discard Changes alert box</p><img src = "../art/ns_s_19.gif" alt = "Discard Changes alert box" width="280" height="97"></div><br/><p>After the user closes the alert box, Navigation Services tells your application which button the user clicked by returning one of the <code>NavAskDiscardChangesResult</code> constants, as described in Discard Changes Action Constants.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_24" title="Advanced Tasks"></a><h2>Advanced Tasks</h2><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_177"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_25" title="Setting Custom Features"></a><h3>Setting Custom Features</h3><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_178"></a><p>You can add or change a number of features in Navigation Services dialog boxes.</p><ul class="spaceabove"><li class="li"><p>You can provide a user prompt or banner, which describes the action performed by the dialog box.</p></li><li class="li"><p>You can change the action button title.</p></li><li class="li"><p>You can change the Cancel button title.</p></li><li class="li"><p>You can preset a dialog box’s location on screen.</p></li><li class="li"><p>You can change the window title of the dialog box.</p></li><li class="li"><p>You can provide an application-defined event-handling function (to provide movable and resizable dialog boxes).</p></li><li class="li"><p>You can provide an application-defined filter function (to determine which file objects are displayed in pop-up menus or the browser list).</p></li><li class="li"><p>You can provide an application-defined file preview function.</p></li></ul><p>You can set <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_179"></a>dialog box options by setting values in a structure of type <code>NavDialogOptions</code>.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_26" title="Setting the Default Location"></a><h3>Setting the Default Location</h3><p>Navigation Services maintains <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_180"></a>default location information for dialog boxes. The <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_181"></a>default location is the folder or volume whose contents will be displayed in the browser list when a dialog box is first displayed. You can override the default location and selection of any Navigation Services dialog box by passing a pointer to an Apple event descriptor (<code>AEDesc</code>) structure for the new location in the <code>defaultLocation</code> parameter of the appropriate function. This <code>AEDesc</code> structure is normally of type <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_182"></a><code>'typeFSS'</code> describing a file, folder, or volume. </p><p>To select the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_183"></a>default location instead of displaying it, supply the <code>kNavSelectDefaultLocation</code> constant in the <code>dialogOptionFlags</code> field of the structure of type NavDialogOptions you specify in the <code>dialogOptions</code> parameter of a Navigation Services function such as <code>NavGetFile</code>. For example, if you pass an <code>AEDesc</code> structure describing the System Folder in the <code>defaultLocation</code> parameter of the <code>NavGetFile</code> function, Navigation Services displays an Open dialog box with the System Folder as the default location. If you pass the same value to the <code>NavGetFile</code> function and supply the <code>kNavSelectDefaultLocation</code> constant in the <code>dialogOptionFlags</code> field of the <code>NavDialogOptions</code> structure, the Open dialog box shows the startup volume as the default location with the System Folder selected.</p><p>If you pass <code>NULL</code> for the <code>AEDesc</code> structure, or attempt to pass an invalid <code>AEDesc</code> structure, Navigation Services 1.1 and later displays the desktop as the default location. </p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJBFIFF" title="Obtaining Object Descriptions"></a><h3>Obtaining Object Descriptions</h3><p>Several Navigation Services functions return <code>AEDesc</code> structures describing objects from the network or the file system. You must not assume that an <code>AEDesc</code> structure is of any particular type. If your application requires a particular type of <code>AEDesc</code> structure, you should attempt to coerce the structure using the Apple Event Manager function <code>AECoerceDesc</code>. For more information on coercing Apple event descriptors, see <em>Inside Macintosh: Interapplication Communication</em>.</p><p>When Navigation Services passes you an <code>AEDesc</code> structure of type <code>'typeCString'</code>, the structure describes a network object by using a <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_184"></a>Uniform Resource Locator (URL). Network objects can be AppleTalk zones, AppleShare servers, or (in Navigation Services 2.0 or later) other network services like FTP or HTTP. For example, an <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_185"></a>AppleTalk zone called “Building 1 - 3rd floor” would be represented by a URL of <code>'at://Building 1 - 3rd floor'</code>. An <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_186"></a>AppleShare server called “Mac Software” in the same zone would be represented by a URL of <code>'afp:/at/Mac Software:Building 1 - 3rd floor'</code>.</p><p>If Navigation Services passes you an <code>AEDesc</code> structure of descriptor type <code>'typeFSS' </code>describing a directory, the directory’s file specification contains an empty <code>name</code> field and its <code>parID</code> field contains the directory ID. If an <code>AEDesc</code> structure of type <code>'typeFSS'</code> describes a file, its file specification’s <code>name</code> field contains the filename and its <code>parID</code> field contains the directory ID of the file’s parent directory. This means you can use the <code>name</code> field to determine whether an object is a file or a folder. </p><p>If you need to determine the ID of a directory’s parent directory, use the File Manager function <code>PBGetCatInfo</code>, described in <em>Inside Macintosh: Files</em>.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJBFHFC" title="Working With Packages"></a><h3>Working With Packages</h3><p>Mac OS 9 introduces the concept of packages. Packages are file objects that combine an application or document with supporting files in a container. By default, Navigation Services does not display packages in the browser list; if you want your application to recognize packages, specify the <code>kNavSupportPackages</code> constant in the <code>dialogOptionFlags</code> field of the <code>NavDialogOptions</code> structure that you pass in the <code>dialogOptions</code> parameter of various Navigation Services functions. If you want your application to be able to navigate packages, specify the <code>kNavAllowOpenPackages</code> constant in the same way. Package support is available in Navigation Services 2.0 and later.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJCHDJA" title="Filtering File Objects"></a><h3>Filtering File Objects</h3><p>The process of choosing which files, folders, and volumes to display in the browser list or the pop-up menus is known as object filtering. If your application needs simple, straightforward object filtering, pass a pointer to a structure of type NavTypeList to the appropriate Navigation Services function. If you desire more specific filtering, Navigation Services lets you implement an application-defined filter function. Filter functions give you more control over what can and can’t be displayed; for example, your function can filter out non-HFS objects. You can use both a NavTypeList structure and a filter function if you wish, but keep in mind that your filter function is directly affected by the <code>NavTypeList</code> structure. For example, if the <code>NavTypeList</code> structure contains only <code>'TEXT'</code> and <code>'PICT'</code> types, only files of those types are passed into your filter function. Also, your filter function can filter out file types that are defined in your <code>NavTypeList</code> structure. Make sure you don’t accidentally exclude items you wish to display by creating conflicts between your type list and filter function.</p><p>Navigation Services tells you which dialog box control was used for each call to your filter function, so you can implement different criteria for each control. You might choose to limit the Desktop button to displaying specific volumes, for example, or to restrict navigation through the Location pop-up menu. The default location and selections can also be filtered. For more information on implementing a filter function, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJDBJHE">“Providing Custom Object Filtering.”</a></span></p><p>The function <code>NavGetFile</code> displays a Show pop-up menu that lists your application's native types as well as translatable file types. If the user chooses a translatable file type, Navigation Services ignores your <code>NavTypeList</code> structure and responds only to your filter function. For more information on the Show pop-up menu, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCEAHJ">“Providing File Opening Options.”</a></span></p><p>The function <code>NavPutFile</code> displays a Format pop-up menu that displays the save format options, the application’s native types, and the file types that can translated. This pop-up menu selection does not affect filtering of the browser list; it determines the file format used to save the final document.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_27" title="Object  Filtering Scenarios "></a><h4>Object  Filtering Scenarios </h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_187"></a><p>This section gives some examples to help explain how filtering works in the Show pop-up menu. For purposes of illustration, assume the following:</p><ul class="spaceabove"><li class="li"><p>The application Sampler can open files of type '<code>TEXT</code>' and '<code>PICT</code>'. </p></li><li class="li"><p>Sampler passes to the <code>NavGetFile</code> function a structure of type <code>NavTypeList</code> that contains these two file types as well as Sampler’s application signature.</p></li><li class="li"><p>Sampler implements a kind string for each of these native file types.</p></li><li class="li"><p>Sampler specifies the <code>kNavDontAddTranslateItems</code> constant in the <code>dialogOptions</code> field in the structure of type <code>NavDialogOptions</code> that it passes in the <code>dialogOptions</code> parameter of the <code>NavGetFile</code> function.</p></li></ul><p>The Show pop-up menu contains the items shown in <span class="content_text">Figure 3-14</span>. Note that the menu does not contain a translatable file section.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_76" title="Figure 2-14A Show pop-up menu without a translatable file section"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BCGBEGAA" title="Figure 2-14A Show pop-up menu without a translatable file section"></a><strong>Figure 2-14&nbsp;&nbsp;</strong>A Show pop-up menu without a translatable file section</p><img src = "../art/ns_s_22.gif" alt = "A Show pop-up menu without a translatable file section" width="204" height="73"></div><br/><p>The user can select the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_188"></a>All Readable Documents command to display all of Sampler’s native file types at once. </p><p>If Sampler specifies the <code>kNavNoTypePopup</code> constant in the <code>dialogOptions</code> field, no Show pop-up menu appears and Sampler’s <code>NavTypeList</code> structure and filter function determine any filtering. If Sampler passes <code>NULL</code> to the <code>NavGetFile</code> function in place of a reference to the <code>NavTypeList</code> structure, the Show pop-up menu does not appear (regardless of the dialog options) and Sampler’s application-defined filter function is the only determining filter. If Sampler doesn’t provide a filter function, all files are displayed.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_77" title="Note"></a><p><strong>Note:</strong>&nbsp; Under Navigation Services 1.1 or later, if your application passes a <code>NavTypeList</code> structure to the <code>NavGetFile</code> function and specifies the <code>kNavNoTypePopup</code> constant, Navigation Services displays all files of the types described in the <code>NavTypeList</code> structure, even if they were created by a different application.</p></div><p>In the next example, assume the following: </p><ul class="spaceabove"><li class="li"><p>The application Portal can open files of type '<code>TEXT</code>', '<code>PICT</code>', and '<code>MooV</code>'.</p></li><li class="li"><p>Portal has a structure of type <code>NavTypeList</code> containing these three file types as well as its application signature.</p></li><li class="li"><p>Portal provides kind strings for each of these native file types.</p></li><li class="li"><p>Portal supplies the <code>kNavAllFilesInPopup</code> constant in the <code>dialogOptions</code> field of the <code>NavDialogOptions</code> structure. This adds the All Documents item at the bottom of the menu.</p></li><li class="li"><p>Portal does not supply the <code>kNavDontAddTranslateItems</code> constant in the <code>dialogOptions</code> field of the <code>NavDialogOptions</code> structure. </p></li></ul><p>In this case, the Show pop-up menu appears as shown in <span class="content_text">&lt;xRefNoLink>Figure 3-15</span>.</p><br/><div><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_78" title="Figure 2-15A Show pop-up menu with a translatable files section"></a><p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJBJHEE" title="Figure 2-15A Show pop-up menu with a translatable files section"></a><strong>Figure 2-15&nbsp;&nbsp;</strong>A Show pop-up menu with a translatable files section</p><img src = "../art/ns_s_26.gif" alt = "A Show pop-up menu with a translatable files section" width="233" height="126"></div><br/><p>The third section of the Show menu shows file types that the Translation Manager can translate into one of Portal’s three <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_189"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_190"></a>native file types.</p><p>Under Navigation Services 1.1 or later, if the user chooses the All Readable Documents menu item, Navigation Services displays all native and translatable file types, regardless of which application created them. If the user chooses the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_191"></a>All Documents menu item, the browser list shows all file types, regardless of whether Portal has identified them as translatable or not.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_28" title=" Refreshing the Browser List"></a><h4> Refreshing the Browser List</h4><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_192"></a><p>If your application needs to refresh the list of file objects in the browser before exiting a function such as <code>NavGetFile</code>, follow these steps if you are using a version of Navigation Services earlier than 2.0:</p><ol class="ol"><li class="li"><p>Supply the <code>kNavCtlGetLocation</code> constant in the <code>selector</code> parameter of the function <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/NavCustomControl" target="_top">NavCustomControl</a></code> to obtain the current location.</p></li><li class="li"><p>Pass the current location in the <code>parms</code> parameter of <code>NavCustomControl</code> and supply the <code>kNavCtlSetLocation</code> constant in the <code>selector</code> parameter of <code>NavCustomControl</code>.</p></li></ol><p>Getting and setting the current location causes Navigation Services to rebuild the browser list.</p><p>Navigation Services 2.0 and later provides the <code>kNavCtlBrowserRedraw</code> constant that you can specify in the the <code>selector</code> parameter of the function <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/NavCustomControl" target="_top">NavCustomControl</a></code> to force the browser list to be refreshed.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_29" title="Providing Document Previews"></a><h3>Providing Document Previews</h3><p>Navigation Services provides a preview area in all dialog boxes that open files. This area can be toggled on or off by the user. If the preview area is visible, Navigation Services automatically displays a preview of any file that contains a valid QuickTime component of type <code>'pnot'</code>. Under Navigation Services 2.0 or later, you can call the NavCreatePreview function to create a preview. You can request <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_193"></a>automatic preview display by setting the <code>kNavAllowPreviews</code> constant in the <code>dialogOptionFlags</code> field of the structure of type NavDialogOptions that you pass in the <code>dialogOptions</code> parameter of the file-opening function. (This option is set by default.) You can provide your own preview function and add custom controls to the preview area, as well. For more information on preview functions, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJDCBHA">“Drawing Custom Previews.”</a></span> For more information on <code>'pnot'</code> resources, see <em>Inside Macintosh: QuickTime Components</em>.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJEBIED" title="Customizing Type Pop-up Menus"></a><h3>Customizing Type Pop-up Menus</h3><p>The Show pop-up menu displayed in Open dialog boxes and the Format pop-up menu displayed in Save dialog boxed are known collectively as <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_194"></a>type pop-up menus. If your application needs to add its own menu items to one of the type pop-up menus, use a structure of type <code>NavMenuItemSpec</code> to describe each menu item to add. This allows you to add specific document types to be opened or saved, or different ways of saving a file (with or without line breaks, as HTML, and so forth). To set your menu items, add a handle to one or more <code>NavMenuItemSpec</code> structures to the <code>popupExtension</code> field in the structure of type <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> parameter of the appropriate function. If you provide a <code>NavMenuItemSpec</code> structure, you must also provide an event-handling function and an object filtering function. Navigation Services will not handle your custom menu items, so if you do not provide these application-defined functions and attempt to use a <code>NavMenuItemSpec</code> structure, Navigation Services functions return a result of <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_195"></a><code>paramErr</code>(-50). For more information, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJBCJJJ">“Creating Application-Defined Functions.”</a></span></p><p>You are not required to provide a value in the<code> menuItemName</code> field of the <code>NavMenuItemSpec</code> structure, but Navigation Services uses this value, if it is available, as a search key. If you choose not to provide a value for this field, make sure to set it to an empty string. </p><p>To handle and examine a selected pop-up menu item, respond to the <code>kNavCBPopupMenuSelect</code> constant, described in Custom Control Setting Constants, when Navigation Services calls your application’s event-handling function. Navigation Services provides information about the selected menu item in a structure of type <code>NavCBRec</code> passed in the <code>callBackParms</code> parameter of your event-handling function. The <code>param</code> field of the <code>NavCBRec</code> structure points to a structure of type NavMenuItemSpec describing the menu item. Your application can respond to a particular menu item by comparing the <code>type</code> and <code>creator</code> fields, for example.</p><p>You can set the Show pop-up menu so that it displays only <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_196"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_197"></a>custom items during a call to a file-opening function such as <code><a href="../../../Reference/Navigation_Services_Ref/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/NavGetFile" target="_top">NavGetFile</a></code>, for instance. The procedure is as follows:</p><ol class="ol"><li class="li"><p>Define your custom menu items by using structures of type <code>NavMenuItemSpec</code>.</p></li><li class="li"><p>Specify a handle to the <code>NavMenuItemSpec</code> structures in the <code>popupExtension</code> field of the structure of type <code>NavDialogOptions</code> that you pass in the <code>dialogOptions</code> parameter.</p></li><li class="li"><p>Pass <code>NULL</code> in the <code>typeList</code> parameter. If you pass any file types in the <code>typeList</code> parameter, Navigation Services will place its own items in the pop-up menu.</p></li><li class="li"><p>Set your filter function to display only your custom items in the pop-up menu.</p></li><li class="li"><p>Ensure that your event-handling function takes care of any selection made from the pop-up menu.</p></li></ol><p>If your application tries to extend the Show pop-up menu and does not provide an event-handling function, Navigation Services functions return a result of <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_198"></a><code>paramErr </code>(-50). If you add menu items that require filtering, you must implement a filter function. For more information, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCHDJA">“Filtering File Objects.”</a></span></p><p>You can set the Format pop-up menu so that it displays only <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_199"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_200"></a>custom items during a call to the <code><a href="../../../Reference/Navigation_Services_Ref/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/NavPutFile" target="_top">NavPutFile</a></code> function. The procedure is as follows:</p><ol class="ol"><li class="li"><p>Define your custom menu items by using structures of type <code>NavMenuItemSpec</code>.</p></li><li class="li"><p>Specify a handle to the NavMenuItemSpec structures in the <code>popupExtension</code> field of the structure of type NavDialogOptions that you pass in the <code>dialogOptions</code> parameter.</p></li><li class="li"><p>Set your filter function to display only your custom items in the pop-up menu.</p></li><li class="li"><p>Ensure that your event-handling function takes care of any selection made from the pop-up menu.</p></li><li class="li"><p>Pass the <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/kNavGenericSignature" target="_top">kNavGenericSignature</a></code> constant in the <code>fileCreator</code> parameter of the <code><a href="../../../Reference/Navigation_Services_Ref/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/NavPutFile" target="_top">NavPutFile</a></code> function.</p></li><li class="li"><p>If you don’t want the Stationery Option menu item to appear, clear the <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/kNavAllowStationery" target="_top">kNavAllowStationery</a></code> constant in the <code>dialogOptions</code> field of the <code>NavDialogOptions</code> structure you pass to the <code><a href="../../../Reference/Navigation_Services_Ref/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/doc/c_ref/NavPutFile" target="_top">NavPutFile</a></code> function.</p></li></ol><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDHEID" title="Adding Custom Controls"></a><h3>Adding Custom Controls</h3><p>The Navigation Services programming interface handles most common situations that demand interface customization when using the Standard File Package. If you look through all the features and find that you still need to provide custom controls in a Navigation Services dialog box, perform the following steps:</p><ol class="ol"><li class="li"><p>Implement an event-handling function to communicate with Navigation Services while Open or Save dialog boxes are open. For more information, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCJEAA">“Handling Events.”</a></span></p></li><li class="li"><p>Respond to the <code>kNavCBCustomize</code> constant, described in Event Message Constants, which your application can obtain from the <code>param</code> field of the structure of type <code>NavCBRec</code> pointed to in the <code>callBackParms</code> parameter of your event-handling function. The <code>customRect</code> field of the <code>NavCBRec</code> structure defines a rectangle in the local coordinates of the window; the top-left coordinates define the anchor point for the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_201"></a>customization rectangle, which is the area Navigation Services provides for your application to add custom dialog box items. Your application responds by setting the values which complete the dimensions of the customization rectangle you require in the <code>customRect</code> field of the <code>NavCBRec</code> structure. After your application responds and exits from the event-handling function, Navigation Services inspects the <code>customRect</code> field to determine if the requested dimensions result in a dialog window that can fit on the screen. If the resulting window dimensions are too large, then Navigation Services responds by setting the rectangle to the largest size that can be accommodated and notifying your application with the <code>kNavCBCustomize</code> constant again. Your application can continue to negotiate with Navigation Services by examining the <code>customRect</code> field and requesting a different size until Navigation Services provides an acceptable rectangle value. The minimum dimensions for the customization area are 400 pixels wide by 40 pixels high on a 600 x 400 pixel screen. If you are designing for a minimum screen size of 640 x 480 or larger, you can assume a larger minimum customization area.</p></li><li class="li"><p>After a customization rectangle has been established, your application must check for the <code>kNavCBStart</code> constant in the <code>param</code> field of the NavCBRec structure. This constant indicates that Navigation Services is opening the dialog box. After you obtain this constant, you can add your interface elements to the customization rectangle. The simplest way to do this is to provide a<a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_202"></a><code> 'DITL'</code> resource (in local coordinates, relative to the anchor point of the customization rectangle) and pass the <code>kNavCtlAddControlList</code> constant in the <code>selector</code> parameter of the function <code>NavCustomControl</code>. <span class="content_text">&lt;xRefNoLink>Listing 3-3</span> illustrates one way to do this.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_79" title="Listing 2-3Adding a custom &#39;DITL&#39; resource"></a><br/><br/><p class="codesample"><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDBAGG" title="Listing 2-3Adding a custom &#39;DITL&#39; resource"></a><strong>Listing 2-3&nbsp;&nbsp;</strong>Adding a custom 'DITL' resource</p><div class="codesample"><table><tr><td scope="row"><pre>gDitlList = GetResource ('DITL', kControlListID);<span></span></pre></td></tr><tr><td scope="row"><pre>theErr = NavCustomControl(callBackParms->context,<span></span></pre></td></tr><tr><td scope="row"><pre>        kNavCtlAddControlList, gDitlList);<span></span></pre></td></tr></table></div></li></ol><p>The advantage of using a <code>'DITL'</code> resource is that the Dialog Manager handles all control movement and tracking.</p><p>You can also draw a <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_203"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_204"></a>single control by calling the Control Manager function <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_205"></a><code>NewControl</code> and passing the <code>kNavCtlAddControl</code> constant, described in Custom Control Setting Constants, in the <code>selector</code> parameter of the function <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/NavCustomControl" target="_top">NavCustomControl</a></code>. <span class="content_text">&lt;xRefNoLink>Listing 3-4</span> illustrates this approach.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_80" title="Listing 2-4Adding a single custom control"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJCHCBG" title="Listing 2-4Adding a single custom control"></a><strong>Listing 2-4&nbsp;&nbsp;</strong>Adding a single custom control</p><div class="codesample"><table><tr><td scope="row"><pre>gCustomControl = NewControl (callBackParms->window, &amp;itemRect,<span></span></pre></td></tr><tr><td scope="row"><pre>                "\pcheckbox", false, 1, 0, 1, checkBoxProc, NULL);<span></span></pre></td></tr><tr><td scope="row"><pre>theErr = NavCustomControl (callBackParms->context, kNavCtlAddControl,<span></span></pre></td></tr><tr><td scope="row"><pre>                            gCustomControl);<span></span></pre></td></tr></table></div><p>If you call <code>NewControl</code>, you must track the custom control yourself.</p><p>4. Navigation Services supplies the <code>kNavCBTerminate</code> constant in the <code>param</code> field of the <code>NavCBRec</code> structure after the user closes the dialog box. Make sure you check for this constant, which is your signal to dispose of your control or resource.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJEBBDD" title="Controlling User Navigation"></a><h3>Controlling User Navigation</h3><p>In Navigation Services 2.0 and later, you can block certain user navigation actions such as file opening and saving by passing the <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/kNavCtlSetActionState" target="_top">kNavCtlSetActionState</a></code> constant in the selector parameter of the function <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/NavCustomControl" target="_top">NavCustomControl</a></code> and one or more of the values defined by the <code>NavActionState</code> enumeration (described in Action State Constants) in the <code>parms</code> parameter. This is useful when you want to prevent a dialog box from being dismissed until certain conditions are met, for example.</p><p>The actions you can block include:</p><ol class="ol"><li class="li"><p>Opening files</p></li><li class="li"><p>Saving files</p></li><li class="li"><p>Choosing file objects</p></li><li class="li"><p>Creating new folders</p></li></ol><p>In the following example, the <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/kNavDontOpenState" target="_top">kNavDontOpenState</a></code> constant is used to disable the Open button in an Open dialog box:</p><div class="codesample"><table><tr><td scope="row"><pre>NavAction newState = kNavDontOpenState;<span></span></pre></td></tr><tr><td scope="row"><pre>NavCustomControl( context, kNavCtlSetActionState, &amp;newState );<span></span></pre></td></tr></table></div><p>In the next example, the <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/kNavDontChooseState" target="_top">kNavDontChooseState</a></code> constant is used in addition to the <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/kNavDontOpenState" target="_top">kNavDontOpenState</a></code> constant. During a call to the <code>NavChooseFolder</code> function, for example, this disables the Open and Choose buttons:</p><div class="codesample"><table><tr><td scope="row"><pre>NavCustomControl( context, kNavCtlSetActionState, kNavDontOpenState +                 kNavDontChooseState);<span></span></pre></td></tr></table></div><p>In the final example, we add the <code>kNavDontNewFolderState </code> constant to disable the Open, Choose, and New Folder buttons during a call to the <code>NavNewFolder</code> function:</p><div class="codesample"><table><tr><td scope="row"><pre>NavCustomControl( context, kNavCtlSetActionState, kNavDontOpenState +                 kNavDontChooseState + kNavDontNewFolderState );<span></span></pre></td></tr></table></div><p>If you block a user action by passing one or more of the <code>NavActionState</code> constants, make sure you set the <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/kNavNormalState" target="_top">kNavNormalState</a></code> constant before exiting in order to restore the default state. If you fail to set the <code><a href="../../../Reference/Navigation_Services_Ref/Reference/reference.html#//apple_ref/doc/c_ref/kNavNormalState" target="_top">kNavNormalState</a></code> constant, the user may be unable to dismiss the dialog box.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJBCJJJ" title="Creating Application-Defined Functions"></a><h2>Creating Application-Defined Functions</h2><p>You can implement application-defined functions to intercept and handle events, provide custom view filtering, and draw custom previews.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJCJEAA" title="Handling Events"></a><h3>Handling Events</h3><p>To respond to events generated by the user and Navigation Services, you can create an event-handling function, described in this document as <code>MyEventProc</code>. You register your event-handling function by passing a Universal Procedure Pointer (UPP) in the <code>eventProc</code> parameter of a Navigation Services function such as <code>NavGetFile</code>. You obtain this UPP by calling the macro <code>NewNavEventProc </code>and passing a pointer to your event-handling function. If an event occurs while the Open dialog box is displayed, for example, the <code>NavGetFile</code> function will call your event-handling function. In the <code>callBackParms</code> parameter of your event-handling function, <code>NavGetFile</code> supplies a structure of type <code>NavCBRec</code>. This structure contains the information your application needs to respond to the event. For instance, your application can obtain the event record describing the event to be handled from the pointer in the <code>event</code> field of the <code>NavCBRec</code> structure. </p><p>When calling your event-handling function, Navigation Services passes only the update events that apply to your windows and only the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_206"></a>mouse-down events that occur in the preview or customization areas.</p><p>You are strongly encouraged to provide at least a simple function to handle update events. If you do this, Navigation Services dialog boxes automatically become movable and resizable. <span class="content_text">&lt;xRefNoLink>Listing 3-5</span> shows an example of such a function.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_81" title="Listing 2-5A sample event-handling function"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDBAEJ" title="Listing 2-5A sample event-handling function"></a><strong>Listing 2-5&nbsp;&nbsp;</strong>A sample event-handling function</p><div class="codesample"><table><tr><td scope="row"><pre>pascal void myEventProc(NavEventCallbackMessage callBackSelector,<span></span></pre></td></tr><tr><td scope="row"><pre>                        NavCBRecPtr callBackParms,<span></span></pre></td></tr><tr><td scope="row"><pre>                        NavCallBackUserData callBackUD)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    WindowPtr window =<span></span></pre></td></tr><tr><td scope="row"><pre>                    (WindowPtr)callBackParms->eventData.event->message;<span></span></pre></td></tr><tr><td scope="row"><pre>    switch (callBackSelector)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        case kNavCBEvent:<span></span></pre></td></tr><tr><td scope="row"><pre>            switch (((callBackParms->eventData)<span></span></pre></td></tr><tr><td scope="row"><pre>                    .eventDataParms).event->what)<span></span></pre></td></tr><tr><td scope="row"><pre>            {<span></span></pre></td></tr><tr><td scope="row"><pre>                case updateEvt:<span></span></pre></td></tr><tr><td scope="row"><pre>                    MyHandleUpdateEvent(window,<span></span></pre></td></tr><tr><td scope="row"><pre>                        (EventRecord*)callBackParms->eventData.event);<span></span></pre></td></tr><tr><td scope="row"><pre>                    break;<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            break;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>In your event-handling function, you can also call the function <code>NavCustomControl</code> to control various aspects of dialog boxes. For example, the following line shows how you can determine whether the preview area is currently showing:</p><div class="codesample"><table><tr><td scope="row"><pre>NavCustomControl(context, kNavCtlIsPreviewShowing, &amp;isShowing);<span></span></pre></td></tr></table></div><p>If you extend the type pop-up menus with custom menu items, Navigation Services expects your event-handling function to respond to these items. For more information, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJEBIED">“Customizing Type Pop-up Menus.”</a></span></p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDBJHE" title="Providing Custom Object Filtering"></a><h3>Providing Custom Object Filtering</h3><p>Navigation Services notifies you before displaying items in the following areas:</p><ul class="spaceabove"><li class="li"><p>Location pop-up menu</p></li><li class="li"><p>browser list</p></li><li class="li"><p>Favorites menu</p></li><li class="li"><p>Recent menu</p></li><li class="li"><p>Shortcuts menu</p></li></ul><p>You can take advantage of this notification process by creating a <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_207"></a><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_208"></a>filter function, described in this document as <code>MyFilterProc</code>, to determine which items are displayed. Register your filter function by passing a Universal Procedure Pointer (UPP) in the <code>filterProc</code> parameter of a Navigation Services function such as <code>NavGetFile</code>. You obtain this UPP by calling the macro <code>NewNavObjectFilterProc</code> and passing a pointer to your filter function. When calling your filter function, Navigation Services provides detailed information on HFS files and folders via a structure of type <code>NavFileOrFolderInfo</code>. Your filter function specifies which file objects to display to the user by returning <code>true</code> for each object you wish to display and <code>false</code> for each object you do not wish to display. If your filter function does not recognize an object, it should return <code>true</code> and allow the object to be displayed.</p><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_82" title="Important:"></a><p><strong>Important:</strong>&nbsp;Your filter function must not assume that the data passed to it in the <em>theItem</em> parameter is a '<code>typeFSS</code>' Apple event descriptor (<code>AEDesc</code>). If you intend to use the data passed in the <code>theItem</code> parameter, you must first determine its Apple event descriptor type by attempting to coerce the data into a type that you expect or support. If the <code>AEDesc</code> structure cannot be coerced into a valid file specification, for example, the data in the <em>info</em> parameter does not refer to an HFS file object. For more information on working with <code>AEDesc</code> structures, see <em>Inside Macintosh:Interapplication Communication</em>.</p><p></p></div><p><span class="content_text">&lt;xRefNoLink>Listing 3-6</span> illustrates a sample filter function that allows only text files to be displayed.</p><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_83" title="Listing 2-6A sample filter function"></a><p class="codesample"><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJCBECF" title="Listing 2-6A sample filter function"></a><strong>Listing 2-6&nbsp;&nbsp;</strong>A sample filter function</p><div class="codesample"><table><tr><td scope="row"><pre>pascal Boolean myFilterProc(AEDesc* theItem, void* info,<span></span></pre></td></tr><tr><td scope="row"><pre>                            NavCallBackUserData callBackUD,<span></span></pre></td></tr><tr><td scope="row"><pre>                            NavFilterModes filterMode)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    OSErr theErr = noErr;<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean display = true;<span></span></pre></td></tr><tr><td scope="row"><pre>    NavFileOrFolderInfo* theInfo = (NavFileOrFolderInfo*)info;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (theItem->descriptorType == typeFSS)<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!theInfo->isFolder)<span></span></pre></td></tr><tr><td scope="row"><pre>            if (theInfo->fileAndFolder.fileInfo.finderInfo.fdType<span></span></pre></td></tr><tr><td scope="row"><pre>                != 'TEXT')<span></span></pre></td></tr><tr><td scope="row"><pre>                display = false;<span></span></pre></td></tr><tr><td scope="row"><pre>    return display;<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><div class="importantbox"><a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_84" title="Important:"></a><p><strong>Important:</strong>&nbsp;Navigation Services expects your filter function to return <code>true</code> if an object is to be displayed. This is the opposite of what <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_209"></a>Standard File expects from file filter functions.</p><p></p></div><p>For more information on object filtering options, see <span class="content_text"><a href="ns_using.html#//apple_ref/doc/uid/TP40000930-CH202-BBJCHDJA">“Filtering File Objects.”</a></span></p><a name="//apple_ref/doc/uid/TP40000930-CH202-BBJDCBHA" title="Drawing Custom Previews"></a><h3>Drawing Custom Previews</h3><p>By default, Navigation Services draws a preview in the Open dialog box when a file selected in the browser list contains a valid <code>'pnot'</code> component. To override how previews are drawn and handled, you can create a <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_210"></a>preview-drawing function, as described in MyPreviewProc. You register your preview-drawing function by passing a Universal Procedure Pointer (UPP) in the <code>previewProc</code> parameter of a Navigation Services function such as NavGetFile. You obtain this UPP by calling the macro <code>NewNavPreviewProc</code> and passing a pointer to your preview-drawing function. When the user selects a file, Navigation Services calls your preview-drawing function. Before you attempt to create a custom preview, your application should determine whether previews are enabled by specifying the <code>kNavCtlIsPreviewShowing</code> constant in the <code>NavCustomControlMessages</code> parameter of the function <code>NavCustomControl</code>.</p><p>Your preview-drawing function obtains information from a structure of type <code>NavCBRec</code> specified in the <code>callBackParms</code> parameter of your event-handling function. The <code>NavCBRec</code> structure contains the following information:</p><ul class="spaceabove"><li class="li"><p>The <code>eventData</code> field contains a structure of type <code>NavEventData</code> describing the file to be previewed. This structure provides an Apple event descriptor list (<code>AEDescList</code>) that you must be able to coerce into a file specification (<code>FSSpec)</code>. If you cannot coerce the <code>AEDescList</code> into a valid <code>FSSpec</code>, the object is not a file and you should not attempt to create a preview.</p></li><li class="li"><p>The <code>previewRect</code> field describes the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_211"></a>preview area, which is the section of the dialog box reserved for preview drawing.</p></li><li class="li"><p>The <code>window</code> field identifies the <a name="//apple_ref/doc/uid/TP40000930-CH202-DontLinkElementID_212"></a>window to draw in.</p></li></ul><p>Once you have determined that previews are enabled, your preview-drawing function should draw the custom preview in the specified area and return a function result of <code>true</code>. If you don’t want to draw a preview for a given file, be sure to return a function result of <code>false</code>.</p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../ns_about/about_ns.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../ns_rev_hx/ns_rev_hx.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-07-07<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Carbon/Conceptual/NavServicesConcepts/ns_using/ns_using.html%3Fid%3DTP40000930-2.1&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Carbon/Conceptual/NavServicesConcepts/ns_using/ns_using.html%3Fid%3DTP40000930-2.1&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Carbon/Conceptual/NavServicesConcepts/ns_using/ns_using.html%3Fid%3DTP40000930-2.1&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>