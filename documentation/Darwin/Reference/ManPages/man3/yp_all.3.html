<html><head><title>Mac OS X
 Manual Page For yp_all(3)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/3/yp_all" title="Mac OS X
 Manual Page for yp_all(3)"><!-- headerDoc=man; indexgroup=Section 3; uid="//apple_ref/doc/man/3/yp_all"; name=yp_all(3) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
YPCLNT(3)                BSD Library Functions Manual                <!-- a -->YPCLNT(3)<!-- /a -->

<b>NAME</b>
     <b>yp_all</b>, <b>yp_bind</b>, <b>yp_first</b>, <b>yp_get_default_domain</b>, <b>yp_master</b>, <b>yp_match</b>, <b>yp_next</b>, <b>yp_order</b>, <b>yp_unbind</b>,
     <b>yperr_string</b>, <b>ypprot_err</b> -- Interface to the YP subsystem

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;rpc/rpc.h&gt;</b>
     <b>#include</b> <b>&lt;rpcsvc/ypclnt.h&gt;</b>
     <b>#include</b> <b>&lt;rpcsvc/yp_prot.h&gt;</b>

     <u>int</u>
     <b>yp_all</b>(<u>char</u> <u>*indomain</u>, <u>char</u> <u>*inmap</u>, <u>struct</u> <u>ypall</u><b>_</b><u>callback</u> <u>*incallback</u>);

     <u>int</u>
     <b>yp_bind</b>(<u>char</u> <u>*dom</u>);

     <u>int</u>
     <b>yp_first</b>(<u>char</u> <u>*indomain</u>, <u>char</u> <u>*inmap</u>, <u>char</u> <u>**outkey</u>, <u>int</u> <u>*outkeylen</u>, <u>char</u> <u>**outval</u>, <u>int</u> <u>*outvallen</u>);

     <u>int</u>
     <b>yp_get_default_domain</b>(<u>char</u> <u>**domp</u>);

     <u>int</u>
     <b>yp_master</b>(<u>char</u> <u>*indomain</u>, <u>char</u> <u>*inmap</u>, <u>char</u> <u>**outname</u>);

     <u>int</u>
     <b>yp_match</b>(<u>char</u> <u>*indomain</u>, <u>char</u> <u>*inmap</u>, <u>const</u> <u>char</u> <u>*inkey</u>, <u>int</u> <u>inkeylen</u>, <u>char</u> <u>**outval</u>, <u>int</u> <u>*outvallen</u>);

     <u>int</u>
     <b>yp_next</b>(<u>char</u> <u>*indomain</u>, <u>char</u> <u>*inmap</u>, <u>char</u> <u>*inkey</u>, <u>int</u> <u>inkeylen</u>, <u>char</u> <u>**outkey</u>, <u>int</u> <u>*outkeylen</u>,
         <u>char</u> <u>**outval</u>, <u>int</u> <u>*outvallen</u>);

     <u>int</u>
     <b>yp_order</b>(<u>char</u> <u>*indomain</u>, <u>char</u> <u>*inmap</u>, <u>char</u> <u>*outorder</u>);

     <u>void</u>
     <b>yp_unbind</b>(<u>char</u> <u>*dom</u>);

     <u>char</u> <u>*</u>
     <b>yperr_string</b>(<u>int</u> <u>incode</u>);

     <u>int</u>
     <b>ypprot_err</b>(<u>unsigned</u> <u>int</u> <u>incode</u>);

<b>DESCRIPTION</b>
     The <b>ypclnt</b> suite provides an interface to the YP subsystem.  For a general description of the YP sub-<font color="#ffffff" class="whiteout">system,&nbsp;subsystem,</font>
     system, see <a href="../man8/yp.8.html#//apple_ref/doc/man/8/yp">yp(8)</a>.

     For all functions, input values begin with <u>in</u> and output values begin with <u>out</u>.  Any output values of
     type <u>char</u> <u>**</u> should be the addresses of uninitialized character pointers.  Memory will be allocated by
     the YP client routines using <b>malloc</b>().  This memory can later be freed by the user if there is no addi-<font color="#ffffff" class="whiteout">tional&nbsp;additional</font>
     tional need for the data stored there.  For <u>outkey</u> and <u>outval</u>, two extra bytes of memory are allocated
     for a `\n' and `\0', which are not reflected in the values of <u>outkeylen</u> or <u>outvallen</u>.  All occurrences
     of <u>indomain</u> and <u>inmap</u> must be non-null, null-terminated strings.  All input strings which also have a
     corresponding length parameter cannot be null unless the corresponding length value is zero.  Such
     strings need not be null-terminated.

     All YP lookup calls (the functions <b>yp_all</b>(), <b>yp_first</b>(), <b>yp_master</b>(), <b>yp_match</b>(), <b>yp_next</b>(),
     <b>yp_order</b>()) require a YP domain name and a YP map name.  The default domain name may be obtained by
     calling <b>yp_get_default_domain</b>(), and should thus be used before all other YP calls in a client program.
     The value it places <u>outdomain</u> is suitable for use as the <u>indomain</u> parameter to all subsequent YP calls.

     In order for YP lookup calls to succeed, the client process must be bound to a YP server process.  The
     client process need not explicitly bind to the server, as it happens automatically whenever a lookup
     occurs.  The function <b>yp_bind</b>() is provided for a backup strategy, e.g. a local file, when a YP server
     process is not available.  Each binding uses one socket descriptor on the client process, which may be
     explicitly freed using <b>yp_unbind</b>(), which frees all per-process and per-node resources to bind the
     domain and marks the domain unbound.

     If, during a YP lookup, an RPC failure occurs, the domain used in the lookup is automatically marked
     unbound and the <b>ypclnt</b> layer retries the lookup as long as <a href="../man8/ypbind.8.html#//apple_ref/doc/man/8/ypbind">ypbind(8)</a> is running and either the client
     process cannot bind to a server for the domain specified in the lookup, or RPC requests to the YP
     server process fail.  If an error is not RPC-related, one of the YP error codes described below is
     returned and control given back to the user code.

     The <b>ypclnt</b> suite provides the following functionality:

     <b>yp_match</b>()      Provides the value associated with the given key.

     <b>yp_first</b>()      Provides the first key-value pair from the given map in the named domain.

     <b>yp_next</b>()       Provides the next key-value pair in the given map.  To obtain the second pair, the
                     <u>inkey</u> value should be the <u>outkey</u> value provided by the initial call to <b>yp_first</b>().  In
                     the general case, the next key-value pair may be obtained by using the <u>outkey</u> value
                     from the previous call to <b>yp_next</b>() as the value for <u>inkey</u>.

                     Of course, the notions of ``first'' and ``next'' are particular to the type of YP map
                     being accessed, and thus there is no guarantee of lexical order.  The only guarantees
                     provided with <b>yp_first</b>() and <b>yp_next</b>(), providing that the same map on the same server
                     is polled repeatedly until <b>yp_next</b>() returns YPERR_NOMORE, are that all key-value pairs
                     in that map will be accessed exactly once, and if the entire procedure is repeated, the
                     order will be the same.

                     If the server is heaviliy loaded or the server fails for some reason, the domain being
                     used may become unbound.  If this happens, and the client process re-binds, the
                     retrieval rules will break: some entries may be seen twice, and others not at all.  For
                     this reason, the function <b>yp_all</b>() provides a better solution for reading all of the
                     entries in a particular map.

     <b>yp_all</b>()        This function provides a way to transfer an entire map from the server to the client
                     process with a single request.  This transfer uses TCP, unlike all other functions in
                     the <b>ypclnt</b> suite, which use UDP.  The entire transaction occurs in a single RPC
                     request-response.  The third argument to this function provides a way to supply the
                     name of a function to process each key-value pair in the map.  <b>Yp_all</b>() returns after
                     the entire transaction is complete, or the <u>foreach</u> function decides that it does not
                     want any more key-value pairs.  The third argument to <b>yp_all</b>() is:

                           struct ypall_callback *incallback {
                                   int (*foreach)();
                                   char *data;
                           };

                     The <u>char</u> <u>*data</u> argument is an opaque pointer for use by the callback function.  The
                     <u>foreach</u> function should return non-zero when it no longer wishes to process key-value
                     pairs, at which time <b>yp_all</b>() returns a value of 0, and is called with the following
                     arguments:

                           int foreach (
                                   int instatus,
                                   char *inkey,
                                   int inkeylen,
                                   char *inval,
                                   int invallen,
                                   char *indata
                           );

                     Where:

                     <u>instatus</u>      Holds one of the return status values described in <b>&lt;rpcsvc/yp_prot.h&gt;</b>:
                                   see <b>ypprot_err</b>() below for a function that will translate YP protocol
                                   errors into a <b>ypclnt</b> layer error code as described in <b>&lt;rpcsvc/ypclnt.h&gt;</b>.

                     <u>inkey,</u> <u>inval</u>  The key and value arguments are somewhat different here than described
                                   above.  In this case, the memory pointed to by <u>inkey</u> and <u>inval</u> is private
                                   to <b>yp_all</b>(), and is overwritten with each subsequent key-value pair, thus
                                   the <u>foreach</u> function should do something useful with the contents of that
                                   memory during each iteration.  If the key-value pairs are not terminated
                                   with either `\n' or `\0' in the map, then they will not be terminated as
                                   such when given to the <u>foreach</u> function, either.

                     <u>indata</u>        This is the contents of the <u>incallback-&gt;data</u> element of the callback
                                   structure.  It is provided as a means to share state between the <u>foreach</u>
                                   function and the user code.  Its use is completely optional: cast it to
                                   something useful or simply ignore it.

     <b>yp_order</b>()      Returns the order number for a map.

     <b>yp_master</b>()     Returns the hostname for the machine on which the master YP server process for a map is
                     running.

     <b>yperr_string</b>()  Returns a pointer to a null-terminated error string that does not contain a `.' or
                     `\n'.

     <b>ypprot_err</b>()    Converts a YP protocol error code to a <b>ypclnt</b> error code suitable for <b>yperr_string</b>().

<b>RETURN</b> <b>VALUES</b>
     All functions in the <b>ypclnt</b> suite which are of type <u>int</u> return 0 upon success or one of the following
     error codes upon failure:

     [YPERR_BADARGS]   The passed arguments to the function are invalid

     [YPERR_BADDB]     The YP map that was polled is defective.

     [YPERR_DOMAIN]    Client process cannot bind to server on this YP domain.

     [YPERR_KEY]       The key passed does not exist.

     [YPERR_MAP]       There is no such map in the server's domain.

     [YPERR_DOM]       The local YP domain is not set.

     [YPERR_NOMORE]    There are no more records in the queried map.

     [YPERR_PMAP]      Cannot communicate with portmap.

     [YPERR_RESRC]     A resource allocation failure occurred.

     [YPERR_RPC]       An RPC failure has occurred.  The domain has been marked unbound.

     [YPERR_VERS]      Client/server version mismatch.  If the server is running version 1 of the YP proto-<font color="#ffffff" class="whiteout">col,&nbsp;protocol,</font>
                       col, <b>yp_all</b>() functionality does not exist.

     [YPERR_BIND]      Cannot communicate with <a href="../man8/ypbind.8.html#//apple_ref/doc/man/8/ypbind">ypbind(8)</a>.

     [YPERR_YPERR]     An internal server or client error has occurred.

     [YPERR_YPSERV]    The client cannot communicate with the YP server process.

<b>SEE</b> <b>ALSO</b>
     <a href="malloc.3.html#//apple_ref/doc/man/3/malloc">malloc(3)</a>, <a href="../man8/yp.8.html#//apple_ref/doc/man/8/yp">yp(8)</a>, <a href="../man8/ypbind.8.html#//apple_ref/doc/man/8/ypbind">ypbind(8)</a>, <a href="../man8/ypserv.8.html#//apple_ref/doc/man/8/ypserv">ypserv(8)</a>

<b>AUTHOR</b>
     Theo De Raadt

BSD                            October 26, 1994                            BSD
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man3/yp_all.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man3/yp_all.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man3/yp_all.3.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
