<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QTMTB46: How to Compute Data Rate for QuickTime Movies</title>	<meta name="keywords" content="Mac OS 8 QuickTime movie compute data rate MovieDrawingCompleteProc ">	<meta name="Description" content="Technical Q&amp;A QTMTB46: Q&amp;A gives two ways, one of which includesa code snippet, of measuring the rate of samples for Quicktimemovies. Q&amp;A also includes a brief introduction on QuickTimeas a time-based sample media."><meta name="categories" content="QuickTime Movie Toolbox"><meta name="week-posted" content="Sep 11, 1995 - Sep 15, 1995"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10002016" title="How to Compute Data Rate for QuickTime Movies"></a> <!-- white background --><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxMovieBasics-date.html">Movie Basics</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QTMTB46</div>
<div id="pageheadsub">How to Compute Data Rate for QuickTime Movies</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER>			<!-- -->						<!-- Document Body --><table cellspacing="0" cellpadding="0" border="0" WIDTH="600"><tr><td align="left" scope="row"><font size="+4">Q</font>  How do I compute the data rate for QuickTime movies? Is this rate storedsomewhere in the QuickTime movie?<br><br><font size="+4">A</font>  QuickTime is a time-based sample media. In other words, various samples areorganized on a track and are played using a uniform time clock. Typically, inthe case of video, one sample equals one frame; in the case of sound and othermedia, this 1:1 relationship does not necessarily hold. Additionally, none ofthe video samples in a continuous stream are exactly the same size, even if inpractical terms this is often assumed.<p>QuickTime always tries to synchronize video and sound. If the CPU does not haveenough cycles to play back samples, the video samples are sacrificed for aperiod, and, in the worst case, sound samples may also be skipped to the nextanchor point (a key frame).</p><p>There are two aspects to measuring the rate of samples, one based on a staticestimation of the duration of the movie and the amount of video samples(frames), and the other based on when the movie is played back.</p><p>In the first case, you can make a quick estimate by assuming that all videosamples are of equal duration, then taking the duration of the movie anddividing it by the duration of the first sample, yielding the number of  videosamples present per one second unit.</p><p>Here's a code snippet showing this technique:</p><pre>framecount = GetMovieDuration(theMovie)/GetDurationofFirstMovieSample(theMovie,VideoMediaType);pascal TimeValue GetDurationOfFirstMovieSample(Movie theMovie, OSType theMediaType){    OSErr             anErr = noErr;    TimeValue        interestingDuration = 0;    short            timeFlags = nextTimeMediaSample+nextTimeEdgeOK;    GetMovieNextInterestingTime(theMovie, timeFlags, (TimeValue)1, &amp;theMediaType,    0, fixed1, NULL, &amp;interestingDuration);    anErr = GetMoviesError(); DebugAssert(anErr == noErr);    return interestingDuration;}</pre><p>If you want the exact number of frames, you need to parse each one usingGetMovieNextInterestingTime (or any of its variants), find out the duration ofeach sample and its starting point, and use this information to calculate theframe rate.</p><p>Note that when you digitize, and you specify the frame rate, you will mostlikely create similarly-sized video samples.</p><p>In the second case, to create a dynamic testing of frames displayed, install aMovieDrawingCompleteProc that is triggered every time a frame is drawn. In thisway you can keep a counter of how many frames are drawn per time unit. Notethat if end user information is drawn too often, the results will be skewed. Refer to <A HREF="../../technotes/qt/qt_04.html" target="_blank">TechnoteQT 04</a> for more information about how to install a MovieDrawingCompleteProc.</p><!-- begin_date --><H4 ALIGN=center>[Sep 15 1995]</H4><!-- end_date --></td></tr></table></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qtmtb/qtmtb46.html%3Fid%3DDTS10002016-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qtmtb/qtmtb46.html%3Fid%3DDTS10002016-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qtmtb/qtmtb46.html%3Fid%3DDTS10002016-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>