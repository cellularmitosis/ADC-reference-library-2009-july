<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Summary of ZIP(IM:N)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING97></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Networking-96.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-98.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Networking-2.html"><B>Networking</B></A> / <BR><DD><A HREF="Networking-84.html"><B>Chapter 4 - Zone Information Protocol (ZIP)</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING97-0></A>
<H1>Summary of ZIP</H1>
<A NAME=HEADING97-1></A>
<H2>Pascal Summary</H2>
<A NAME=HEADING97-2></A>
<H3>Constants</H3>
<PRE>
CONST
   {csCode for .XPP extended calls}
   xCall             =     246;

   {.XPP driver unit and reference number}
   xppUnitNum        =     40;      
   xppRefNum         =     -41; 
   
   {routine selectors}
   zipGetLocalZones  =      5;      {routine selector for local zone names}
   zipGetZoneList    =      6;      {routine selector for internet zone list}
   zipGetMyZone      =      7;      {routine selector for node's zone name}
</PRE>
<A NAME=HEADING97-4></A>
<H3>Data Types</H3>
<A NAME=HEADING97-5></A>
<H4>The XPP Parameter Block for ZIP</H4>
<PRE>
TYPE XPPParamBlock = 
      PACKED RECORD
         qLink:               QElemPtr;   {reserved}
         qType:               Integer;    {reserved}
         ioTrap:              Integer;    {reserved}
         ioCmdAddr:           Ptr;        {reserved}
         ioCompletion:        ProcPtr;    {completion routine}
         ioResult:            OSErr;      {result code}
         cmdResult:           LongInt;    {reserved}
         ioVRefNum:           Integer;    {reserved}
         ioRefNum:            Integer;    {driver reference number}
         csCode:              Integer;    {primary command code}


         CASE XPPPrmBlkType OF
            xCallParam
               xppSubCode:    Integer;    {secondary command code}
               xppTimeout:    Byte;       {timeout period for .XPP}
               xppRetry:      Byte;       {retry count}
               filler1:       Integer;    {reserved}
               zipBuffPtr:    Ptr;        {returned zone names}
               zipNumZones:   Integer;    {number of zones returned}
               zipLastFlag:   Byte;       {nonzero when all zone }
                                          { names have been returned}
               filler2:       Byte;       {reserved}
               zipInfoField:  PACKED ARRAY[1..70] OF Byte;
                                          {reserved for use by .XPP}
      END;
      XPPParmBlkPtr = ^XPPParamBlock;
</PRE>
<A NAME=HEADING97-7></A>
<H3>Routines</H3>
<A NAME=HEADING97-8></A>
<H4>Obtaining Zone Information </H4>
<PRE>
FUNCTION GetMyZone(thePBptr: XPPParmBlkPtr; async: Boolean): OSErr;
FUNCTION GetLocalZones(thePBptr: XPPParmBlkPtr; async: Boolean): OSErr;
FUNCTION GetZoneList(thePBptr: XPPParmBlkPtr; async: Boolean): OSErr;
</PRE>
<A NAME=HEADING97-12></A>
<H2>C Summary</H2>
<A NAME=HEADING97-13></A>
<H3>Constants</H3>
<PRE>
/*MPP parameter constants*/
#define MPPioCompletion MPP.ioCompletion
#define MPPioResult MPP.ioResult
#define MPPioRefNum MPP.ioRefNum
#define MPPcsCode MPP.csCode
enum {                              /*.XPP csCode*/
   xCall             =     246};    /*csCode for .XPP extended calls*/

enum {                              /*.XPP driver unit and reference */
                                    /* numbers*/
   xppUnitNum        =     40,      /*XPP unit number */
   xppRefNum         =     -41};    /*XPP reference number */

enum {                        /*XPP routine selectors*/
   zipGetLocalZones  =  5,    /*routine selector for local zone names*/
   zipGetZoneList    =  6,    /*routine selector for internet zone list*/
   zipGetMyZone      =  7};   /*routine selector for node's zone name*/
</PRE>
<A NAME=HEADING97-16></A>
<H3>Data Types</H3>
<A NAME=HEADING97-17></A>
<H4>The XPP Parameter Block for ZIP</H4>
<PRE>
#define XPPPBHeader
   QElem          *qLink;           /*reserved*/\
   short          qType;            /*reserved*/\
   short          ioTrap;           /*reserved */\
   Ptr            ioCmdAddr;        /*reserved*/\
   ProcPtr        ioCompletion;     /*completion routine*/\
   OSErr          ioResult;         /*result code*/\
   long           cmdResult;        /*reserved*/\
   short          ioVRefNum;        /*reserved*/\
   short          ioRefNum;         /*driver reference number*/
   short          csCode;           /*primary command code*/
typedef struct {
   XPPPBHeader 
      short       xppSubCode;       /*secondary command code*/
      char        xppTimeout;       /*retry interval in seconds*/
      char        xppRetry;         /*retry count*/
      short       filler1;
      Ptr         zipBuffPtr;       /*pointer to buffer of 578 bytes*/
      short       zipNumZones;      /*number of zone names in response*/
      char        zipLastFlag;      /*nonzero if no more zones*/
      char        filler2;          /*filler*/
      char        zipInfoField[70]; /*initial call, set first word to 0*/
}XCallParam;
</PRE>
<A NAME=HEADING97-20></A>
<H3>Routines</H3>
<A NAME=HEADING97-21></A>
<H4>Obtaining Zone Information</H4>
<PRE>
pascal OSErr GetMyZone(XPPParmBlkPtr thePBptr, Boolean async);
pascal OSErr GetLocalZones(XPPParmBlkPtr thePBptr, Boolean async);
pascal OSErr GetZoneList(XPPParmBlkPtr thePBptr, Boolean async);
</PRE>
<A NAME=HEADING97-25></A>
<H2>Assembly-Language Summary</H2>
<A NAME=HEADING97-26></A>
<H3>Constants</H3>
<A NAME=HEADING97-27></A>
<H4>XPP csCode</H4>
<PRE>
xCall             EQU      246   ;csCode for XPP extended calls
</PRE>
<A NAME=HEADING97-29></A>
<H4>XPP Driver Unit Reference Number</H4>
<PRE>
xppUnitNum        EQU      9     ;XPP unit number
</PRE>
<A NAME=HEADING97-31></A>
<H4>XPP xCall Subcodes for ZIP Commands</H4>
<PRE>
ZGetMyZone        EQU      7     ;selector for GetMyZone command
ZGetZoneList      EQU      8     ;selector for GetZoneList command
ZGetLocalZones    EQU      9     ;selector for GetLocalZones command
</PRE>
<A NAME=HEADING97-33></A>
<H3>Data Structures</H3>
<A NAME=HEADING97-34></A>
<H4>XPP Parameter Block Common Fields for ZIP Routines
<TABLE BORDER="0" CELLPADDING=3><TD>0<TD>qLink<TD>long<TD>reserved<TR>
<TD>4<TD>qType<TD>word<TD>reserved<TR>
<TD>6<TD>ioTrap<TD>word<TD>reserved<TR>
<TD>8<TD>ioCmdAddr<TD>long<TD>reserved<TR>
<TD>12<TD>ioCompletion<TD>long<TD>address of completion routine<TR>
<TD>16<TD>ioResult<TD>word<TD>result code<TR>
<TD>18<TD>cmdResult<TD>long<TD>reserved<TR>
<TD>22<TD>ioVRefNum<TD>word<TD>reserved<TR>
<TD>24<TD>ioRefNum<TD>word<TD>driver reference number</TABLE>
</H4>
<A NAME=HEADING97-35></A>
<H4>GetMyZone
<TABLE BORDER="0" CELLPADDING=3><TD>28<TD>xppSubCode<TD>word<TD>always <CODE>zipGetZoneList</CODE> for this function<TR>
<TD>30<TD>xppTimeout<TD>byte<TD>retry interval in seconds<TR>
<TD>31<TD>xppRetry<TD>byte<TD>retry count<TR>
<TD>34<TD>zipBuffPtr<TD>long<TD>pointer to data buffer<TR>
<TD>42<TD>zipInfoField<TD>70 bytes<TD>data buffer for use by ZIP; first word set to 0</TABLE>
</H4>
<A NAME=HEADING97-36></A>
<H4>GetLocalZones
<TABLE BORDER="0" CELLPADDING=3><TD>28<TD>xppSubCode<TD>word<TD>always <CODE>zipGetLocalZones</CODE> for this function<TR>
<TD>30<TD>xppTimeout<TD>byte<TD>retry interval in seconds<TR>
<TD>31<TD>xppRetry<TD>byte<TD>retry count<TR>
<TD>34<TD>zipBuffPtr<TD>long<TD>pointer to data buffer<TR>
<TD>38<TD>zipNumZones<TD>word<TD>number of names returned<TR>
<TD>40<TD>zipLastFlag<TD>byte<TD>nonzero if no more names<TR>
<TD>42<TD>zipInfoField<TD>70 bytes<TD>data buffer for use by ZIP; first word set to 0</TABLE>
</H4>
<A NAME=HEADING97-37></A>
<H4>GetZoneList
<TABLE BORDER="0" CELLPADDING=3><TD>28<TD>xppSubCode<TD>word<TD>always <CODE>zipGetZoneList</CODE> for this function<TR>
<TD>30<TD>xppTimeout<TD>byte<TD>retry interval in seconds<TR>
<TD>31<TD>xppRetry<TD>byte<TD>retry count<TR>
<TD>34<TD>zipBuffPtr<TD>long<TD>pointer to data buffer<TR>
<TD>38<TD>zipNumZones<TD>word<TD>number of names returned<TR>
<TD>40<TD>zipLastFlag<TD>byte<TD>nonzero if no more names<TR>
<TD>42<TD>zipInfoField<TD>70 bytes<TD>data buffer for use by ZIP; first word set to 0</TABLE>
</H4>
<A NAME=HEADING97-38></A>
<H2>Result Codes
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>noBridgeErr<TD>-93<TD>No router is available<TR>
<TD>reqFailed<TD>-1096<TD>Request to contact router failed; retry count exceeded <TR>
<TD>tooManyReqs<TD>-1097<TD>Too many concurrent requests<TR>
<TD>noDataArea<TD>-1104<TD>Too many outstanding ATP calls<A NAME=MARKER-2-89></A></TABLE>
</H2>
</BLOCKQUOTE><P>

</BLOCKQUOTE>
<HR>
<center>
<A HREF="Networking-96.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Networking-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Networking-304.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt= "Book Index"></A> <A HREF="Networking-98.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Networking-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
