<HTML>		<HEAD>		<TITLE>			WOStatisticsStore		</TITLE>		</HEAD>	<body bgcolor="#ffffff"><!--start of banner --><!-- #include virtual="/techpubs/navbar" --><!-- end of banner --><!--start of path --><font face="Geneva,Helvetica,Arial" size="1"><b>PATH<spacer type="horizontal" size="5">&nbsp;</b> <a href="../../../../../../../index.html" target="_top">Documentation</a> <b>&gt;</b> <a href="../../../../../../webobjects.html" target="_top">WebObjects 4.5</a> <b>&gt;</b>WebObjects Reference</font><br><br><!--end of path --><a href="../WebObjectsTOC.html"><img src="../../../../../../images/up.gif" border="0" alt="Table of Contents"></a> <a name = "WOStatisticsStore"><BR><h1><FONT COLOR=\"#000066\"><a name="//apple_ref/occ/cl/WOStatisticsStore">WOStatisticsStore</a></FONT></h1><br></a><blockquote><b>Inheritsfrom: </b> NSObject</blockquote><blockquote><b>Conforms to: </b> NSObject<BR>(NSObject)</blockquote><blockquote><b>Declared in: </b> WebObjects/WOStatisticsStore.h<BR></blockquote><br><br><HR SIZE=4><br><h2>Class Description</h2><hr><p>The WOStatisticsStore object records statistics about a WebObjectsapplication while that application runs. All WebObjects applicationshave a WOStatisticsStore object, which you can access by sending  <a frame= "conv" href="WOApplication.html#//apple_ref/occ/instm/WOApplication/statisticsStore">statisticsStore</a> to the WOApplicationobject.</p><br><h2>Recording Information</h2><p>The WOStatisticsStore object records the bulk of its statisticsat the end of each cycle of the request-response loop. Specifically,at the end of WOSession's  <a frame= "conv" href="WOSession.html#//apple_ref/occ/instm/WOSession/appendToResponse:inContext:">appendToResponse:inContext:</a> method, theWOSession sends the  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/recordStatisticsForResponse:inContext:">recordStatisticsForResponse:inContext:</a> messageto the WOStatisticsStore. This message tells the WOStatisticsStoreto begin recording statistics. Then, WOSession sends it a  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/descriptionForResponse:inContext:">descriptionForResponse:inContext:</a> message.This method sends the response component a  <a frame= "conv" href="WOComponent.html#//apple_ref/occ/instm/WOComponent/descriptionForResponse:inContext:">descriptionForResponse:inContext:</a> message.The default implementation of <b>descriptionForResponse:inContext:</b> inWOComponent returns the component's name.  </p><p>You can override <b>descriptionForResponse:inContext:</b> ineach of your components if you want to record more information.For example, you might want to record the values of all of the component'svariables or perhaps just one or two key variables.  </p><p>If you want to record extra information about the session,you can override WOStatisticsStore's <b>recordStatisticsForResponse:inContext:</b> method.</p><br><h2>Maintaining a Log File</h2><p>You can maintain an application log file by sending the message  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setLogFile:rotationFrequencyInDays:">setLogFile:rotationFrequencyInDays:</a> tothe WOStatisticsStore object. When a log file has been specified,each session records information in the log file about the pagesit accessed.</p><p>The log is maintained in Common Log File Format (CLFF) sothat it can be analyzed by any standard CLFF-analysis tool. (Formore information about the statistics recorded in the log file,see the  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/formatDescription:forResponse:inContext:">formatDescription:forResponse:inContext:</a> methoddescription.) If a log file has been specified, the WOSession objectkeeps its own statistics about which pages it has accessed. Whenthe session terminates, it writes this information to the log file. </p><br><br><br><h2>Adopted Protocols</h2><hr><blockquote>NSLocking<dd>- lock</dd><dd>- unlock</dd></blockquote><br><br><h2>Method Types</h2><hr><blockquote><dl><dt>Recording information</dt><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/recordStatisticsForResponse:inContext:">- recordStatisticsForResponse:inContext:</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/descriptionForResponse:inContext:">- descriptionForResponse:inContext:</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setSessionMovingAverageSampleSize:">- setSessionMovingAverageSampleSize:</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/transactionMovingAverageSampleSize">- transactionMovingAverageSampleSize</a></dd></dl><dl><dt>Retrieving information</dt><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/statistics">- statistics</a></dd></dl><dl><dt>Maintaining a CLFF logfile</dt><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setLogFile:rotationFrequencyInDays:">- setLogFile:rotationFrequencyInDays:</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logFileRotationFrequencyInDays">- logFileRotationFrequencyInDays</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logFile">- logFile</a></dd></dl><dl><dt>Recording informationin the CLFF log file</dt><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/formatDescription:forResponse:inContext:">- formatDescription:forResponse:inContext:</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logString:">- logString:</a></dd></dl><dl><dt>Securing access to theWOStats page</dt><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setPassword:">- setPassword:</a></dd><dd> <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/validateLogin:forSession:">- validateLogin:forSession:</a></dd></dl></blockquote><BR><BR><h2>Instance Methods</h2><hr><a name = "descriptionForResponse_inContext_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/descriptionForResponse:inContext:">descriptionForResponse:inContext:</a></h3></a><p><code>- (NSString *)<b>descriptionForResponse:</b>(WOResponse*)<em>aResponse</em><b>inContext:</b>(WOContext *)<em>aContext</em></code></p>Records information about the current responseby sending the  <a frame= "conv" href="WOComponent.html#//apple_ref/occ/instm/WOComponent/descriptionForResponse:inContext:">descriptionForResponse:inContext:</a> messageto the response page and returning the result. This method is invokedat the end of the request-response loop in WOSession's  <a frame= "conv" href="WOSession.html#//apple_ref/occ/instm/WOSession/appendToResponse:inContext:">appendToResponse:inContext:</a> method,after the  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/recordStatisticsForResponse:inContext:">recordStatisticsForResponse:inContext:</a> method. <hr WIDTH=25% ALIGN=LEFT><a name = "formatDescription_forResponse_inContext_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/formatDescription:forResponse:inContext:">formatDescription:forResponse:inContext:</a></h3></a><p><code>- (NSString *)<b>formatDescription:</b>(NSString*)<em>responseDescription</em><b>forResponse:</b>(WOResponse *)<em>aResponse</em><b>inContext:</b>(WOContext *)<em>aContext</em></code></p>If log file recording is enabled, this methodformats the string responseDescription in using Common Log FileFormat (CLFF). The resulting string contains:  <ul><li>Thehost from which the HTTP request was received </li><li>The name of the user that performed the request </li><li>The current date </li><li>The request's HTTP method (GET or PUT) </li><li>The WebObjects application name </li><li>The result of the  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/descriptionForResponse:inContext:">descriptionForResponse:inContext:</a> method(by default, this method returns the response component's name) </li><li>The request's HTTP version </li><li>The HTTP status of the response </li><li>The size of the response </li></ul><p>You enablelog file recording by setting a log file using the  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setLogFile:rotationFrequencyInDays:">setLogFile:rotationFrequencyInDays:</a> method. </p><p>This method is used by WOSession to record informationabout the current transaction when log file recording is enabled. </p><p><b>SeeAlso: </b>  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logFile">- logFile</a>,  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logString:">- logString:</a> </p><hr WIDTH=25% ALIGN=LEFT><a name = "logFile"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/logFile">logFile</a></h3></a><p><code>- (NSString *)<b>logFile</b></code></p>Returns the full path to the CLFF log file.This log file does not exist unless you send  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setLogFile:rotationFrequencyInDays:">setLogFile:rotationFrequencyInDays:</a> tothe WOStatisticsStore. <p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/formatDescription:forResponse:inContext:">- formatDescription:forResponse:inContext:</a>,  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logFileRotationFrequencyInDays">- logFileRotationFrequencyInDays</a>,  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logString:">- logString:</a> </p><hr WIDTH=25% ALIGN=LEFT><a name = "logFileRotationFrequencyInDays"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/logFileRotationFrequencyInDays">logFileRotationFrequencyInDays</a></h3></a><p><code>- (double)<b>logFileRotationFrequencyInDays</b></code></p>The number of days a log file lasts. That is,a log file's contents are flushed after a certain time interval toensure that it does not grow too large and a new log file is started.This method returns that time interval.  <p>Before a new logfile is started, the contents of the current log file are savedto a backup file. You can then inspect this log file and/or removeit when its data has grown stale. </p><p><b>SeeAlso: </b>  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setLogFile:rotationFrequencyInDays:">- setLogFile:rotationFrequencyInDays:</a> </p><hr WIDTH=25% ALIGN=LEFT><a name = "logString_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/logString:">logString:</a></h3></a><p><code>- (void)<b>logString:</b>(NSString*)<em>aString</em></code></p>Writes the string <em>aString</em> tothe CLFF log file specified by  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logFile">logFile</a>. The method is used to recorda session's statistics when that session ends. You can also useit to record any string to the log file that might be helpful toyou. <p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/formatDescription:forResponse:inContext:">- formatDescription:forResponse:inContext:</a> </p><hr WIDTH=25% ALIGN=LEFT><a name = "recordStatisticsForResponse_inContext_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/recordStatisticsForResponse:inContext:">recordStatisticsForResponse:inContext:</a></h3></a><p><code>- (void)<b>recordStatisticsForResponse:</b>(WOResponse*)<em>aResponse</em><b>inContext:</b>(WOContext *)<em>aContext</em></code></p>Records statistics for the current cycle ofthe request-response loop. This method is invoked at the end ofWOSession's  <a frame= "conv" href="WOSession.html#//apple_ref/occ/instm/WOSession/appendToResponse:inContext:">appendToResponse:inContext:</a> method,immediately before the  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/descriptionForResponse:inContext:">descriptionForResponse:inContext:</a> method.By default, this method records the name of the response page forlater use by <b>descriptionForResponse:inContext:</b>.You can override it if you want to record more information aboutthe session before the current request and response are deallocated.You must begin your implementation by invoking the superclass method. <hr WIDTH=25% ALIGN=LEFT><a name = "sessionMovingAverageSampleSize"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/sessionMovingAverageSampleSize">sessionMovingAverageSampleSize</a></h3></a><p><code>- (int)<b>sessionMovingAverageSampleSize</b></code></p>Returns the sample size used to compute movingaverage statistics for each session. The WOStatisticsStore objectuses this sample size to compute the response time for the lastn transactions and the idle time between the last n transactions,where n is the number returned by this method. The default samplesize is 10.<p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setSessionMovingAverageSampleSize:">- setSessionMovingAverageSampleSize:</a></p><hr WIDTH=25% ALIGN=LEFT><a name = "setLogFile_rotationFrequencyInDays_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/setLogFile:rotationFrequencyInDays:">setLogFile:rotationFrequencyInDays:</a></h3></a><p><code>- (void)<b>setLogFile:</b>(NSString*)<em>filePath</em><b>rotationFrequencyInDays:</b>(double)<em>logRotation</em></code></p>Sets the full path of the log file to whichCLFF statistics will be recorded to <em>filePath</em>.The <em>logRotation</em> argument specifiesthe number of days statistics will be recorded to this log file.Every <em>logRotation</em> days, the contentsof the current log file are saved to a backup file and a new logfile is started.  <p>The default is not to record informationto a log file. </p><p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logFile">- logFile</a>,  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/logFileRotationFrequencyInDays">- logFileRotationFrequencyInDays</a> </p><hr WIDTH=25% ALIGN=LEFT><a name = "setPassword_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/setPassword:">setPassword:</a></h3></a><p><code>- (void)<b>setPassword:</b>(NSString*)<em>aPassword</em></code></p>Implements security for the WOStats page bysetting its password to <em>aPassword</em>.By default, there is no password, so any user can access the WOStatspage (provided they know the URL). If you implement this method,when you enter the WOStats URL, a login panel appears. You can leavethe User name field blank; as long as you type the appropriate passwordin the password field, the WOStats page will appear. <p><b>SeeAlso: </b>  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/validateLogin:forSession:">- validateLogin:forSession:</a></p><hr WIDTH=25% ALIGN=LEFT><a name = "setMovingAverageSampleSize_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/setSessionMovingAverageSampleSize:">setSessionMovingAverageSampleSize:</a></h3></a><p><code>- (void)<b>setSessionMovingAverageSampleSize:</b>(int)<em>aSize</em></code></p>Sets the moving average sample size for eachsession to <em>aSize</em>. The WOStatisticsStoreobject uses this sample size to compute the response time for thelast aSize transactions and the idle time between the last <em>aSize</em> transactions. <p>The default moving average session sample size is 10 transactions. </p><p><b>SeeAlso: </b>   <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/sessionMovingAverageSampleSize">- sessionMovingAverageSampleSize</a></p><hr WIDTH=25% ALIGN=LEFT><a name = "setTransactionMovingAverageSampleSize_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/setTransactionMovingAverageSampleSize:">setTransactionMovingAverageSampleSize:</a></h3></a><p><code>- (void)<b>setTransactionMovingAverageSampleSize:</b>(int)<em>aSize</em></code></p>Sets the moving average sample size for eachtransaction to <em>aSize</em>. The WOStatisticsStoreobject uses this sample size to compute the response time for thelast <em>aSize</em> transactions and the idletime between the last <em>aSize</em> transactions. <p>The default moving average transaction sample size is 100transactions. </p><p><b>See Also: </b>   <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/transactionMovingAverageSampleSize">- transactionMovingAverageSampleSize</a></p><hr WIDTH=25% ALIGN=LEFT><a name = "statistics"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/statistics">statistics</a></h3></a><p><code>- (NSDictionary *)<b>statistics</b></code></p>Returns a dictionary containing the statisticsthat the WOStatisticsStore records.<p>The averages that are displayedby this method are not computed until this method is invoked. Therefore,invoking this method is costly and should not be done at every request. </p><hr WIDTH=25% ALIGN=LEFT><a name = "transactionMovingAverageSampleSize"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/transactionMovingAverageSampleSize">transactionMovingAverageSampleSize</a></h3></a><p><code>- (int)<b>transactionMovingAverageSampleSize</b></code></p>Returns the sample size used to compute movingaverage statistics for each transaction. The WOStatisticsStore objectuses this sample size to compute the response time for the lastn transactions and the idle time between the last n transactions,where n is the number returned by this method. The default samplesize is 100.<p><b>See Also: </b>  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setTransactionMovingAverageSampleSize:">- setTransactionMovingAverageSampleSize:</a></p><hr WIDTH=25% ALIGN=LEFT><a name = "validateLogin_forSession_"><BR><h3><a name="//apple_ref/occ/instm/WOStatisticsStore/validateLogin:forSession:">validateLogin:forSession:</a></h3></a><p><code>- (BOOL)<b>validateLogin:</b>(NSString*)<em>string</em><b>forSession:</b>(WOSession *)<em>aSession</em></code></p>Returns YES if string is the password set by  <a frame= "conv" href="#//apple_ref/occ/instm/WOStatisticsStore/setPassword:">setPassword:</a>, and NO otherwise.The password controls if the user can see the WOStats page. <hr WIDTH=25% ALIGN=LEFT><BR><br><a href="../WebObjectsTOC.html"><img src="../../../../../../images/up.gif" border="0" alt="Table of Contents"></a> </BODY></HTML>