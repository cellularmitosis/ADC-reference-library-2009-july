<!-- legacy work start --><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"        "http://www.w3.org/TR/html4/loose.dtd"><!-- legacy work end --><HTML><HEAD><META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter"><TITLE>Constructing Sound Resource and File Headers (deprecated)</title><!-- legacy work start -->        <META NAME="Generator" CONTENT="manual">        <META http-equiv="content-type" CONTENT="text/html;charset=utf-8">        <META NAME = "Copyright" CONTENT="Copyright 2007 Apple Inc. All Rights Reserved.">        <META NAME="IndexTitle" CONTENT="Sound Input Manager (Not Recommended)">        <meta name="xcode-display" content="render">        <LINK REL="stylesheet" TYPE="text/css" HREF="../../../Resources/CSS/frameset_styles.css"> <!-- before submitting, globally replace ".." with "developer.apple.com" -->        <script type="text/javascript" language="JavaScript" src="../../../Resources/JavaScript/page.js"></script><!-- legacy work end --></HEAD><BODY BGCOLOR="#ffffff"><!-- start of header --><!--#include virtual="/includes/framesetheader" --><!-- end of header --><!-- path goes here --><!-- QTnavbar start --><P><I>Inside Macintosh: Sound Manager</I><P>| <A target="doc" HREF="imsoundinput.1a.htm">Previous</A> | <A target="doc" HREF="imsoundinput.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundinput.htm">Chapter top</A> | <A target="doc" HREF="imsoundinput.16.htm">Section top</A> | <A target="doc" HREF="imsoundinput.1c.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --><H1 CLASS="RH3.RoutineHd3"><A NAME="pgfId=901"> </A>Constructing Sound Resource and File Headers</H1><P CLASS="T0.Text0"><A NAME="pgfId=907"> </A>The Sound Input Manager provides two functions, <TT CLASS="cv">SetupSndHeader</TT> and <TT CLASS="cv">SetupAIFFHeader</TT>, to help you set up headers for sound resources and sound files.</P><DIV><H2 CLASS="RoH.RoutineHeading"><A NAME="pgfId=908"> </A>SetupSndHeader<A NAME="marker=262"> </A><A NAME="marker=67"> </A></H2><P CLASS="T0.Text0"><A NAME="pgfId=909"> </A><A NAME="marker=468"> </A>You can use the <TT CLASS="cv">SetupSndHeader</TT> function to construct a sound resource containing sampled sound that can be passed to the <TT CLASS="cv">SndPlay</TT> function.</P><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=13620"> </A>FUNCTION SetupSndHeader (sndHandle: Handle;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numChannels: Integer;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampleRate: Fixed;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampleSize: Integer; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compressionType: OSType; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baseFrequency: Integer; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numBytes: LongInt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VAR headerLen: Integer): OSErr;<BR></CODE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6546"> </A><TT CLASS="cv">sndHandle</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=911"> </A>A handle to a block of memory that is at least large enough to store the sound resource header information. The handle is not resized in any way upon successful completion of <TT CLASS="cv">SetupSndHeader</TT>. The <TT CLASS="cv">SetupSndHeader</TT> function simply fills the relocatable block specified by this parameter with the header information needed for a format 1 <TT CLASS="cv">'snd&nbsp;'</TT> resource, including the sound resource header, the list of sound commands, and a sampled sound header. It is your application's responsibility to append the desired sampled-sound data.</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6555"> </A><TT CLASS="cv">numChannels</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=912"> </A> The number of channels for the sound; one channel is equivalent to monaural sound and two channels are equivalent to stereo sound.</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6565"> </A><TT CLASS="cv">sampleRate</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=913"> </A> The rate at which the sound was recorded. The sample rate is declared as a <TT CLASS="cv">Fixed</TT> data type. In order to accommodate sample rates greater than 32&nbsp;kHz, the most significant bit is not treated as a sign bit; instead, that bit is interpreted as having the value 32,768.</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6575"> </A><TT CLASS="cv">sampleSize</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=914"> </A> The sample size for the original sound (that is, bits per sample).</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6585"> </A><TT CLASS="cv">compressionType</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=915"> </A> The compression type for the sound (<TT CLASS="cv">'NONE'</TT>, <TT CLASS="cv">'MAC3'</TT>, <TT CLASS="cv">'MAC6'</TT>, or other third-party types).</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6595"> </A><TT CLASS="cv">baseFrequency</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=916"> </A> The base frequency for the sound, expressed as a MIDI note value.</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6605"> </A><TT CLASS="cv">numBytes</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=917"> </A>The number of bytes of audio data that are to be stored in the handle. (This value is not necessarily the same as the number of samples in the&nbsp;sound.)</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6614"> </A><TT CLASS="cv">headerLen</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=918"> </A>On exit, the size (in bytes) of the <TT CLASS="cv">'snd&nbsp;'</TT> resource header that is created. In no case will this length exceed 100 bytes. This field allows you to put the audio data right after the header in the relocatable block specified by the <TT CLASS="cv">sndHandle</TT> parameter. The value returned depends on the type of sound header created.</BLOCKQUOTE><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=919"> </A>DESCRIPTION</H3><P CLASS="T0.Text0"><A NAME="pgfId=920"> </A>The <TT CLASS="cv">SetupSndHeader</TT> function creates a format 1 <TT CLASS="cv">'snd&nbsp;'</TT> resource for a sampled sound. The resource contains a sound resource header that links the sound to the sampled synthesizer, a single sound command (a <TT CLASS="cv">bufferCmd</TT> command to play the accompanying data), and a sampled sound header. You can use <TT CLASS="cv">SetupSndHeader</TT> to construct a sampled sound header that can be passed to the Sound Manager's <TT CLASS="cv">SndPlay</TT> function or stored as an <TT CLASS="cv">'snd&nbsp;'</TT> resource. After calling the <TT CLASS="cv">SetupSndHeader</TT> function, your application should place the sampled-sound data directly after the sampled sound header so that, in essence, the sampled sound header's final field contains the sound&nbsp;data.<A NAME="marker=78"> </A></P><P CLASS="T1.Text1"><A NAME="pgfId=1246"> </A>The sampled sound is in one of three formats depending on several of the parameters passed. <A target="doc" HREF="imsoundinput.1b.htm#26973" CLASS="XRef">Table&nbsp;3</A> shows how <TT CLASS="cv">SetupSndHeader</TT> determines what kind of sound header to create. </P><TABLE><CAPTION><P CLASS="Tb.Table"><A NAME="pgfId=902"> </A>Table&nbsp;3 <A NAME="26973"> </A>The sampled sound header format used by <TT CLASS="cv">SetupSndHeader</TT></P></CAPTION><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=923"> </A>compressionType</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=924"> </A>numChannels</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=925"> </A>sampleSize</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=926"> </A>Sampled sound header format</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1572"> </A>'NONE'<BR></CODE></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1573"> </A>1</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1574"> </A>8</P></TD><TD ROWSPAN="1" COLSPAN="1"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1575"> </A>SoundHeader<BR></CODE></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1576"> </A>'NONE'<BR></CODE></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1577"> </A>1</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1578"> </A>16</P></TD><TD ROWSPAN="1" COLSPAN="1"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1579"> </A>ExtSoundHeader<BR></CODE></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1580"> </A>'NONE'<BR></CODE></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1581"> </A>2</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1582"> </A>any</P></TD><TD ROWSPAN="1" COLSPAN="1"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1583"> </A>ExtSoundHeader<BR></CODE></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1584"> </A> not <TT CLASS="cv">'NONE'</TT></P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1585"> </A>any</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="TbT.TblText"><A NAME="pgfId=1586"> </A>any</P></TD><TD ROWSPAN="1" COLSPAN="1"><CODE CLASS="TbCv.TblCode"><A NAME="pgfId=1587"> </A>CmpSoundHeader<A NAME="marker=443"> </A><BR></CODE></TD></TR></TABLE><P CLASS="T1.Text1"><A NAME="pgfId=922"> </A>A good way to use this function is to create a handle in which you want to store a sampled sound, then call <TT CLASS="cv">SetupSndHeader</TT> with the <TT CLASS="cv">numBytes</TT> parameter set to <TT CLASS="cv">0</TT> to see how much room the header for that sound will occupy and hence where to append the audio data. Then record the data into the handle and call <TT CLASS="cv">SetupSndHeader</TT> again with <TT CLASS="cv">numBytes</TT> set to the correct amount of sound data recorded. The handle filled out in this way can be passed to <TT CLASS="cv">SndPlay</TT> to play the sound.</P></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=927"> </A>SPECIAL CONSIDERATIONS</H3><P CLASS="T0.Text0"><A NAME="pgfId=928"> </A>You cannot call the <TT CLASS="cv">SetupSndHeader</TT> function at interrupt time.</P></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=929"> </A>ASSEMBLY-LANGUAGE INFORMATION</H3><P CLASS="T0.Text0"><A NAME="pgfId=1247"> </A>The trap macro and routine selector for the <TT CLASS="cv">SetupSndHeader</TT> function are</P><TABLE><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=1249"> </A>Trap macro</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=1588"> </A>Selector</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="MLCv.MLCode"><A NAME="pgfId=906"> </A>_SoundDispatch</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=921"> </A>$0D480014</P></TD></TR></TABLE></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=1248"> </A>RESULT CODES</H3><TABLE><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="MLCv.MLCode"><A NAME="pgfId=931"> </A>noErr</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="MLR.RtAlign"><A NAME="pgfId=1569"> </A>0</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1570"> </A>No error</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="MLCv.MLCode"><A NAME="pgfId=1571"> </A>siInvalidCompression</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="MLR.RtAlign"><A NAME="pgfId=1589"> </A>-223</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1590"> </A>Invalid compression type</P></TD></TR></TABLE></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=933"> </A>SEE ALSO</H3><P CLASS="T0.Text0"><A NAME="pgfId=1405"> </A>For an example that uses the <TT CLASS="cv">SetupSndHeader</TT> function to set up a sound header before recording, see <A target="doc" HREF="imsoundinput.7.htm#14131" CLASS="XRef">Listing&nbsp;42</A>.<A NAME="marker=270"> </A><A NAME="marker=68"> </A><A NAME="marker=469"> </A></P></DIV></DIV><DIV><H2 CLASS="RoH.RoutineHeading"><A NAME="pgfId=935"> </A>SetupAIFFHeader<A NAME="marker=271"> </A></H2><P CLASS="T0.Text0"><A NAME="pgfId=936"> </A><A NAME="marker=444"> </A>You can use the <TT CLASS="cv">SetupAIFFHeader</TT> function to set up a file that can subsequently be played by <TT CLASS="cv">SndStartFilePlay</TT>.</P><CODE CLASS="RD.RoutineDeclare"><A NAME="pgfId=13624"> </A>FUNCTION SetupAIFFHeader (fRefNum: Integer; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numChannels: Integer;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sampleRate: Fixed; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampleSize: Integer;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compressionType: OSType; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numBytes: LongInt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; numFrames: LongInt): OSErr;<BR></CODE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6627"> </A><TT CLASS="cv">fRefNum</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=938"> </A>A file reference number of a file that is open for writing.</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6636"> </A><TT CLASS="cv">numChannels</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=939"> </A> The number of channels for the sound; one channel is equivalent to monaural sound and two channels are equivalent to stereo sound.</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6646"> </A><TT CLASS="cv">sampleRate</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=940"> </A> The rate at which the sound was recorded. The sample rate is declared as a <TT CLASS="cv">Fixed</TT> data type. In order to accommodate sample rates greater than 32 kHz, the most significant bit is not treated as a sign bit; instead, that bit is interpreted as having the value 32,768. </BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6656"> </A><TT CLASS="cv">sampleSize</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=941"> </A> The sample size for the original sound (that is, bits per sample).</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6666"> </A><TT CLASS="cv">compressionType</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=942"> </A> The compression type for the sound (<TT CLASS="cv">'NONE'</TT>, <TT CLASS="cv">'MAC3'</TT>, <TT CLASS="cv">'MAC6'</TT>, or other third-party types).</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6676"> </A><TT CLASS="cv">numBytes</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=943"> </A>The number of bytes of audio data that are to be stored in the Common Chunk of the AIFF or AIFF-C file.</BLOCKQUOTE><P CLASS="DT.DefinitionTerm"><A NAME="pgfId=6685"> </A><TT CLASS="cv">numFrames</TT></P><BLOCKQUOTE CLASS="DD.DefinitionDef"><A NAME="pgfId=944"> </A>The number of sample frames for the sample sound. If you are using a compression type defined by Apple, you can pass 0 in this field and the appropriate value for this field will be computed automatically.</BLOCKQUOTE><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=945"> </A>DESCRIPTION</H3><P CLASS="T0.Text0"><A NAME="pgfId=946"> </A>The <TT CLASS="cv">SetupAIFFHeader</TT> function creates an AIFF or AIFF-C file header, depending on the parameters passed to it:</P><UL><LI CLASS="B1.Bullet1"><A NAME="pgfId=947"> </A>Uncompressed sounds of any type are stored in AIFF format (that is, the <TT CLASS="cv">compressionType</TT> parameter is <TT CLASS="cv">'NONE'</TT>).</LI><LI CLASS="B1.Bullet1"><A NAME="pgfId=948"> </A>Compressed sounds of any type are stored in AIFF-C format (that is, the <TT CLASS="cv">compressionType</TT> parameter is different from <TT CLASS="cv">'NONE'</TT>).</LI></UL><P CLASS="Note"><A NAME="pgfId=1250"> </A>The <TT CLASS="cv">SetupAIFFHeader</TT> function might format a sound file as an AIFF file even if the File Manager file type of a file is <TT CLASS="cv">'AIFC'</TT>. The Sound Manager will still play such files correctly. </P><P CLASS="T1.Text1"><A NAME="pgfId=949"> </A>The AIFF header information is written starting at the current file position of the file specified by the <TT CLASS="cv">fRefNum</TT> parameter, and the file position is left at the end of the header upon completion. The <TT CLASS="cv">SetupAIFFHeader</TT> function creates a Form Chunk, a Format Version Chunk, a Common Chunk, and a Sound Data chunk, but it does not put any sound data at the end of the Sound Data Chunk.</P><P CLASS="T1.Text1"><A NAME="pgfId=953"> </A>A good way to use this routine is to create a file that you want to store a sound in, then call <TT CLASS="cv">SetupAIFFHeader</TT> with <TT CLASS="cv">numBytes</TT> set to 0 to position the file to be ready to write the audio data. Then record the data to the file, set the file position to the beginning of the file, and call <TT CLASS="cv">SetupAIFFHeader</TT> again with <TT CLASS="cv">numBytes</TT> set to the correct amount of sound data recorded. The file created in this way can be passed to the <TT CLASS="cv">SndStartFilePlay</TT> function to play the sound.</P></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=930"> </A>SPECIAL CONSIDERATIONS</H3><P CLASS="T0.Text0"><A NAME="pgfId=950"> </A>If recording produces an odd number of bytes of sound data, you must add a pad byte to make the total number of bytes even.</P><P CLASS="T1.Text1"><A NAME="pgfId=1162"> </A>Because the <TT CLASS="cv">SetupAIFFHeader</TT> function moves memory, you should not call it at interrupt time.</P></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=1387"> </A>ASSEMBLY-LANGUAGE INFORMATION</H3><P CLASS="T0.Text0"><A NAME="pgfId=1388"> </A>The trap macro and routine selector for the <TT CLASS="cv">SetupAIFFHeader</TT> function are</P><TABLE><TR><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=1390"> </A>Trap macro</P></TH><TH ROWSPAN="1" COLSPAN="1"><P CLASS="TbH.TblHd"><A NAME="pgfId=1598"> </A>Selector</P></TH></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="MLCv.MLCode"><A NAME="pgfId=954"> </A>_SoundDispatch</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1393"> </A>$0B4C0014</P></TD></TR></TABLE></DIV><DIV><H3 CLASS="RSb.RoutineSbhd"><A NAME="pgfId=1389"> </A>RESULT CODES</H3><TABLE><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="MLCv.MLCode"><A NAME="pgfId=932"> </A>noErr</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="MLR.RtAlign"><A NAME="pgfId=934"> </A>0</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1404"> </A>No error</P></TD></TR><TR><TD ROWSPAN="1" COLSPAN="1"><P CLASS="MLCv.MLCode"><A NAME="pgfId=1591"> </A>siInvalidCompression</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="MLR.RtAlign"><A NAME="pgfId=1592"> </A>-223</P></TD><TD ROWSPAN="1" COLSPAN="1"><P CLASS="ML.ColsList"><A NAME="pgfId=1593"> </A>Invalid compression type<A NAME="marker=446"> </A><A NAME="marker=466"> </A></P></TD></TR></TABLE></DIV></DIV><hr>&#169; 1999 Apple Computer, Inc.<!-- QTnavbar start --><P><I>Inside Macintosh: Sound Manager</I><P>| <A target="doc" HREF="imsoundinput.1a.htm">Previous</A> | <A target="doc" HREF="imsoundinput.1.htm">Chapter contents</A> | <A target="doc" HREF="imsoundinput.htm">Chapter top</A> | <A target="doc" HREF="imsoundinput.16.htm">Section top</A> | <A target="doc" HREF="imsoundinput.1c.htm">Next</a> | <!-- QTnavbar end --><!-- legacy work start --><script type="text/javascript"> placeWatermark()</script><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox" style="position: relative;"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b><i>Sound Input Manager</i> is deprecated as of Mac OS X v10.5. For new audio development in Mac OS X, use Core Audio. See the <a href="http://developer.apple.com/referencelibrary/MusicAudio/" target="_top">Audio</a> page in the ADC Reference Library.</p></div></div></div><!-- legacy work end --></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV></DIV><!-- start of footer --><!--#include virtual="/includes/framesetfooter" --><!-- end of footer --></BODY></HTML>