<html><head><title>Mac OS X Server
 Manual Page For clamscan(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/clamscan" title="Mac OS X Server
 Manual Page for clamscan(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/clamscan"; name=clamscan(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with Mac&nbsp;OS&nbsp;X&nbsp;Server.  It is
not available on standard Mac OS X (client) installations.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
clamscan(1)                                    Clam AntiVirus                                    clamscan(1)



<b>NAME</b>
       clamscan - scan files and directories for viruses

<b>SYNOPSIS</b>
       clamscan [options] [file/directory/-]

<b>DESCRIPTION</b>
       clamscan is a command line anti-virus scanner.

<b>OPTIONS</b>
       <b>-h,</b> <b>--help</b>
              Print help information and exit.

       <b>-V,</b> <b>--version</b>
              Print version number and exit.

       <b>-v,</b> <b>--verbose</b>
              Be verbose.

       <b>--debug</b>
              Display debug messages from libclamav.

       <b>--quiet</b>
              Be quiet (only print error messages).

       <b>--stdout</b>
              Write all messages (except for libclamav output) to the standard output (stdout).

       <b>-d</b> <b>FILE/DIR,</b> <b>--database=FILE/DIR</b>
              Load virus database from FILE or load all virus database files from DIR.

       <b>-l</b> <b>FILE,</b> <b>--log=FILE</b>
              Save scan report to FILE.

       <b>--tempdir=DIRECTORY</b>
              Create  temporary  files  in  DIRECTORY.  Directory must be writable for the '_clamav' user or
              unprivileged user running clamscan.

       <b>--leave-temps</b>
              Do not remove temporary files.

       <b>-r,</b> <b>--recursive</b>
              Scan directories recursively. All the subdirectories in the given directory will be scanned.

       <b>--bell</b> Sound bell on virus detection.

       <b>--no-summary</b>
              Do not display summary at the end of scanning.

       <b>--exclude=PATT,</b> <b>--exclude-dir=PATT</b>
              Don't scan file/directory names containing PATT. It may be used multiple times.

       <b>--include=PATT,</b> <b>--include-dir=PATT</b>
              Only scan file/directory names containing PATT. It may be used multiple times.

       <b>-i,</b> <b>--infected</b>
              Only print infected files.

       <b>--remove</b>
              Remove infected files. <b>Be</b> <b>careful.</b>

       <b>--move=DIRECTORY</b>
              Move infected files into DIRECTORY. Directory must be  writable  for  the  '_clamav'  user  or
              unprivileged user running clamscan.

       <b>--copy=DIRECTORY</b>
              Copy  infected  files  into  DIRECTORY.  Directory  must be writable for the '_clamav' user or
              unprivileged user running clamscan.

       <b>--detect-pua</b>
              Detect Possibly Unwanted Applications.

       <b>--no-mail</b>
              Disable scanning of mail files.

       <b>--no-phishing-sigs</b>
              Disable signature-based phishing detection.

       <b>--no-phishing-scan-urls</b>
              Disable url-based heuristic phishing detection. This disables Phishing.Heuristics.Email.*

       <b>--no-phishing-restrictedscan</b>
              Enable url-based heuristic phishing detection for all  domains  (might  lead  to  false  posi-<font color="#ffffff" class="whiteout">tives!).&nbsp;positives!).</font>
              tives!).

       <b>--phishing-ssl</b>
              Always block SSL mismatches in URLs (might lead to false positives!).

       <b>--phishing-cloak</b>
              Always block cloaked URLs (might lead to some false positives).

       <b>--no-algorithmic</b>
              In  some  cases (eg. complex malware, exploits in graphic files, and others), ClamAV uses spe-<font color="#ffffff" class="whiteout">cial&nbsp;special</font>
              cial algorithms to provide accurate detection. This option disables the algorithmic detection.

       <b>--no-pe</b>
              PE stands for Portable Executable - it's an executable file format used in all 32-bit versions
              of Windows operating systems. By default ClamAV performs deeper analysis of  executable  files
              and  attempts  to  decompress  popular  executable  packers such as UPX, Petite, and FSG. This
              option <b>disables</b> PE support and should be used with care!

       <b>--no-elf</b>
              Executable and Linking Format is a standard format for UN*X executables. This option  <b>disables</b>
              ELF support.

       <b>--no-ole2</b>
              Disable support for Microsoft Office documents and .msi files.

       <b>--no-pdf</b>
              Disable scanning within PDF files.

       <b>--no-html</b>
              Disable support for HTML detection and normalisation.

       <b>--no-archive</b>
              Disable archive support built in libclamav.

       <b>--detect-broken</b>
              Mark broken executables as viruses (Broken.Executable).

       <b>--block-encrypted</b>
              Mark encrypted archives as viruses (Encrypted.Zip, Encrypted.RAR).

       <b>--block-max</b>
              Mark  archives  as  viruses  (e.g. RAR.ExceededFileSize, Zip.ExceededFilesLimit) if max-files,
              max-space, or max-recursion is reached.

       <b>--mail-follow-urls</b>
              If an email contains URLs ClamAV can download and scan them. <b>WARNING:</b>  <b>This</b>  <b>option</b>  <b>may</b>  <b>open</b>
              <b>your</b> <b>system</b> <b>to</b> <b>a</b> <b>DoS</b> <b>attack.</b> <b>Never</b> <b>use</b> <b>it</b> <b>on</b> <b>loaded</b> <b>servers.</b>

       <b>--max-files=#n</b>
              Extract first #n files from each archive. This option protects your system against DoS attacks
              (default: 500)

       <b>--max-space=#n</b>
              Extract first #n kilobytes from each archive. You may pass the value in megabytes in format xM
              or  xm, where x is a number. This option protects your system against DoS attacks (default: 10
              MB)

       <b>--max-recursion=#n</b>
              Set archive recursion level limit. This  option  protects  your  system  against  DoS  attacks
              (default: 8).

       <b>--max-ratio=#n</b>
              Set  maximum  archive  compression  ratio  limit. This option protects your system against DoS
              attacks (default: 250).

       <b>--max-mail-recursion=#n</b>
              Recursion level limit for the internal mail scanner.

       <b>--max-dir-recursion=#n</b>
              Maximum depth directories are scanned at (default: 15).

       <b>--unzip[=FULLPATH]</b>
              In most cases you don't need this option - the built-in unarchiver will extract Zip  archives.
              Howvere,  this  option may be used as a backup for internal unpacker - see the full documenta-<font color="#ffffff" class="whiteout">tion&nbsp;documentation</font>
              tion for more information. When enabled without an argument, unzip program will be searched in
              $PATH. If unzip cannot be found in $PATH, you must force it with =pathname. Remember about '='
              between the option and the argument.

       <b>--unrar[=FULLPATH]</b>
              Scan .rar files. In most cases the unpacker built into libclamav is enough.

       <b>--arj[=FULLPATH]</b>
              Scan .arj files.

       <b>--unzoo[=FULLPATH]</b>
              Scan .zoo files.

       <b>--lha[=FULLPATH]</b>
              Scan .lzh files.

       <b>--jar[=FULLPATH]</b>
              clamscan uses unzip for .jar files, so in some cases you may need  to  pass  a  full  path  to
              unzip. In most cases the unpacker built into libclamav is enough.

       <b>--deb[=FULLPATH]</b>
              This  option  supports  debian  binary  packages.  Implies  --tgz,  but  doesn't conflict with
              --tgz=FULLPATH. It requires ar utility.

       <b>--tar[=FULLPATH]</b>
              This option supports non-compressed tar archives. In most cases the unpacker built  into  lib-<font color="#ffffff" class="whiteout">clamav&nbsp;libclamav</font>
              clamav is enough.

       <b>--tgz[=FULLPATH]</b>
              This option supports tar.gz and .tgz files. You need GNU tar, on non-Linux system you probably
              have it installed as gtar. If it's in $PATH, please use --tgz=gtar in other case please pass a
              full path. In most cases the unpacker built into libclamav is enough.

<b>EXAMPLES</b>
       (0) Scan a single file:

              <b>clamscan</b> <b>file</b>

       (1) Scan a current working directory:

              <b>clamscan</b>

       (2) Scan all files (and subdirectories) in /home:

              <b>clamscan</b> <b>-r</b> <b>/home</b>

       (3) Load database from a file and limit disk usage to 50 MB:

              <b>clamscan</b> <b>-d</b> <b>/tmp/newclamdb</b> <b>--max-space=50m</b> <b>-r</b> <b>/tmp</b>

       (4) Scan a data stream:

              <b>cat</b> <b>testfile</b> <b>|</b> <b>clamscan</b> <b></b>-<font color="#ffffff" class="whiteout">(5)&nbsp;clamscan(5)</font>

       (5) Scan a mail spool directory:

              <b>clamscan</b> <b>-r</b> <b>/var/spool/mail</b>

<b>RETURN</b> <b>CODES</b>
       Note: some return codes may only appear in a single file mode (when clamscan is started with a single
       argument). Those are marked with <b>(ofm)</b>.

       0 : No virus found.

       1 : Virus(es) found.

       40: Unknown option passed.

       50: Database initialization error.

       52: Not supported file type.

       53: Can't open directory.

       54: Can't open file. (ofm)

       55: Error reading file. (ofm)

       56: Can't stat input file / directory.

       57: Can't get absolute path name of current working directory.

       58: I/O error, please check your file system.

       59: Can't get information about current user from /etc/passwd.

       60: Can't get information about user '_clamav' from /etc/passwd.

       61: Can't fork.

       62: Can't initialize logger.

       63: Can't create temporary files/directories (check permissions).

       64: Can't write to temporary directory (please specify another one).

       70: Can't allocate memory (calloc).

       71: Can't allocate memory (malloc).

<b>CREDITS</b>
       Please check the full documentation for credits.

<b>AUTHOR</b>
       Tomasz Kojm &lt;tkojm@clamav.net&gt;

<b>SEE</b> <b>ALSO</b>
       <a href="clamdscan.1.html#//apple_ref/doc/man/1/clamdscan">clamdscan(1)</a>, <a href="freshclam.1.html#//apple_ref/doc/man/1/freshclam">freshclam(1)</a>



ClamAV 0.91.2                                 February 12, 2007                                  clamscan(1)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/clamscan.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/clamscan.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/clamscan.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
