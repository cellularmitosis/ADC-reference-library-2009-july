<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"            "http://www.w3.org/TR/REC-html40/loose.dtd"><html><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QTMCC13: Setting Export Quality</title><meta name="keywords" content="Mac OS 8  QuickTime GetGraphicsImporterForFile GraphicsImportExportImageFile image compression setting export quality JPEG"><meta name="Description" content="Technical Q&amp;A QTMCC13: Q&amp;A explains how to change the compressionfactor  when exporting a particular file to JPEG format beyondusing GetGraphicsImporterForFile()  and GraphicsImportExportImageFile(),which by themselves are unable to do so."><meta name="categories" content="QuickTime Components"><meta name="week-posted" content="Dec 6, 1999 - Dec 10, 1999"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF" TEXT="#000000"><a name="//apple_ref/doc/uid/DTS10001956" title="Setting Export Quality"></a> <!-- white background --><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxImportExport-date.html">Import & Export</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QTMCC13</div>
<div id="pageheadsub">Setting Export Quality</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER>            <!-- -->                        <!-- Document Body --><table cellspacing="0" cellpadding="0" border="0" WIDTH="600"><tr><td align="left" scope="row"><hr width=500 align=center><p id=p2>Q: We currently have a file which we would like to export in a different format. We're using <CODE>GetGraphicsImporterForFile()</CODE> and <CODE>GraphicsImportExportImageFile()</CODE> to do this. However, we didn't see how to change the compression factor if we're saving as a JPEG file. Is this possible?</p><p id=p4>A: This is possible with just a little more work than using <CODE>GraphicsImportExportImageFile()</CODE>. The idea is to use the Graphics Exporter Component APIs with a specific call to <CODE>GraphicsExportSetCompressionQuality()</CODE> or <CODE>GraphicsExportSetTargetDataSize()</CODE> to set the compression quality for the export.</p><p id=p4>Here's an overview of the steps to follow:</p><OL TYPE=1 START=1>    <LI>Select your Export Component. In the code below, we get the JPEG Export Component.</LI>    <LI>Specify the source for the export. This can be a Graphics Importer instance, a QuickDraw Picture, GWorld, PixMap, or a segment of compressed data described by an image description record.</LI>    <LI>Tell the Export Component where the input is coming from. The code below uses a Graphics Importer Instance.</LI>    <LI>Tell the Export Component the destination of the exported data. The code below uses a file.</LI>    <LI>Specify your settings. A variety of <CODE>Get</CODE> and <CODE>Set</CODE> functions are available to manipulate various graphics exporter settings. There are two examples in the code below.<BLOCKQUOTE>    a. Explicitly tell the exporter we want low quality.<br>    b. Ask the exporter to fit the file to a given size constraint and ramp the quality accordingly.</BLOCKQUOTE>    </LI><LI>Do the export. The code below will write out the data and create a JPEG file.</LI></OL><P ID="p4">Graphics Exporter Components Documentation can be found in the <a href="../../documentation/quicktime/qtdevdocs/RM/rmExporter.htm" target="_blank">QuickTime 4 API Documentation.</A></P><TABLE BORDER=0 CELLPADDING=1> <TR>        <td bgcolor="#EEEEE0" width=550 align=left>                 <pre>Example:OSErr DoEasyExportToJpeg(){    SFTypeList      myTypeList = {kQTFileTypeMovie, 0, 0, 0};    StandardFileReply     myReply;    GraphicsImportComponent theImportComponent = NULL;    GraphicsExportComponent theExportComponent = NULL;    OSErr       rc = noErr;    StandardGetFilePreview( NULL, 1, myTypeList, &amp;myReply );    if (!myReply.sfGood) goto bail;    // 1. Open the JPEG Exporter Component.    // We'll connect an Import Component to this Export Component    // and very easily export a JPEG file.    rc = OpenADefaultComponent( GraphicsExporterComponentType, kQTFileTypeJPEG,          &amp;theExportComponent );    if (rc) goto bail;    // 2. Find the Graphics Import Component for our file.    rc = GetGraphicsImporterForFile( &amp;myReply.sfFile, &amp;theImportComponent );    if (rc) goto bail;    // 3. Connect the Importer to the Exporter.    rc = GraphicsExportSetInputGraphicsImporter( theExportComponent,         theImportComponent );    if (rc) goto bail;    StandardPutFile( &quot;\pExport File As...&quot;,         &quot;\pMyJpeg.jpg&quot;, &amp;myReply );    if (!myReply.sfGood) goto bail;    // 4. We're going to export this to a file.    rc = GraphicsExportSetOutputFile( theExportComponent,         &amp;myReply.sfFile );    if (rc) goto bail;    // 5a. Set the image compression quality.    rc = GraphicsExportSetCompressionQuality( theExportComponent,         codecLowQuality );    if (rc) goto bail;    // 5b. Alternatively you could use GraphicsExportSetTargetDataSize().    // This API let's you specify the desired data size in bytes; the    // JPEG exporter will    // decrease the quality until it reaches the specified size or    // bottoms out on the    // quality setting.    //rc = GraphicsExportSetTargetDataSize( theExportComponent,         25000 ); // Max size 25k    //if (rc) goto bail;    // 6. Do the export, write the file.    rc = GraphicsExportDoExport( theExportComponent, NULL );bail: if ( theImportComponent != NULL )     CloseComponent( theImportComponent ); if ( theExportComponent != NULL )         CloseComponent( theExportComponent );    return rc;}</pre> </TD> </TR> </TABLE><!-- begin_date --><H4 ALIGN=center>[Dec 06 1999]</H4><!-- end_date --></td></tr></table></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qtmcc/qtmcc13.html%3Fid%3DDTS10001956-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qtmcc/qtmcc13.html%3Fid%3DDTS10001956-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qtmcc/qtmcc13.html%3Fid%3DDTS10001956-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>