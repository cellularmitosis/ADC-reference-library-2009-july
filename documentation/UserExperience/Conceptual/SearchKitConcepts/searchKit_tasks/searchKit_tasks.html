<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Search Kit Programming Guide: Search Kit Tasks</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="Search Kit Tasks"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40001071-CH204" title="Search Kit Tasks"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000437" target="_top">User Experience</a> &gt; <a href="../../../Carbon-date.html#//apple_ref/doc/uid/TP30000440-TP30000437-TP30000494" target="_top">Carbon</a> &gt; <a href="../searchKit_intro/searchKit_intro.html#//apple_ref/doc/uid/TP40002842-TPXREF101">Search Kit Programming Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../searchKit_concepts/searchKit_concepts.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../searchKit_docRevisionHistory/searchKit_docRevHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40001071-CH204-SW1" title="Search Kit Tasks"></a><h1><a name="//apple_ref/doc/uid/TP40001071-CH204-BCIDHIFH" title="Search Kit Tasks"></a>Search Kit Tasks</h1><p>This chapter provides instructions and code samples for common Search Kit tasks including creating and using indexes of various types, performing searches, and displaying results.</p><p>The code samples assume you are using Xcode and they illustrate how to use Search Kit's ANSI-C API within Objective-C methods.</p>
<!-- This template is being used for both PDF and HTML. -->

    
    <h4>In this section:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-BCIBIGAI">Using Indexes and Documents</a>
				
			<br/>
			
        
			
			
				<a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-BCICICFB">Searching</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/TP40001071-CH204-BCIBIGAI" title="Using Indexes and Documents"></a><h2>Using Indexes and Documents</h2><p>To index a document your application first creates an empty index and then adds document content to it. Search Kit indexes have a variety of characteristics you can set at the time of index creation. These characteristics determine such things as which types of searches users can perform.</p><p>Your application can create file-based or memory-based indexes. Use file-based indexes for information you want to retain between invocations of your program. Use memory-based indexes for temporary processes such as searching on a subset of a file-based index. Because memory-based indexes can be opened as read-only as well as read/write, you can use a memory-based index when your application needs an index that is open only for searching.</p><p>When you create an index, either file-based or memory-based, the index is automatically open. The Search Kit functions for opening indexes let your application re-open an index that you've closed, or open a previously-created file-based index.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-SW5" title="Creating a File-Based Index"></a><h3>Creating a File-Based Index</h3><p>To create a persistent, file-based index your application need only supply a file-system location, in the form of a CFURL object, and an appropriate constant specifying the type of index you want. If you’re developing in Cocoa, you can use an NSURL object for the index location and cast it to a CFURLRef object as shown in <span class="content_text">Listing 3-1</span>.</p><p>To create an index in memory, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW3">“Creating an Index in Memory.”</a></span> To specify text analysis properties for an index, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW4">“Specifying Text Analysis Properties.”</a></span></p><a name="//apple_ref/doc/uid/TP40001071-CH204-SW2" title="Listing 3-1Creating a file-based index"></a><p class="codesample"><strong>Listing 3-1&nbsp;&nbsp;</strong>Creating a file-based index</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) newIndexInFile<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [pathTextField stringValue];          // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url = [NSURL fileURLWithPath: path];            // 2<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * name = [nameTextField stringValue];          // 3<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([name length] == 0) name = nil;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    SKIndexType type = kSKIndexInverted;                    // 4<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    skIndex = SKIndexCreateWithURL (                        // 5<span></span></pre></td></tr><tr><td scope="row"><pre>        (CFURLRef) url,<span></span></pre></td></tr><tr><td scope="row"><pre>        (CFStringRef) name,<span></span></pre></td></tr><tr><td scope="row"><pre>        (SKIndexType) type,<span></span></pre></td></tr><tr><td scope="row"><pre>        (CFDictionaryRef) NULL<span></span></pre></td></tr><tr><td scope="row"><pre>    );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here is how this code works:</p><ol class="ol"><li class="li"><p>Gets the file-system path for a new file-based index and converts it to an NSString object.</p></li><li class="li"><p>Converts the NSString object to an NSURL object.</p></li><li class="li"><p>Gets the optional index name, if provided, and saves it in an NSString object. If there's no index name, uses <code>nil</code>.</p></li><li class="li"><p>Defines the index type, in this case specifying an inverted index.</p></li><li class="li"><p>Creates the new, empty, file-based index using the specified URL, name, and type. Returns a Search Kit index object. In this simple example, the code creates an index without specifying a text analysis properties dictionary. See <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW4">“Specifying Text Analysis Properties”</a></span> for more information on using a text analysis properties dictionary.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-SW3" title="Creating an Index in Memory"></a><h3>Creating an Index in Memory</h3><p>To create an index in memory, your application supplies an NSMutableData object (or, equivalently, a CFMutableData object) to hold the index.</p><p>To create an index in a file, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW5">“Creating a File-Based Index.”</a></span> To specify text analysis properties for an index, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW4">“Specifying Text Analysis Properties.”</a></span></p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_64" title="Listing 3-2Creating an index in memory"></a><p class="codesample"><strong>Listing 3-2&nbsp;&nbsp;</strong>Creating an index in memory</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) newIndexInMemory<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * name = [nameTextField stringValue];                    // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([name length] == 0) name = nil;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    SKIndexType type = kSKIndexInverted;                              // 2<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    indexObject = [[NSMutableData dataWithCapacity: 2^16] retain];    // 3<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    skIndex = SKIndexCreateWithMutableData (                          // 4<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFMutableDataRef) indexObject,<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFStringRef) name,<span></span></pre></td></tr><tr><td scope="row"><pre>                 (SKIndexType) type,<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFDictionaryRef) NULL<span></span></pre></td></tr><tr><td scope="row"><pre>             );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here is how this code works:</p><ol class="ol"><li class="li"><p>Gets the optional index name, if provided, and saves it in an NSString object. If there's no index name, uses <code>nil</code>.</p></li><li class="li"><p>Defines the index type, in this case specifying an inverted index.</p></li><li class="li"><p>Creates a mutable data object to hold the new memory-based index, specifying the capacity and retaining it.</p></li><li class="li"><p>Creates the new, empty, memory-based index using the supplied mutable data object, name, and type. Returns a Search Kit index object. In this simple example, the code creates an index without specifying a text analysis properties dictionary. See <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW4">“Specifying Text Analysis Properties”</a></span> for more information on using a text analysis properties dictionary.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_25" title="Opening a File-Based Index For Searching or Updating"></a><h3>Opening a File-Based Index For Searching or Updating</h3><p>To work with an already-existing file-based index (one that existed before your application launched), or to work with one that you have explicitly closed, your application must first open it. Once open, a file-based Search Kit index can be searched or updated.</p><p>Memory-based indexes can be opened in a read-only mode as well as in a read/write mode. See <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW6">“Opening a Memory-Based Index for Searching Only”</a></span> and <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW7">“Opening a Memory-Based Index for Searching or Updating.”</a></span></p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_65" title="Listing 3-3Opening a file-based index for searching or updating"></a><p class="codesample"><strong>Listing 3-3&nbsp;&nbsp;</strong>Opening a file-based index for searching or updating</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) openIndex<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [pathTextField stringValue];     // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url = [NSURL fileURLWithPath:path];        // 2<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * name = [nameTextField stringValue];     // 3<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([name length] == 0) name = nil;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // open the specified index<span></span></pre></td></tr><tr><td scope="row"><pre>    skIndex = SKIndexOpenWithURL (                     // 4<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFURLRef) url,<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFStringRef) name,<span></span></pre></td></tr><tr><td scope="row"><pre>                 true<span></span></pre></td></tr><tr><td scope="row"><pre>              );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Gets the file-system path for the existing file-based index and converts it to an NSString object.</p></li><li class="li"><p>Converts the path NSString object to an NSURL object.</p></li><li class="li"><p>Gets the index name, if provided, for the existing file-based index and saves it as an NSString object. If there's no index name, uses <code>nil</code>.</p></li><li class="li"><p>Opens the file-based index and returns a Search Kit index object.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-SW6" title="Opening a Memory-Based Index for Searching Only"></a><h3>Opening a Memory-Based Index for Searching Only</h3><p>To work with an already-existing memory-based index that your application has explicitly closed, your application must first open it.</p><p>This task describes how to open a memory-based index for searching only. To open a memory-based index for searching or updating, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW7">“Opening a Memory-Based Index for Searching or Updating.”</a></span></p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_66" title="Listing 3-4Opening a memory-based index for searching only"></a><p class="codesample"><strong>Listing 3-4&nbsp;&nbsp;</strong>Opening a memory-based index for searching only</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) openIndexInMemoryReadOnly<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    skIndex = SKIndexOpenWithData (<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFDataRef) indexObject,<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFStringRef) nil<span></span></pre></td></tr><tr><td scope="row"><pre>             );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><p>Your application provides a previously-created mutable data object to the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexOpenWithData" target="_top">SKIndexOpenWithData</a></code> function, which then returns a read-only Search Kit index object. The index name is optional and in this example is specified as <code>nil</code>. To open a memory-based index for searching and updating, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW7">“Opening a Memory-Based Index for Searching or Updating.”</a></span> For information on creating a mutable data object, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW3">“Creating an Index in Memory.”</a></span></p><a name="//apple_ref/doc/uid/TP40001071-CH204-SW7" title="Opening a Memory-Based Index for Searching or Updating"></a><h3>Opening a Memory-Based Index for Searching or Updating</h3><p>To work with an already-existing memory-based index that your application has explicitly closed, your application must first open it.</p><p>This task describes how to open a memory-based index for searching or updating. To open a memory-based index for searching only, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW6">“Opening a Memory-Based Index for Searching Only.”</a></span></p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_67" title="Listing 3-5Opening a memory-based index for searching or updating"></a><p class="codesample"><strong>Listing 3-5&nbsp;&nbsp;</strong>Opening a memory-based index for searching or updating</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) openIndexInMemoryReadWrite<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    skIndex = SKIndexOpenWithMutableData (<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFMutableDataRef) indexObject,<span></span></pre></td></tr><tr><td scope="row"><pre>                 (CFStringRef) nil<span></span></pre></td></tr><tr><td scope="row"><pre>              );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><p>Your application provides a previously-created mutable data object to the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexOpenWithMutableData" target="_top">SKIndexOpenWithMutableData</a></code> function, which then returns a read/write Search Kit index object. The index name is optional and in this example is specified as <code>nil</code>. To open a memory-based index for searching only, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW6">“Opening a Memory-Based Index for Searching Only.”</a></span> For information on creating a mutable data object, see <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW3">“Creating an Index in Memory.”</a></span></p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_26" title="Closing an Index"></a><h3>Closing an Index</h3><p>A Search Kit index, as a Core Foundation object, can be closed by passing the index object to the <code><a href="../../../../CoreFoundation/Reference/CFTypeRef/Reference/reference.html#//apple_ref/doc/c_ref/CFRelease" target="_top">CFRelease</a></code> function. Alternatively, your application can use the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexClose" target="_top">SKIndexClose</a></code> function as shown here.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_68" title="Listing 3-6Closing an index"></a><p class="codesample"><strong>Listing 3-6&nbsp;&nbsp;</strong>Closing an index</p><div class="codesample"><table><tr><td scope="row"><pre>-(void) closeIndex<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    if (skIndex) {<span></span></pre></td></tr><tr><td scope="row"><pre>        SKIndexClose (skIndex);<span></span></pre></td></tr><tr><td scope="row"><pre>        skIndex = nil;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001071-CH204-SW4" title="Specifying Text Analysis Properties"></a><h3>Specifying Text Analysis Properties</h3><p>Your application specifies an index's text analysis properties at the time of index creation. This task illustrates setting some of the available properties including minimum term length, stopwords, and customized term characters while creating a new file-based index.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_69" title="Listing 3-7Specifying text analysis properties"></a><p class="codesample"><strong>Listing 3-7&nbsp;&nbsp;</strong>Specifying text analysis properties</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) newIndexWithPropertiesInFile<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [pathTextField stringValue];                    // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url = [NSURL fileURLWithPath: path];                      // 2<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * name = [nameTextField stringValue];                    // 3<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([name length] == 0) name = nil;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    SKIndexType type = kSKIndexInverted;                              // 4<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSNumber * minTermLength = [NSNumber numberWithInt: (int) 3];     // 5<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSSet * stopwords = [NSSet setWithObjects:                        // 6<span></span></pre></td></tr><tr><td scope="row"><pre>                            @"all",<span></span></pre></td></tr><tr><td scope="row"><pre>                            @"and",<span></span></pre></td></tr><tr><td scope="row"><pre>                            @"its",<span></span></pre></td></tr><tr><td scope="row"><pre>                            @"it's",<span></span></pre></td></tr><tr><td scope="row"><pre>                            @"the",<span></span></pre></td></tr><tr><td scope="row"><pre>                            nil<span></span></pre></td></tr><tr><td scope="row"><pre>                        ];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        NSDictionary * properties =                                   // 7<span></span></pre></td></tr><tr><td scope="row"><pre>        [NSDictionary dictionaryWithObjectsAndKeys:<span></span></pre></td></tr><tr><td scope="row"><pre>            @"", @"kSKStartTermChars",   // additional starting-characters for terms<span></span></pre></td></tr><tr><td scope="row"><pre>            @"-_@.'", @"kSKTermChars",   // additional characters within terms<span></span></pre></td></tr><tr><td scope="row"><pre>            @"", @"kSKEndTermChars",     // additional ending-characters for terms<span></span></pre></td></tr><tr><td scope="row"><pre>            minTermLength, @"kSKMinTermLength",<span></span></pre></td></tr><tr><td scope="row"><pre>            stopwords, @"kSKStopWords",<span></span></pre></td></tr><tr><td scope="row"><pre>            nil<span></span></pre></td></tr><tr><td scope="row"><pre>        ];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    skIndex = SKIndexCreateWithURL(                                   // 8<span></span></pre></td></tr><tr><td scope="row"><pre>        (CFURLRef) url,<span></span></pre></td></tr><tr><td scope="row"><pre>        (CFStringRef) name,<span></span></pre></td></tr><tr><td scope="row"><pre>        (SKIndexType) type,<span></span></pre></td></tr><tr><td scope="row"><pre>        (CFDictionaryRef) properties<span></span></pre></td></tr><tr><td scope="row"><pre>    );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Gets the file-system path for a new file-based index and converts it to an NSString object.</p></li><li class="li"><p>Converts the NSString object to an NSURL object.</p></li><li class="li"><p>Gets the optional index name, if provided, and saves it in an NSString object. If there's no index name, uses <code>nil</code>.</p></li><li class="li"><p>Defines the index type, in this case specifying an inverted index.</p></li><li class="li"><p>Specifies the minimum term length as a NSNumber object.</p></li><li class="li"><p>Specifies a list of stopwords as an NSSet object.</p></li><li class="li"><p>Specifies the text analysis properties dictionary, including minimum term length, stopwords, and additional term character specifications.</p></li><li class="li"><p>Creates the new, empty, file-based index using the specified URL, name, type, and text analysis properties. Returns a Search Kit index object.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_27" title="Loading The Spotlight Text Importers"></a><h3>Loading The Spotlight Text Importers</h3><p>Loading the Spotlight text importers is a single-step process that applications typically perform at launch time.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_70" title="Listing 3-8Loading the Spotlight text importers"></a><p class="codesample"><strong>Listing 3-8&nbsp;&nbsp;</strong>Loading the Spotlight text importers</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) loadImporters<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    SKLoadDefaultExtractorPlugIns ();<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_28" title="Adding a File-Based Document to an Index"></a><h3>Adding a File-Based Document to an Index</h3><p>To add a file-based document to an index your application simply supplies the index object and a document URL object. You can optionally provide a MIME type hint, as described in <em><a href="../../../Reference/SearchKit/index.html#//apple_ref/doc/uid/TP30000904" target="_top">Search Kit Reference</a></em>. Finally, you specify the document as replaceable or not.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_71" title="Listing 3-9Adding a file-based document to an index"></a><p class="codesample"><strong>Listing 3-9&nbsp;&nbsp;</strong>Adding a file-based document to an index</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) addDoc<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [filePathTextField stringValue];    // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url = [NSURL fileURLWithPath: path];          // 2<span></span></pre></td></tr><tr><td scope="row"><pre>    SKDocumentRef doc = SKDocumentCreateWithURL (         // 3<span></span></pre></td></tr><tr><td scope="row"><pre>                            (CFURLRef) url<span></span></pre></td></tr><tr><td scope="row"><pre>                        );<span></span></pre></td></tr><tr><td scope="row"><pre>    [(id) doc autorelease];                               // 4<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean added = SKIndexAddDocument (                  // 5<span></span></pre></td></tr><tr><td scope="row"><pre>        (SKIndexRef) skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>        (SKDocumentRef) doc,<span></span></pre></td></tr><tr><td scope="row"><pre>        (CFStringRef) NULL,       // optional MIME type hint<span></span></pre></td></tr><tr><td scope="row"><pre>        (Boolean) true            // replaceable<span></span></pre></td></tr><tr><td scope="row"><pre>    );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>How this code works:</p><ol class="ol"><li class="li"><p>Gets the file-system path for the document to be added to an index. Converts the path string to an NSString object.</p></li><li class="li"><p>Converts the NSString object to an NSURL object.</p></li><li class="li"><p>Creates a document URL object from the NSURL object.</p></li><li class="li"><p>Specifies that the document URL object should be auto-released.</p></li><li class="li"><p>Adds the document identified by the document URL object, along with its text, to the specified Search Kit index.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_29" title="Adding a Folder of File-Based Documents to an Index"></a><h3>Adding a Folder of File-Based Documents to an Index</h3><p>To index a folder of documents, your application makes use of other Carbon or Cocoa frameworks. This task illustrates how to do this in Cocoa, descending recursively into a folder structure.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_72" title="Listing 3-10Adding a folder of file-based documents to an index"></a><p class="codesample"><strong>Listing 3-10&nbsp;&nbsp;</strong>Adding a folder of file-based documents to an index</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) addDocsInFolder<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [filePathTextField stringValue];    // 1<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSDirectoryEnumerator * dirEnumerator =               // 2<span></span></pre></td></tr><tr><td scope="row"><pre>        [[NSFileManager defaultManager] enumeratorAtPath: path];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * item;<span></span></pre></td></tr><tr><td scope="row"><pre>    while ((item = [dirEnumerator nextObject]) != nil) {  // 3<span></span></pre></td></tr><tr><td scope="row"><pre>        NSString * fullPath =                             // 4<span></span></pre></td></tr><tr><td scope="row"><pre>            [path stringByAppendingPathComponent: item];<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!fullPath) continue;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        NSURL * url =                                     // 5<span></span></pre></td></tr><tr><td scope="row"><pre>            [NSURL fileURLWithPath: fullPath];<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!url) continue;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        SKDocumentRef doc = SKDocumentCreateWithURL (     // 6<span></span></pre></td></tr><tr><td scope="row"><pre>                                (CFURLRef) url<span></span></pre></td></tr><tr><td scope="row"><pre>                            );<span></span></pre></td></tr><tr><td scope="row"><pre>        if (!doc) continue;<span></span></pre></td></tr><tr><td scope="row"><pre>        [(id) doc autorelease];                           // 7<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        Boolean added = SKIndexAddDocument (              // 8<span></span></pre></td></tr><tr><td scope="row"><pre>            (SKIndexRef) skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>            (SKDocumentRef) doc,<span></span></pre></td></tr><tr><td scope="row"><pre>            (CFStringRef) NULL,   // optional MIME type hint<span></span></pre></td></tr><tr><td scope="row"><pre>            (Boolean) true        // replaceable<span></span></pre></td></tr><tr><td scope="row"><pre>        );<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Gets the file-system path for a folder containing file-based documents. Converts the path string to an NSString object.</p></li><li class="li"><p>Creates an NSDirectoryEnumerator object for recursively finding all the file-based documents within the folder.</p></li><li class="li"><p>Steps through the enumerator, getting the path to each file-based document in the folder.</p></li><li class="li"><p>Converts each path to an NSString object.</p></li><li class="li"><p>Converts each NSString object to an NSURL object.</p></li><li class="li"><p>Creates a document URL object from each NSURL object.</p></li><li class="li"><p>Specifies that the document URL object should be auto-released.</p></li><li class="li"><p>Adds the document identified by the document URL object, along with its text, to the specified Search Kit index.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_30" title="Adding Text Explicitly to an Index"></a><h3>Adding Text Explicitly to an Index</h3><p>To add text explicitly to an index, your application gets the text, parses it as necessary, and then hands it off along with an index object to Search Kit. This example illustrates indexing text from a text field in the user interface of an application. You could just as well take text from a database record or from a remote URL, for example.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_73" title="Listing 3-11Adding text explicitly to an index"></a><p class="codesample"><strong>Listing 3-11&nbsp;&nbsp;</strong>Adding text explicitly to an index</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) addDocWithText<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [filePathTextField stringValue];    // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url = [NSURL fileURLWithPath:path];           // 2<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    SKDocumentRef doc = SKDocumentCreateWithURL (         // 3<span></span></pre></td></tr><tr><td scope="row"><pre>                            (CFURLRef) url<span></span></pre></td></tr><tr><td scope="row"><pre>                        );<span></span></pre></td></tr><tr><td scope="row"><pre>    [(id) doc autorelease];                               // 4<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * contents = [fileContentsTextView string];  // 5<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean added = SKIndexAddDocumentWithText (          // 6<span></span></pre></td></tr><tr><td scope="row"><pre>                        skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                        doc,<span></span></pre></td></tr><tr><td scope="row"><pre>                        (CFStringRef) contents,<span></span></pre></td></tr><tr><td scope="row"><pre>                        (Boolean) true     // replaceable<span></span></pre></td></tr><tr><td scope="row"><pre>                    );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Gets the file-system path for the document to be added to an index. Converts the path string to an NSString object.</p></li><li class="li"><p>Converts the NSString object to an NSURL object.</p></li><li class="li"><p>Creates a document URL object from the NSURL object.</p></li><li class="li"><p>Specifies that the document URL object should be auto-released.</p></li><li class="li"><p>Gets textual content from a user-interface text field and converts it to an NSString object.</p></li><li class="li"><p>Adds the document URL object along with the specified text to the specified Search Kit index. The text is associated in the index to the document URL object such that queries that match terms in the text will return the document URL object.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_31" title="Updating an Index When a Document Changes"></a><h3>Updating an Index When a Document Changes</h3><p>To reindex a document that has changed, simply replace it in the index. Do this by calling the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexAddDocumentWithText" target="_top">SKIndexAddDocumentWithText</a></code> or <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexAddDocument" target="_top">SKIndexAddDocument</a></code> function, as appropriate, with the <em>inCanReplace</em> parameter set to a <code>true</code> value. This example assumes that the document involved is a local, file-based document and so uses the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexAddDocument" target="_top">SKIndexAddDocument</a></code> function.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_74" title="Listing 3-12Updating an index when a document changes"></a><p class="codesample"><strong>Listing 3-12&nbsp;&nbsp;</strong>Updating an index when a document changes</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) replaceChangedDoc: (id) sender<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [filePathTextField stringValue];   // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url = [NSURL fileURLWithPath:path];<span></span></pre></td></tr><tr><td scope="row"><pre>    SKDocumentRef doc = SKDocumentCreateWithURL (<span></span></pre></td></tr><tr><td scope="row"><pre>                            (CFURLRef) url<span></span></pre></td></tr><tr><td scope="row"><pre>                        );<span></span></pre></td></tr><tr><td scope="row"><pre>    [(id) doc autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean replaced = SKIndexAddDocument (              // 2<span></span></pre></td></tr><tr><td scope="row"><pre>                        skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                        doc,<span></span></pre></td></tr><tr><td scope="row"><pre>                        NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>                        true<span></span></pre></td></tr><tr><td scope="row"><pre>                    );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><ol class="ol"><li class="li"><p>Gets the file-system path for the replacement document. Converts the path string to an NSString object.]</p></li><li class="li"><p>Replaces the document identified by the document URL object, along with its text, in the specified Search Kit index.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_32" title="Updating an Index When a Document Moves or Moves and Changes"></a><h3>Updating an Index When a Document Moves or Moves and Changes</h3><p>To reindex a document that has moved, or moved and changed, perform these three steps:</p><ol class="ol"><li class="li"><p>Remove the old document with the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexRemoveDocument" target="_top">SKIndexRemoveDocument</a></code> function.</p></li><li class="li"><p>Remove the old text (if desired, or if the index is significantly fragmented) with the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexCompact" target="_top">SKIndexCompact</a></code> function.</p></li><li class="li"><p>Add the changed document and its text to the index.</p></li></ol><p>Compacting the index during this process removes any orphaned terms. However, the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexCompact" target="_top">SKIndexCompact</a></code> function can be expensive in terms of performance. Apple recommends that you do not call it every time a document is modified or deleted, but only when an index is significantly fragmented (bloated with unused text).</p><p>To check for bloat you can take advantage of the way Search Kit allocates document IDs. It does so starting at 1 and without reusing previously allocated IDs for an index. Simply compare the highest document ID, found with the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexGetMaximumDocumentID" target="_top">SKIndexGetMaximumDocumentID</a></code> function, with the current document count, found with the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKIndexGetDocumentCount" target="_top">SKIndexGetDocumentCount</a></code> function.</p><p>The following simple example illustrates compacting without checking for index bloat.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_75" title="Listing 3-13Updating an index when a document moves or moves and changes"></a><p class="codesample"><strong>Listing 3-13&nbsp;&nbsp;</strong>Updating an index when a document moves or moves and changes</p><div class="codesample"><table><tr><td scope="row"><pre>- (void) replaceDoc: (id) sender<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// remove a specified document from an index<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [filePathTextField stringValue];   // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url = [NSURL fileURLWithPath: path];         // 2<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    SKDocumentRef doc = SKDocumentCreateWithURL (        // 3<span></span></pre></td></tr><tr><td scope="row"><pre>                            (CFURLRef) url<span></span></pre></td></tr><tr><td scope="row"><pre>                        );<span></span></pre></td></tr><tr><td scope="row"><pre>    [(id) doc autorelease];                              // 4<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean removed = SKIndexRemoveDocument (            // 5<span></span></pre></td></tr><tr><td scope="row"><pre>                          skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                          doc<span></span></pre></td></tr><tr><td scope="row"><pre>                       );<span></span></pre></td></tr><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// compact the index to remove the terms associated with the removed document<span></span></pre></td></tr><tr><td scope="row"><pre>    SKIndexCompact (skIndex);                            // 6<span></span></pre></td></tr><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// add the document and its terms back to the index<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * path = [filePathTextField stringValue];   // 7<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url = [NSURL fileURLWithPath:path];<span></span></pre></td></tr><tr><td scope="row"><pre>    SKDocumentRef doc = SKDocumentCreateWithURL (<span></span></pre></td></tr><tr><td scope="row"><pre>                            (CFURLRef) url<span></span></pre></td></tr><tr><td scope="row"><pre>                        );<span></span></pre></td></tr><tr><td scope="row"><pre>    [(id) doc autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean added = SKIndexAddDocument (                 // 8<span></span></pre></td></tr><tr><td scope="row"><pre>                        skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                        doc,<span></span></pre></td></tr><tr><td scope="row"><pre>                        NULL,<span></span></pre></td></tr><tr><td scope="row"><pre>                        true<span></span></pre></td></tr><tr><td scope="row"><pre>                    );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Gets the file-system path for the document to be removed from an index. Converts the path string to an NSString object.</p></li><li class="li"><p>Converts the NSString object to an NSURL object.</p></li><li class="li"><p>Creates a document URL object from the NSURL object.</p></li><li class="li"><p>Specifies that the document URL object should be auto-released.</p></li><li class="li"><p>Removes the document URL object from the specified index.</p></li><li class="li"><p>Compacts the index to remove the terms associated with the removed document.</p></li><li class="li"><p>Gets the file-system path for the replacement document. Converts the path string to an NSString object.</p></li><li class="li"><p>Adds the replacement document identified by the document URL object, along with its text, to the specified Search Kit index.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-BCICICFB" title="Searching"></a><h2>Searching</h2><p>This section describes each of the sub-tasks important to query-based searching and then assembles them in the task titled <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW8">“A Complete Search Method.”</a></span> Briefly, the steps are:</p><ul class="ul"><li class="li"><p>Specify the maximum number of hits to return; this is simply defining a constant.</p></li><li class="li"><p>Set up the search options.</p></li><li class="li"><p>Get the user's query.</p></li><li class="li"><p>Create an asynchronous search object.</p></li><li class="li"><p>Request hits from the search object.</p></li><li class="li"><p>Convert the hits into document locations and displays the results.</p></li></ul><p>Your application can use similarity-based searching instead of query-based searching by turning on the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/kSKSearchOptionFindSimilar" target="_top">kSKSearchOptionFindSimilar</a></code> flag when creating a search object. In this case, use the content of an example document, or a portion of an example document, as the query string.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_33" title="Setting Up Search Options"></a><h3>Setting Up Search Options</h3><p>When your application creates a search object it can specify a variety of search options. Each option is simply a binary flag for the <em>inSearchOptions</em> parameter of the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/c/func/SKSearchCreate" target="_top">SKSearchCreate</a></code> function.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_76" title="Listing 3-14Setting up search options"></a><p class="codesample"><strong>Listing 3-14&nbsp;&nbsp;</strong>Setting up search options</p><div class="codesample"><table><tr><td scope="row"><pre>SKSearchOptions options = kSKSearchOptionDefault;        // 1<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>if ([searchOptionNoRelevance intValue])                  // 2<span></span></pre></td></tr><tr><td scope="row"><pre>    options |= kSKSearchOptionNoRelevanceScores;<span></span></pre></td></tr><tr><td scope="row"><pre>if ([searchOptionSpaceIsOR intValue])                    // 3<span></span></pre></td></tr><tr><td scope="row"><pre>    options |= kSKSearchOptionSpaceMeansOR;<span></span></pre></td></tr><tr><td scope="row"><pre>if ([searchOptionSpaceFindSimilar intValue])             // 4<span></span></pre></td></tr><tr><td scope="row"><pre>    options |= kSKSearchOptionFindSimilar;<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Specifies use of the default set of search options.</p></li><li class="li"><p>If the user has specified that searches should not consider relevance, adds that option.</p></li><li class="li"><p>If the user has specified that spaces should indicate a logical <code>OR</code> in a query, adds that option.</p></li><li class="li"><p>If the user has specified similarity searching instead of query-based searching, adds that option.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_34" title="Getting a User&#39;s Query"></a><h3>Getting a User's Query</h3><p>This task illustrates the simple step of creating an NSString object from a user's query.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_77" title="Listing 3-15Getting a user&#39;s query"></a><p class="codesample"><strong>Listing 3-15&nbsp;&nbsp;</strong>Getting a user's query</p><div class="codesample"><table><tr><td scope="row"><pre>NSString * query = [searchField stringValue];<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_35" title="Creating an Asynchronous Search Object"></a><h3>Creating an Asynchronous Search Object</h3><p>Your application creates a search object by supplying an index object, an NSString object representing the user's query, and a set of option flags that determine the searching behavior.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_78" title="Listing 3-16Creating an asynchronous search object"></a><p class="codesample"><strong>Listing 3-16&nbsp;&nbsp;</strong>Creating an asynchronous search object</p><div class="codesample"><table><tr><td scope="row"><pre>SKSearchRef search = SKSearchCreate (            // 1<span></span></pre></td></tr><tr><td scope="row"><pre>                         skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                         (CFStringRef) query,<span></span></pre></td></tr><tr><td scope="row"><pre>                         options<span></span></pre></td></tr><tr><td scope="row"><pre>                     );<span></span></pre></td></tr><tr><td scope="row"><pre>[(id) search autorelease];                       // 2<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Creates a search object based on the user's query and the specified search options, targeting the specified Search Kit index.</p></li><li class="li"><p>Specifies that the search object should be auto-released.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-SW10" title="Getting Matches From a Search Object"></a><h3>Getting Matches From a Search Object</h3><p>To retrieve matches from an asynchronous search object, your application sets up arrays to hold the results and then requests the results. You can use a loop to keep requesting additional hits while there are more to be had, as illustrated in this task and in <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW8">“A Complete Search Method.”</a></span></p><p>The result of a hit is a lightweight document identifier. The next task, <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW9">“Getting Document Locations and Displaying Results,”</a></span> illustrates converting the document identifiers to document locations as represented by document URL objects. </p><a name="//apple_ref/doc/uid/TP40001071-CH204-SW11" title="Listing 3-17Getting matches from a search object"></a><p class="codesample"><strong>Listing 3-17&nbsp;&nbsp;</strong>Getting matches from a search object</p><div class="codesample"><table><tr><td scope="row"><pre>while (more) {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    SKDocumentID    foundDocIDs [kSearchMax];          // 1<span></span></pre></td></tr><tr><td scope="row"><pre>    float           foundScores [kSearchMax];          // 2<span></span></pre></td></tr><tr><td scope="row"><pre>    float * scores;                                    // 3<span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean unranked =                                 // 4<span></span></pre></td></tr><tr><td scope="row"><pre>        options &amp; kSKSearchOptionNoRelevanceScores;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if (unranked) {                                    // 5<span></span></pre></td></tr><tr><td scope="row"><pre>        scores = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>    } else {<span></span></pre></td></tr><tr><td scope="row"><pre>        scores = foundScores;<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    CFIndex foundCount = 0;                            // 6<span></span></pre></td></tr><tr><td scope="row"><pre>    more = SKSearchFindMatches (                       // 7<span></span></pre></td></tr><tr><td scope="row"><pre>              search,<span></span></pre></td></tr><tr><td scope="row"><pre>              kSearchMax,<span></span></pre></td></tr><tr><td scope="row"><pre>              foundDocIDs,<span></span></pre></td></tr><tr><td scope="row"><pre>              scores,<span></span></pre></td></tr><tr><td scope="row"><pre>              1,    // maximum time before function returns, in seconds<span></span></pre></td></tr><tr><td scope="row"><pre>              &amp;foundCount<span></span></pre></td></tr><tr><td scope="row"><pre>          );<span></span></pre></td></tr><tr><td scope="row"><pre>    // display or accumulate results here<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    totalCount += foundCount;                          // 8<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Sets up an array to hold document identifiers resulting from hits during the search.</p></li><li class="li"><p>Sets up an array to hold relevance scores.</p></li><li class="li"><p>Sets up a pointer to the relevance scores array.</p></li><li class="li"><p>Creates a Boolean flag specifying whether or not relevance scores should be reported.</p></li><li class="li"><p>Uses the relevance flag to define the <em>outScoresArray</em> parameter for the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKSearchFindMatches" target="_top">SKSearchFindMatches</a></code> function.</p></li><li class="li"><p>Initializes the found count to 0.</p></li><li class="li"><p>Queries the search object. The <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/doc/c_ref/SKSearchFindMatches" target="_top">SKSearchFindMatches</a></code> function places hits in the <em>foundDocIDs</em> array, relevance scores in the <em>scores</em> array, and a Boolean value indicating whether there are more results to be had (<code>TRUE</code>) or not (<code>FALSE</code>).</p></li><li class="li"><p>Accumulates the number of new matches into the total number of matches.</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-SW9" title="Getting Document Locations and Displaying Results"></a><h3>Getting Document Locations and Displaying Results</h3><p>To obtain results that are meaningful to a user, you convert each of the document identifiers, provided by the search object as hits, to a document location in the form of a document URL object. This task illustrates a simple logging of results—including document ID, document URL, and relevance score if applicable—to a text field. </p><p>In this code excerpt, and in the complete example shown in <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW8">“A Complete Search Method,”</a></span> the code simply displays results as they're found. Using other Carbon or Cocoa frameworks, you may want to, instead, accumulate results and present them in a single list sorted by relevance and perhaps dynamically updated.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_79" title="Listing 3-18Getting document locations and displaying results"></a><p class="codesample"><strong>Listing 3-18&nbsp;&nbsp;</strong>Getting document locations and displaying results</p><div class="codesample"><table><tr><td scope="row"><pre>SKDocumentRef   foundDocRefs [kSearchMax];         // 1<span></span></pre></td></tr><tr><td scope="row"><pre>SKIndexCopyDocumentRefsForDocumentIDs (            // 2<span></span></pre></td></tr><tr><td scope="row"><pre>    skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>    (CFIndex) foundCount,<span></span></pre></td></tr><tr><td scope="row"><pre>    foundDocIDs,<span></span></pre></td></tr><tr><td scope="row"><pre>    foundDocRefs<span></span></pre></td></tr><tr><td scope="row"><pre>);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>CFIndex pos;<span></span></pre></td></tr><tr><td scope="row"><pre>for (pos = 0; pos &lt; foundCount; pos++) {           // 3<span></span></pre></td></tr><tr><td scope="row"><pre>    SKDocumentRef doc =                            // 4<span></span></pre></td></tr><tr><td scope="row"><pre>        (SKDocumentRef) [(id) foundDocRefs [pos] autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>    NSURL * url =                                  // 5<span></span></pre></td></tr><tr><td scope="row"><pre>        [(id) SKDocumentCopyURL (doc) autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * urlStr = [url absoluteString];      // 6<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * desc;<span></span></pre></td></tr><tr><td scope="row"><pre>    if (unranked) {                                // 7<span></span></pre></td></tr><tr><td scope="row"><pre>        desc = [NSString stringWithFormat:<span></span></pre></td></tr><tr><td scope="row"><pre>            @"---\nDocID: %d,<span></span></pre></td></tr><tr><td scope="row"><pre>            URL: %@",<span></span></pre></td></tr><tr><td scope="row"><pre>            (int) foundDocIDs [pos],<span></span></pre></td></tr><tr><td scope="row"><pre>            urlStr];<span></span></pre></td></tr><tr><td scope="row"><pre>    } else {<span></span></pre></td></tr><tr><td scope="row"><pre>        desc = [NSString stringWithFormat:<span></span></pre></td></tr><tr><td scope="row"><pre>            @"---\nDocID: %d,<span></span></pre></td></tr><tr><td scope="row"><pre>            Score: %f,<span></span></pre></td></tr><tr><td scope="row"><pre>            URL: %@",<span></span></pre></td></tr><tr><td scope="row"><pre>            (int) foundDocIDs[ pos],<span></span></pre></td></tr><tr><td scope="row"><pre>            foundScores [pos],<span></span></pre></td></tr><tr><td scope="row"><pre>            urlStr];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>    [self log: desc];                             // 8<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Sets up an array to hold document URL objects derived from the document identifiers collected in <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW10">“Getting Matches From a Search Object.”</a></span></p></li><li class="li"><p>Converts the document identifiers to document URL objects. The found count and the document identifiers are from <span class="content_text"><a href="searchKit_tasks.html#//apple_ref/doc/uid/TP40001071-CH204-SW10">“Getting Matches From a Search Object.”</a></span></p></li><li class="li"><p>Iterates through the <code>foundDocRefs</code> array to convert document URL objects to NSString objects for display.</p></li><li class="li"><p>Gets the next document URL object.</p></li><li class="li"><p>For the current document URL object, gets the URL.</p></li><li class="li"><p>Converts the URL to an NSString object.</p></li><li class="li"><p>Formats the result information for the current hit. The information to be displayed depends on whether the search was ranked or unranked.</p></li><li class="li"><p>Displays the results using the applications <code>log:</code> method (not illustrated here).</p></li></ol><a name="//apple_ref/doc/uid/TP40001071-CH204-SW8" title="A Complete Search Method"></a><h3>A Complete Search Method</h3><p>This task collects the preceding code excerpts in this section and presents a complete search method. As described in the introduction to this section, your application:</p><ul class="spaceabove"><li class="li"><p>Specifies the maximum number of hits to return.</p></li><li class="li"><p>Sets up the search options.</p></li><li class="li"><p>Gets the user's query.</p></li><li class="li"><p>Creates an asynchronous search object.</p></li><li class="li"><p>Requests hits from the search object.</p></li><li class="li"><p>Converts the hits into document locations and displays the results.</p></li></ul><p>For descriptions of how this code works, refer to the preceding subtasks in this section.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_80" title="Listing 3-19A complete search method"></a><p class="codesample"><strong>Listing 3-19&nbsp;&nbsp;</strong>A complete search method</p><div class="codesample"><table><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// specify the maximum number of hits<span></span></pre></td></tr><tr><td scope="row"><pre>#define kSearchMax 1000<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>- (void) search<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// set up search options<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    SKSearchOptions options = kSKSearchOptionDefault;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    if ([searchOptionNoRelevance intValue]) options |= kSKSearchOptionNoRelevanceScores;<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([searchOptionSpaceIsOR intValue]) options |= kSKSearchOptionSpaceMeansOR;<span></span></pre></td></tr><tr><td scope="row"><pre>    if ([searchOptionSpaceFindSimilar intValue]) options |= kSKSearchOptionFindSimilar;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// get the user's query<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * query = [searchField stringValue];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// create an asynchronous search object<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    SKSearchRef search = SKSearchCreate (<span></span></pre></td></tr><tr><td scope="row"><pre>                             skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>                             (CFStringRef) query,<span></span></pre></td></tr><tr><td scope="row"><pre>                             options<span></span></pre></td></tr><tr><td scope="row"><pre>                         );<span></span></pre></td></tr><tr><td scope="row"><pre>    [(id) search autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// get matches from a search object<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    Boolean more = true;<span></span></pre></td></tr><tr><td scope="row"><pre>    UInt32 totalCount = 0;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    while (more) {<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        SKDocumentID    foundDocIDs [kSearchMax];<span></span></pre></td></tr><tr><td scope="row"><pre>        float            foundScores [kSearchMax];<span></span></pre></td></tr><tr><td scope="row"><pre>        SKDocumentRef    foundDocRefs [kSearchMax];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        float * scores;<span></span></pre></td></tr><tr><td scope="row"><pre>        Boolean unranked = options &amp; kSKSearchOptionNoRelevanceScores;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        if (unranked) {<span></span></pre></td></tr><tr><td scope="row"><pre>            scores = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre>        } else {<span></span></pre></td></tr><tr><td scope="row"><pre>            scores = foundScores;<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        CFIndex foundCount = 0;<span></span></pre></td></tr><tr><td scope="row"><pre>        CFIndex pos;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        more =    SKSearchFindMatches (<span></span></pre></td></tr><tr><td scope="row"><pre>                    search,<span></span></pre></td></tr><tr><td scope="row"><pre>                    kSearchMax,<span></span></pre></td></tr><tr><td scope="row"><pre>                    foundDocIDs,<span></span></pre></td></tr><tr><td scope="row"><pre>                    scores,<span></span></pre></td></tr><tr><td scope="row"><pre>                    1, // maximum time before func returns, in seconds<span></span></pre></td></tr><tr><td scope="row"><pre>                    &amp;foundCount<span></span></pre></td></tr><tr><td scope="row"><pre>                );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        totalCount += foundCount;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>//..........................................................................<span></span></pre></td></tr><tr><td scope="row"><pre>// get document locations for matches and display results.<span></span></pre></td></tr><tr><td scope="row"><pre>//     alternatively, you can collect results over iterations of this loop<span></span></pre></td></tr><tr><td scope="row"><pre>//     for display later.<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        SKIndexCopyDocumentRefsForDocumentIDs (<span></span></pre></td></tr><tr><td scope="row"><pre>            (SKIndexRef) skIndex,<span></span></pre></td></tr><tr><td scope="row"><pre>            (CFIndex) foundCount,<span></span></pre></td></tr><tr><td scope="row"><pre>            (SKDocumentID *) foundDocIDs,<span></span></pre></td></tr><tr><td scope="row"><pre>            (SKDocumentRef *) foundDocRefs<span></span></pre></td></tr><tr><td scope="row"><pre>        );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>        for (pos = 0; pos &lt; foundCount; pos++) {<span></span></pre></td></tr><tr><td scope="row"><pre>            SKDocumentRef doc = (SKDocumentRef) [(id) foundDocRefs [pos] autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>            NSURL * url = [(id) SKDocumentCopyURL (doc) autorelease];<span></span></pre></td></tr><tr><td scope="row"><pre>            NSString * urlStr = [url absoluteString];<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            NSString * desc;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            if (unranked) {<span></span></pre></td></tr><tr><td scope="row"><pre>                desc = [NSString stringWithFormat: @"---\nDocID: %d, URL: %@", (int) foundDocIDs [pos], urlStr];<span></span></pre></td></tr><tr><td scope="row"><pre>            } else {<span></span></pre></td></tr><tr><td scope="row"><pre>                desc = [NSString stringWithFormat: @"---\nDocID: %d, Score: %f, URL: %@", (int) foundDocIDs[ pos], foundScores [pos], urlStr];<span></span></pre></td></tr><tr><td scope="row"><pre>            }<span></span></pre></td></tr><tr><td scope="row"><pre>            [self log: desc];<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    NSString * desc = [NSString stringWithFormat: @"\"%@\" - %d matches", query, (int) totalCount];<span></span></pre></td></tr><tr><td scope="row"><pre>    [self log: desc];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>For descriptions of how this code works, refer to the preceding subtasks in this section.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-SW12" title="Using Timeout to Search an Index Group in Parallel"></a><h3>Using Timeout to Search an Index Group in Parallel</h3><p>To search an index group in parallel you can use a separate thread for querying each search object. Alternatively, as illustrated here, you can repeatedly rotate through a set of search objects, querying one and then moving on to the next, by using the timeout option in the <code><a href="../../../Reference/SearchKit/Reference/reference.html#//apple_ref/c/func/SKSearchFindMatches" target="_top">SKSearchFindMatches</a></code> function.</p><a name="//apple_ref/doc/uid/TP40001071-CH204-DontLinkElementID_81" title="Listing 3-20Using timeout to search an index group in parallel"></a><p class="codesample"><strong>Listing 3-20&nbsp;&nbsp;</strong>Using timeout to search an index group in parallel</p><div class="codesample"><table><tr><td scope="row"><pre>completeCount = indexCount;                   // 1<span></span></pre></td></tr><tr><td scope="row"><pre>while (completeCount) {                       // 2<span></span></pre></td></tr><tr><td scope="row"><pre>    for (i = 0; i &lt; indexCount; i++) {<span></span></pre></td></tr><tr><td scope="row"><pre>        if (more [i]) {<span></span></pre></td></tr><tr><td scope="row"><pre>            more [i] = SKSearchFindMatches (  // 3<span></span></pre></td></tr><tr><td scope="row"><pre>                           searchObjects [i],<span></span></pre></td></tr><tr><td scope="row"><pre>                           kSearchMax,<span></span></pre></td></tr><tr><td scope="row"><pre>                           foundDocIDs,<span></span></pre></td></tr><tr><td scope="row"><pre>                           scores,<span></span></pre></td></tr><tr><td scope="row"><pre>                           timeout,<span></span></pre></td></tr><tr><td scope="row"><pre>                           &amp;foundCount<span></span></pre></td></tr><tr><td scope="row"><pre>                       );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>            if (!more [i]) completeCount--;   // 4<span></span></pre></td></tr><tr><td scope="row"><pre>            ProcessHits (                     // 5<span></span></pre></td></tr><tr><td scope="row"><pre>                searchObjects [i],<span></span></pre></td></tr><tr><td scope="row"><pre>                foundDocIDs,<span></span></pre></td></tr><tr><td scope="row"><pre>                scores,<span></span></pre></td></tr><tr><td scope="row"><pre>                foundCount<span></span></pre></td></tr><tr><td scope="row"><pre>            );<span></span></pre></td></tr><tr><td scope="row"><pre>        }<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>Here's how this code works:</p><ol class="ol"><li class="li"><p>Initializes the <code>completeCount</code> variable to the number of indexes in the group. An application using this code would have previously defined one search object per index in the group. It also would have initialized the <code>more</code> array with <code>true</code> values for each element. The <code>completeCount</code> variable holds the diminishing number of search objects that still have results available.</p></li><li class="li"><p>Iterates through the list of search objects, getting hits from each in turn. After the period specified by the <em>timeout</em> parameter, moves on to the next search object. As long as hits from at least one search object are not exhausted, repeats the iteration.</p></li><li class="li"><p>Gets the next set of search hits for the current search object, accumulating the results in <code>foundDocIDs</code>, <code>scores</code>, and <code>foundCount</code>.</p></li><li class="li"><p>If no new search hits were found for the current search object, decrements the number of active search objects.</p></li><li class="li"><p>Calls the application-defined <code>ProcessHits</code> function to work with the new search hits.</p></li></ol>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../searchKit_concepts/searchKit_concepts.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../searchKit_docRevisionHistory/searchKit_docRevHistory.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2004, 2005 Apple Computer, Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2005-12-06<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/UserExperience/Conceptual/SearchKitConcepts/searchKit_tasks/searchKit_tasks.html%3Fid%3DTP40001071-2.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/UserExperience/Conceptual/SearchKitConcepts/searchKit_tasks/searchKit_tasks.html%3Fid%3DTP40001071-2.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/UserExperience/Conceptual/SearchKitConcepts/searchKit_tasks/searchKit_tasks.html%3Fid%3DTP40001071-2.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>