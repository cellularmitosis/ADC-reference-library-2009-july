<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Data Structures Within Apple Events(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING98></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-97.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-99.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-94.html"><B>Chapter 3 - Introduction to Apple Events</B></A> / <A HREF="IAC-95.html"><B>About Apple Events</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING98-0></A>
<H2><A NAME=MARKER-9-157></A><A NAME=MARKER-21-158></A>Data Structures Within Apple Events</H2>
 <A NAME=MARKER-2-110></A>The Apple Event Manager constructs its own internal data structures to contain the information in an Apple event. Neither the sender nor the receiver of an Apple event should manipulate data directly after it has been added to an Apple event; each should rely on Apple Event Manager functions to do so. <P>
 This section describes the most important data structures used by the Apple event Manager to construct Apple events. The first structure described is the descriptor record, a data structure of type <CODE>AEDesc</CODE>. Applications may access the data in an individual descriptor record directly if it is not part of another Apple Event Manager data structure. <P>
 In some cases it is convenient for the Apple Event Manager to describe descriptor records by data types that indicate their contents; thus, it also defines data structures such as type <CODE>AEAddressDesc</CODE>, <CODE>AEDescList</CODE>, and <CODE>AERecord</CODE>, which are descriptor records used to hold addresses, lists of other descriptor records, and Apple event parameters, respectively. These and most of the other data structures described in this section are formally defined as data structures of type <CODE>AEDesc</CODE>; they differ only in the purposes for which they are used.<A NAME=MARKER-9-231></A><P>
<A NAME=HEADING98-4></A>
<H3>Descriptor Records</H3>
 Descriptor records are the building blocks used by the Apple Event Manager to construct Apple event attributes and parameters. A <B>descriptor record</B> is a data structure of type <CODE>AEDesc</CODE>; it consists of a handle to data and a descriptor type that identifies the type of the data to which the handle refers.<A NAME=MARKER-2-40></A><A NAME=MARKER-2-111></A><P>
<PRE>
TYPE AEDesc = 
RECORD                           {descriptor record}
   descriptorType:   DescType;   {type of data}
   dataHandle:       Handle;     {handle to data}
END;
</PRE>
 If a descriptor record exists separately from other Apple Event Manager data structures, it is possible to retrieve the data associated with its handle by dereferencing the handle twice. After a descriptor record has been added to any other Apple Event Manager data structure, you must use Apple Event Manager routines to extract data from the descriptor record.<P>
 <A NAME=MARKER-2-128></A><A NAME=MARKER-2-134></A>The <B>descriptor type</B> is a structure of type <CODE>DescType</CODE>, which in turn is of data type <CODE>ResType</CODE>--that is, a four-character code. Constants are usually used in place of these four-character codes when referring to descriptor types. Descriptor types represent various data types. Here are some of the major descriptor type constants, their values, and the kinds of data they identify.
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Descriptor type<TH>Value<TH>Description of data<TR>
<TD>typeBoolean<TD>'bool'<TD>1-byte Boolean value<TR>
<TD>typeChar<TD>'TEXT'<TD>Unterminated string<TR>
<TD>typeLongInteger<TD>'long'<TD>32-bit integer<TR>
<TD>typeShortInteger<TD>'shor'<TD>16-bit integer<TR>
<TD>typeMagnitude<TD>'magn'<TD>Unsigned 32-bit integer<TR>
<TD>typeAEList<TD>'list'<TD>List of descriptor records<TR>
<TD>typeAERecord<TD>'reco'<TD>List of keyword-specified descriptor records<TR>
<TD>typeAppleEvent<TD>'aevt'<TD>Apple event record<TR>
<TD>typeEnumerated<TD>'enum'<TD>Enumerated data<TR>
<TD>typeType<TD>'type'<TD>Four-character code <TR>
<TD>typeFSS<TD>'fss '<TD>File system specification<TR>
<TD>typeKeyword<TD>'keyw'<TD>Apple event keyword<TR>
<TD>typeNull<TD>'null'<TD>Nonexistent data (handle whose value is <CODE>NIL</CODE>)</TABLE>
<P>
 For a complete list of the basic descriptor types used by the Apple Event Manager, see <A HREF=IAC-132.html#MARKER-9-42>Table 4-2 on page 4-57</A>.<P>
 <A HREF=#MARKER-9-165>Figure 3-5</A> illustrates the logical arrangement of a descriptor record with a descriptor type of <CODE>typeChar</CODE>, which specifies that the data handle refers to an unterminated string (in this case, the text "Summary of Sales").<P>
<B>Figure 3-5  <A NAME=MARKER-9-165></A>A descriptor record whose data handle refers to an unterminated string</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-25.jpg"><P>
 <A HREF=#MARKER-9-167>Figure 3-6</A> illustrates the logical arrangement of a descriptor record with a descriptor type of <CODE>typeType</CODE>, which specifies that the data handle refers to a four-character code (in this case the constant <CODE>kCoreEventClass</CODE>, whose value is <CODE>'aevt'</CODE>). This descriptor record can be used in an Apple event attribute that identifies the event class for any Apple event in the Core suite. <A NAME=MARKER-9-289></A><P>
<B>Figure 3-6  <A NAME=MARKER-9-167></A><A NAME=MARKER-21-168></A>A descriptor record whose data handle refers to event class data</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-05.jpg"><P>
 Every Apple event includes an attribute specifying the address of the target application. A descriptor record that contains an application's address is called an <B>address</B> <B>descriptor</B> <B>record.<A NAME=MARKER-2-425></A><A NAME=MARKER-2-221></A></B><P>
<PRE>
TYPE  AEAddressDesc = AEDesc;       {address descriptor record}
</PRE>
 The address in an address descriptor record can be specified as one of these four basic types (or as any other descriptor type you define that can be coerced to one of these types):
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Descriptor type<TH>Value<TH>Description<TR>
<TD>typeApplSignature<TD>'sign'<TD>Application signature<A NAME=MARKER-2-163></A><A NAME=MARKER-9-120></A><A NAME=MARKER-2-30></A><TR>
<TD>typeSessionID<TD>'ssid'<TD>Session reference number<A NAME=MARKER-9-192></A><A NAME=MARKER-2-275></A><A NAME=MARKER-9-48></A><TR>
<TD>typeTargetID<TD>'targ'<TD>Target ID record<A NAME=MARKER-2-34></A><A NAME=MARKER-2-560></A><A NAME=MARKER-2-506></A><TR>
<TD>typeProcessSerialNumber<TD>'psn '<TD>Process serial number<A NAME=MARKER-9-522></A><A NAME=MARKER-2-38></A><A NAME=MARKER-9-44></A></TABLE>
<P>
 Like several of the other data structures defined by the Apple Event Manager for use in Apple event attributes and Apple event parameters, an address descriptor record is identical to a descriptor record of data type <CODE>AEDesc</CODE>; the only difference is that the data for an address descriptor record must always consist of an application's address. <A NAME=MARKER-21-145></A> <A NAME=MARKER-2-146></A> <A NAME=MARKER-2-160></A><P>
<A NAME=HEADING98-20></A>
<H3><A NAME=MARKER-9-174></A>Keyword-Specified Descriptor Records</H3>
 <A NAME=MARKER-2-175></A>After the Apple Event Manager has assembled the necessary descriptor records as the attributes and parameters of an Apple event, your application cannot examine the contents of the Apple event directly. Instead, your application must use Apple Event Manager routines to request each attribute and parameter by keyword. <B>Keywords</B> are arbitrary names used by the Apple Event Manager to keep track of various descriptor records. The <CODE>AEKeyword</CODE> data type is defined as a four-character code.<A NAME=MARKER-2-220></A><A NAME=MARKER-2-212></A><P>
<PRE>
TYPE  AEKeyword = PACKED ARRAY[1..4] OF Char; {keyword for a }
                                              { descriptor record}
</PRE>
 Constants are typically used for keywords. Here is a list of the keyword constants for Apple event attributes:<CODE>
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Attribute keyword<TH>Value<TH>Description<TR>
<TD>keyAddressAttr <TD>'addr'<TD>Address of target or client application <A NAME=MARKER-2-298></A><A NAME=MARKER-2-467></A><A NAME=MARKER-9-53></A> <A NAME=MARKER-21-186></A><TR>
<TD>keyEventClassAttr <TD>'evcl'<TD>Event class of Apple event<A NAME=MARKER-9-291></A><A NAME=MARKER-2-167></A><A NAME=MARKER-2-190></A> <A NAME=MARKER-9-37></A><TR>
<TD>keyEventIDAttr<TD>'evid'<TD>Event ID of Apple event<A NAME=MARKER-2-38></A><A NAME=MARKER-2-56></A><A NAME=MARKER-2-50></A> <A NAME=MARKER-2-65></A><TR>
<TD>keyEventSourceAttr<TD>'esrc'<TD>Nature of the source application<A NAME=MARKER-2-315></A><A NAME=MARKER-2-368></A><A NAME=MARKER-9-24></A><A NAME=MARKER-21-320></A><TR>
<TD>keyInteractLevelAttr<TD>'inte'<TD>Settings for allowing the Apple Event Manager to bring a server application to the foreground, if necessary, to interact with the user<A NAME=MARKER-2-322></A><A NAME=MARKER-2-436></A><A NAME=MARKER-2-164></A> <A NAME=MARKER-2-449></A><TR>
<TD>keyMissedKeywordAttr<TD>'miss'<TD>Keyword for first required parameter remaining in an Apple event<A NAME=MARKER-2-450></A><A NAME=MARKER-9-234></A><A NAME=MARKER-9-3></A><A NAME=MARKER-9-160></A> <A NAME=MARKER-2-64></A><TR>
<TD>keyOptionalKeywordAttr<TD>'optk'<TD>List of keywords for parameters of the Apple event that should be treated as optional by the target application<A NAME=MARKER-2-65></A><A NAME=MARKER-9-225></A><A NAME=MARKER-2-270></A><A NAME=MARKER-2-271></A><TR>
<TD>keyOriginalAddressAttr<TD>'from'<TD>Address of original source of Apple event if the event has been forwarded (available only in version 1.01 or later versions of the Apple Event Manager) <A NAME=MARKER-9-432></A><A NAME=MARKER-9-455></A><A NAME=MARKER-2-71></A> <A NAME=MARKER-2-72></A><TR>
<TD>keyReturnIDAttr <TD>'rtid'<TD>Return ID for reply Apple event <A NAME=MARKER-2-73></A><A NAME=MARKER-2-30></A><A NAME=MARKER-2-75></A><TR>
<TD>keyTimeoutAttr<TD>'timo'<TD>Length of time, in ticks, that the client will wait for a reply or a result from the server<A NAME=MARKER-2-76></A><A NAME=MARKER-2-77></A><A NAME=MARKER-2-78></A> <A NAME=MARKER-2-79></A><TR>
<TD>keyTransactionIDAttr<TD>'tran'<TD>Transaction ID identifying a series of Apple events<A NAME=MARKER-21-243></A><A NAME=MARKER-2-81></A><A NAME=MARKER-2-82></A> <A NAME=MARKER-2-83></A></TABLE>
 <A NAME=MARKER-21-35></A></CODE><P>
 Here is a list of the keyword constants for commonly used Apple event parameters:
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Parameter keyword<TH>Value<TH>Description<TR>
<TD>keyDirectObject<TD>'----'<TD>Direct parameter<A NAME=MARKER-21-93></A><A NAME=MARKER-2-94></A><A NAME=MARKER-6-174></A><A NAME=MARKER-2-95></A> <A NAME=MARKER-2-158></A><TR>
<TD>keyErrorNumber<TD>'errn'<TD>Error number parameter<A NAME=MARKER-2-119></A><A NAME=MARKER-2-120></A><A NAME=MARKER-2-100></A><TR>
<TD>keyErrorString<TD>'errs'<TD>Error string parameter<A NAME=MARKER-21-115></A><A NAME=MARKER-2-93></A><A NAME=MARKER-2-327></A></TABLE>
<P>
 The <I>Apple Event Registry: Standard Suites</I> defines additional keyword constants for Apple event parameters that can be used with specific Apple events. <A NAME=MARKER-2-143></A><P>
 The Apple Event Manager associates keywords with specific descriptor records by means of a <B>keyword-specified descriptor record,</B> a data structure of type <CODE>AEKeyDesc</CODE> that consists of a keyword and a descriptor record. <A NAME=MARKER-2-243></A><P>
<PRE>
TYPE  AEKeyDesc = {keyword-specified descriptor record}
RECORD
   descKey:       AEKeyword;     {keyword}
   descContent:   AEDesc;        {descriptor record}
END;
</PRE>
 <A HREF=#MARKER-9-181>Figure 3-7</A> illustrates a keyword-specified descriptor record with the keyword <CODE>keyEventClassAttr</CODE>--the keyword that identifies an event class attribute. The figure shows the logical arrangement of the event class attribute for the Open Documents event shown in <A HREF=IAC-97.html#MARKER-9-151>Figure 3-3 on page 3-9</A>. The descriptor record in <A HREF=#MARKER-9-181>Figure 3-7</A> is identical to the one in <A HREF=#MARKER-9-167>Figure 3-6</A>; its descriptor type is <CODE>typeType</CODE>, and the data to which its handle refers identifies the event class as <CODE>kCoreEventClass</CODE>. <P>
<B>Figure 3-7  <A NAME=MARKER-9-181></A>A keyword-specified descriptor record for the event class attribute of an Open Documents eve<A NAME=MARKER-2-136></A>nt<A NAME=MARKER-2-3></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-06.jpg"><P>
<A NAME=HEADING98-31></A>
<H3>Descriptor Lists</H3>
 When extracting data from an Apple event, you use Apple Event Manager functions to copy data to a buffer specified by a pointer, or to return a descriptor record whose data handle refers to a copy of the data, or to return lists of descriptor records (called descriptor lists). <P>
 As previously noted, the descriptor record (of data type <CODE>AEDesc</CODE>) is the fundamental structure in Apple events, and it consists of a descriptor type and a handle to data. A <B>descriptor list</B> is a data structure of type <CODE>AEDescList</CODE> defined by the data type <CODE>AEDesc</CODE>--that is, a descriptor list is a descriptor record whose data handle refers to a list of other descriptor records (unless it is an empty list).<A NAME=MARKER-2-370></A><A NAME=MARKER-2-259></A><P>
<PRE>
TYPE  AEDescList = AEDesc;       {list of descriptor records}
</PRE>
 Like several other Apple Event Manager data structures, a descriptor list is identical to a descriptor record of data type <CODE>AEDesc</CODE>; the only difference is that the data in a descriptor list must always consist of a list of other descriptor records. <P>
 <A HREF=#MARKER-9-186>Figure 3-8</A> illustrates the logical arrangement of the descriptor list that specifies the direct parameter of the Open Documents event shown in <A HREF=IAC-97.html#MARKER-9-151>Figure 3-3 on page 3-9</A>. This descriptor list consists of a list of descriptor records that contain alias records to filenames. (See the chapter "Alias Manager" in <I><A HREF="../Files/Files-2.html">Inside Macintosh: Files</A></I> for a detailed description of alias records.)<P>
<B>Figure 3-8  <A NAME=MARKER-9-186></A><A NAME=MARKER-21-187></A>A descriptor list for a list of aliases<A NAME=MARKER-9-42></A><A NAME=MARKER-2-189></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-07.jpg"><P>
 The descriptor list in <A HREF=#MARKER-9-186>Figure 3-8</A> provides the data for a keyword-specified descriptor record. Keyword-specified descriptor records for Apple event parameters can in turn be combined in an <B>AE record,</B> which is a descriptor list of data type <CODE>AERecord</CODE>.<A NAME=MARKER-2-264></A><A NAME=MARKER-2-265></A><P>
<PRE>
TYPE  AERecord = AEDescList;        {list of keyword-specified }
                                    { descriptor records}
</PRE>
 The handle for a descriptor list of data type <CODE>AERecord</CODE> refers to a list of keyword-specified descriptor records that can be used to construct Apple event parameters. The Apple Event Manager provides routines that allow your application to create AE records and extract data from them when creating or responding to Apple events. <P>
 An AE record has the descriptor type <CODE>typeAERecord</CODE> and can be coerced to several other descriptor types. An <B>Apple event record</B>, which is different from an AE record, is another special descriptor list of data type <CODE>AppleEvent</CODE> and descriptor type <CODE>typeAppleEvent</CODE>.<A NAME=MARKER-2-266></A><A NAME=MARKER-2-64></A><P>
<PRE>
TYPE  AppleEvent = AERecord;        {list of attributes and }
                                    { parameters necessary for }
                                    { an Apple event}
</PRE>
 An Apple event record describes a full-fledged Apple event. Like the data for an AE record, the data for an Apple event record consists of a list of keyword-specified descriptor records. Unlike an AE record, the data for an Apple event record is divided into two parts, one for attributes and one for parameters. This division within the Apple event record allows the Apple Event Manager to distinguish between an Apple event's attributes and its parameters. <P>
 Descriptor lists, AE records, and Apple event records are all descriptor records whose handles refer to a nested list of other descriptor records. The data associated with each data type may be organized differently and is used by the Apple Event Manager for different purposes. In each case, however, the data is identified by a handle in a descriptor record. This means that you can pass an Apple event record to any Apple Event Manager function that expects an AE record. Similarly, you can pass Apple event records and AE records, as well as descriptor lists and descriptor records, to any Apple Event Manager functions that expect records of data type <CODE>AEDesc</CODE>.<A NAME=MARKER-2-79></A><A NAME=MARKER-2-54></A><A NAME=MARKER-2-81></A><A NAME=MARKER-21-102></A><A NAME=MARKER-21-129></A><A NAME=MARKER-2-130></A><A NAME=MARKER-21-140></A><P>
 When you use the <CODE>AECreateAppleEvent</CODE> function, the Apple Event Manager creates an Apple event record containing the attributes for an Apple event's event class, event ID, target address, return ID, and transaction ID. You then use Apple Event Manager functions such as <CODE>AEPutParamDesc</CODE> and <CODE>AEPutAttributeDesc</CODE> to add or modify attributes and to add any necessary parameters to the Apple event. <P>
 <A HREF=#MARKER-9-201>Figure 3-9</A> shows an example of a complete Apple event--a data structure of type <CODE>AppleEvent</CODE> containing a list of keyword-specified descriptor records that name the attributes and parameters of an Open Documents event. The figure includes the event class attribute shown in <A HREF=#MARKER-9-181>Figure 3-7</A> and the descriptor list shown in <A HREF=#MARKER-9-186>Figure 3-8</A>, which forms the direct parameter--the keyword-specified descriptor record with the keyword <CODE>keyDirectObject</CODE>. The entire figure corresponds to the Open Documents event shown in <A HREF=IAC-97.html#MARKER-9-151>Figure 3-3 on page 3-9</A>.<P>
 The next two sections, <A HREF=IAC-99.html#MARKER-9-205>"Responding to Apple Events"</A> and <A HREF=IAC-102.html#MARKER-9-227>"Creating and Sending Apple Events,"</A> provide a quick overview of the steps your application must take to respond to and send Apple events.<P>
<B>Figure 3-9  <A NAME=MARKER-9-201></A><A NAME=MARKER-21-202></A>Data structures within an Open Documents event<A NAME=MARKER-2-203></A><A NAME=MARKER-9-163></A></B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-08.jpg"><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-97.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-99.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
