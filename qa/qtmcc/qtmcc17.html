<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><HTML><HEAD><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Q&amp;A QTMCC17: Track Editing</title><meta name="keywords" content="have creator list relevant keywords here"><meta name="Description" content="Technical Q&amp;A QTMCC17: This Q&amp;A discusses different APIsused to edit tracks in QuickTime movies."><meta name="categories" content="QuickTime Movie Toolbox"><meta name="week-posted" content="Sep 18, 2000 - Sep 22, 2000"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10001960" title="Track Editing"></a><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalqas/index.html">Technical Q&As</a> &gt; <a href="../../technicalqas/QuickTime/index.html">QuickTime</a> &gt; <a href="../../technicalqas/QuickTime/idxMovieBasics-date.html">Movie Basics</a> &gt; </p><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Q&amp;A QTMCC17</div>
<div id="pageheadsub">Track Editing</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600> <TR> <td align="left"><!-- begin_content --> <hr width=500 align=center><P ID=p2>Q:  I've been working with QuickTime edit lists and would like some clarification regarding the track-editing APIs. I've noticed QuickTime routines such as <CODE>NewTrackEditState</CODE>, <CODE>UseTrackEditState</CODE> and <CODE>DisposeTrackEditState</CODE>: what are these used for?</P><P ID=p2>To modify the entries in a QuickTime movies edit list table I use APIs such as <CODE>InsertTrackSegment</CODE> and <CODE>DeleteTrackSegment</CODE>, how do these calls affect the actual media samples? For example, if I use <CODE>DeleteTrackSegment</CODE>, are the media samples in the segment actually deleted?</P><P ID=p2>How does <CODE>InsertEmptyTrackSegment</CODE> work? Does it put a "zero-sample" in the media data or does it tell the movie controller to do nothing in the specified time interval? Which field of which atom is being modified by this routine?</P><P ID=p4>A: Each track in a QuickTime movie contains a list of references which identify the portions of the tracks media being used. The <CODE>TrackEditState</CODE> identifier which is returned from <CODE>NewTrackEditState</CODE> contains all the information describing a track's contents; this includes the identity of the media data associated with the track and all the tracks edit lists. This "state" can then be used with <CODE>UseTrackEditState</CODE> to return a track to its previously created edit state (i.e., "Undo"). <CODE>DisposeTrackEditState</CODE> simply disposes of the <CODE>TrackEditState</CODE> identifier created when <CODE>NewTrackEditState</CODE> is called. Although these APIs allow you to work with the track's edit state, they do not allow you to modify this state.</P><P ID=p4>To modify the entries in a QuickTime Movies edit list, you need to use a number of track related editing APIs. These include <CODE>InsertMediaIntoTrack</CODE>, <CODE>InsertTrackSegment</CODE>, <CODE>DeleteTrackSegment</CODE>, <CODE>ScaleTrackSegment</CODE> and <CODE>InsertEmptyTrackSegment</CODE>. If you would like to perform the same operations across all tracks of a movie use <CODE>InsertMovieSegment</CODE>, <CODE>DeleteMovieSegment</CODE>, <CODE>ScaleMovieSegment</CODE> and <CODE>InsertEmptyMovieSegment</CODE>.</P><P ID=p4>None of the editing APIs will modify or delete already written media samples. <CODE>DeleteTrackSegment</CODE> and <CODE>InsertEmptyTrackSegment</CODE> just update the Track's edit list structure which maps from the movie's play list to the media to actually play.</P><P ID=p4>When you call <CODE>DeleteTrackSegment</CODE>, the deleted segment is removed from the edit list and all following references to the media are moved forward. <CODE>InsertEmptyTrackSegment</CODE> adds a special sentinel value to the edit list, indicating that no media should be played for that empty segment's duration. <CODE>InsertTrackSegment</CODE> copies references. <CODE>ScaleTrackSegment</CODE> changes the edit list in such a way that the media referenced changes its rate so as to fill the new duration.</P><P ID=p4>There is an exception with <CODE>InsertTrackSegment</CODE> if you have enabled media changes by calling <CODE>BeginMediaEdits</CODE>. In this case, if you are inserting sample references to as yet un-referenced media in the destination track, the sample data will be copied the first time it is referenced. If you don't want this behavior just don't call <CODE>BeginMediaEdits</CODE>.</P><P ID=p4>In all cases where <CODE>BeginMediaEdits</CODE> has not been called, no media is harmed.</P><P ID=p4>The editing APIs all make adjustments to the <CODE>'elst'</CODE> atom found in the <CODE>'edts'</CODE> atom found in the <CODE>'trak'</CODE> atom found in the <CODE>'moov'</CODE> atom. Consult the file format documentation for more information regarding these atoms.</P><P ID=p4>Finally, you cannot insert an empty segment at the end of the track and then add sample references. An empty insertion at the end of the track will disappear, since after the end of the track there is already an empty segment. If you must add empty space before some sample references, add the sample references and then insert the empty segment before the references which will move them into place.</P><P ID=p4>For more information regarding editing and the <CODE>'elst'</CODE> atom consult the following:</P><UL TYPE="circle">	<LI><a href="http://developer.apple.com/documentation/quicktime/qtdevdocs/RM/rmMTEditing.htm">Movie Toolbox: Editing</A></li>	<LI><a href="http://developer.apple.com/documentation/quicktime/qtdevdocs/PDF/QTFileFormat.pdf">QuickTime File Format: June 2000</A></li></UL><hr width=500 align=center><!-- begin_date --><H4 ALIGN=center>[Sep 22 2000]</H4><!-- end_date --></TD> </TR> </TABLE></CENTER></CENTER><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/qa/qtmcc/qtmcc17.html%3Fid%3DDTS10001960-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/qa/qtmcc/qtmcc17.html%3Fid%3DDTS10001960-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/qa/qtmcc/qtmcc17.html%3Fid%3DDTS10001960-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>