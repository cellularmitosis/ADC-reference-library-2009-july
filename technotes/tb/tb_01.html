<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"			"http://www.w3.org/TR/REC-html40/loose.dtd"><html><head><LINK REL="stylesheet" HREF="../../adcstyle.css" TYPE="text/css"><LINK REL="stylesheet" HREF="../../style.css" TYPE="text/css"><title>Technical Note TB01: Bundles</title>                                      <meta name="categories" content="Human Interface Toolbox"><meta name="week-posted" content="Oct 31, 1988 - Nov 4, 1988"><LINK REL="stylesheet" HREF="../../css/adcstyle.css" TYPE="text/css"><script language="JavaScript" type="text/javascript" src="../../js/adc.js"></script></HEAD><BODY BGCOLOR="#FFFFFF"><a name="//apple_ref/doc/uid/DTS10002752" title="Bundles"></a><a name="top"></A><!-- top_of_header_marker_comment --><!-- begin_header_information --><!--#include virtual="/adcnavbar" --><p><a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../technicalnotes/index.html">Technical Notes</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../technicalnotes/LegacyTechnologies/idxMacOS9Earlier-date.html">Mac OS 9 & Earlier</a> &gt; </p><div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="../../referencelibrary/Carbon/idxHumanInterfaceToolbox-date.html" target="_blank">Carbon > Human Interface Toolbox</a></li>
	</ul>
</div>




</div></div></div><!-- end_header_information --><!-- bottom_of_header_marker_comment --><!-- top_of_titles_marker_comment --><CENTER><table width="600" cellpadding="0" cellspacing="0" border="0">
<tr><td align="left" scope="row">
<h1>
<div id="pagehead">Technical Note TB01</div>
<div id="pageheadsub">Bundles</div>
</h1>
</td></tr></table></CENTER><!-- bottom_of_titles_marker_comment --><CENTER><TABLE BORDER=0 CELLSPACING=1 WIDTH=600><TR><td align="left"><!-- begin_header_box --><table width="600" cellpadding="0" cellspacing="0" border="0">    <tr>        <td width=300 valign="top" align=left scope="row">            <table border="0" width="300" cellpadding="0" cellspacing="0">			<tr>                        <td width=300 align=left> <img src="images/tnmenutop.gif" alt="" align="bottom" width=300 height=7></td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>                                         <span id="menutitle">                            CONTENTS                             <br>                            <br>                        </span>                    </td>                </tr>                <tr bgcolor="#e6e6e6">                    <td background="images/tnmenubody.gif" width=300 align=left>					<!-- begin_toc -->										<p id="menutext"><A HREF="#Section1">Introduction</A><BR><BR><A HREF="#Section2">How to Create a Bundle</A><BR><BR><A HREF="#Section3">How the Finder Uses Bundles</A><BR><BR><A HREF="#Section4">Problems That May Arise</A><BR><BR><A HREF="#References">References</A><BR><BR><A HREF="#Downloads">Downloadables</A></P>                   <!-- end_toc -->                  </td>                </tr>                <tr>                    <td width=300 align=left scope="row">                        <img src="images/tnmenubottom.gif" alt="" width=300 height=16>                    </td>                </tr>            </table>        </td>        <td width=300 valign="top" align=left><!-- begin_intro_text --><P id = "introtext">This Technote describes what a bundle is and how to create one.</p><!-- end_intro_text --><!-- begin_date --><h3 align=center>[Nov 01 1988]</h3><!-- end_date -->                </TD>             </TR>          </TABLE>          <!-- end_table_box --> <BR><BR>          <hr width=500 align=center>          <BR><BR>          <!-- begin_content --><a name=Section1></A><h2>Introduction</h2><p>A bundle is a collection of resources. Bundles can be used for a number ofdifferent purposes, and are currently used by the Finder ito tie an icon to afile type, allowing your application or data file to have its own icon.</p><P><A HREF="#top">Back to top</A></p><a name="Section2"></a><h2>How to Create a Bundle</h2><p>A bundle is a collection of resources. To make a bundle for finder icons, weneed to set up four types of resources: an <code>ICN#</code>, an <code>FREF</code>, a creator <code>STR</code> and a<code>BNDL</code>.</p><p>The <code>ICN#</code> resource type is an icon list. Each <code>ICN#</code> resource contains one or moreicons, on after another. For Finder bundle icons, there are two icons in each<code>ICN#</code>: one for the icon itself and one for the mask. In our sample bundle, wehave two file types, each with its own icon. To define the icons for thesefiles we would enter this into our Rez input file:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    resource 'ICN#' (732) { /* first icon: the ID number can be anything */       {                    /* first, the icon */          $&quot;FF FF FF FF&quot;    /* each line is 4 bytes (32 bits) */          $&quot;F0 09 CD DD&quot;    /* 32 lines total for icon */          ...          $&quot;FF FF FF FF&quot;    /* 32nd line of icon */          ,                 /* now, the mask */          $&quot;FF FF FF FF&quot;    /* 32 lines total for mask */          $&quot;FF FF FF FF&quot;          ...          $&quot;FF FF FF FF&quot;    /* 32nd line of mask*/       }    };    resource 'ICN#' (733) { /* second icon */       {          $&quot;FF FF FF FF&quot;          ...          ,          $&quot;FF FF FF FF&quot;          ...       }</pre>	</TD></TR></TABLE></CENTER><p>Now that we've defined our icons we can set up the <code>FREF</code>s. An <code>FREF</code> is a filetype reference; you need one for each file type that has an icon. It ties afile type to a local icon resource ID. This will be mapped by the <code>BNDL</code> onto anactual resource ID number of an <code>ICN#</code> resource. Our <code>FREF</code>s will look like this:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    resource 'FREF' (816) { /* file type reference for application icon */       {          'APPL', 605, /* the type is APPL(ication), the local ID is 605 */          &quot;&quot;           /* this string should be empty (it is unused) */       }    };    resource 'FREF' (817) { /* file type reference for a document icon */       {          'TEXT', 612, /* the type is TEXT, the local ID is 612 */          &quot;&quot;           /* this string should be empty (it is unused) */       }</pre>	</TD></TR></TABLE></CENTER><p>The reason that you specify the local ID, rather than the actual resource ID ofthe <code>ICN#</code> is that the Finder will copy all of the bundle resources into theDesktop file and renumber them to avoid conflicts. This means that the actualIDs will change, but the local IDs will remain the same.</p><p>Every application (or other file with a bundle) has a unique four-charactersignature. The Finder uses this to identify an application. The creatorresource that contains a single string, and should be defined like this:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    type 'MINE' as 'STR '; /* MINE is the signature */    resource 'MINE' (0) { /* the creator resource ID must be 0 */       &quot;MyProgram 1.0 Copyright 1988&quot;</pre>	</TD></TR></TABLE></CENTER><p>Now for the BNDL resource. The BNDL resource associates local resource IDs withactual resource IDs, and also tells the Finder what file types exist, and whichICN#s and FREFs are part of the bundle. The resource looks like this:</p><CENTER><TABLE BORDER=0 CELLPADDING=5 WIDTH=550><TR>	<td bgcolor="#E6E6E6" align=left><pre>    resource 'BNDL' (128) { /* the bundle resource ID should be 0 */       'MINE', /* signature of this application */       0, /* the creator resource ID (this must be 0) */       {          'ICN#', /* local resource ID mapping for icons */          {             605, 732, /* ICN# local ID 605 maps to 732 */             612, 733  /* ICN# local ID 612 maps to 733 */          },          'FREF', /* local resource ID mapping for file type references */          {             523, 816, /* FREF local ID 523 maps to 816 */             555, 817  /* FREF local ID 555 maps to 817 */</pre>	</TD></TR></TABLE></CENTER><p>When you are in the Finder, your application, type <code>APPL</code> (<code>FREF</code> 816), will bedisplayed with icon local ID 605 (from the <code>FREF</code> resource). This is <code>ICN#</code> 732.Files of type TEXT (<code>FREF</code> 817) created by your application will be displayedwith icon local ID 612 (from the <code>FREF</code> resource). This is <code>ICN#</code> 733.</p><a name="Section3"></a><P><A HREF="#top">Back to top</A></p><h2>How the Finder Uses Bundles</h2><p>If a file has the bundle bit set, but the bundle isn't in the Desktop file, theFinder looks for a <code>BNDL</code> resource. If the <code>BNDL</code> resource matches the signature oftheapplication, the Finder then makes a copy of the bundle and puts it in theDesktop file. The file is then displayed with its associated icon.</p><p>If a file has lost its icon (it's on a disk without the file containing bundleand the Desktop file doesn't contain the bundle), then it will be displayedwith the default document icon until the Finder encounters a copy of the filethat contains the right bundle. The Finder then makes a copy of theapplication's bundle (renumbering resources if necessary) and places it in theDesktop file of that disk.</p><P><A HREF="#top">Back to top</A></p><a name="Section4"></a><h2>Problems That May Arise</h2><p>There are times when you have set up these resource types properly but the iconis either the wrong one or it has defaulted to the standard application or datafile icon. There are a number of possible reasons for this.</p><p>If you are using the Macintosh-based RMaker, the first thing to check iswhether there are any extraneous spaces in your resource compiler input file.The Macintosh-based RMaker is very picky about extra spaces.</p><p>If your icon is defaulting to the standard icon, check to see that the bundlebit is set. If the bundle bit isn't set , the Finder doesn't know to place thebundle in the Desktop file. If it isn't in the Desktop file, the Finderdisplays the file with a default icon.</p><p>If you changed the icon and remade the resource file, but the file still hasthe same old icon when displayed in the Finder. The old icon is still in theDesktop file. The Finder doesn't know that you've changed it, so it uses whatit has. To get it to use the new icon you need to rebuild the Desktop file. Toforce the Finder to rebuild the Desktop file, you can hold down the Option andCommand keys on startup or on insertion of the disk in question if it isn't theboot disk. The Finder will ask whether or not you want to rebuild the desktop(meaning the Desktop file).</p><p>Have a bundle of fun!</p><P><A HREF="#top">Back to top</A></p><a name = "References"></a><h2>References</h2><p>The Finder Interface</p><a name="Downloads"></a>       <P><A HREF="#top">Back to top</A></p><h2>Downloadables</H2>                  <TABLE BORDER=0 CELLPADDING=3 WIDTH="100%">            <TR>               <td width=50 align=left>                  <P ALIGN=center><img src="images/acrobatsmall.gif" width=22 height=23 align=middle alt="Acrobat gif"></P>               </TD>               <td align="left">                  <P>Acrobat version of this Note (40K).</P>               </TD>               <td width=60 align=left>                  <P><A HREF="pdf/tb_01.pdf">Download</A></P>               </TD>            </TR>                    </TABLE>         <BR></TD></TR></table></center><!-- begin_footer_information -->	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/technotes/tb/tb_01.html%3Fid%3DDTS10002752-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/technotes/tb/tb_01.html%3Fid%3DDTS10002752-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/technotes/tb/tb_01.html%3Fid%3DDTS10002752-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
<!--#include virtual="/includes/footer"--><!-- end_footer_information --></BODY></HTML>