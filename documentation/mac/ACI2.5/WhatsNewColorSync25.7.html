<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML EXPERIMENTAL 970324//EN">
<HTML>
<HEAD>
<META NAME="GENERATOR" CONTENT="Adobe FrameMaker 5.5/HTML Export Filter">

<TITLE> Scripting Support</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">

<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->

<!-- top image banner and para -->



<CENTER>
<P>   
<A HREF="WhatsNewColorSync25.6.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="WhatsNewColorSync25-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A>  <A HREF="WhatsNewColorSync25.8.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html"><B>Inside Macintosh:</B></A> <A HREF="WhatsNewColorSync25-2.html"><B>What's New in ColorSync 2.5</B></A> / </DL></FONT><P>
<HR>


<H1 CLASS="H1.Heading1">
<A NAME="pgfId=6016">
 </A>
<A NAME="41236">
 </A>
Scripting Support</H1>
<P CLASS="T1.Text1">
<A NAME="pgfId=8884">
 </A>
ColorSync 2.5 provides AppleScript support that allows users to script many common color-matching tasks. To provide this support, ColorSync now runs as a faceless background application (one with no user interface), rather than as a standard extension. By running as a background application, ColorSync can avoid namespace collisions and time-outs during long operations, and it can have its own AppleScript dictionary.</P>

<A NAME="pgfId=9088"></A>
<h4>Note</h4>
You can examine ColorSync's full AppleScript dictionary by dragging the file &quot;ColorSync Extension&quot; from your Extensions folder onto the Script Editor application (usually located in the AppleScript folder within the Apple Extras folder).
</P>
<DIV>
<H2 CLASS="H2.Heading2">
<A NAME="pgfId=9092">
 </A>
Scriptable Properties</H2>
<P CLASS="T1.Text1">
<A NAME="pgfId=9044">
 </A>
ColorSync provides scriptable support for getting and setting the following properties:</P>
<UL>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=9045">
 </A>
system profile (the default system profile)</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=10448">
 </A>
default profiles for RGB, CMYK, Lab, and XYZ color spaces</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=9047">
 </A>
quit delay (the time in seconds for auto-quit, where 0 = never)</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=9096">
 </A>
profile location (a file specification)</LI>
</UL>
<P CLASS="T1.Text1">
<A NAME="pgfId=9097">
 </A>
For the following, you can only get, not set, the property:</P>
<UL>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=10227">
 </A>
profile folder (the ColorSync profile folder)</LI>
</UL>
<P CLASS="T1.Text1">
<A NAME="pgfId=10224">
 </A>
Location is the only property currently supported for profiles, but future support is planned for additional profile properties.</P>
</DIV>
<DIV>
<H2 CLASS="H2.Heading2">
<A NAME="pgfId=8904">
 </A>
Scriptable Operations</H2>
<P CLASS="T1.Text1">
<A NAME="pgfId=8854">
 </A>
ColorSync supports the following scriptable operations:</P>
<UL>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=8921">
 </A>
Matching an image.</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=8924">
 </A>
Matching an image with a device link profile.</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=8927">
 </A>
Proofing an image.</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=8930">
 </A>
Embedding a profile in an image. </LI>
</UL>
<P CLASS="T1.Text1">
<A NAME="pgfId=10248">
 </A>
Scriptable image operations currently work only on TIFF files, but support for other formats is planned.</P>
</DIV>
<DIV>
<H2 CLASS="H2.Heading2">
<A NAME="pgfId=10314">
 </A>
Extending the Scripting Framework</H2>
<P CLASS="T1.Text1">
<A NAME="pgfId=10413">
 </A>
The scripting framework uses a plug-in architecture that is fully accessible to third-party scripting plug-ins. When a user invokes a script to perform a ColorSync operation on an image, ColorSync (operating as a faceless background application) automatically builds a list of all available scripting plug-ins. It then attempts to call each of the plug-ins in the list until one of them successfully executes the desired operation. To appear in the list, a plug-in must meet the following criteria:</P>
<UL>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=11843">
 </A>
It must be stored in the Extensions folder.</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=11844">
 </A>
It must be a shared library (file type <CODE>
'shlb'</CODE>
).</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=11845">
 </A>
It should have a unique creator type (registered with Apple).</LI>
<LI CLASS="B1.Bullet1">
<A NAME="pgfId=11846">
 </A>
The name of the library's code fragment (specified in the <CODE>
'cfrg'</CODE>
 resource) must be unique (among all currently loaded shared libraries) and begin with <CODE>
'CSSP'</CODE>
. For example, you might want to name the library by appending your creator type to <CODE>
'CSSP'.</CODE>
</LI>
</UL>
</DIV>
<DIV>
<H2 CLASS="H2.Heading2">
<A NAME="pgfId=10249">
 </A>
Sample Scripts</H2>
<P CLASS="T1.Text1">
<A NAME="pgfId=10263">
 </A>
The ColorSync SDK includes several sample scripts that demonstrate how to perform common operations. You can use the scripts as is, or borrow from them for your own custom scripts. For more information, see the detailed Read Me files that accompany the sample scripts.</P>
</DIV>
<HR>


<CENTER>
<P>   
<A HREF="WhatsNewColorSync25.6.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="WhatsNewColorSync25-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A>  <A HREF="WhatsNewColorSync25.8.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>


<!-- bottom image banner and para -->

<!-- start of footer -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->

</BODY>
</HTML>
