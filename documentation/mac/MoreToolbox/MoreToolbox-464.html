<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating the Required Resources for a Monitors Extension (IM: MTb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING464></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MoreToolbox-463.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-465.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MoreToolbox-2.html"><B>More Macintosh Toolbox</B></A> / <BR><DD><A HREF="MoreToolbox-453.html"><B>Chapter 8 - Control Panels</B></A> / <A HREF="MoreToolbox-462.html"><B>Creating an Extension for the Monitors Control Panel</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING464-0></A>
<H2>Creating the Required Resources for a Monitors Extension</H2>
 This section describes the four required resources that you supply for your monitors extension. <P>
 To create these resources, either you can specify the resource description in an input file and compile the resource using a resource compiler, such as Rez, or you can directly create your resou<A NAME=MARKER-2-250></A>rces in a resource file using a tool such as ResEdit.<P>
 The required resources and their resource IDs are<P>
<UL>
<LI>the card (<CODE>'card'</CODE>) resource: resource ID from -4080 through -4065
<LI>the rectangle (<CODE>'RECT'</CODE>) resource: resource ID -4096
<LI>the item list (<CODE>'DITL'</CODE>) resource: resource ID -4096
<LI>the monitor (<CODE>'mntr'</CODE>) resource: resource ID -4096<P>
</UL>
<A NAME=HEADING464-8></A>
<H3><A NAME=MARKER-9-251></A>Creating a Card Resource for a Monitors Extension</H3>
 You create a card resource of type <CODE>'card'</CODE> to identify the monitors extension for your video card and to specify the name of your video card. When the monitor to which your card is connected is the selected one and the user clicks the Options button, the Monitors control panel checks all monitors extension files for a card resource that contains the name of your video card. If it finds a match, the Monitors control panel extends the Options dialog box to display the monitors extension containing the matching card resource.<A NAME=MARKER-2-252></A> The Monitors control panel also displays, at the very top of the Options dialog box, your video card's name as defined in the card resource. This title indicates to the user that the Options dialog box pertains to your card. For example, <A HREF=MoreToolbox-463.html#MARKER-9-237>Figure 8-11 on page 8-49</A> shows the Macintosh Display Card name at the top of the Options dialog box. The card resource is required, and its resource ID must be in the range of -4080 <BR>through -4065. <A NAME=MARKER-2-253></A><P>
 <A NAME=MARKER-2-265></A>Your card resource must contain a Pascal string identical to the name of your video card as specified in the <CODE>sResource</CODE> data structure in the ROM of the card. (For more information on the <CODE>sResource</CODE> data structure, see <I>Designing Cards and Drivers for the Macintosh Family</I>, third edition.) <P>
 If you do not want to use the video card name specified in the ROM of the card, you can include in your monitors extension file a string list resource of type <CODE>'STR#'</CODE>. In that resource, specify an alternative name for the Monitors control panel to display. See <A HREF=MoreToolbox-465.html#MARKER-9-293>"Providing an Alternative Name for a Video Card" on page 8-58</A> for more information. <A NAME=MARKER-2-255></A><P>
 You use a card resource to ensure that your monitors extension is called when the user selects the monitor to which your card is connected and clicks the Options button. Because your monitors extension file can contain as many card resources as you wish, one extension file can handle several types of video cards. For example, <A HREF=#MARKER-9-256>Listing 8-17</A> shows two card resources; thus, when the user selects the monitor connected to the SurfBoard Display Card or the SurfBoard Super Display Card, the monitors extension <CODE>MyMonExtend</CODE> is called. (See <A HREF=MoreToolbox-466.html#MARKER-9-326>Listing 8-25 on page 8-64</A> for the <CODE>MyMonExtend</CODE> function.)<P>
<B>Listing 8-17  R<A NAME=MARKER-9-256></A>ez input for a card (<CODE>'card'</CODE>) resource</B><P>
<PRE>
resource 'card' (-4080, purgeable)
{
   &quot;SurfBoard Display Card&quot;
};
resource 'card' (-4079, purgeable)
{
   &quot;SurfBoard Super Display Card&quot;
};
</PRE>
<A NAME=HEADING464-15></A>
<H3><A NAME=MARKER-9-257></A>Defining a Rectangle for a Monitors Extension</H3>
 <A NAME=MARKER-2-258></A>You create a rectangle resource of type <CODE>'RECT'</CODE> to define the display area for <A NAME=MARKER-2-259></A>the controls of your monitors extension. When the user clicks the Options button in the Monitors control panel, the <A NAME=MARKER-2-260></A>Monitors control panel uses your monitors extension to expand the Options dialog box under these circumstances: if the monitor connected to your video card is currently selected, and if you have provided a <A NAME=MARKER-2-261></A>monitors extension <BR>for your card. Before displaying it, the Monitors control panel expands the Options dialog box to include the space defined by the rectangle resource. The rectangle resource is required, and its resource ID must be -4096.<A NAME=MARKER-2-262></A><P>
 To specify the top coordinate of your rectangle, determine the height in pixels of the space required to display your controls and specify that value as a negative number. For example, if you need a display area that is 60 pixels high, specify -60 as the top coordinate. Specify 0 as the left coordinate. This is the same value used to define the left edge of the Options dialog box, and your rectangle should have the same left edge. <P>
 Specify 0 as the bottom coordinate. You can think of the distance from the bottom coordinate to the top coordinate--60 pixels, in this example--as the height of your rectangle. Specify 320 as the right coordinate. This is the same value used to define the right edge of the Options dialog box, and your rectangle should have the same right edge.<P>
<DL>
<DT><B>Note</B>
<DD>Although you specify other coordinate values for your rectangle's origin, when you assign coordinates to your controls, assume that <BR>the origin of the local coordinate system for your dialog items is (0,0).<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 <A HREF=#MARKER-9-263>Figure 8-14</A> shows the Options dialog box for the SurfBoard Display Card. The OK and Cancel buttons and the scrollable list for the monitor type are standard controls. The Magnify Enabled checkbox and three lines of text have been added by the SurfBoard monitors extension. This figure shows the height and width, in pixels, defined in the rectangle resource; this is the area required to display the additional controls. <P>
<B>Figure 8-14  <A NAME=MARKER-9-263></A>Display area defined by a rectangle resource </B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CP-L-14.jpg">
 <A HREF=#MARKER-9-264>Listing 8-18</A> shows, in Rez input, the rectangle resource used in this example. Notice that the top coordinate is -60 and the bottom coordinate is 0. In other words, the space to be added to the Options dialog box is 60 pixels high. <P>
<B>Listing 8-18  <A NAME=MARKER-9-264></A>Rez input for a rectangle (<CODE>'RECT'</CODE>) resource<A NAME=MARKER-2-265></A></B><P>
<PRE>
resource 'RECT' (-4096, purgeable)
{
   {-60,0,0,320}
};
</PRE>
<A NAME=HEADING464-26></A>
<H3><A NAME=MARKER-9-266></A><A NAME=MARKER-21-267></A>Creating an Item List Resource for a Monitors Extension</H3>
 <A NAME=MARKER-2-268></A>You provide an item list resource of type <CODE>'DITL'</CODE> to specify which items you want to appear in the rectangle display area (see the previous section for information about the rectangle resource). In an item list, you specify static text, buttons, checkboxes, radio buttons, editable text, user items, the resource IDs of icons and QuickDraw pictures, and the resource IDs of other types of controls, such as pop-up menus. The item list is required, and its resource ID must be -4096. <P>
 When you assign coordinates to your controls, assume that the origin (that is, the upper-left corner) of the local coordinate system is (0,0). The Monitors control panel transforms the coordinates of your controls to the coordinate system that it uses for the <A NAME=MARKER-2-269></A>Options dialog box. Thus, you must use the <CODE>GetDialogItem</CODE> procedure to get the true locations of your dialog items. See the chapter "Dialog Manager" in <I><A HREF="../Toolbox/Toolbox-2.html">Inside Macintosh: Macintosh Toolbox Essentials</A></I> for information on the <CODE>GetDialogItem</CODE> procedure. <P>
 If you add additional controls for superusers, you should place them below a horizontal line separating them from other controls, as illustrated in <A HREF=#MARKER-9-270>Figure 8-15</A>.<P>
<B>Figure 8-15  <A NAME=MARKER-9-270></A>The SurfBoard Options dialog box with superuser controls</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/CP-S-15.jpg">
 To draw a dividing line, specify a separate dialog item of type <CODE>userItem</CODE>. <A HREF=#MARKER-9-271>Listing 8-19</A> shows the item list resource for the SurfBoard monitor extension. Notice that the dividing line (item 2) is defined as a user item. <P>
<B>Listing 8-19  <A NAME=MARKER-9-271></A>Rez input for the SurfBoard monitors extension item list resource</B><P>
<PRE>
resource 'DITL' (-4096, purgeable) {
   {  
      /* [1] */
      {10, 151, 50, 314},
      StaticText {   disabled,   &quot;River Change Systems\nmonitors extension&quot;
                                 &quot;\nCopyright &#169; 1993&quot;                   },
      /* [2] dividing line for superuser controls*/
      {60, 1, 61, 319},
      UserItem {     enabled                                               },
      /* [3] */
      {70, 28, 80, 236},
      StaticText {   enabled,    &quot;Superuser Options&quot;                    },
      /* [4] */
      {82, 7, 110, 200},
      RadioButton {  enabled,    &quot;Zirconian Filtration&quot;                 },
      /* [5] */
      {112, 7, 132, 200},
      RadioButton {  enabled,    &quot;Anti-Aliasing&quot;                        },
      /* [6] */
      {22, 7, 58, 160},
      CheckBox {     enabled,    &quot;Magnify Enabled&quot;                      }
      }
   }; 
</PRE>
 <A HREF=MoreToolbox-466.html#MARKER-9-339>Listing 8-29 on page 8-70</A> shows the procedure that the SurfBoard monitors extension function uses to draw a line separating the items for normal users from the items displayed for superusers. It uses the QuickDraw <CODE>FrameRect</CODE> procedure to draw the item as a 1-pixel-high rectangle. After calling the <CODE>FrameRect</CODE> procedure, a monitors extension can also dither the line in the same manner used to dither menu divider lines. (For information on the <CODE>FrameRect</CODE> procedure, see <I><A HREF="../QuickDraw/QuickDraw-2.html">Inside Macintosh: Imaging with QuickDraw</A></I>.)<P>
 If you use an item color table resource of type <CODE>'ictb'</CODE> to draw your items in color or in a different font, you must include placeholder entries for the standard Options dialog box items before you define the item color table entries to be mapped to the items in your monitors extension item list. This step is necessary because the Monitors control panel appends your monitors extension item list to that of the Options dialog box. To maintain the mapping between entries in the item color table (<CODE>'ictb'</CODE>) and your item list, you must account for the Options dialog box items.  <A NAME=MARKER-2-272></A> <A NAME=MARKER-2-273></A><A NAME=MARKER-2-274></A><A NAME=MARKER-2-275></A><P>
 Currently, the Options dialog box contains 10 items (although this number is subject to change in future implementations of the Monitors control panel). An item color table entry contains two words for each corresponding item. For this implementation of the Monitors control panel, you can ensure that the first item in your item list is mapped to the correct item color table entry as follows: create 10 entries in the item color table to correspond to the 10 items in the Options dialog box, and specify a value of 0 for both words of each entry.<P>
<A NAME=HEADING464-38></A>
<H3>Creating the Monitor Code Resource</H3>
 <A NAME=MARKER-2-276></A>A monitor code resource (of type <CODE>'mntr'</CODE>) contains the code that carries out the functions of a monitors extension. In MPW, you can set the code resource type to <CODE>'mntr'</CODE> when you link the program. When you create such a resource, the resource must begin with a function that you <A NAME=MARKER-2-57></A>provide, called the monitors extension function. <A NAME=MARKER-2-365></A><P>
 The Monitors control panel passes to your monitors extension function parameters that specify actions to perform. You can use the function result to keep a handle to allocated memory or to return an error code. For more information about the monitors extension function, see <A HREF=MoreToolbox-466.html#MARKER-9-312>"Writing a Monitors Extension Function"</A> beginning on <A HREF=MoreToolbox-466.html#MARKER-9-312>page 8-61</A>. <A NAME=MARKER-2-279></A> <A NAME=MARKER-9-146></A> <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MoreToolbox-463.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MoreToolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MoreToolbox-513.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MoreToolbox-465.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MoreToolbox-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>   
