<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>AppleScript Language Guide: About Handlers</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="About Handlers"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>    
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/TP40000983-CH206" title="About Handlers"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../../ScriptingAutomation/index.html#//apple_ref/doc/uid/TP30000440-TP40005948" target="_top">Scripting &amp; Automation</a> &gt; <a href="../../../../ScriptingAutomation/AppleScript-date.html#//apple_ref/doc/uid/TP30000440-TP40005948-TP30000481" target="_top">AppleScript</a> &gt; <a href="../index.html" target="_top">AppleScript Language Guide</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_script_objects.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../reference/ASLR_classes.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <hr />
        
        
        <a name="//apple_ref/doc/uid/TP40000983-CH206-CJBIDBJH" title="About Handlers"></a><h1>About Handlers</h1><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_221"></a>When script developers want to factor and re-use their code, they can turn to handlers. A handler is a collection of statements that can be invoked by name. Handlers are also known as functions, subroutines, or methods.</p><p>This chapter describes how to work with handlers, in the following sections:</p><ul class="ul"><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW3">“Handler Basics”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW12">“Saving and Loading Libraries of Handlers”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW14">“Handlers in Script Applications”</a></span></p></li></ul>
<p>For detailed reference information, see <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163762">“Handler Reference.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW3" title="Handler Basics"></a><h2>Handler Basics</h2>
<p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_222"></a>A <strong>handler</strong> is a collection of statements that can be invoked by name. Handlers are useful in scripts that perform the same action in more than one place. You can package statements that perform a specific task as a handler, give it a descriptive name, and call it from anywhere in the script. This makes the script shorter and easier to maintain.</p><p>A script can contain one or more handlers. However, you can not nest a handler definition within another handler (although a script object defined in a handler can contain other handlers).</p><p>The definition for a handler specifies the parameters it uses, if any. It does not specify the class for its parameters. However, most handlers expect each parameter to be of a specific class, so it is useful to add a comment that lists the expected class types.</p><p>When you call a handler, you must list its parameters according to how they are specified in its definition. Handlers may have labeled parameters or positional parameters, described in subsequent sections.</p><p>A handler definition can contain variable declarations and statements. It may use a <code>return</code> statement (described in detail in <code><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163937">“return”</a></code>) to return a value and exit the handler<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_223"></a>.</p><p>A call to a handler must include all the parameters specified in the handler definition. There is no way to specify optional parameters.</p>
<p>The sections that follow provide additional information on working with handlers:</p>
<ul class="ul">
<li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW23">“Defining a Simple Handler”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW22">“Handlers with Labeled Parameters”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW13">“Handlers with Positional Parameters”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW20">“Handlers with Patterned Positional Parameters”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW11">“Recursive Handlers”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW10">“Errors in Handlers”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW4">“Passing by Reference Versus Passing by Value”</a></span></p></li><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW1">“Calling Handlers in a tell Statement”</a></span></p></li></ul><a name="//apple_ref/doc/uid/TP40000983-CH206-SW23" title="Defining a Simple Handler"></a><h3>Defining a Simple Handler</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_224"></a>The following is a definition for a simple handler that takes any parameter value that can be displayed as text (presumably one representing a date) and displays it in a dialog box. The handler name is <code>rock</code>; its parameter is <code>around the clock</code>, where <code>around</code> is a parameter label and <code>clock</code> is the parameter name (<code>the</code> is an AppleScript filler for readability):</p><div class="codesample"><table><tr><td scope="row"><pre>on rock around the clock<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog (clock as text)<span></span></pre></td></tr><tr><td scope="row"><pre>end rock<span></span></pre></td></tr></table></div><p>This handler allows an English-like calling statement:</p><div class="codesample"><table><tr><td scope="row"><pre>rock around the current date -- call handler to display current date<span></span></pre></td></tr></table></div><p>A handler can have no parameters. To indicate that a handler has no parameters, you include a pair of empty parentheses after the handler name in both the handler definition and the handler call. For example, the following <code>helloWorld</code> script has no parameters.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_225"></a></p><div class="codesample"><table><tr><td scope="row"><pre>on helloWorld()<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Hello World"<span></span></pre></td></tr><tr><td scope="row"><pre>end<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>helloWorld() -- Call the handler<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH206-SW22" title="Handlers with Labeled Parameters"></a><h3>Handlers with Labeled Parameters</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_226"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_227"></a>To define a handler with labeled parameters, you list the labels to use when calling the handler and the statements to be executed when it is called. (The syntax is shown in <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-SW2">“Handler Syntax (Labeled Parameters).”</a></span>)</p><p>Handlers with labeled parameters can also have a direct parameter. With the exception of the direct parameter, which must directly follow the handler name, labeled parameters can appear in any order, with the labels from the handler definition identifying the parameter values. This includes parameters listed in <code>given</code>, <code>with</code>, and <code>without</code> clauses (of which there can be any number).</p><p>The <code>findNumbers</code> handler in the following example uses the special label <code>given</code> to define a parameter with the label <code>given rounding</code>.</p><div class="codesample"><table><tr><td scope="row"><pre>to findNumbers of numberList above minLimit given rounding:roundBoolean<span></span></pre></td></tr><tr><td scope="row"><pre>        set resultList to {}<span></span></pre></td></tr><tr><td scope="row"><pre>        repeat with i from 1 to (count items of numberList)<span></span></pre></td></tr><tr><td scope="row"><pre>            set x to item i of numberList<span></span></pre></td></tr><tr><td scope="row"><pre>            if roundBoolean then -- round the number<span></span></pre></td></tr><tr><td scope="row"><pre>                -- Use copy so original list isn’t modified.<span></span></pre></td></tr><tr><td scope="row"><pre>                copy (round x) to x<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>            if x > minLimit then<span></span></pre></td></tr><tr><td scope="row"><pre>                set end of resultList to x<span></span></pre></td></tr><tr><td scope="row"><pre>            end if<span></span></pre></td></tr><tr><td scope="row"><pre>        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>        return resultList<span></span></pre></td></tr><tr><td scope="row"><pre>end findNumbers<span></span></pre></td></tr></table></div><p>The next statements show how to call <code>findNumbers</code> by passing a predefined <code>list</code> variable:</p><div class="codesample"><table><tr><td scope="row"><pre>set myList to {2, 5, 19.75, 99, 1}<span></span></pre></td></tr><tr><td scope="row"><pre>findNumbers of myList above 19 given rounding:true<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: {20, 99}<span></span></pre></td></tr><tr><td scope="row"><pre>findNumbers of myList above 19 given rounding:false<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: {19.75, 99}<span></span></pre></td></tr></table></div><p>You can also specify the value of the <code>rounding</code> parameter by using a <code>with</code> or <code>without</code> clause to indicate <code>true</code> or <code>false</code>. (In fact, when you compile the previous examples, AppleScript automatically converts <code>given rounding:true</code> to <code>with rounding</code> and <code>given rounding:false</code> to <code>without rounding</code>.) These examples pass a <code>list</code> object directly, rather than using a <code>list</code> variable as in the previous case:</p><div class="codesample"><table><tr><td scope="row"><pre>findNumbers of {5.1, 20.1, 20.5, 33} above 20 with rounding<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: {33}<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>findNumbers of {5.1, 20.1, 20.5, 33.7} above 20 without rounding<span></span></pre></td></tr><tr><td scope="row"><pre>    --result: {20.1, 20.5, 33.7}<span></span></pre></td></tr></table></div><p>Here is another handler that uses parameter labels:</p><div class="codesample"><table><tr><td scope="row"><pre>to check for yourNumber from startRange thru endRange<span></span></pre></td></tr><tr><td scope="row"><pre>    if startRange ≤ yourNumber and yourNumber ≤ endRange then<span></span></pre></td></tr><tr><td scope="row"><pre>        display dialog "Congratulations! Your number is included."<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end check<span></span></pre></td></tr></table></div><p>The following statement calls the handler, causing it to display the <code>"Congratulations!"</code> message</p><div class="codesample"><table><tr><td scope="row"><pre>check for 8 from 7 thru 10 -- call the handler<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH206-SW13" title="Handlers with Positional Parameters"></a><h3>Handlers with Positional Parameters</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_228"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_229"></a>The definition for a handler with positional parameters shows the order in which to list parameters when calling the handler and the statements to be executed when the handler is called. The definition must include parentheses, even if it doesn’t include any parameters. The syntax is shown in <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-166812">“Handler Syntax (Positional Parameters).”</a></span></p><p>In the following example, the <code>minimumValue</code> routine returns the smaller of two values:</p><div class="codesample"><table><tr><td scope="row"><pre>on minimumValue(x, y)<span></span></pre></td></tr><tr><td scope="row"><pre>    if x &lt; y then<span></span></pre></td></tr><tr><td scope="row"><pre>        return x<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        return y<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end minimumValue<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-- To call minimumValue:<span></span></pre></td></tr><tr><td scope="row"><pre>minimumValue(5, 105) --result: 5<span></span></pre></td></tr></table></div><p>The first line of the <code>minimumValue</code> handler specifies the parameters of the handler. To call a handler with positional parameters you list the parameters in the same order as they are specified in the handler definition.</p><p>If a handler call is part of an expression, AppleScript uses the value returned by the handler to evaluate the expression. For example, to evaluate the following expression, AppleScript first calls <code>minimumValue</code>, then evaluates the rest of the expression.</p><div class="codesample"><table><tr><td scope="row"><pre>minimumValue(5, 105) + 50 --result: 55<span></span></pre></td></tr></table></div><a name="//apple_ref/doc/uid/TP40000983-CH206-SW20" title="Handlers with Patterned Positional Parameters"></a><h3>Handlers with Patterned Positional Parameters</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_230"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_231"></a>You can create a handler whose positional parameters define a pattern to match when calling the handler. For example, the following handler takes a single parameter whose pattern consists of two items in a list:</p><div class="codesample"><table><tr><td scope="row"><pre>on displayPoint({x, y})<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog ("x = " &amp; x &amp; ", y = " &amp; y)<span></span></pre></td></tr><tr><td scope="row"><pre>end displayPoint<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-- Calling the handler:<span></span></pre></td></tr><tr><td scope="row"><pre>set testPoint to {3, 8}<span></span></pre></td></tr><tr><td scope="row"><pre>displayPoint(testPoint)<span></span></pre></td></tr></table></div><p>A parameter pattern can be much more complex than a single list. The handler in the next example takes two numbers and a record whose properties include a list of bounds. The handler displays a dialog box summarizing some of the passed information.</p><div class="codesample"><table><tr><td scope="row"><pre>on hello(a, b, {length:l, bounds:{x, y, w, h}, name:n})<span></span></pre></td></tr><tr><td scope="row"><pre>    set q to a + b<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    set response to "Hello " &amp; n &amp; ", you  are " &amp; l &amp; ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        " inches tall and occupy position (" &amp; x &amp;  ", " &amp; y &amp; ")."<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog response<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>end hello<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>set thing to {bounds:{1, 2, 4, 5}, name:"George", length:72}<span></span></pre></td></tr><tr><td scope="row"><pre>hello (2, 3, thing)<span></span></pre></td></tr><tr><td scope="row"><pre>--result: A dialog displaying "Hello George, you are 72 inches  tall<span></span></pre></td></tr><tr><td scope="row"><pre>--          and occupy position (1,2)."<span></span></pre></td></tr></table></div><p>The properties of a record passed to a handler with patterned parameters don’t have to be given in the same order in which they are given in the handler’s definition, as long as all the properties required to fit the pattern are present.</p><p>The following call to <code>minimumValue</code> uses the value from a handler call to <code>maximumValue</code> as its second parameter. The <code>maximumValue</code> handler (not shown) returns the larger of two passed numeric values.</p><div class="codesample"><table><tr><td scope="row"><pre>minimumValue(20, maximumValue(1, 313)) --result: 20<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW11" title="Recursive Handlers"></a><h3>Recursive Handlers</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_232"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_233"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_234"></a>A <strong>recursive handler</strong> is a handler that calls itself. For example, this recursive handler generates a factorial. (The factorial of a number is the product of all the positive integers from 1 to that number. For example, 4 factorial is equal to 1 * 2 * 3 * 4, or 24. The factorial of 0 is 1.)</p>
<div class="codesample"><table><tr><td scope="row"><pre>on factorial(x)<span></span></pre></td></tr><tr><td scope="row"><pre>    if x > 0 then<span></span></pre></td></tr><tr><td scope="row"><pre>        return x * factorial(x - 1)<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        return 1<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end factorial<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-- To call factorial:<span></span></pre></td></tr><tr><td scope="row"><pre>factorial(10)   --result: 3628800<span></span></pre></td></tr></table></div>
<p>In the example above, the handler <code>factorial</code> is called once, passing the value <code>10</code>. The handler then calls itself recursively with a value of <code>x - 1</code>, or <code>9</code>. Each time the handler calls itself, it makes another recursive call, until the value of <code>x</code> is <code>0</code>. When <code>x</code> is equal to <code>0</code>, AppleScript skips to the <code>else</code> clause and finishes executing all the partially executed handlers, including the original <code>factorial</code> call.</p>
<p>When you call a recursive handler, AppleScript keeps track of the variables and pending statements in the original (partially executed) handler until the recursive handler has completed. Because each call uses some memory, the maximum number of pending handlers is limited by the available memory. As a result, a recursive handler may generate an error before the recursive calls complete.</p>
<p>In addition, a recursive handler may not be the most efficient solution to a problem. For example, the factorial handler shown above can be rewritten to use a <code>repeat</code> statement instead of a recursive call, as shown in the example in <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-128207">repeat with loopVariable (from startValue to stopValue)</a></code>.</p><a name="//apple_ref/doc/uid/TP40000983-CH206-SW10" title="Errors in Handlers"></a><h3>Errors in Handlers</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_235"></a>As with any AppleScript statements that may encounter an error, you can use a <code>try</code> statement to deal with possible errors in a handler. A <code><a href="../reference/ASLR_control_statements.html#//apple_ref/doc/uid/TP40000983-CH6g-129232">try</a></code> statement includes two collections of statements: one to be executed in the general case, and a second to be executed only if an error occurs.</p><p>By using one or more <code>try</code> statements with a handler, you can combine the advantages of reuse and error handling in one package. For a detailed example that demonstrates this approach, see <span class="content_text"><a href="../reference/ASLR_error_xmpls.html#//apple_ref/doc/uid/TP40000983-CH221-SW1">“Working with Errors.”</a></span></p><a name="//apple_ref/doc/uid/TP40000983-CH206-SW4" title="Passing by Reference Versus Passing by Value"></a><h3>Passing by Reference Versus Passing by Value</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_236"></a>Within a handler, each parameter is like a variable, providing access to passed information. AppleScript passes all parameters by reference, which means that a passed variable is shared between the handler and the caller, as if the handler had created a variable using the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW52">set</a></code> command. However, it is important to remember a point raised in <span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW7">“Using the copy and set Commands”</a></span>: only mutable objects can actually be changed.</p><p>As a result, a parameter’s class type determines whether information is effectively passed by value or by reference:</p><ul class="spaceabove"><li class="li"><p>For mutable objects (those whose class is <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCGECID">date</a></code>, <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDBHIE">list</a></code>, <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-BBCDGEAH">record</a></code>, or <code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW5">script</a></code>), information is passed <em>by reference</em>:</p><p>If a handler changes the value of a parameter of this type, the original object is changed.</p></li><li class="li"><p>For all other class types, information is effectively passed <em>by value</em>:</p><p>Although AppleScript passes a reference to the original object, that object cannot be changed. If the handler assigns a new value to a parameter of this type, the original object is unchanged.</p></li></ul><p>If you <em>want</em> to pass by reference with a class type other than <code>date</code>, <code>list</code>, <code>record</code>, or <code>script</code>, you can pass a <code>reference</code> object that refers to the object in question. Although the handler will have access only to a copy of the <code>reference</code> object, the specified object will be the same. Changes to the specified object in the handler will change the original object, although changes to the <code>reference</code> object itself will not.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW1" title="Calling Handlers in a tell Statement"></a><h3>Calling Handlers in a tell Statement</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_237"></a>To call a handler from within a <code>tell</code> statement, you must use the reserved words <code>of me</code> or <code>my</code> to indicate that the handler is part of the script and not a command that should be sent to the target of the <code>tell</code> statement.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_238"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_239"></a></p>
<p>For example, the following script calls the <code>minimumValue</code> handler defined in <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW13">“Handlers with Positional Parameters”</a></span> from within a <code>tell</code> statement. If this call did not include the words <code>of me</code>, it would cause an error, because AppleScript would send the <code>minimumValue</code> command to TextEdit, which does not understand that message.</p><div class="codesample"><table><tr><td scope="row"><pre>tell front document of application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>    minimumValue(12, 400) of me<span></span></pre></td></tr><tr><td scope="row"><pre>    set paragraph 1 to result as text<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr><tr><td scope="row"><pre>--result: The handler call is successful.<span></span></pre></td></tr></table></div>
<p>Instead of using the words <code>of me</code>, you could insert the word <code>my</code> before the handler call:</p>
<div class="codesample"><table><tr><td scope="row"><pre>my minimumValue(12, 400)<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW12" title="Saving and Loading Libraries of Handlers"></a><h2>Saving and Loading Libraries of Handlers</h2>
<p>In addition to defining and calling handlers within a script, you can access handlers from other scripts. To make a handler available to another script, save it as a compiled script, then use the <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW35">load script</a></code> command to load it in any script that needs to call the handler. You can use this technique to create libraries containing many handlers.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_240"></a> <a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_241"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_242"></a></p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH206-SW5" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code>load script</code> command loads the compiled script as a <code>script</code> object; for more information, see <span class="content_text"><a href="ASLR_script_objects.html#//apple_ref/doc/uid/TP40000983-CH207-BAJJCIAA">“Script Objects.”</a></span></p></div>
<p>For example, the following script contains two handlers: <code>areaOfCircle</code> and <code>factorial</code>:</p>
<div class="codesample"><table><tr><td scope="row"><pre>-- This handler computes the area of a circle from its radius.<span></span></pre></td></tr><tr><td scope="row"><pre>-- (The area of a circle is equal to pi times its radius squared.)<span></span></pre></td></tr><tr><td scope="row"><pre>on areaOfCircle from radius<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Make sure the parameter is a real number or an integer.<span></span></pre></td></tr><tr><td scope="row"><pre>    if class of radius is contained by {integer, real}<span></span></pre></td></tr><tr><td scope="row"><pre>        return radius * radius * pi -- pi is predefined by AppleScript.<span></span></pre></td></tr><tr><td scope="row"><pre>    else<span></span></pre></td></tr><tr><td scope="row"><pre>        error "The parameter must be a real number or an integer"<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>end areaOfCircle<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>-- This handler returns the factorial of a number.<span></span></pre></td></tr><tr><td scope="row"><pre>on factorial(x)<span></span></pre></td></tr><tr><td scope="row"><pre>    set returnVal to 1<span></span></pre></td></tr><tr><td scope="row"><pre>    if x > 1 then<span></span></pre></td></tr><tr><td scope="row"><pre>        repeat with n from 2 to x<span></span></pre></td></tr><tr><td scope="row"><pre>            set returnVal to returnVal * n<span></span></pre></td></tr><tr><td scope="row"><pre>        end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>    return returnVal<span></span></pre></td></tr><tr><td scope="row"><pre>end factorial<span></span></pre></td></tr></table></div>
<p>In Script Editor, save the script as a compiled Script (which has extension <code>scpt</code>) or Script Bundle (extension <code>scptd</code>) and name it “NumberLib”.</p>
<p>After saving the script as a compiled script, other scripts can use the <code>load script</code> command to load it. For example, the following script loads the compiled script <code>NumberLib.scpt</code>, storing the resulting <code>script</code> object in the variable <code>numberLib</code>. It then makes handler calls within a <code>tell</code> statement that targets the <code>script</code> object. The compiled script must exist in the specified location for this script to work.</p>
<div class="codesample"><table><tr><td scope="row"><pre>set numberLibrary to (load script file "NumberLib.scpt")<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>tell numberLibrary<span></span></pre></td></tr><tr><td scope="row"><pre>    factorial(10)             --result: 3628800<span></span></pre></td></tr><tr><td scope="row"><pre>    areaOfCircle from 12      --result: 452.38934211693<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW14" title="Handlers in Script Applications"></a><h2>Handlers in Script Applications</h2>
<p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_243"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_244"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_245"></a>A <strong>script application</strong> is an application whose only function is to run the script associated with it. Script applications contain handlers that allow them to respond to commands. For example, many script applications can respond to the <code>run</code> command and the <code>open</code> command. A script application receives a <code>run</code> command whenever it is launched and an <code>open</code> command whenever another icon is dropped on its icon in the Finder. It can also contain other handlers to respond to commands such as <code>quit</code> or <code>print</code>.</p><p>When saving a script in Script Editor, you can create a script application by choosing either Application or Application Bundle from the File Format options. Saving as Application results in a simple format that is compatible with Mac OS 9.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_246"></a> Saving as Application Bundle results in an application that uses the modern bundle format, with its specified directory structure, which is supported back to Mac OS X v10.3.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_247"></a></p><p>When creating a script application, you can also specify whether a <a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_248"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_249"></a>startup screen should appear before the application runs its script. Whatever you write in the Description pane of the script window in Script Editor is displayed in the startup screen. <a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_250"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_251"></a>You can also specify in Script Editor whether a script application should stay open after running. The default is for the script to quit immediately after it is run.</p><p>You can run a script application from the Finder much like any other application. If it has a startup screen, the user must click the Run button or press the Return key before the script actually runs.</p><p>Consider the following simple script</p><div class="codesample"><table><tr><td scope="row"><pre>tell application "Finder"<span></span></pre></td></tr><tr><td scope="row"><pre>    close front window<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div><p>What this script does as a script application depends on what you specify when you save it. If you don’t specify a startup screen or tell it to stay open, it will automatically execute once, closing the front Finder window, and then quit.</p><p>If a script application modifies the value of a property, the changed value persists across launches of the application. For related information, see <span class="content_text"><a href="ASLR_variables.html#//apple_ref/doc/uid/TP40000983-CH223-SW1">“Scope of Variables and Properties.”</a></span></p>
<p>For information about some common script application handlers, see the following sections:</p>
<ul class="ul"><li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW15">“run Handlers”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW16">“open Handlers”</a></span></p></li>
<li class="li"><p><span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW7">“idle and quit Handlers for Stay-Open Applications”</a></span></p></li></ul><p>See <span class="content_text"><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163762">“Handler Reference”</a></span> for syntax information.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW15" title="run Handlers"></a><h3>run Handlers</h3><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_252"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_253"></a>When you run a script or launch a script application, its <code>run</code> handler is invoked. A script’s <code>run</code> handler is defined in one of two ways:</p><ul class="spaceabove"><li class="li"><p>As an implicit <code>run</code> handler, which consists of all statements declared outside any handler or nested <code>script</code> object in a script.</p><p>Declarations for properties and <code>global</code> variables are not considered statements in this context—that is, they are not considered to be part of an implicit <code>run</code> handler.</p></li><li class="li"><p>As an explicit <code>run</code> handler, which is enclosed within <code>on run</code> and <code>end</code> statements, similar to other handlers.<a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_254"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_255"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_256"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_257"></a></p></li></ul><p>Having both an implicit and an explicit <code>run</code> handler is not allowed, and causes a syntax error during compilation. If a script has no run handler (for example, a script that serves as a library of handlers, as described in <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW12">“Saving and Loading Libraries of Handlers”</a></span>), executing the script does nothing. However, sending it an explicit <code>run</code> command causes an error.</p>
<p>The following script demonstrates an implicit <code>run</code> handler. The script consists of a statement that invokes the <code>sayHello</code> handler, and the definition for the handler itself:</p>
<div class="codesample"><table><tr><td scope="row"><pre>sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Hello"<span></span></pre></td></tr><tr><td scope="row"><pre>end sayHello<span></span></pre></td></tr></table></div>
<p>The implicit <code>run</code> handler for this script consists of the statement <code>sayHello()</code>, which is the only statement outside the handler. If you save this script as a script application and then run the application, the script receives a <code>run</code> command, which causes it to execute the one statement in the implicit <code>run</code> handler.</p>
<p>You can rewrite the previous script to provide the exact same behavior with an explicit <code>run</code> handler:</p>
<div class="codesample"><table><tr><td scope="row"><pre>on run<span></span></pre></td></tr><tr><td scope="row"><pre>    sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre>end run<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>on sayHello()<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Hello"<span></span></pre></td></tr><tr><td scope="row"><pre>end sayHello<span></span></pre></td></tr></table></div>
<p>Whether a script is saved as a script application or as a compiled script, its <code>run</code> handler is invoked when the script is run. You can also invoke a <code>run</code> handler in a script application from another script. For information about how to do this, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW17">“Calling a Script Application From a Script.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW16" title="open Handlers"></a><h3>open Handlers</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_258"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_259"></a>Mac OS X applications, including script applications, receive an <code>open</code> command whenever the user drops file, folder, or disk icons on the application’s Finder icon, even if the application is already running.</p>
<p>If the script in a script application includes an <code>open</code> handler, the handler is executed when the application receives the <code>open</code> command. The <code>open</code> handler takes a single parameter which provides a list of all the items to be opened. Each item in the list is an<code><a href="../reference/ASLR_classes.html#//apple_ref/doc/uid/TP40000983-CH1g-SW3">alias</a></code> object.</p>
<p>For example, the following <code>open</code> handler makes a list of the pathnames of all items dropped on the script application’s icon and saves them in the frontmost TextEdit document:</p>
<div class="codesample"><table><tr><td scope="row"><pre>on open names<span></span></pre></td></tr><tr><td scope="row"><pre>    set pathNamesString to "" -- Start with empty text string.<span></span></pre></td></tr><tr><td scope="row"><pre>    repeat with i in names<span></span></pre></td></tr><tr><td scope="row"><pre>        -- In this loop, you can perform operations on each dropped item.<span></span></pre></td></tr><tr><td scope="row"><pre>        -- For now, just get the name and append a return character.<span></span></pre></td></tr><tr><td scope="row"><pre>        set iPath to (i as text)<span></span></pre></td></tr><tr><td scope="row"><pre>        set pathNamesString to pathNamesString &amp; iPath &amp; return<span></span></pre></td></tr><tr><td scope="row"><pre>    end repeat<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Store list in open document, to verify what was dropped.<span></span></pre></td></tr><tr><td scope="row"><pre>    tell application "TextEdit"<span></span></pre></td></tr><tr><td scope="row"><pre>        set paragraph 1 of front document to pathNamesString<span></span></pre></td></tr><tr><td scope="row"><pre>    end tell<span></span></pre></td></tr><tr><td scope="row"><pre>    return<span></span></pre></td></tr><tr><td scope="row"><pre>end open<span></span></pre></td></tr></table></div>
<p>Files, folders, or disks are not moved, copied, or affected in any way by merely dropping them on a script application. However, the script application’s handler can tell Finder to move, copy, or otherwise manipulate the items. For examples that work with Finder items, see <span class="content_text"><a href="../reference/ASLR_folder_actions.html#//apple_ref/doc/uid/TP40000983-CH219-SW2">“Folder Actions Reference.”</a></span></p>
<p>You can also run an <code>open</code> handler by sending a script application the <code>open</code> command. For details, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW17">“Calling a Script Application From a Script.”</a></span></p>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW7" title="idle and quit Handlers for Stay-Open Applications"></a><h3>idle and quit Handlers for Stay-Open Applications</h3>
<p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_260"></a>By default, a script application that receives a <code>run</code> or <code>open</code> command handles that single command and then quits. In contrast, a stay-open script application (one saved as Stay Open in Script Editor) stays open after it is launched.</p>
<p>A stay-open script application can be useful for several reasons:</p>
<ul class="spaceabove">
<li class="li"><p>Stay-open script applications can receive and handle other commands in addition to <code>run</code> and <code>open</code>. This allows you to use a script application as a script server that, when it is running, provides a collection of handlers that can be invoked by any other script.</p></li>
<li class="li"><p>Stay-open script applications can perform periodic actions, even in the background, as long as the script application is running.</p></li></ul><p>Two particular handlers that stay-open script applications often provide are an <code>idle</code> handler and a <code>quit</code> handler.</p>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW8" title="idle Handlers"></a><h4>idle Handlers</h4>
<p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_261"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_262"></a>If a stay-open script application includes an <code>idle</code> handler, AppleScript sends the script application periodic <code>idle</code> commands—by default, every 30 seconds—allowing it to perform background tasks when it is not performing other actions.</p><p>If an <code>idle</code> handler returns a positive number, that number becomes the rate (in seconds) at which the handler is called. If the handler returns a non-numeric value, the rate is not changed. You can return 0 to maintain the default delay of 30 seconds.</p>
<p>For example, when saved as a stay-open application, the following script beeps every 5 seconds:</p>
<div class="codesample"><table><tr><td scope="row"><pre>on idle<span></span></pre></td></tr><tr><td scope="row"><pre>    beep<span></span></pre></td></tr><tr><td scope="row"><pre>    return 5<span></span></pre></td></tr><tr><td scope="row"><pre>end idle<span></span></pre></td></tr></table></div>
<p>The result returned from a handler is just the result of the last statement, even if it doesn’t include the word <code>return</code> explicitly. (See <code><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-163937">“return”</a></code> for more information.) For example, this handler gets called once a minute, because the value of the last statement is 60:</p>
<div class="codesample"><table><tr><td scope="row"><pre>on idle<span></span></pre></td></tr><tr><td scope="row"><pre>    set x to 10<span></span></pre></td></tr><tr><td scope="row"><pre>    beep<span></span></pre></td></tr><tr><td scope="row"><pre>    set x to x * 6  -- The handler returns the result (60).<span></span></pre></td></tr><tr><td scope="row"><pre>end idle<span></span></pre></td></tr></table></div>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW9" title="quit Handlers"></a><h4>quit Handlers</h4>
<p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_263"></a><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_264"></a>AppleScript sends a stay-open script application a <code>quit</code> command whenever the user chooses the Quit menu command or presses Command-Q while the application is active. If the script includes a <code>quit</code> handler, the statements in the handler are run before the application quits.</p>
<p>A <code>quit</code> handler can be used to set script properties, tell another application to do something, display a dialog box, or perform almost any other task. If the handler includes a <code>continue quit</code> statement, the script application’s default quit behavior is invoked and it quits. If the <code>quit</code> handler returns before it encounters a <code>continue quit</code> statement, the application doesn’t quit.</p><div class="notebox"><a name="//apple_ref/doc/uid/TP40000983-CH206-SW6" title="Note"></a><p><strong>Note:</strong>&nbsp;The <code>continue</code> statement passes control back to the application’s default <code>quit</code> handler. For more information, see <code><a href="../reference/ASLR_handlers.html#//apple_ref/doc/uid/TP40000983-CH7g-SW1">“continue”</a></code>.</p></div>
<p>For example, this handler checks with the user before allowing the application to quit:</p>
<div class="codesample"><table><tr><td scope="row"><pre>on quit<span></span></pre></td></tr><tr><td scope="row"><pre>    display dialog "Really quit?" ¬<span></span></pre></td></tr><tr><td scope="row"><pre>        buttons {"No", "Quit"} default button  "Quit"<span></span></pre></td></tr><tr><td scope="row"><pre>    if the button returned of the result is "Quit" then<span></span></pre></td></tr><tr><td scope="row"><pre>        continue quit<span></span></pre></td></tr><tr><td scope="row"><pre>    end if<span></span></pre></td></tr><tr><td scope="row"><pre>    -- Without the continue statement, the application doesn't quit.<span></span></pre></td></tr><tr><td scope="row"><pre>end quit<span></span></pre></td></tr></table></div>
<div class="warningbox"><img src="../../../../Resources/Images/icon_warning.gif" alt="!" width="20" height="20" border="0" class="warningicon" /><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_8" title="Warning:"></a><p><strong>Warning:</strong>&nbsp;

If AppleScript doesn’t encounter a <code>continue quit</code> statement while executing an <code>on quit</code> handler, it may seem to be impossible to quit the application. For example, if the handler shown above gets an error before the <code>continue quit</code> statement, the application won’t quit. If necessary, you can use Force Quit (Command-Option-Esc) to halt the application. <a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_265"></a></p><p></p><div class="clear"></div></div>
<a name="//apple_ref/doc/uid/TP40000983-CH206-SW17" title="Calling a Script Application From a Script"></a><h2>Calling a Script Application From a Script</h2><p><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_266"></a>A script can send commands to a script application just as it can to other applications. To launch a non-stay-open application and run its script, use a <code><a href="../reference/ASLR_cmds.html#//apple_ref/doc/uid/TP40000983-CH216-SW51">launch</a></code> command followed by a <code>run</code> command, like this:</p>
<div class="codesample"><table><tr><td scope="row"><pre>launch application "NonStayOpen"<span></span></pre></td></tr><tr><td scope="row"><pre>run application "NonStayOpen"<span></span></pre></td></tr></table></div>
<p>The <code>launch</code> command launches the script application without sending it an implicit <code>run</code> command. When the <code>run</code> command is sent to the script application, it processes the command, sends back a reply if necessary, and quits.</p>
<p>Similarly, to launch a non-stay-open application and run its <code>stringTest</code> handler (which takes a <code>text</code> object as a parameter), use a <code>launch</code> command followed by a <code>stringTest</code> command, like this:</p>
<div class="codesample"><table><tr><td scope="row"><pre>tell application "NonStayOpen"<span></span></pre></td></tr><tr><td scope="row"><pre>    launch<span></span></pre></td></tr><tr><td scope="row"><pre>    stringTest("Some example text.")<span></span></pre></td></tr><tr><td scope="row"><pre>end tell<span></span></pre></td></tr></table></div>
<p>For information on how to create script applications, see <span class="content_text"><a href="ASLR_about_handlers.html#//apple_ref/doc/uid/TP40000983-CH206-SW14">“Handlers in Script Applications.”</a></span><a name="//apple_ref/doc/uid/TP40000983-CH206-DontLinkElementID_267"></a></p>

        <br /><br /> 
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="ASLR_script_objects.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="../reference/ASLR_classes.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-03-11<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_about_handlers.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_about_handlers.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/AppleScript/Conceptual/AppleScriptLangGuide/conceptual/ASLR_about_handlers.html%3Fid%3DTP40000983-3.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>