<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>MeasureJustified(IM: Tx)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING166></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Text-165.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-167.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Text-2.html"><B>Text</B></A> / <BR><DD><A HREF="Text-126.html"><B>Chapter 3 - QuickDraw Text</B></A> / <A HREF="Text-143.html"><B>QuickDraw Text Reference</B></A><BR><DL><DD><A HREF="Text-147.html"><B>Routines</B></A> / <A HREF="Text-161.html"><B>Measuring Text</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING166-0></A>
<H3><A NAME=MARKER-9-329></A><A NAME=MARKER-2-364></A><A NAME=MARKER-2-250></A>MeasureJustified</H3>
 For text that is expanded, condensed, or scaled, the <A NAME=MARKER-2-236></A><CODE>MeasureJustified</CODE> procedure calculates the onscreen width in pixels from the left edge of the text segment to the glyph of the character.<P>
<PRE>
PROCEDURE MeasureJustified (textPtr: Ptr; textLength: LongInt;
                            slop: Fixed; charLocs: Ptr;
                            styleRunPosition: JustStyleCode;
                            numer, denom: Point);
</PRE>
<DL>
<DT><CODE>textPtr</CODE>
<DD> A pointer to the memory location of the beginning of the text to <BR>be measured.
<DT><CODE>textLength</CODE>
<DD> The number of bytes of text to be measured. The text length should equal the entire visible part of the text on a line, including trailing spaces if and only if they are displayed. Otherwise, the results for the last glyph on the line may be invalid.
<DT><CODE>slop</CODE>
<DD> The amount of slop for the text to be drawn. A positive value extends the text segment; a negative value condenses the text segment.
<DT><CODE>charLocs</CODE>
<DD> A pointer to an application-defined array of <CODE>textLength</CODE> + 1 integers.
<DT><CODE>styleRunPosition</CODE>
<DD> The position on the line of this style run. The style run can be the only one on the line, the leftmost on the l<A NAME=MARKER-2-421></A>ine, the rightmost on the line, or one between two other style runs.
<DT><CODE>numer</CODE>
<DD> A point giving the numerator for the horizontal and vertical <BR>scaling factors.
<DT><CODE>denom</CODE>
<DD> A point giving the denominator for the horizontal and vertical <BR>scaling factors.
</DL>
<A NAME=HEADING166-10></A>
<H5>DESCRIPTION</H5>
 The <CODE>MeasureJustified</CODE> procedure is similar to the <CODE>MeasureText</CODE> procedure, except that it is used to find the pixel location of a character's glyph in text that is expanded or condensed.<P>
 The <CODE>MeasureJustified</CODE> procedure calculates the onscreen pixel width of the glyph of each character beginning from the left edge of the text segment, taking into account <CODE>slop</CODE> value, scaling, and style run position.<P>
 On return, the first element in the <CODE>charLocs</CODE> array contains 0 and the last element contains the total width of the text segment, when the primary line direction is left to right and the text is unidirectional. When the primary line direction is right to left and the text is unidirectional, the first element in the array contains the total width of the text segment, and the last element in the array contains 0. When the text is bidirectional, at a direction boundary, <CODE>MeasureJustified</CODE> selects the character whose direction maps to that of the primary line direction.<P>
 The <CODE>MeasureJustified</CODE> procedure returns the same results that an application would get if it called <CODE>CharToPixel</CODE> for each character with a direction parameter value of <CODE>hilite</CODE>. Using <CODE>MeasureJustified</CODE> to find the pixel location of a character's glyph is less efficient than using the <CODE>CharToPixel</CODE> function because the application must define the array pointed to by <CODE>charLocs</CODE>, and then walk the array after <CODE>MeasureText</CODE> returns the results.<P>
 The <CODE>MeasureJustified</CODE> procedure temporarily resets the space extra (<CODE>spExtra</CODE>) value, adding to the current value of the field, if any, the amount of extra space to be added to space characters in order to fully justify the text, based on calculations that take into account the slop value and all the text characteristics. On exit, <CODE>MeasureJustified</CODE> restores the original value.<P>
 Because MeasureJustified measures text in only the current font, style, and size, you need to call it once for each individual style run.<P>
 For more information about the scaling factors, see <A HREF=Text-147.html#MARKER-9-256>"The numer and denom Parameters" on page 3-64</A>. See <A HREF=Text-147.html#MARKER-9-255>"The styleRunPosition Parameter" on page 3-63</A> for a description of the <CODE>styleRunPosition</CODE> parameter and the values it takes. See <A HREF=Text-147.html#MARKER-9-254>"The slop Parameter" on page 3-63</A> for more information about the <CODE>slop</CODE> parameter.<P>
 For additional information about <CODE>MeasureJustified</CODE>, contact Developer <BR>Technical Support.<P>
<A NAME=HEADING166-19></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The MeasureJustified procedure works properly for text in all script systems. For 1-byte complex script systems, MeasureJustified calculates the widths of any ligatures, reversals, and compound characters that would need to be drawn.<P>
 Note that <CODE>textLen</CODE>gth is the number of <I>bytes</I> to be drawn, not the number of characters. Because 2-byte script systems also include characters consisting of only one byte, you should not simply multiply the number of characters by 2 to determine this value; the application must determine and specify the correct number of bytes.<P>
 Some 1-byte script system fonts may have zero-width characters, which are usually overlapping diacritical marks that typically follow the base character in memory. In this case, <CODE>MeasureJustified</CODE> measures both the glyph of the base character (the high-order, low-address byte) and the width of the diacritical mark. The <CODE>charLoc</CODE> array includes an entry for each, but both entries contain the same value.<P>
 For 1-byte complex script systems, <CODE>MeasureJustified</CODE> calculates the widths of any ligatures, reversals, compound characters, and character clusters that need to be drawn. For example, for an Arabic ligature, the entry that corresponds to the trailing edge of each character that is part of the ligature is the trailing edge of the entire ligature.<P>
 The <CODE>MeasureJustified</CODE> procedure may move memory; do not call this procedure at interrupt time.<A NAME=MARKER-2-363></A><A NAME=MARKER-9-381></A><A NAME=MARKER-2-213></A><A NAME=MARKER-2-337></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Text-165.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Text-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Text-594.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Text-167.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Text-3.html">&copy; Apple Computer, Inc.</A><br>6 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
