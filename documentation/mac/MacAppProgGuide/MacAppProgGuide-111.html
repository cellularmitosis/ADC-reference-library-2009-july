<!-- Generated by Harlequin WebMaker 2.2.3 (30-Apr-1996)
Macintosh Common Lisp Version 3.0kp2p2 [AppGen 3.0b1kp2p2] -->
<HTML> <HEAD>
<TITLE>Recipes--The Keyboard (MacApp PG)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING111></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="MacAppProgGuide-110.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-112.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="MacAppProgGuide-2.html"><B>Programmer's Guide to MacApp</B></A> / <A HREF="MacAppProgGuide-78.html"><B>Part 2 - Working With MacApp</B></A><BR><DD><A HREF="MacAppProgGuide-109.html"><B>Chapter 20 - Working With the Keyboard</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING111-0></A>
<H1><A NAME=MARKER-2-33></A>Recipes--The Keyboard</H1>
 The recipes and sample code in this section demonstrate how to work with various kinds of keystrokes in a MacApp application.<P>
<A NAME=HEADING111-2></A>
<H2><A NAME=MARKER-9-34></A><A NAME=MARKER-2-35></A>Working With the Keyboard--A General Outline</H2>
 MacApp gives event-handler objects and behavior objects in the target chain a chance to handle keystrokes. Your application normally works with keystrokes in three ways:<P>
<OL>
<LI>If the Command key is not held down when a key is pressed, MacApp calls the <CODE>HandleKeyCommand</CODE> method of the current target object, which in turn calls the <CODE>DoKeyEvent</CODE> method. To handle a keystroke in your application, do the following:<P>
<UL>
<LI>Override the <CODE>DoKeyEvent</CODE> method of an event-handling or behavior class. 
<LI>Use the <CODE>TToolboxEvent</CODE> parameter to <CODE>DoKeyEvent</CODE> to determine if the key is one you wish to handle. Identify the key by examining the parameter's <CODE>fCharacter</CODE> field.
<LI>If the character is one you wish to handle, perform the desired action.
<LI>If the character is <I>not</I> one you wish to handle, call <CODE>Inherited::DoKeyEvent</CODE> to give other event-handler and behavior objects in the target chain a chance to handle the keystroke.<P>
For a detailed example, see the next section, <A HREF=MacAppProgGuide-117.html#MARKER-9-70>"Recipe--Handling a Keystroke Other Than a Command-Key Combination."</A><P>
</UL>
<LI>If the keystroke is a Command-key combination and it has a menu command equivalent, MacApp calls the <CODE>DoMenuCommand</CODE> method of the current target object, just as if the user had selected the menu command with the mouse.<P>
For a detailed example, see <A HREF=MacAppProgGuide-117.html#MARKER-9-66>"Recipe--Responding to a Command-Key Combination," beginning on page 481</A>.
<LI>If the keystroke is a Command-key combination and it does <I>not</I> have a menu command equivalent, MacApp calls the <CODE>HandleCommandKey</CODE> method of the current target object, which in turn calls the <CODE>DoCommandKeyEvent</CODE> method. This call travels along the target chain until it is handled by one of the event-handler or behavior objects in the chain. To handle Command-key combinations of this type, do the following:<P>
<UL>
<LI>Override the <CODE>DoCommandKeyEvent</CODE> method of an event-handling or behavior class.
<LI>Use the <CODE>TToolboxEvent</CODE> parameter to <CODE>DoCommandKeyEvent</CODE> to determine whether the key is one you wish to handle. Identify the key that was pressed along with the Command key by examining the parameter's <CODE>fCharacter</CODE> field.
<LI>If the character is one you wish to handle, perform the desired action.
<LI>If the character is <I>not</I> one you wish to handle, call <CODE>Inherited::DoCommandKeyEvent</CODE> to give other event-handler objects and behaviors in the target chain a chance to handle the keystroke.<P>
For a detailed example, see <A HREF=MacAppProgGuide-117.html#MARKER-9-66>"Recipe--Responding to a Command-Key Combination," beginning on page 481</A>.<A NAME=MARKER-2-36></A><P>
</UL>
</OL>
<A NAME=HEADING111-18></A>
<H2><A NAME=MARKER-2-37></A><A NAME=MARKER-9-70></A>Recipe--Handling a Keystroke Other Than a Command-Key Combination</H2>
 To handle a keystroke other than a Command-key combination, you perform only one step.<P>
<OL>
<LI>Override the <CODE>DoKeyEvent</CODE> method of an event-handling or behavior class.<P>
<UL>
<LI>If the key is one you wish to handle, perform the desired action.
<LI>If the key is <I>not</I> one you wish to handle, call <CODE>Inherited</CODE> to pass on the keystroke.<P>
</UL>
</OL>
 The sample code shown in this recipe is from the DemoDialogs application.<P>
<A NAME=HEADING111-24></A>
<H3>Override the DoKeyEvent Method of an Event-Handling or Behavior Class</H3>
 The DemoDialogs sample application uses the <CODE>TMonthlyDialog</CODE> view class to display a window containing 12 number-entry views labeled with the months of the year. TMonthlyDialog overrides the <CODE>DoKeyEvent</CODE> method to set the target to the view's window whenever the user presses the Option-Tab combination.<P>
 The DoKeyEvent method uses the <CODE>fCharacter</CODE> field of the <CODE>TToolboxEvent</CODE> parameter to determine whether the Tab key was pressed and uses the IsOptionKeyPressed method to check for the Option key. If the keystroke is Option-Tab, DoKeyEvent sets the current target object to the view's window. If not, it calls <CODE>Inherited</CODE> to give other objects in the target chain a chance to handle the keystroke. Your application can use similar code when it needs to process a simple keystroke or a particular keystroke combination.<P>
<DL>
<DT><B>Note</B>
<DD>The DemoDialogs application processes the Option-Tab key combination to demonstrate setting the target object. However, your application may want to avoid using Option-Tab because MacApp uses that combination to tab between the mailer view and the document view for documents with PowerTalk mailers.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
<PRE>
void TMonthlyDialog::DoKeyEvent(TToolboxEvent* event) // Override.
{
   TWindow * theWindow = NULL;
   Boolean dummy;
   
   // If Option-Tab is pressed, make the view's window the current
   // target. This is for test purposes only.
   if ((event-&gt;fCharacter == chTab) &amp;&amp; (event-&gt;IsOptionKeyPressed()))
   {
      // Get the view's window and make it the current target.
      // The return value indicates whether the window actually
      // became the target. Since we're just testing, ignore the
      // return value.
      theWindow = this-&gt;GetWindow();
      if (theWindow != NULL)
         dummy = theWindow-&gt;BecomeTarget();
   }
   else
      Inherited::DoKeyEvent(event);
}
</PRE>
<A NAME=HEADING111-29></A>
<H2><A NAME=MARKER-2-39></A><A NAME=MARKER-9-66></A>Recipe--Responding to a Command-Key Combination</H2>
 When your application receives a Command-key combination that has a menu command equivalent, MacApp calls the <CODE>HandleMenuCommand</CODE> method of the current target object, which in turn calls the <CODE>DoMenuCommand</CODE> method, passing the command constant for the menu command. Your application responds by overriding the <CODE>DoMenuCommand</CODE> method of an event-handling or behavior class, as described in <A HREF=MacAppProgGuide-147.html#MARKER-9-28>"Recipe--Adding, Enabling, and Responding to a Menu Command," beginning on page 314</A>.<P>
 When your application receives a Command-key combination that does <I>not</I> have a menu command equivalent, MacApp calls the <CODE>DoCommandKeyEvent</CODE> method of the current target object. To respond to the Command-key combination, you perform only one step:<P>
<OL>
<LI>Override the <CODE>DoCommandKeyEvent</CODE> method of an event-handling or behavior class.<P>
<UL>
<LI>Determine whether the key is one you wish to handle.
<LI>If so, perform the desired action.
<LI>If not, call <CODE>Inherited</CODE> to pass on the keystroke.<P>
</UL>
</OL>
 The sample code shown in this recipe is based on the <CODE>TDialogBehavior</CODE> class from the MacApp class library.<P>
<A NAME=HEADING111-37></A>
<H3>Override DoCommandKeyEvent in an Event-Handling or Behavior Class</H3>
 MacApp uses the <CODE>TDialogView</CODE> view class to provide standard dialog-box behavior. The <CODE>TDialogView</CODE> class has few methods and fields--most of its behavior is supplied by an attached behavior object of type TDialogBehavior. For example, TDialogBehavior overrides the DoCommandKeyEvent method to check for the Command-period combination. When it finds this combination, it cancels the dialog; otherwise, it calls Inherited::DoCommandKeyEvent to give other behaviors and event-handler objects in the target chain a chance to handle the keystroke.<P>
 The TDialogBehavior::DoCommandKeyEvent method is shown below. It uses the <CODE>fCharacter</CODE> field of the <CODE>TToolboxEvent</CODE> parameter to determine whether the period key was pressed. If the behavior has a view and the view is enabled and the keystroke is a period and the view can be dismissed, DoCommandKeyEvent attempts to cancel the dialog box. Otherwise, it calls <CODE>Inherited</CODE> to give other objects in the target chain a chance to handle the keystroke.<P>
<PRE>
void TDialogBehavior::<A NAME=MARKER-2-41></A>DoCommandKeyEvent(TToolboxEvent* event) // Override. 
{
	// Maps Command-period to the cancel item (view).
	TView* owner = ( TView* )fOwner;

	if (owner &amp;&amp; owner-&gt;IsEnabled() &amp;&amp; event-&gt;fCharacter == '.'
		&amp;&amp; ((long)fCancelItem != (long)kNoIdentifier))
	{
		TView* cancelView = owner-&gt;FindSubView(fCancelItem);
		if (cancelView)
		{
			if (cancelView-&gt;IsEnabled())
			{
				cancelView-&gt;HandleEvent(cancelView-&gt;GetEventNumber(), owner, NULL);
			}
		}
		else
			owner-&gt;HandleEvent(mCancelKey, owner, NULL);
	}
	else
		Inherited::DoCommandKeyEvent(event);
}<A NAME=MARKER-2-42></A><A NAME=MARKER-2-43></A>
</PRE>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="MacAppProgGuide-110.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="MacAppProgGuide-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="MacAppProgGuide-158.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="MacAppProgGuide-112.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="MacAppProgGuide-3.html">&copy; Apple Computer, Inc.</A><br>25 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
