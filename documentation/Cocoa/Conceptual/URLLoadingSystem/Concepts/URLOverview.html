<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>URL Loading System: URL Loading System Overview</title>
	<meta id="Generator" name="Generator" content="Gutenberg"/>
	<meta id="GeneratorVersion" name="GeneratorVersion" content="v132"/>
	<meta http-equiv="content-type" content="text/html;charset=utf-8"/>
	<meta id="Copyright" name="Copyright" content="Copyright 2009 Apple Inc. All Rights Reserved."/>
	<meta id="IndexTitle" name="IndexTitle" content="URL Loading System Overview"/>
	<meta id="xcode-display" name="xcode-display" content="render"/>
	<meta id="toc-file" name="toc-file" content="../toc.html"/>
	<meta id="RESOURCES" content="../../../../Resources" />
	
	<link rel="stylesheet" type="text/css" href="../../../../Resources/CSS/frameset_styles.css"/>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/prototype.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/lib/scriptaculous.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/page.js"></script>
	<script language="JavaScript" type="text/javascript" src="../../../../Resources/JavaScript/pedia.js"></script>
	<!--[if lte IE 6]>
		<style type="text/css">
			/*<![CDATA[*/ 
			html {overflow-x:auto; overflow-y:hidden;  }
			/*]]>*/
		</style>
	<![endif]-->
</head>
<body bgcolor="#ffffff" onload="initialize_page();"><a name="//apple_ref/doc/uid/20001834" title="URL Loading System Overview"></a>
    <noscript>
    <div id="tocMenu">
        <iframe id="toc_content" name="toc_content" SRC="../toc.html" width="210" height="100%" align="left" frameborder="0">This document set is best viewed in a browser that supports iFrames.</iframe>
    </div>
    </noscript>
    <div id="bodyText">
        <a name="top"></a>
        <div class="hideOnPrint hideInXcode">
        <!-- start of header -->
        <!--#include virtual="/includes/framesetheader" -->
        <!-- end of header -->
        </div>
        
        <!-- start of path -->
<div class="breadcrumb hideOnPrint hideInXcode"><a href="http://developer.apple.com/" target="_top">ADC Home</a> &gt; <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> &gt; <a href="../../../../index.html#//apple_ref/doc/uid/TP30000440" target="_top">Guides</a> &gt; <a href="../../../index.html#//apple_ref/doc/uid/TP30000440-TP30000416" target="_top">Cocoa</a> &gt; <a href="../../../Networking-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000453" target="_top">Networking</a> &gt; <a href="../index.html" target="_top">URL Loading System</a> &gt; </div><br class="hideInXcode"/><!-- end of path -->
        
        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../URLLoadingSystem.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="AsyncConnection.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCUpperSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" hideText="Hide TOC" showText="Show TOC" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>
        
        
        <a name="//apple_ref/doc/uid/20001834-BAJEAIEE" title="URL Loading System Overview"></a><hr /><H1>URL Loading System Overview</H1><p>The URL loading system is a set of classes and protocols that provide the underlying capability for an application to access the data specified by a URL. </p><p>These classes fall into five categories: URL loading, cache management, authentication and credentials, cookie storage, and protocol support.</p><br/><div><a name="//apple_ref/doc/uid/20001834-156829" title="Figure 1The URL loading system class hierarchy"></a><p><strong>Figure 1&nbsp;&nbsp;</strong>The URL loading system class hierarchy</p><img src = "art/nsobject_hierarchy.gif" alt = "The URL loading system class hierarchy" width="425" height="382"></div><br/>
<!-- This template is being used for both PDF and HTML. -->

    
    <!-- TopicBook.pm uses this template for its miniTOCs, but needs a different title. -->
    <h4>Contents:</h4>
    
    
    <p class="blockquote">
    
        
			
			
				<a href="URLOverview.html#//apple_ref/doc/uid/20001834-156642">URL Loading</a>
				
			<br/>
			
        
			
			
				<a href="URLOverview.html#//apple_ref/doc/uid/20001834-155585-BCIBICDJ">Cache Management</a>
				
			<br/>
			
        
			
			
				<a href="URLOverview.html#//apple_ref/doc/uid/20001834-155630">Authentication and Credentials</a>
				
			<br/>
			
        
			
			
				<a href="URLOverview.html#//apple_ref/doc/uid/20001834-157091">Cookie Storage</a>
				
			<br/>
			
        
			
			
				<a href="URLOverview.html#//apple_ref/doc/uid/20001834-155857">Protocol Support</a>
				
			<br/>
			
        

    </p><br/>

<a name="//apple_ref/doc/uid/20001834-156642" title="URL Loading"></a><h2>URL Loading</h2><p>The most commonly used classes in the URL loading system allow an application to create a request for the content of a URL and download it from the source. </p><p>A request for the contents of a URL is represented by an <code>NSURLRequest</code> object. The <code>NSURLRequest</code> class encapsulates a URL and any protocol-specific properties, in a protocol-independent manner. It also provides an interface to set the timeout for a connection and specifies the policy regarding the use of any locally cached data. The <code>NSMutableURLRequest</code> class is a mutable subclass of <code>NSURLRequest</code> that allows a client application to alter an existing request. </p><div class="notebox"><a name="//apple_ref/doc/uid/20001834-DontLinkElementID_4" title="Note"></a><p><strong>Note:</strong>&nbsp;When a client application initiates a connection or download using an instance of <code>NSMutableURLRequest</code>, a deep copy is made of the request. Changes made to the initiating request have no effect once a download has been initialized.</p></div><p>Protocols, such as HTTP, that support protocol-specific properties must create categories on the <code>NSURLRequest</code> and <code>NSMutableURLRequest</code> classes to provide accessors for those properties. As an example, the HTTP protocol adds methods to <code>NSURLRequest</code> to return the HTTP request body, headers, and transfer method. It also adds methods to <code>NSMutableURLRequest</code> to set the corresponding values. Methods for setting and getting property values in those accessors are exposed in the <code>NSURLProtocol</code> class.</p><p>The response from a server to a request can be viewed as two parts: metadata describing the contents and the URL content data. The metadata that is common to most protocols is encapsulated by the <code>NSURLResponse</code> class and consists of the MIME type, expected content length, text encoding (where applicable), and the URL that provided the response. Protocols can create subclasses of <code>NSURLResponse</code> to store protocol-specific metadata. <code><a href="../../../Reference/Foundation/Classes/NSHTTPURLResponse_Class/Reference/Reference.html#//apple_ref/occ/cl/NSHTTPURLResponse" target="_top">NSHTTPURLResponse</a></code>, for example, stores the headers and the status code returned by the web server.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001834-DontLinkElementID_5" title="Note"></a><p><strong>Note:</strong>&nbsp;It’s important to remember that only the metadata for the response is stored in an <code>NSURLResponse</code> object. An <code>NSCachedURLResponse</code> instance is used to encapsulate an <code>NSURLResponse</code>, the URL content data, and any application-provided information. See <span class="content_text"><a href="URLOverview.html#//apple_ref/doc/uid/20001834-155585">“Cache Management”</a></span> for details.</p></div><p>The <code>NSURLConnection</code> and <code>NSURLDownload</code> classes provide the interface to make a connection specified by an <code>NSURLRequest</code> object and download the contents. An <code>NSURLConnection</code> object provides data to the delegate as it is received from the originating source, whereas an <code>NSURLDownload</code> object writes the request data directly to disk. Both classes provide extensive delegate support for responding to redirects, authentication challenges, and error conditions. </p><p>the <code>NSURLConnection</code> class provides a delegate method that allows an application to control the caching of a response on a per-request basis. Downloads initiated by an <code>NSURLDownload</code> instance are not cached.</p><a name="//apple_ref/doc/uid/20001834-155585" title="Cache Management"></a><a name="//apple_ref/doc/uid/20001834-155585-BCIBICDJ" title="Cache Management"></a><h2>Cache Management</h2><p>The URL loading system provides a composite on-disk and in-memory cache allowing an application to reduce its dependence on a network connection and provide faster turnaround for previously cached responses. The cache is stored on a per-application basis.</p><p>The cache is queried by NSURLConnection or NSURLDownload according to the cache policy specified by the initiating NSURLRequest. </p><p>The NSURLCache class provides methods to configure the cache size and its location on disk. It also provides methods to manage the collection of NSCachedURLResponse objects that contain the cached responses. </p><p>An NSCachedURLResponse encapsulates the NSURLResponse and the URL content data. NSCachedURLResponse also provides a user info dictionary that can be used by an application to cache any custom data.</p><p>Not all protocol implementations support response caching. Currently only <code>http</code> and <code>https</code> requests are cached, and <code>https</code> requests are never cached to disk. </p><p>An NSURLConnection can control whether a response is cached and whether the response should be cached only in memory by implementing the <code>connection:willCacheResponse:</code> delegate method.</p><a name="//apple_ref/doc/uid/20001834-155630" title="Authentication and Credentials"></a><h2>Authentication and Credentials</h2><p>Some servers restrict access to certain content, requiring a user to authenticate with a valid user name and password in order to gain access. In the case of a web server, restricted content is grouped together into a realm that requires a single set of credentials.</p><p>The URL loading system provides classes that model credentials and protected areas as well as providing secure credential persistence. Credentials can be specified to persist for a single request, for the duration of an application’s launch, or permanently in the user’s keychain.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001834-DontLinkElementID_6" title="Note"></a><p><strong>Note:</strong>&nbsp;Credentials stored in persistent storage are kept in the user's keychain and shared among all applications.</p></div><p>The NSURLCredential class encapsulates a credential consisting of the user name, password, and the type of persistence to use. The NSURLProtectionSpace class represents an area that requires a specific credential. A protection space can be limited to a single URL, encompass a realm on a web server, or refer to a proxy.</p><p>A shared instance of the NSURLCredentialStorage class manages credential storage and provides the mapping of an NSURLCredential object to the corresponding NSURLProtectionSpace object for which it provides authentication.</p><p>The NSURLAuthenticationChallenge class encapsulates the information required by an NSURLProtocol implementation to authenticate a request: a proposed credential, the protection space involved, the error or response that the protocol used to determine that authentication is required, and the number of authentication attempts that have been made. An NSURLAuthenticationChallenge instance also specifies the object that initiated the authentication. The initiating object, referred to as the sender, must conform to the NSURLAuthenticationChallengeSender protocol. </p><p>NSURLAuthenticationChallenge instances are used by NSURLProtocol subclasses to inform the URL loading system that authentication is required. They are also provided to the delegate methods of NSURLConnection and NSURLDownload that facilitate customized authentication handling.</p><a name="//apple_ref/doc/uid/20001834-157091" title="Cookie Storage"></a><h2>Cookie Storage</h2><p>Due to the stateless nature of the HTTP protocol, cookies are often used to provide persistent storage of data across URL requests. The URL loading system provides interfaces to create and manage cookies as well as sending and receiving cookies from web servers.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001834-DontLinkElementID_7" title="Note"></a><p><strong>Note:</strong>&nbsp;Cookies are shared among all applications using the URL loading system. </p></div><p>The NSHTTPCookie class encapsulates a cookie, providing accessors for many of the common cookie attributes. It also provides methods to convert HTTP cookie headers to NSHTTPCookie instances and convert an NSHTTPCookie instance to headers suitable for use with an NSURLRequest. The URL loading system automatically sends any stored cookies appropriate for an NSURLRequest unless the request specifies not to send cookies. Likewise, cookies returned in an NSURLResponse are accepted in accordance with the current cookie acceptance policy.</p><p>The NSHTTPCookieStorage class provides the interface for managing the collection of NSHTTPCookie objects shared by all applications.</p><p>NSHTTPCookieStorage allows an application to specify a cookie acceptance policy. The cookie acceptance policy controls whether cookies should always be accepted, never be accepted, or accepted only from the same domain as the main document URL.</p><div class="notebox"><a name="//apple_ref/doc/uid/20001834-DontLinkElementID_8" title="Note"></a><p><strong>Note:</strong>&nbsp;Changing the cookie acceptance policy in an application affects the cookie acceptance policy for all other running applications.</p></div><p>When another application changes the cookie storage or the cookie acceptance policy, NSHTTPCookieStorage notifies an application by posting the <code><!--a  -->NSHTTPCookieStorageCookiesChangedNotification<!--/a--></code> and <code><!--a  -->NSHTTPCookieStorageAcceptPolicyChangedNotification<!--/a--></code> notifications.</p><a name="//apple_ref/doc/uid/20001834-155857" title="Protocol Support"></a><h2>Protocol Support</h2><p>The URL loading system design allows a client application to extend the protocols that are supported for transferring data. The URL loading system natively supports <code>http</code>, <code>https</code>, <code>file</code>, and <code>ftp</code> protocols.</p><p>Custom protocols are implemented by subclassing NSURLProtocol and then registering the new class with the URL loading system using the NSURLProtocol class method <code>registerClass:</code>. When an NSURLConnection or NSURLDownload object initiates a connection for an NSURLRequest, the URL loading system consults each of the registered classes in the reverse order of their registration. The first class that returns <code>YES</code> for a <code>canInitWithRequest:</code> message is used to handle the request. </p><p>The URL loading system is responsible for creating and releasing NSURLProtocol instances when connections start and complete. An application should never create an instance of NSURLProtocol directly.</p><p>When an NSURLProtocol subclass is initialized by the URL loading system, it is provided a client object that conforms to the NSURLProtocolClient protocol. The NSURLProtocol subclass sends messages from the NSURLProtocolClient protocol to the client object to inform the URL loading system of its actions as it creates a response, receives data, redirects to a new URL, requires authentication, and completes the load. If the custom protocol supports authentication, then it must conform to the NSURLAuthenticationChallengeSender protocol.</p>

        <br/><br/> 

        <div class="mini_nav_text" align="left">
        <span class="navButtons">
        <a href="../URLLoadingSystem.html">&lt; Previous Page</a><span style="margin-left: 8px"><a href="AsyncConnection.html">Next Page &gt;</a></span>
        </span>
        <span id="showHideTOCLowerSpan">
        <a href="#" onclick="showHideTOC();"><img src="../../../../Resources/Images/show_toc_icon.gif" width="15" height="14" border="0" style="margin-bottom: -2px;" alt="" /></a> <a href="#" onclick="showHideTOC();">Hide TOC</a>
        </span>
        </div>

        <br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> <!--#if expr="0=1" -->&#x00a9; 2003, 2008 Apple Inc. All Rights Reserved. &#40;<!--#endif -->Last updated: 2008-05-06<!--#if expr="0=1" -->&#041;<!--#endif --></p></div>

        
        <div class="hideOnPrint hideInXcode">
        <!-- start of footer -->
        	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Cocoa/Conceptual/URLLoadingSystem/Concepts/URLOverview.html%3Fid%3D10000165i-2.7&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Cocoa/Conceptual/URLLoadingSystem/Concepts/URLOverview.html%3Fid%3D10000165i-2.7&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Cocoa/Conceptual/URLLoadingSystem/Concepts/URLOverview.html%3Fid%3D10000165i-2.7&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

        <!--#include virtual="/includes/framesetfooter" -->
        <!-- end of footer -->
        </div>
    </div>
</body>
</html>
