<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating a Complex Object Specifier Record(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING253></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-252.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-254.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A> / <A HREF="IAC-251.html"><B>Creating Object Specifier Records</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING253-0></A>
<H2><A NAME=MARKER-9-264></A>Creating a Complex Object Specifier Record</H2>
 <A NAME=MARKER-2-426></A>This section describes how to create object specifier records that specify a test or a range. You can specify the object class ID for these object specifier records the same way you would for any other object specifier record. When you create the other three keyword-specified descriptor records, however, you can use additional Apple Event Manager routines and descriptor types to specify any combination of Apple event objects. <P>
<A NAME=HEADING253-2></A>
<H3><A NAME=MARKER-9-266></A>Specifying a Test</H3>
 <A NAME=MARKER-9-289></A><A NAME=MARKER-2-270></A>The key form <CODE>formTest</CODE> allows your application to specify key data that identifies one or more elements in the specified container that pass a test. To do so, your application must construct several interconnected descriptor records that specify comparisons and, if necessary, logical expressions. <P>
 For example, to specify "the first row in which the First Name column equals 'John' and the Last Name column equals 'Chapman' in the table 'MyAddresses' of the database 'SurfDB,'" your application must construct an object specifier record whose key data describes a logical expression that applies the logical operator <CODE>AND</CODE> to two separate comparisons for each row: a comparison of the First Name column to the word "John" and a comparison of the Last Name column to the word "Chapman." <P>
 The logical organization of the data for the object specifier record that specifies this test is summarized in <A HREF=#MARKER-9-51>Table 6-8</A> and <A HREF=#MARKER-9-52>Table 6-9</A>. (It is also illustrated in <A HREF=IAC-238.html#MARKER-9-120>Figure 6-3</A> and <A HREF=IAC-238.html#MARKER-9-121>Figure 6-4</A>, beginning on <A HREF=IAC-238.html#MARKER-9-120>page 6-22</A>.) The listings in the remainder of this section demonstrate how to create this object specifier record. For general information about the organization of key data for a test, see <A HREF=IAC-238.html#MARKER-9-114>"Key Data for a Test,"</A> which begins on <A HREF=IAC-238.html#MARKER-9-114>page 6-16</A>.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-51></A><B>Table 6-8 Object specifier record for the first row that meets a test in the table named "MyAddresses"</B></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAEDesiredClass<TD>typeType<TD>cRow<TR>
<TD>keyAEContainer<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cRow<TR>
<TD>  keyAEContainer<TD>  typeObjectSpecifier<TD>  (see indented record)<TR>
<TD>    keyAEDesiredClass<TD>    typeType<TD>    cTable<TR>
<TD>    keyAEContainer<TD>    typeObjectSpecifier<TD>    (see indented record)<TR>
<TD>      keyAEDesiredClass<TD><CODE>      </CODE>typeType<TD>      cDatabase<TR>
<TD>      keyAEContainer<TD>      typeNull<TD>      Data handle is <CODE>NIL</CODE><TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formName<TR>
<TD>      keyAEKeyData<TD>      typeChar<TD>      "SurfDB"<TR>
<TD>    keyAEKeyForm<TD>    typeEnumerated<TD>    formName<TR>
<TD>    keyAEKeyData<TD>    typeChar<TD>    "MyAddresses"<TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formTest<TR>
<TD>  keyAEKeyData<TD>  typeLogicalDescriptor<TD>  (see <A HREF=#MARKER-9-52>Table 6-9</A>)<TR>
<TD>keyAEKeyForm<TD>typeEnumerated<TD>formAbsolutePosition<TR>
<TD>keyAEKeyData<TD>typeLongInteger<TD>1</TABLE>

<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-52></A><B>Table 6-9 Logical descriptor record that specifies a test</B></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAELogicalOperator<TD>typeEnumerated<TD>kAEAnd<TR>
<TD>keyAELogicalTerms<TD>typeAEList<TD>(see indented records)<TR>
<TD>&nbsp;<TD>  typeCompDescriptor<TD><CODE>  </CODE>(see indented record)<TR>
<TD>    keyAECompOperator<TD>    typeType<TD>    kAEEquals<TR>
<TD>    keyAEObject1<TD>    typeObjectSpecifier<TD><CODE>  </CODE>  (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cColumn<TR>
<TD>      keyAEContainer<TD>      typeObjectBeingExamined<TD>      Data handle is <CODE>NIL</CODE><TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formName<TR>
<TD>      keyAEKeyData<TD>      typeChar<TD>      "First Name"<TR>
<TD>    keyAEObject2<TD>    typeChar<TD>    "John"<TR>
<TD>  <TD>  typeCompDescriptor<TD>  (see indented record)<TR>
<TD>    keyAECompOperator<TD>    typeType<TD>    kAEEquals<TR>
<TD>    keyAEObject1<TD>    typeObjectSpecifier<TD><CODE>  </CODE>  (see indented record)<TR>
<TD>      keyAEDesiredClass<TD>      typeType<TD>      cColumn<TR>
<TD>      keyAEContainer<TD>      typeObjectBeingExamined<TD>      Data handle is <CODE>NIL</CODE><TR>
<TD>      keyAEKeyForm<TD>      typeEnumerated<TD>      formName<TR>
<TD>      keyAEKeyData<TD>      typeChar<TD>      "Last Name"<TR>
<TD>    keyAEObject2<TD>    typeChar<TD>    "Chapman"</TABLE>
<P>
 Because both the database and the table shown in <A HREF=#MARKER-9-51>Table 6-8</A> are specified by name, it would be convenient to have an application-defined routine that creates an object specifier record that uses the key form <CODE>formName</CODE>. The <CODE>MyCreateFormNameObjSpecifier</CODE> function shown in <A HREF=#MARKER-9-269>Listing 6-16</A> can be used for this purpose.<P>
<B>Listing 6-16  <A NAME=MARKER-9-269></A>Creating an object specifier record with the key form <CODE>formName</CODE><A NAME=MARKER-2-270></A></B><P>
<PRE>
FUNCTION MyCreateFormNameObjSpecifier
                        (class: DescType; container: AEDesc; 
                         keyDataName: str255; 
                         VAR resultObjSpecRec: AEDesc): OSErr;
VAR
   keyDataDescRec: AEDesc;
   myErr:          OSErr;
BEGIN
   myErr := AECreateDesc(typeChar, @keyDataName[1], 
                           Length(keyDataName), keyDataDescRec);
   IF myErr = noErr THEN
      myErr := CreateObjSpecifier(class, container, formName,
                                    keyDataDescRec, TRUE,
                                    resultObjSpecRec);
   MyCreateFormNameObjSpecifier := myErr;
END;
</PRE>
 The <CODE>MyCreateFormNameObjSpecifier</CODE> function shown in <A HREF=#MARKER-9-269>Listing 6-16</A> returns, in the <CODE>resultObjSpecRec</CODE> parameter, an object specifier record that describes an Apple event object of the class specified by the <CODE>class</CODE> parameter, located in the container specified by the <CODE>container</CODE> parameter, with the key form <CODE>formName</CODE> and key data specified by the <CODE>keyDataName</CODE> parameter. This function is used in <A HREF=#MARKER-9-282>Listing 6-19 on page 6-83</A> to create object specifier records that use the key form <CODE>formName</CODE> for the database and the table. <P>
 <A NAME=MARKER-2-271></A>The nested object specifier records shown in <A HREF=#MARKER-9-52>Table 6-9</A> specify "the rows in which the First Name column equals 'John' and the Last Name column equals 'Chapman.'" To identify the rows that pass this test, the Apple Event Manager needs to evaluate two comparisons: the comparison of each row of the First Name column to the word "John," and the comparison of each row of the Last Name column to the word "Chapman."<P>
 The Apple Event Manager uses the information in comparison descriptor records to compare the specified elements in a container, one at a time, either to another Apple event object or to the data associated with a descriptor record. The two comparison descriptor records you need to create for this example are summarized in <A HREF=#MARKER-9-52>Table 6-9 on page 6-79</A>. <P>
 You can use the <CODE>CreateCompDescriptor</CODE> function to create a comparison descriptor record, or you can create an AE record and use <CODE>AECoerceDesc</CODE> to coerce it to a comparison descriptor record. <A HREF=#MARKER-9-273>Listing 6-17</A> shows an example of an application-defined routine that creates an object specifier record and a descriptor record of <CODE>typeChar</CODE>, then uses the <CODE>CreateCompDescriptor</CODE> function to add them to a comparison descriptor record. <A NAME=MARKER-2-272></A><P>
<B>Listing 6-17  <A NAME=MARKER-9-273></A>Creating a comparison descriptor record<A NAME=MARKER-2-274></A></B><P>
<PRE>
FUNCTION MyCreateComparisonDescRec (VAR compDesc: AEDesc;
                                    colName: str255; 
                                    name: str255): OSErr;
VAR
   logicalContainer, colNameDesc, nameDesc:  AEDesc;
   myObjectExaminedContainer:                AEDesc;
   myErr:                                    OSErr;
BEGIN
   {create the object specifier record for keyAEObject1; }
   { first create container}
   myErr := AECreateDesc(typeObjectBeingExamined, NIL, 0,
                           myObjectExaminedContainer);
   {create key data}
   IF myErr = noErr THEN
      myErr := AECreateDesc(typeChar, @colName[1],
                            Length(colName), colNameDesc);
   {now create the object specifier record}
   IF myErr = noErr THEN
      myErr := CreateObjSpecifier(cColumn,
                                  myObjectExaminedContainer, 
                                  formName, colNameDesc, TRUE,
                                  logicalContainer);
   {create the descriptor record for keyAEObject2}
   IF myErr = noErr THEN
      myErr := AECreateDesc(typeChar, @name[1], Length(name), 
                            nameDesc);
   {create the first logical term (comp descriptor record)}
   IF myErr = noErr THEN
      myErr := CreateCompDescriptor(kAEEquals, logicalContainer,
                                    nameDesc, TRUE, compDesc);
   MyCreateComparisonDescRec := myErr;
END; 
</PRE>
 The <CODE>MyCreateComparisonDescRec</CODE> function takes two strings and uses them to create a comparison descriptor record. The string passed in the second parameter specifies the name of the column whose contents should be compared to the string passed in the third parameter. First, the <CODE>MyCreateComparisonDescRec</CODE> function uses <CODE>AECreateDesc</CODE> to create a descriptor record of <CODE>typeObjectBeingExamined</CODE>, which is returned in the variable <CODE>myObjectExaminedContainer</CODE>. Next, <CODE>AECreateDesc</CODE> creates a descriptor record of descriptor type <CODE>typeChar</CODE>, whose data consists of the string in the variable <CODE>colName</CODE>, and which is returned in the variable <CODE>colNameDesc</CODE>. The code then passes the variables <CODE>myObjectExaminedContainer</CODE> and <CODE>colNameDesc</CODE> to the <CODE>CreateObjSpecifier</CODE> function, which uses them to create an object specifier record, returned in the <CODE>logicalContainer</CODE> variable, that becomes the keyword-specified descriptor record with the keyword <CODE>keyAEObject1</CODE>.<P>
 Next, the <CODE>MyCreateComparisonDescRec</CODE> function uses <CODE>AECreateDesc</CODE> and the <CODE>name</CODE> parameter to create the descriptor record for <CODE>keyAEObject2</CODE>, which <CODE>AECreateDesc</CODE> returns in the <CODE>nameDesc</CODE> variable. Finally, the code passes the constant <CODE>kAEEquals</CODE>, the variable <CODE>logicalContainer</CODE>, and the variable <CODE>nameDesc</CODE> to the <CODE>CreateCompDescriptor</CODE> function, which creates a comparison descriptor record that allows the Apple Event Manager (with the help of object-comparison functions provided by the server application) to determine whether the specified column in the row currently being checked equals the specified string. <A NAME=MARKER-2-269></A><P>
 You can use the <CODE>MyCreateComparisonDescRec</CODE> function to create both the descriptor records of type <CODE>typeCompDescriptor</CODE> shown in <A HREF=#MARKER-9-52>Table 6-9 on page 6-79</A>. These descriptor records provide two logical terms for a logical descriptor record. The entire logical descriptor record corresponds to the logical expression "the First Name column equals 'John' <CODE>AND</CODE> the Last Name column equals 'Chapman.'" <A NAME=MARKER-2-146></A> <A NAME=MARKER-2-277></A><P>
 <A NAME=MARKER-2-278></A>You can use the <CODE>CreateLogicalDescriptor</CODE> function to create a logical descriptor record, or you can create an AE record and use the <CODE>AECoerceDesc</CODE> function to coerce it to a comparison descriptor record. <A HREF=#MARKER-9-279>Listing 6-18</A> shows an application-defined function that adds two comparison descriptor records to a descriptor list, then uses the <CODE>CreateLogicalDescriptor</CODE> function to create a logical descriptor record whose logical terms are the two comparison descriptor records.<P>
<B>Listing 6-18  <A NAME=MARKER-9-279></A>Creating a logical descriptor record<A NAME=MARKER-2-280></A></B><P>
<PRE>
FUNCTION MyCreateLogicalDescRec (VAR compDesc1, compDesc2: AEDesc;
                                 logicalOperator: DescType;
                                 VAR logicalDesc: AEDesc): OSErr;
VAR
   logicalTermsList: AEDescList;
   myErr:            OSErr;
BEGIN
   {create a logical descriptor record that contains two }
   { comparison descriptor records}
   {first create a list}
   myErr := AECreateList(NIL, 0, FALSE, logicalTermsList);
   IF myErr = noErr THEN
      myErr := AEPutDesc(logicalTermsList, 1, compDesc1);
   IF myErr = noErr THEN
      myErr := AEPutDesc(logicalTermsList, 2, compDesc2);
   IF myErr = noErr THEN
      myErr := AEDisposeDesc(compDesc1);
   IF myErr = noErr THEN
      myErr := AEDisposeDesc(compDesc2);
   IF myErr = noErr THEN
      myErr := CreateLogicalDescriptor(logicalTermsList,
                                       logicalOperator, TRUE,
                                       logicalDesc);
   MyCreateLogicalDescRec := myErr;
END;
</PRE>
 <A HREF=#MARKER-9-282>Listing 6-19</A> uses the application-defined functions shown in <A HREF=#MARKER-9-269>Listing 6-16</A>, <A HREF=#MARKER-9-273>Listing 6-17</A>, and <A HREF=#MARKER-9-279>Listing 6-18</A> to build the object specifier record illustrated in <A HREF=#MARKER-9-51>Table 6-8</A> and <A HREF=#MARKER-9-52>Table 6-9</A>. <A NAME=MARKER-2-281></A> <P>
<B>Listing 6-19  <A NAME=MARKER-9-282></A>Creating a complex object specifier record<A NAME=MARKER-2-283></A></B><P>
<PRE>
FUNCTION MyCreateObjSpecRec (VAR theResultObj: AEDesc): OSErr;
VAR
   nullContainer, databaseContainer, tableContainer:  AEDesc;
   compDesc1, compDesc2:                              AEDesc;
   logicalTestDesc, rowTestContainer, rowOffset:      AEDesc;
   myErr:                                             OSErr;




BEGIN
   {create a null container}
   myErr := AECreateDesc(typeNull, NIL, 0, nullContainer);
   {create a container for the database}
   IF myErr = noErr THEN
      myErr := MyCreateFormNameObjSpecifier(cDatabase, nullContainer,
                                            'SurfDB', databaseContainer);
   {create a container for the table}
   IF myErr = noErr THEN
      myErr := MyCreateFormNameObjSpecifier(cTable, databaseContainer, 
                                            'MyAddresses', tableContainer);
   {create a container for the row--an object specifier record that }
   { specifies a test (the row whose First Name column = 'John' and }
   { Last Name column = 'Chapman')}

   {create the first comparison descriptor record}
   IF myErr = noErr THEN
      myErr := MyCreateComparisonDescRec(compDesc1, 'First Name', 'John'); 
   {create the second comparison descriptor record}
   IF myErr = noErr THEN
      myErr := MyCreateComparisonDescRec(compDesc2, 'Last Name', 'Chapman'); 

   {create the logical descriptor record}
   IF myErr = noErr THEN
      myErr := MyCreateLogicalDescRec(compDesc1, compDesc2, kAEAND, 
                                       logicalTestDesc);

   {now create the object specifier record that specifies the test}
   IF myErr = noErr THEN
      myErr := CreateObjSpecifier(cRow, tableContainer, formTest,
                                  logicalTestDesc, TRUE, rowTestContainer);

   {create the object specifier record for the Apple event object}
   {first, create the descriptor record for the key data}
   IF myErr = noErr THEN
      myErr := CreateOffsetDescriptor (1, rowOffset);
   {now create the object specifier record}
   IF myErr = noErr THEN
      myErr := CreateObjSpecifier (cRow, rowTestContainer, 
                                    formAbsolutePosition, rowOffset, 
                                    TRUE, theResultObj);
   MyCreateObjSpecRec := myErr;
END;
</PRE>
 The <CODE>MyCreateObjSpecRec</CODE> function shown in <A HREF=#MARKER-9-282>Listing 6-19</A> begins by using <CODE>AECreateDesc</CODE> to create a null descriptor record, then uses the <CODE>MyCreateFormNameObjSpecifier</CODE> function (shown in <A HREF=#MARKER-9-269>Listing 6-16</A>) to specify the default container for the database named "SurfDB." The code then calls the <CODE>MyCreateFormNameObjSpecifier</CODE> function again, this time passing the object specifier record for SurfDB to specify the container for the table "MyAddresses." The next two calls are both to the <CODE>MyCreateComparisonDescRec</CODE> function (shown in <A HREF=#MARKER-9-273>Listing 6-17</A>), which creates the comparison descriptor records that allow the Apple Event Manager to compare the First Name column and Last Name column to the names "John" and "Chapman," respectively. The next call passes these two comparison descriptor records to the <CODE>MyCreateLogicalDescRec</CODE> function (shown in <A HREF=#MARKER-9-279>Listing 6-18</A>) in the <CODE>compDesc1</CODE> and <CODE>compDesc2</CODE> variables. <P>
 Now all the components of the logical descriptor record are ready to assemble. The next call, to <CODE>CreateObjSpecifier</CODE>, specifies the logical descriptor record in the <CODE>logicalTestDesc</CODE> variable as the key data for the object specifier record that specifies the test. A call to the Apple Event Manager routine <CODE>CreateOffsetDescriptor</CODE> then creates an offset descriptor record that contains the integer 1. Finally, the code passes the offset descriptor record to the <CODE>CreateObjSpecifier</CODE> function in the <CODE>rowOffset</CODE> variable to create the final object specifier record, which describes the requested row as the first row that passes the test.<P>
 The <CODE>CreateOffsetDescriptor</CODE> function creates a descriptor record of type <CODE>typeLongInteger</CODE> that can be used as the key data with a key form of <CODE>formAbsolutePosition</CODE> to indicate an element's offset within its container. A positive integer indicates an offset from the beginning of the container (the first element has an offset of 1), and a negative integer indicates an offset from the end of the container (the last element has an offset of -1). Using <CODE>CreateOffsetDescriptor</CODE> accomplishes the same thing as setting a variable to an integer and passing the variable to <CODE>AECreateDesc</CODE> to create a descriptor record of type <CODE>typeLongInteger</CODE>. <A NAME=MARKER-2-284></A> <A NAME=MARKER-2-131></A> <A NAME=MARKER-2-286></A> <A NAME=MARKER-2-168></A><P>
<A NAME=HEADING253-27></A>
<H3><A NAME=MARKER-9-288></A>Specifying a Range</H3>
 <A NAME=MARKER-9-105></A>The key form <CODE>formRange</CODE> allows your application to specify key data that identifies a range of elements in the specified container. To do so, your application must first create a range descriptor record. The Apple Event Manager uses a range descriptor record to identify the two Apple event objects that specify the beginning and end of a range of elements. <P>
 For example, an object specifier record for a range of text in a document could specify the table named "Summary of Sales" as the first boundary object and the figure named "Best-Selling Widgets for 1991" as the second boundary object for a range that consists of all the text between the table and the figure. Any word processor that keeps track of the relative positions of text, tables, and figures should be capable of supporting such a request. <P>
 <A HREF=#MARKER-9-53>Table 6-10</A> summarizes the logical organization of the data for the object specifier record that specifies this range. For general information about the organization of data within a range descriptor record, see <A HREF=IAC-238.html#MARKER-9-125>"Key Data for a Range" on page 6-23</A>.
<TABLE BORDER="0" CELLPADDING=3>
<CAPTION><A NAME=MARKER-9-53></A><B>Table 6-10 A range descriptor record</B></CAPTION>
<TH>Keyword<TH>Descriptor type<TH>Data<TR>
<TD>keyAERangeStart<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cTable<TR>
<TD>  keyAEContainer<TD>  typeCurrentContainer<TD>  Data handle is <CODE>NIL</CODE><TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formName<TR>
<TD>  keyAEKeyData<TD>  typeChar<TD>  "Summary of Sales"<TR>
<TD>keyAERangeStop<TD>typeObjectSpecifier<TD>(see indented record)<TR>
<TD>  keyAEDesiredClass<TD>  typeType<TD>  cFigure<TR>
<TD>  keyAEContainer<TD>  typeCurrentContainer<TD>  Data handle is <CODE>NIL</CODE><TR>
<TD>  keyAEKeyForm<TD>  typeEnumerated<TD>  formName<TR>
<TD>  keyAEKeyData<TD>  typeChar<TD>  "Best-Selling Widgets <BR>  for 1991"</TABLE>
<P>
 You can use the <CODE>CreateRangeDescriptor</CODE> function to create a range descriptor record, or you can create an AE record and use <CODE>AECoerceDesc</CODE> to coerce it to a range descriptor record. <A HREF=#MARKER-9-291>Listing 6-20</A> provides an example of an application-defined routine that creates two object specifier records, then uses the <CODE>CreateRangeDescriptor</CODE> function to add them to a range descriptor record.<P>
 The container for the boundary objects in the range descriptor record created by <BR><A HREF=#MARKER-9-291>Listing 6-20</A> is the same as the container for the range itself. The object specifier record for the range's container is added to an object specifier record of key form <CODE>formRange</CODE> at the same time that the range descriptor record is added as key data. The container for the two boundary objects can therefore be specified in the range descriptor record by a descriptor record of type <CODE>typeCurrentContainer</CODE> whose data handle has the value <CODE>NIL</CODE>. The Apple Event Manager interprets this as a placeholder for the range's container when it is resolving the range descriptor record.<A NAME=MARKER-2-290></A><P>
<B>Listing 6-20  <A NAME=MARKER-9-291></A>Creating a range descriptor record<A NAME=MARKER-2-292></A></B><P>
<PRE>
FUNCTION MyCreateRangeDescriptor (VAR rangeDescRec: AEDesc): OSErr;
VAR
   rangeStart:          AEDesc;
   rangeEnd:            AEDesc;
   currentContainer:    AEDesc;
   tableNameDescRec:    AEDesc;
   figureNameDescRec:   AEDesc;
   myErr:               OSErr;
BEGIN
{create the object specifier record for the start of the range }
{ (the table named 'Summary of Sales' in 'MyDoc' document)}

   {create a descriptor record of type typeCurrentContainer}
   myErr := AECreateDesc(typeCurrentContainer, NIL, 0, currentContainer);

   {create the object specifier record}
   IF myErr = noErr THEN
      myErr := MyCreateNameDescRec(tableNameDescRec, 
                                    'Summary of Sales');
   IF myErr = noErr THEN
   myErr := CreateObjSpecifier(cTable, currentContainer, formName,
                                 tableNameDescRec, FALSE, rangeStart);
   
   myErr := AEDisposeDesc(tableNameDescRec);
   {create the object specifier record for the end of the range }
   { (the figure named 'Best-Selling Widgets...' in 'MyDoc') }
   IF myErr = noErr THEN
      myErr := MyCreateNameDescRec(figureNameDescRec, 
                                    'Best-Selling Widgets for 1991');

   IF myErr = noErr THEN
      myErr := CreateObjSpecifier(cFigure, currentContainer, formName,
                                 figureNameDescRec, TRUE, rangeEnd);

   {now create the range descriptor record}
   IF myErr = noErr THEN
      myErr := CreateRangeDescriptor(rangeStart, rangeEnd, TRUE, 
                                       rangeDescRec);
   MyCreateRangeDescriptor := myErr;
END;
</PRE>
 After creating a descriptor record of type <CODE>typeCurrentContainer</CODE> and a descriptor record for the first table's name, <A HREF=#MARKER-9-291>Listing 6-20</A> uses the <CODE>CreateObjSpecifier</CODE> function to create an object specifier record that identifies the beginning of the range. The parameters to <CODE>CreateObjSpecifier</CODE> specify that the beginning of the range is an Apple event object of the object class <CODE>cTable</CODE> in the current container, with a key form of <CODE>formName</CODE> and key data that identifies the table by name. A second call to <CODE>CreateObjSpecifier</CODE> creates the object specifier record that identifies the end of the range--an Apple event object of the <CODE>cFigure</CODE> object class in the current container, with a key form of <CODE>formName</CODE> and key data that identifies the figure by name. Finally, the code in <A HREF=#MARKER-9-291>Listing 6-20</A> uses the <CODE>CreateRangeDescriptor</CODE> function to create the range descriptor record, using the two previously created object specifier records to specify the beginning and end of the range. <A NAME=MARKER-2-269></A><A NAME=MARKER-2-398></A><A NAME=MARKER-2-427></A><A NAME=MARKER-2-77></A> <A NAME=MARKER-9-128></A><A NAME=MARKER-2-380></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-252.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-254.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
