<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>CallOSTrapUniversalProc (IM: PS)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING36></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="PPCSoftware-35.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-37.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="PPCSoftware-2.html"><B>PowerPC System Software</B></A> / <BR><DD><A HREF="PPCSoftware-17.html"><B>Chapter 2 - Mixed Mode Manager</B></A> / <A HREF="PPCSoftware-20.html"><B>Mixed Mode Manager Reference</B></A><BR><DL><DD><A HREF="PPCSoftware-29.html"><B>Mixed Mode Manager Routines</B></A> / <A HREF="PPCSoftware-34.html"><B>Calling Routines via Universal Procedure Pointers</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING36-0></A>
<H3>CallOSTrapUniversalProc<A NAME=MARKER-2-356></A></H3>
 You can call the <CODE>CallOSTrapUniversalProc</CODE> function to call the routine associated with a universal procedure pointer, following Operating System register saving and restoring conventions. You're likely to need to use this function only if you need to patch an Operating System trap.<P>
<PRE>
long CallOSTrapUniversalProc (UniversalProcPtr theProcPtr, 
                              ProcInfoType theProcInfo, ...);
</PRE>
<DL>
<DT><CODE>theProcPtr</CODE>
<DD> A universal procedure pointer.
<DT><CODE>theProcInfo</CODE>
<DD> The procedure information associated with the routine specified by the <CODE>theProcPtr</CODE> parameter.
</DL>
<A NAME=HEADING36-5></A>
<H5>DESCRIPTION</H5>
 The <CODE>CallOSTrapUniversalProc</CODE> function executes the routine associated with the specified universal procedure pointer, following standard conventions for executing Operating System traps. Registers A1, A2, D1, and D2 are saved before the routine is executed and restored after its completion; in addition, register A0 is saved and restored, depending on the setting of the appropriate flag bit in the trap word. The trap number <BR>is put into register D1; you should make certain to record that fact in any procedure information you build yourself.<P>
 You pass <CODE>CallOSTrapUniversalProc</CODE> a universal procedure pointer (which may be either a 680x0 procedure pointer or the address of a routine descriptor), a set of procedure information, and a variable number of parameters that are passed to the routine. <CODE>CallOSTrapUniversalProc</CODE> returns a result of type <CODE>long</CODE> that contains the result (if any) returned by the called routine.<P>
<A NAME=HEADING36-8></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 If the universal procedure pointer passed to <CODE>CallOSTrapUniversalProc</CODE> is the address of the routine descriptor, that routine descriptor must already exist before you call <CODE>CallOSTrapUniversalProc</CODE>. If you pass the address of an invalid routine descriptor <BR>to <CODE>CallOSTrapUniversalProc</CODE>, a system error will occur.<P>
 The <CODE>CallOSTrapUniversalProc</CODE> function is defined only for register-based Operating System traps. Make sure that the procedure information specified in the <CODE>theProcInfo</CODE> parameter correctly specifies the calling conventions of the trap. In particular, do not specify either C or Pascal calling conventions.<A NAME=MARKER-2-357></A><A NAME=MARKER-2-358></A><A NAME=MARKER-2-359></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="PPCSoftware-35.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="PPCSoftware-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="PPCSoftware-86.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="PPCSoftware-37.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="PPCSoftware-3.html">&copy; Apple Computer, Inc.</A><br>3 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
