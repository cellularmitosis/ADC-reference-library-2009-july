<html><head><title>Mac OS X
 Manual Page For slapd-tcl(5)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/5/slapd-tcl" title="Mac OS X
 Manual Page for slapd-tcl(5)"><!-- headerDoc=man; indexgroup=Section 5; uid="//apple_ref/doc/man/5/slapd-tcl"; name=slapd-tcl(5) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
SLAPD-TCL(5)                                                                                    SLAPD-TCL(5)



<b>NAME</b>
       slapd-tcl - Tcl backend to slapd

<b>SYNOPSIS</b>
       /etc/openldap/slapd.conf

<b>DESCRIPTION</b>
       The  Tcl backend to <a href="../man8/slapd.8.html#//apple_ref/doc/man/8/slapd"><b>slapd</b>(8)</a> works by embedding a <!-- a --><b>Tcl</b>(3tcl)<!-- /a --> interpreter into <a href="../man8/slapd.8.html#//apple_ref/doc/man/8/slapd"><b>slapd</b>(8)</a>.  Any tcl data-<font color="#ffffff" class="whiteout">base&nbsp;database</font>
       base section of the configuration file <a href="slapd.conf.5.html#//apple_ref/doc/man/5/slapd.conf"><b>slapd.conf</b>(5)</a> must then specify what Tcl script to use.

       This backend is experimental.

<b>WARNING</b>
       <b>This</b> <b>backend's</b> <b>calling</b> <b>conventions</b> <b>have</b> <b>changed</b> <b>since</b> <b>OpenLDAP</b> <b>2.0.</b>  Previously, the 2nd argument  to
       the  procs  was  a message ID.  Now they are an "operation ID" string.  Also, proc abandon now gets a
       new <b>abandonid</b> argument.

<b>CONFIGURATION</b>
       These <b>slapd.conf</b> options apply to the TCL backend database.  That is, they must  follow  a  "database
       tcl"  line  and come before any subsequent "backend" or "database" lines.  Other database options are
       described in the <a href="slapd.conf.5.html#//apple_ref/doc/man/5/slapd.conf"><b>slapd.conf</b>(5)</a> manual page.

       <b>scriptpath</b> <b>&lt;filename.tcl&gt;</b>
              The full path to the tcl script used for this database.

       <b>search</b> <b>&lt;proc&gt;</b>
       <b>add</b> <b>&lt;proc&gt;</b>
       <b>delete</b> <b>&lt;proc&gt;</b>
       <b>modify</b> <b>&lt;proc&gt;</b>
       <b>bind</b> <b>&lt;proc&gt;</b>
       <b>unbind</b> <b>&lt;proc&gt;</b>
       <b>modrdn</b> <b>&lt;proc&gt;</b>
       <b>compare</b> <b>&lt;proc&gt;</b>
       <b>abandon</b> <b>&lt;proc&gt;</b>
              The procs for each ldap function.  They refer to the tcl procs in the `scriptpath' script that
              handles them.

       <b>tclrealm</b> <b>&lt;interpreter</b> <b>name&gt;</b>
              This  is one of the biggest pluses of using the tcl backend.  The realm lets you group several
              databases to the same interpreter.  This basically means they share the same global  variables
              and  proc  space.   So  global variables, as well as all the procs, are callable between data-<font color="#ffffff" class="whiteout">bases.&nbsp;databases.</font>
              bases.  If no tclrealm is specified, it is put into the "default" realm.

<b>Variables</b> <b>passed</b> <b>to</b> <b>the</b> <b>procs</b>
       <b>abandon</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>abandonid</b> <b>}</b>
              action    - Always equal to ABANDON.
              opid      - The opid of this ldap operation.
              suffix    - List of suffix(es) associated with the
                          call.  Each one is an entry in a tcl
                          formatted list (surrounded by {}'s).
              abandonid - The opid of the operation to abandon.

       <b>add</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>entry</b> <b>}</b>
              action - Always equal to ADD.
              opid   - The opid of this ldap operation.
              suffix - List of suffix(es), as above.
              entry  - Full entry to add. Each "type: val" is
                       an element in a tcl formatted list.

       <b>bind</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>dn</b> <b>method</b> <b>cred_len</b> <b>cred</b> <b>}</b>
              action   - Always equal to BIND.
              opid     - The opid of this ldap operation.
              suffix   - List of suffix(es), as above.
              dn       - DN being bound to.
              method   - One of the ldap authentication methods.
              cred_len - Length of cred.
              cred     - Credentials being used to authenticate,
                         according to RFC.  If this value is empty,
                         then it should be considered an anonymous
                         bind (??)

       <b>compare</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>dn</b> <b>ava_type</b> <b>ava_value</b> <b>}</b>
              action    - Always equal to COMPARE.
              opid      - The opid of this ldap operation.
              suffix    - List of suffix(es), as above.
              dn        - DN for compare.
              ava_type  - Type for comparison.
              ava_value - Value to compare.

       <b>delete</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>dn</b> <b>}</b>
              action    - Always equal to DELETE.
              opid      - The opid of this ldap operation.
              suffix    - List of suffix(es), as above.
              dn        - DN to delete.

       <b>modify</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>dn</b> <b>mods</b> <b>}</b>
              action - Always equal to MODIFY.
              opid   - The opid of this ldap operation.
              suffix - List of suffix(es), as above.
              dn     - DN to modify.
              mods   - Tcl list of modifications.
                       The list is formatted in this way:

                       {
                         { {op: type} {type: val} }
                         { {op: type} {type: val} {type: val} }
                         ...
                       }

                       Newlines are not present in the actual var,
                       they are present here for clarification.
                       "op" is the type of modification
                       (ADD, DELETE, REPLACE).

       <b>modrdn</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>dn</b> <b>newrdn</b> <b>deleteoldrdn</b> <b>}</b>
              action - Always equal to MODRDN.
              opid   - The opid of this ldap operation.
              suffix - List of suffix(es), as above.
              dn     - DN whose RDN is being renamed.
              newrdn - New RDN.
              deleteoldrdn - Boolean stating whether or not the
                       old RDN should be removed after being renamed.

       <b>search</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>base</b> <b>scope</b> <b>deref</b> <b>sizelimit</b> <b>timelimit</b> <b>filterstr</b> <b>attrsonly</b> <b>attrlist</b> <b>}</b>
              action    - Always equal to SEARCH.
              opid      - The opid of this ldap operation.
              suffix    - List of suffix(es), as above.
              base      - Base for this search.
              scope     - Scope of search, ( 0 | 1 | 2 ).
              deref     - Alias dereferencing ( 0 | 1 | 2 | 3 ).
              sizelimit - Maximum number of entries to return.
              timelimit - Time limit for search.
              filterstr - Filter string as sent by the requester.
              attrsonly - Boolean for whether to list only the
                          attributes, and not values as well.
              attrlist  - Tcl list if to retrieve.

       <b>unbind</b> <b>{</b> <b>action</b> <b>opid</b> <b>suffix</b> <b>dn</b> <b>}</b>
              action - Always equal to UNBIND.
              opid   - The opid of this ldap operation.
              suffix - List of suffix(es), as above.
              dn     - DN to unbind.

       An <u>opid</u> (operation ID) is a "connection ID/message ID" string identifying an operation.


<b>Return</b> <b>Method</b> <b>and</b> <b>Syntax</b>
       There are only 2 return types.  All procs must return a result to show status of the operation.   The
       result is in this form:

              { RESULT {code: &lt;integer&gt;} {matched: &lt;partialdn&gt;}
                {info: &lt;string&gt;} {} }

       This is best accomplished with this type of tcl code

                lappend ret_val "RESULT"
                lappend ret_val "code: 0"
                lappend ret_val ""
                return $ret_val

       The  final  empty  string  (item  in  list)  is  necessary  to point to the end of list.  The `code',
       `matched', and `info' values are not necessary, and default values are given if not  specified.   The
       `code'  value is usually an LDAP error in decimal notation from ldap.h.  The `info', may be sent back
       to the client, depending on the function.  In the bind proc, LDAP uses the value of `code'  to  indi-<font color="#ffffff" class="whiteout">cate&nbsp;indicate</font>
       cate whether or not the authentication is acceptable.

       The  other  type  of return is for searches.  It is similar format to the shell backend return (as is
       most of the syntax here).  Its format follows:

              {dn: o=Company, c=US} {attr: val} {objectclass: val} {}
              {dn: o=CompanyB, c=US} {attr: val} {objectclass: val} {}

       Again, newlines are for visual purposes here.  Also note the {} marking the end of  the  entry  (same
       effect  as  a  newline  in ldif format).  Here is some example code again, showing a full search proc
       example.

              # Note that `args' lets you lump all possible args
              # into one var, used here for simplicity of example
              proc ldap:search { args } {
                # ...perform some operations...

                lappend ret_val "dn: $rdn,$base"
                lappend ret_val "objectclass: $objcl"
                lappend ret_val "sn: $rdn"
                lappend ret_val "mail: $email"
                lappend ret_val ""
                # Now setup the result
                lappend ret_val "RESULT"
                lappend ret_val "code: 0"
                lappend ret_val ""
                return $ret_val
              }

       NOTE: Newlines in the return value is acceptable  in  search  entries  (i.e.  when  returning  base64
       encoded binary entries).


<b>Builtin</b> <b>Commands</b> <b>and</b> <b>Variables</b>
       <b>ldap:debug</b> <b>&lt;msg&gt;</b>
              Allows  you to send debug messages through OpenLDAP's native debugging system, this is sent as
              a LDAP_DEBUG_ANY and will be logged.  Useful for debugging scripts or logging bind failures.

<b>FILES</b>
       /etc/openldap/slapd.conf
              default slapd configuration file

<b>SEE</b> <b>ALSO</b>
       <a href="slapd.conf.5.html#//apple_ref/doc/man/5/slapd.conf"><b>slapd.conf</b>(5)</a>, <a href="../man8/slapd.8.html#//apple_ref/doc/man/8/slapd"><b>slapd</b>(8)</a>, <!-- a --><b>Tcl</b>(3tcl)<!-- /a -->.



OpenLDAP 2.3.27                                  2006/08/19                                     SLAPD-TCL(5)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man5/slapd-tcl.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man5/slapd-tcl.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man5/slapd-tcl.5.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
