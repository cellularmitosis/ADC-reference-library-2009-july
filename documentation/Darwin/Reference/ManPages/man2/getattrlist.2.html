<html><head><title>Mac OS X Developer Tools
 Manual Page For getattrlist(2)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/2/getattrlist" title="Mac OS X Developer Tools
 Manual Page for getattrlist(2)"><!-- headerDoc=man; indexgroup=Section 2; uid="//apple_ref/doc/man/2/getattrlist"; name=getattrlist(2) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac&nbsp;OS&nbsp;X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="../man1/man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>

<p style='text-align:justify;'>This manual page is associated with the Mac&nbsp;OS&nbsp;X
developer tools.  The software or headers described may not be present on your
Mac&nbsp;OS&nbsp;X installation until you install the developer tools
package.  This package is available on your Mac&nbsp;OS&nbsp;X installation DVD,
and the latest versions can be downloaded from
<a href="http://developer.apple.com/tools/download/">developer.apple.com</a>.</p>

<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
GETATTRLIST(2)              BSD System Calls Manual             GETATTRLIST(2)

<b>NAME</b>
     <b>getattrlist</b> -- get file system attributes

<b>SYNOPSIS</b>
     <b>#include</b> <b>&lt;sys/attr.h&gt;</b>
     <b>#include</b> <b>&lt;unistd.h&gt;</b>

     <u>int</u>
     <b>getattrlist</b>(<u>const</u> <u>char*</u> <u>path</u>, <u>struct</u> <u>attrlist</u> <u>*</u> <u>attrList</u>, <u>void</u> <u>*</u> <u>attrBuf</u>, <u>size</u><b>_</b><u>t</u> <u>attrBufSize</u>,
         <u>unsigned</u> <u>long</u> <u>options</u>);

<b>DESCRIPTION</b>
     The <b>getattrlist</b>() function returns attributes (that is, metadata) of file system objects.  You can
     think of <b>getattrlist</b>() as a seriously enhanced version of <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.  The function returns attributes
     about the file system object specified by <u>path</u> in the buffer specified by <u>attrBuf</u> and <u>attrBufSize</u>.  The
     <u>attrList</u> parameter determines what attributes are returned.  The <u>options</u> parameter lets you control
     specific aspects of the function's behavior.

     The <b>getattrlist</b>() function is only supported by certain volume format implementations.  For maximum
     compatibility, client programs should use high-level APIs (such as the Carbon File Manager) to access
     file system attributes.  These high-level APIs include logic to emulate file system attributes on vol-<font color="#ffffff" class="whiteout">umes&nbsp;volumes</font>
     umes that don't support <b>getattrlist</b>().

     Not all volumes support all attributes.  See the discussion of ATTR_VOL_ATTRIBUTES for a discussion of
     how to determine whether a particular volume supports a particular attribute.

     Furthermore, you should only request the attributes that you need.  Some attributes are expensive to
     calculate on some volume formats.  For example, ATTR_DIR_ENTRYCOUNT is usually expensive to calculate
     on non-HFS [Plus] volumes.  If you don't need a particular attribute, you should not ask for it.

     The <u>path</u> parameter must reference a valid file system object.  Read, write or execute permission of the
     object itself is not required, but all directories listed in the path name leading to the object must
     be searchable.

     The <u>attrList</u> parameter is a pointer to an <u>attrlist</u> structure, as defined by &lt;<u>sys/attr.h&gt;</u> (shown below).
     It determines what attributes are returned by the function.  You are responsible for filling out all
     fields of this structure before calling the function.

     typedef u_int32_t attrgroup_t;

     struct attrlist {
         u_short     bitmapcount; /* number of attr. bit sets in list */
         u_int16_t   reserved;    /* (to maintain 4-byte alignment) */
         attrgroup_t commonattr;  /* common attribute group */
         attrgroup_t volattr;     /* volume attribute group */
         attrgroup_t dirattr;     /* directory attribute group */
         attrgroup_t fileattr;    /* file attribute group */
         attrgroup_t forkattr;    /* fork attribute group */
     };
     #define ATTR_BIT_MAP_COUNT 5

     The fields of the <u>attrlist</u> structure are defined as follows.

     bitmapcount     Number of attribute bit sets in the structure.  In current systems you must set this to
                     ATTR_BIT_MAP_COUNT.

     reserved        Reserved.  You must set this to 0.

     commonattr      A bit set that specifies the common attributes that you require.  Common attributes
                     relate to all types of file system objects.  See below for a description of these
                     attributes.

     volattr         A bit set that specifies the volume attributes that you require.  Volume attributes
                     relate to volumes (that is, mounted file systems).  See below for a description of
                     these attributes.  If you request volume attributes, <u>path</u> must reference the root of a
                     volume.  In addition, you can't request volume attributes if you also request file or
                     directory attributes.

     dirattr         A bit set that specifies the directory attributes that you require.  See below for a
                     description of these attributes.

     fileattr        A bit set that specifies the file attributes that you require.  See below for a
                     description of these attributes.

     forkattr        A bit set that specifies the fork attributes that you require.  Fork attributes relate
                     to the actual data in the file, which can be held in multiple named contiguous ranges,
                     or forks.  See below for a description of these attributes.

     Unless otherwise noted in the lists below, attributes are read-only.  Attributes labelled as read/write
     can be set using <a href="setattrlist.2.html#//apple_ref/doc/man/2/setattrlist">setattrlist(2)</a>.

     The <u>attrBuf</u> and <u>attrBufSize</u> parameters specify a buffer into which the function places attribute val-<font color="#ffffff" class="whiteout">ues.&nbsp;values.</font>
     ues.  The format of this buffer is sufficiently complex that its description requires a separate sec-<font color="#ffffff" class="whiteout">tion&nbsp;section</font>
     tion (see below).  The initial contents of this buffer are ignored.

     The <u>options</u> parameter is a bit set that controls the behaviour of <b>getattrlist</b>().  The following option
     bits are defined.

     FSOPT_NOFOLLOW  If this bit is set, <b>getattrlist</b>() will not follow a symlink if it occurs as the last
                     component of <u>path</u>.

<b>ATTRIBUTE</b> <b>BUFFER</b>
     The data returned in the buffer described by <u>attrBuf</u> and <u>attrBufSize</u> is formatted as follows.

     1.   The first element of the buffer is a <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> that contains the overall length, in bytes, of the
          attributes returned.  This size includes the length field itself.

     2.   Following the length field is a list of attributes.  Each attribute is represented by a field of
          its type, where the type is given as part of the attribute description (below).

     3.   The attributes are placed into the attribute buffer in the order that they are described below.

     If the attribute is of variable length, it is represented in the list by an <u>attrreference</u> structure, as
     defined by &lt;<u>sys/attr.h&gt;</u> (shown below).

     typedef struct attrreference {
         long        attr_dataoffset;
         size_t      attr_length;
     } attrreference_t;

     This structure contains a 'pointer' to the variable length attribute data.  The <u>attr</u><b>_</b><u>length</u> field is
     the length of the attribute data (in bytes).  The <u>attr</u><b>_</b><u>dataoffset</u> field is the offset in bytes from the
     <u>attrreference</u> structure to the attribute data.  This offset will always be a multiple of
     sizeof(unsigned long) bytes, so you can safely access common data types without fear of alignment
     exceptions.

     The <b>getattrlist</b>() function will silently truncate attribute data if <u>attrBufSize</u> is too small.  The
     length field at the front of the attribute list always represents the length of the data actually
     copied into the attribute buffer.  If the data is truncated, there is no easy way to determine the
     buffer size that's required to get all of the requested attributes.  You should always pass an
     <u>attrBufSize</u> that is large enough to accommodate the known size of the attributes in the attribute list
     (including the leading length field).

     Because the returned attributes are simply truncated if the buffer is too small, it's possible for a
     variable length attribute to reference data beyond the end of the attribute buffer.  That is, it's pos-<font color="#ffffff" class="whiteout">sible&nbsp;possible</font>
     sible for the attribute data to start beyond the end of the attribute buffer (that is, if <u>attrRef</u> is a
     pointer to the <u>attrreference</u><b>_</b><u>t</u>, ( ( (char *) <u>attrRef</u> ) + <u>attr</u><b>_</b><u>dataoffset</u> ) &gt; ( ( (char *) <u>attrBuf</u> ) +
     <u>attrSize</u> ) ) or, indeed, for the attribute data to extend beyond the end of the attribute buffer (that
     is, ( ( (char *) <u>attrRef</u> ) + <u>attr</u><b>_</b><u>dataoffset</u> + <u>attr</u><b>_</b><u>datalength</u> ) &gt; ( ( (char *) <u>attrBuf</u> ) + <u>attrSize</u> )
     ).  If this happens you must increase the size of the buffer and call <b>getattrlist</b>() to get an accurate
     copy of the attribute.

<b>COMMON</b> <b>ATTRIBUTES</b>
     Common attributes relate to all types of file system objects.  The following common attributes are
     defined.

     ATTR_CMN_NAME             An <u>attrreference</u> structure containing the name of the file system object as
                               UTF-8 encoded, null terminated C string.  The attribute data length will not
                               be greater than NAME_MAX + 1.

     ATTR_CMN_DEVID            A <u>dev</u><b>_</b><u>t</u> containing the device number of the device on which this file system
                               object's volume is mounted.  Equivalent to the <u>st</u><b>_</b><u>dev</u> field of the <u>stat</u>
                               structure returned by <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_CMN_FSID             An <u>fsid</u><b>_</b><u>t</u> structure containing the file system identifier for the volume on
                               which the file system object resides.  Equivalent to the <u>f</u><b>_</b><u>fsid</u> field of the
                               <u>statfs</u> structure returned by <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a>.

                               This value is not related to the file system ID from traditional Mac OS (for
                               example, the <u>filesystemID</u> field of the <u>FSVolumeInfo</u> structure returned by
                               Carbon's FSGetVolumeInfo() function).  On current versions of Mac OS X that
                               value is synthesised by the Carbon File Manager.

     ATTR_CMN_OBJTYPE          An <u>fsobj</u><b>_</b><u>type</u><b>_</b><u>t</u> that identifies the type of file system object.  The values
                               are taken from <u>enum</u> <u>vtype</u> in &lt;<u>sys/vnode.h&gt;</u>.

     ATTR_CMN_OBJTAG           An <u>fsobj</u><b>_</b><u>tag</u><b>_</b><u>t</u> that identifies the type of file system containing the object.
                               The values are taken from <u>enum</u> <u>vtagtype</u> in &lt;<u>sys/vnode.h&gt;</u>.

     ATTR_CMN_OBJID            An <u>fsobj</u><b>_</b><u>id</u><b>_</b><u>t</u> structure that uniquely identifies the file system object
                               within its volume.  The fid_generation field of this structure will be zero
                               for all non-root callers (effective UID not 0).  This identifier need not be
                               persistent across an unmount/mount sequence.

                               Some volume formats use well known values for the <u>fid</u><b>_</b><u>objno</u> field for the
                               root directory (2) and the parent of root directory (1).  This is not a
                               required behaviour of this attribute.

     ATTR_CMN_OBJPERMANENTID   An <u>fsobj</u><b>_</b><u>id</u><b>_</b><u>t</u> structure that uniquely identifies the file system object
                               within its volume.  The fid_generation field of this structure will be zero
                               for all non-root callers (effective UID not 0).  This identifier should be
                               persistent across an unmount/mount sequence.

                               Some file systems (for example, original HFS) may need to modify the on-disk
                               structure to return a persistent identifier.  If such a file system is
                               mounted read-only, an attempt to get this attribute will fail with the error
                               EROFS.

     ATTR_CMN_PAROBJID         An <u>fsobj</u><b>_</b><u>id</u><b>_</b><u>t</u> structure that identifies the parent directory of the file sys-<font color="#ffffff" class="whiteout">tem&nbsp;system</font>
                               tem object.  The fid_generation field of this structure will be zero for all
                               non-root callers (effective UID not 0).  Equivalent to the ATTR_CMN_OBJID
                               attribute of the parent directory.  This identifier need not be persistent
                               across an unmount/mount sequence.

                               On a volume that supports hard links, a multiply linked file has no unique
                               parent.  This attribute will return an unspecified parent.

                               For some volume formats this attribute is very expensive to calculate.

     ATTR_CMN_SCRIPT           (read/write) A <u>text</u><b>_</b><u>encoding</u><b>_</b><u>t</u> containing a text encoding hint for the file
                               system object's name.  It is included to facilitate the lossless round trip
                               conversion of names between Unicode and traditional Mac OS script encodings.
                               The values are defined in &lt;<u>CarbonCore/TextCommon.h&gt;</u>.  File systems that do
                               not have an appropriate text encoding value should return kTextEncodingMacU-<font color="#ffffff" class="whiteout">nicode.&nbsp;kTextEncodingMacUnicode.</font>
                               nicode.  See DTS Q&amp;A 1173 "File Manager Text Encoding Hints".

     ATTR_CMN_CRTIME           (read/write) A <u>timespec</u> structure containing the time that the file system
                               object was created.

     ATTR_CMN_MODTIME          (read/write) A <u>timespec</u> structure containing the time that the file system
                               object was last modified.  Equivalent to the <u>st</u><b>_</b><u>mtimespec</u> field of the <u>stat</u>
                               structure returned by <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_CMN_CHGTIME          (read/write) A <u>timespec</u> structure containing the time that the file system
                               object's attributes were last modified.  Equivalent to the <u>st</u><b>_</b><u>ctimespec</u> field
                               of the <u>stat</u> structure returned by <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_CMN_ACCTIME          (read/write) A <u>timespec</u> structure containing the time that the file system
                               object was last accessed.  Equivalent to the <u>st</u><b>_</b><u>atimespec</u> field of the <u>stat</u>
                               structure returned by <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_CMN_BKUPTIME         (read/write) A <u>timespec</u> structure containing the time that the file system
                               object was last backed up.  This value is for use by backup utilities.  The
                               file system stores but does not interpret the value.

     ATTR_CMN_FNDRINFO         (read/write) 32 bytes of data for use by the Finder.  Equivalent to the con-<font color="#ffffff" class="whiteout">catenation&nbsp;concatenation</font>
                               catenation of a <u>FileInfo</u> structure and an <u>ExtendedFileInfo</u> structure (or, for
                               directories, a <u>FolderInfo</u> structure and an <u>ExtendedFolderInfo</u> structure).
                               These structures are defined in &lt;<u>CarbonCore/Finder.h&gt;</u>.

                               This attribute is not byte swapped by the file system.  The value of multi-<font color="#ffffff" class="whiteout">byte&nbsp;multibyte</font>
                               byte fields on disk is always big endian.  When running on a little endian
                               system (such as Darwin on x86), you must byte swap any multibyte fields.

     ATTR_CMN_OWNERID          (read/write) A <u>uid</u><b>_</b><u>t</u> containing the owner of the file system object.  Equiva-<font color="#ffffff" class="whiteout">lent&nbsp;Equivalent</font>
                               lent to the <u>st</u><b>_</b><u>uid</u> field of the <u>stat</u> structure returned by <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_CMN_GRPID            (read/write) A <u>gid</u><b>_</b><u>t</u> containing the group of the file system object.  Equiva-<font color="#ffffff" class="whiteout">lent&nbsp;Equivalent</font>
                               lent to the <u>st</u><b>_</b><u>gid</u> field of the <u>stat</u> structure returned by <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_CMN_ACCESSMASK       (read/write) A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the access permissions of the file system
                               object.  Equivalent to the <u>st</u><b>_</b><u>mode</u> field of the <u>stat</u> structure returned by
                               <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_CMN_NAMEDATTRCOUNT   A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the number of named attributes of the file system
                               object.

     ATTR_CMN_NAMEDATTRLIST    An <u>attrreference</u> structure containing a list of named attributes of the file
                               system object.  No built-in file systems on Mac OS X currently support named
                               attributes.  Because of this, the structure of this attribute's value is not
                               yet defined.

     ATTR_CMN_FLAGS            (read/write) A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing file flags.  Equivalent to the <u>st</u><b>_</b><u>flags</u>
                               field of the <u>stat</u> structure returned by <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.  For more information about
                               these flags, see <a href="chflags.2.html#//apple_ref/doc/man/2/chflags">chflags(2)</a>.

                               The order that attributes are placed into the attribute buffer almost invari-<font color="#ffffff" class="whiteout">ably&nbsp;invariably</font>
                               ably matches the order of the attribute mask bit values.  The exception is
                               ATTR_CMN_FLAGS.  If its order was based on its bit position, it would be
                               before the ATTR_CMN_NAMEDATTRCOUNT / ATTR_CMN_NAMEDATTRLIST pair, however, it
                               is placed in the buffer after them.

     ATTR_CMN_USERACCESS       A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the effective permissions of the current user (the
                               calling process's effective UID) for this file system object.  You can test
                               for read, write, and execute permission using R_OK, W_OK, and X_OK, respec-<font color="#ffffff" class="whiteout">tively.&nbsp;respectively.</font>
                               tively.  See <a href="access.2.html#//apple_ref/doc/man/2/access">access(2)</a> for more details.

     ATTR_CMN_FILEID           A <u>u</u><b>_</b><u>int64</u><b>_</b><u>t</u> that uniquely identifies the file system object within its vol-<font color="#ffffff" class="whiteout">ume.&nbsp;volume.</font>
                               ume.

     ATTR_CMN_PARENTID         A <u>u</u><b>_</b><u>int64</u><b>_</b><u>t</u> that identifies the parent directory of the file system object.

<b>VOLUME</b> <b>ATTRIBUTES</b>
     Volume attributes relate to volumes (that is, mounted file systems).  The following volume attributes
     are defined.

     ATTR_VOL_INFO             For reasons that are not at all obvious, you must set ATTR_VOL_INFO in the
                               <u>volattr</u> field if you request any other volume attributes.  This does not
                               result in any attribute data being added to the attribute buffer.

     ATTR_VOL_FSTYPE           A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the file system type.  Equivalent to the <u>f</u><b>_</b><u>type</u> field
                               of the <u>statfs</u> structure returned by <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a>.  Generally not a useful value.

     ATTR_VOL_SIGNATURE        A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the volume signature word.  This value is unique
                               within a given file system type and lets you distinguish between different
                               volume formats handled by the same file system.  See &lt;<u>CarbonCore/Files.h&gt;</u> for
                               more details.

     ATTR_VOL_SIZE             An <u>off</u><b>_</b><u>t</u> containing the total size of the volume in bytes.

     ATTR_VOL_SPACEFREE        An <u>off</u><b>_</b><u>t</u> containing the free space on the volume in bytes.

     ATTR_VOL_SPACEAVAIL       An <u>off</u><b>_</b><u>t</u> containing the space, in bytes, on the volume available to non-priv-<font color="#ffffff" class="whiteout">ileged&nbsp;non-privileged</font>
                               ileged processes.  This is the free space minus the amount of space reserved
                               by the system to prevent critical disk exhaustion errors.  Non-privileged
                               programs, like a disk management tool, should use this value to display the
                               space available to the user.

                               ATTR_VOL_SPACEAVAIL is to ATTR_VOL_SPACEFREE as <u>f</u><b>_</b><u>bavail</u> is to <u>f</u><b>_</b><u>bfree</u> in
                               <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a>.

     ATTR_VOL_MINALLOCATION    An <u>off</u><b>_</b><u>t</u> containing the minimum allocation size on the volume in bytes.  If
                               you create a file containing one byte, it will consume this much space.

     ATTR_VOL_ALLOCATIONCLUMP  An <u>off</u><b>_</b><u>t</u> containing the allocation clump size on the volume, in bytes.  As a
                               file is extended, the file system will attempt to allocate this much space
                               each time in order to reduce fragmentation.

     ATTR_VOL_IOBLOCKSIZE      A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the optimal block size when reading or writing data.
                               Equivalent to the <u>f</u><b>_</b><u>iosize</u> field of the <u>statfs</u> structure returned by
                               <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a>.

     ATTR_VOL_OBJCOUNT         A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the number of file system objects on the volume.

     ATTR_VOL_FILECOUNT        A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the number of files on the volume.

     ATTR_VOL_DIRCOUNT         A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the number of directories on the volume.

     ATTR_VOL_MAXOBJCOUNT      A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the maximum number of file system objects that can be
                               stored on the volume.

     ATTR_VOL_MOUNTPOINT       An <u>attrreference</u> structure containing the path to the volume's mount point as
                               a UTF-8 encoded, null terminated C string.  The attribute data length will
                               not be greater than MAXPATHLEN.  Equivalent to the <u>f</u><b>_</b><u>mntonname</u> field of the
                               <u>statfs</u> structure returned by <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a>.

     ATTR_VOL_NAME             (read/write) An <u>attrreference</u> structure containing the name of the volume as
                               a UTF-8 encoded, null terminated C string.  The attribute data length will
                               not be greater than NAME_MAX + 1.

                               This attribute is only read/write if the VOL_CAP_INT_VOL_RENAME bit is set in
                               the volume capabilities (see below).

     ATTR_VOL_MOUNTFLAGS       A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the volume mount flags.  This is a copy of the value
                               passed to the <u>flags</u> parameter of <a href="mount.2.html#//apple_ref/doc/man/2/mount">mount(2)</a> when the volume was mounted.
                               Equivalent to the <u>f</u><b>_</b><u>flags</u> field of the <u>statfs</u> structure returned by
                               <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a>.

     ATTR_VOL_MOUNTEDDEVICE    An <u>attrreference</u> structure that returns the same value as the <u>f</u><b>_</b><u>mntfromname</u>
                               field of the <u>statfs</u> structure returned by <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a>.  For local volumes this
                               is the path to the device on which the volume is mounted as a UTF-8 encoded,
                               null terminated C string.  For network volumes, this is a unique string that
                               identifies the mount.  The attribute data length will not be greater than
                               MAXPATHLEN.

     ATTR_VOL_ENCODINGSUSED    An <u>unsigned</u> <u>long</u> <u>long</u> containing a bitmap of the text encodings used on this
                               volume.  For more information about this, see the discussion of
                               <u>encodingsBitmap</u> in DTS Technote 1150 "HFS Plus Volume Format".

     ATTR_VOL_CAPABILITIES     A <u>vol</u><b>_</b><u>capabilities</u><b>_</b><u>attr</u><b>_</b><u>t</u> structure describing the optional features sup-<font color="#ffffff" class="whiteout">ported&nbsp;supported</font>
                               ported by this volume.  See below for a discussion of volume capabilities.

     ATTR_VOL_ATTRIBUTES       A <u>vol</u><b>_</b><u>attributes</u><b>_</b><u>attr</u><b>_</b><u>t</u> structure describing the attributes supported by this
                               volume.  This structure is discussed below, along with volume capabilities.

<b>DIRECTORY</b> <b>ATTRIBUTES</b>
     The following directory attributes are defined.

     ATTR_DIR_LINKCOUNT        A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the number of hard links to the directory; this does
                               not include the historical "." and ".." entries.  For filesystems that do not
                               support hard links to directories, this value will be 1.

     ATTR_DIR_ENTRYCOUNT       A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the number of file system objects in the directory,
                               not including any synthetic items.

     ATTR_DIR_MOUNTSTATUS      A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing flags describing what's mounted on the directory.
                               Currently the only flag defined is DIR_MNTSTATUS_MNTPOINT, which indicates
                               that there is a file system mounted on this directory.  Due to a bug (r.
                               3502822), this flag is never set on current system.

<b>FILE</b> <b>ATTRIBUTES</b>
     The following file attributes are defined.

     ATTR_FILE_LINKCOUNT       A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the number of hard links to this file.  Equivalent to
                               the <u>st</u><b>_</b><u>nlink</u> field of the <u>stat</u> structure returned by <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_FILE_TOTALSIZE       An <u>off</u><b>_</b><u>t</u> containing the total number of bytes in all forks of the file (the
                               logical size).

     ATTR_FILE_ALLOCSIZE       An <u>off</u><b>_</b><u>t</u> containing a count of the bytes on disk used by all of the file's
                               forks (the physical size).

     ATTR_FILE_IOBLOCKSIZE     A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the optimal block size when reading or writing this
                               file's data.

     ATTR_FILE_CLUMPSIZE       A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the allocation clump size for this file, in bytes.  As
                               the file is extended, the file system will attempt to allocate this much
                               space each time in order to reduce fragmentation.  This value applies to the
                               data fork.

     ATTR_FILE_DEVTYPE         (read/write) A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the device type for a special device
                               file.  Equivalent to the <u>st</u><b>_</b><u>rdev</u> field of the <u>stat</u> structure returned by
                               <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>.

     ATTR_FILE_FILETYPE        A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> that whose value is reserved.  Clients should ignore its value.
                               New volume format implementations should not support this attribute.

     ATTR_FILE_FORKCOUNT       A <u>u</u><b>_</b><u>int32</u><b>_</b><u>t</u> containing the number of forks in the file.  No built-in file
                               systems on Mac OS X currently support forks other than the data and resource
                               fork.

     ATTR_FILE_FORKLIST        An <u>attrreference</u> structure containing a list of named forks of the file.  No
                               built-in file systems on Mac OS X currently support forks other than the data
                               and resource fork.  Because of this, the structure of this attribute's value
                               is not yet defined.

     ATTR_FILE_DATALENGTH      An <u>off</u><b>_</b><u>t</u> containing the length of the data fork in bytes (the logical size).

     ATTR_FILE_DATAALLOCSIZE   An <u>off</u><b>_</b><u>t</u> containing a count of the bytes on disk used by the data fork (the
                               physical size).

     ATTR_FILE_DATAEXTENTS     An <u>extentrecord</u> array for the data fork.  The array contains eight <u>diskextent</u>
                               structures which represent the first eight extents of the fork.

                               This attributes exists for compatibility reasons.  New clients should not use
                               this attribute.  Rather, they should use the F_LOG2PHYS command in <a href="fcntl.2.html#//apple_ref/doc/man/2/fcntl">fcntl(2)</a>.

                               In current implementations the value may not be entirely accurate for a vari-<font color="#ffffff" class="whiteout">ety&nbsp;variety</font>
                               ety of reasons.

     ATTR_FILE_RSRCLENGTH      An <u>off</u><b>_</b><u>t</u> containing the length of the resource fork in bytes (the logical
                               size).

     ATTR_FILE_RSRCALLOCSIZE   An <u>off</u><b>_</b><u>t</u> containing a count of the bytes on disk used by the resource fork
                               (the physical size).

     ATTR_FILE_RSRCEXTENTS     An <u>extentrecord</u> array for the resource fork.  The array contains eight
                               <u>diskextent</u> structures which represent the first eight extents of the fork.

                               See also ATTR_FILE_DATAEXTENTS.

<b>FORK</b> <b>ATTRIBUTES</b>
     Fork attributes relate to the actual data in the file, which can be held in multiple named contiguous
     ranges, or forks.  The following fork attributes are defined.

     ATTR_FORK_TOTALSIZE       An <u>off</u><b>_</b><u>t</u> containing the length of the fork in bytes (the logical size).

     ATTR_FORK_ALLOCSIZE       An <u>off</u><b>_</b><u>t</u> containing a count of the bytes on disk used by the fork (the physi-<font color="#ffffff" class="whiteout">cal&nbsp;physical</font>
                               cal size).

     Fork attributes are not properly implemented by any current Mac OS X volume format implementation.  We
     strongly recommend that client programs do not request fork attributes.  If you are implementing a vol-<font color="#ffffff" class="whiteout">ume&nbsp;volume</font>
     ume format, you should not support these attributes.

<b>VOLUME</b> <b>CAPABILITIES</b>
     Not all volumes support all features.  The ATTR_VOL_CAPABILITIES attribute returns a
     <u>vol</u><b>_</b><u>capabilities</u><b>_</b><u>attr</u><b>_</b><u>t</u> structure (shown below) that indicates which features are supported by the vol-<font color="#ffffff" class="whiteout">ume.&nbsp;volume.</font>
     ume.

     typedef u_int32_t vol_capabilities_set_t[4];

     #define VOL_CAPABILITIES_FORMAT     0
     #define VOL_CAPABILITIES_INTERFACES 1
     #define VOL_CAPABILITIES_RESERVED1  2
     #define VOL_CAPABILITIES_RESERVED2  3

     typedef struct vol_capabilities_attr {
         vol_capabilities_set_t capabilities;
         vol_capabilities_set_t valid;
     } vol_capabilities_attr_t;

     The structure contains two fields, <u>capabilities</u> and <u>valid</u>.  Each consists of an array of four elements.
     The arrays are indexed by the following values.

     VOL_CAPABILITIES_FORMAT          This element contains information about the volume format.  See
                                      VOL_CAP_FMT_PERSISTENTOBJECTIDS and so on, below.

     VOL_CAPABILITIES_INTERFACES      This element contains information about which optional functions are
                                      supported by the volume format implementation.  See
                                      VOL_CAP_INT_SEARCHFS and so on, below.

     VOL_CAPABILITIES_RESERVED1       Reserved.  A file system implementation should set this element to
                                      zero.  A client program should ignore this element.

     VOL_CAPABILITIES_RESERVED2       Reserved.  A file system implementation should set this element to
                                      zero.  A client program should ignore this element.

     The <u>valid</u> field contains bit sets that indicate which flags are known to the volume format implementa-<font color="#ffffff" class="whiteout">tion.&nbsp;implementation.</font>
     tion.  Each bit indicates whether the contents of the corresponding bit in the <u>capabilities</u> field is
     valid.

     The <u>capabilities</u> field contains bit sets that indicate whether a particular feature is implemented by
     this volume format.

     The following bits are defined in the first element (indexed by VOL_CAPABILITIES_FORMAT) of the
     <u>capabilities</u> and <u>valid</u> fields of the <u>vol</u><b>_</b><u>capabilities</u><b>_</b><u>attr</u><b>_</b><u>t</u> structure.

     VOL_CAP_FMT_PERSISTENTOBJECTIDS  If this bit is set the volume format supports persistent object iden-<font color="#ffffff" class="whiteout">tifiers&nbsp;identifiers</font>
                                      tifiers and can look up file system objects by their IDs.  See
                                      ATTR_CMN_OBJPERMANENTID for details about how to obtain these identi-<font color="#ffffff" class="whiteout">fiers.&nbsp;identifiers.</font>
                                      fiers.

     VOL_CAP_FMT_SYMBOLICLINKS        If this bit is set the volume format supports symbolic links.

     VOL_CAP_FMT_HARDLINKS            If this bit is set the volume format supports hard links.

     VOL_CAP_FMT_JOURNAL              If this bit is set the volume format supports a journal used to speed
                                      recovery in case of unplanned restart (such as a power outage or
                                      crash).  This does not necessarily mean the volume is actively using a
                                      journal.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_FMT_JOURNAL_ACTIVE       If this bit is set the volume is currently using a journal for speedy
                                      recovery after an unplanned restart.  This bit can be set only if
                                      VOL_CAP_FMT_JOURNAL is also set.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_FMT_NO_ROOT_TIMES        If this bit is set the volume format does not store reliable times for
                                      the root directory, so you should not depend on them to detect
                                      changes, identify volumes across unmount/mount, and so on.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_FMT_SPARSE_FILES         If this bit is set the volume format supports sparse files, that is,
                                      files which can have 'holes' that have never been written to, and thus
                                      do not consume space on disk.  A sparse file may have an allocated
                                      size on disk that is less than its logical length (that is,
                                      ATTR_FILE_ALLOCSIZE &lt; ATTR_FILE_TOTALSIZE ).

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_FMT_ZERO_RUNS            For security reasons, parts of a file (runs) that have never been
                                      written to must appear to contain zeroes.  When this bit is set, the
                                      volume keeps track of allocated but unwritten runs of a file so that
                                      it can substitute zeroes without actually writing zeroes to the media.
                                      This provides performance similar to sparse files, but not the space
                                      savings.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_FMT_CASE_SENSITIVE       If this bit is set the volume format treats upper and lower case char-
                                      acters in file and directory names as different.  Otherwise an upper
                                      case character is equivalent to a lower case character, and you can't
                                      have two names that differ solely in the case of the characters.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_FMT_CASE_PRESERVING      If this bit is set the volume format preserves the case of file and
                                      directory names.  Otherwise the volume may change the case of some
                                      characters (typically making them all upper or all lower case).  A
                                      volume that sets VOL_CAP_FMT_CASE_SENSITIVE must also set
                                      VOL_CAP_FMT_CASE_PRESERVING.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_FMT_FAST_STATFS          This bit is used as a hint to upper layers (specifically the Carbon
                                      File Manager) to indicate that <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a> is fast enough that its
                                      results need not be cached by the caller.  A volume format implementa-<font color="#ffffff" class="whiteout">tion&nbsp;implementation</font>
                                      tion that caches the <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a> information in memory should set this
                                      bit.  An implementation that must always read from disk or always per-<font color="#ffffff" class="whiteout">form&nbsp;perform</font>
                                      form a network transaction to satisfy <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a> should not set this
                                      bit.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_FMT_2TB_FILESIZE         If this bit is set the volume format supports file sizes upto 2TB.
                                      This bit does not necessarily mean that the file system does not sup-<font color="#ffffff" class="whiteout">port&nbsp;support</font>
                                      port file size more than 2TB.  This bit does not mean that the cur-<font color="#ffffff" class="whiteout">rently&nbsp;currently</font>
                                      rently available space on the volume is 2TB.

                                      Introduced with Darwin 8.0 (Mac OS X version 10.4).

     The following bits are defined in the second element (indexed by VOL_CAPABILITIES_INTERFACES) of the
     <u>capabilities</u> and <u>valid</u> fields of the <u>vol</u><b>_</b><u>capabilities</u><b>_</b><u>attr</u><b>_</b><u>t</u> structure.

     VOL_CAP_INT_SEARCHFS             If this bit is set the volume format implementation supports
                                      <a href="searchfs.2.html#//apple_ref/doc/man/2/searchfs">searchfs(2)</a>.

     VOL_CAP_INT_ATTRLIST             If this bit is set the volume format implementation supports
                                      <b>getattrlist</b>() and <a href="setattrlist.2.html#//apple_ref/doc/man/2/setattrlist">setattrlist(2)</a>.

     VOL_CAP_INT_NFSEXPORT            If this bit is set the volume format implementation allows this volume
                                      to be exported via NFS.

     VOL_CAP_INT_READDIRATTR          If this bit is set the volume format implementation supports
                                      <a href="getdirentriesattr.2.html#//apple_ref/doc/man/2/getdirentriesattr">getdirentriesattr(2)</a>.

     VOL_CAP_INT_EXCHANGEDATA         If this bit is set the volume format implementation supports
                                      <a href="exchangedata.2.html#//apple_ref/doc/man/2/exchangedata">exchangedata(2)</a>.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_INT_COPYFILE             If this bit is set the volume format implementation supports the (pri-<font color="#ffffff" class="whiteout">vate&nbsp;(private</font>
                                      vate and undocumented) copyfile() function.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_INT_ALLOCATE             If this bit is set the volume format implementation supports the
                                      F_PREALLOCATE selector of <a href="fcntl.2.html#//apple_ref/doc/man/2/fcntl">fcntl(2)</a>.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_INT_VOL_RENAME           If this bit is set the volume format implementation allows you to mod-<font color="#ffffff" class="whiteout">ify&nbsp;modify</font>
                                      ify the volume name using <a href="setattrlist.2.html#//apple_ref/doc/man/2/setattrlist">setattrlist(2)</a>.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_INT_ADVLOCK              If this bit is set the volume format implementation supports advisory
                                      locking, that is, the F_GETLK, F_SETLK, and F_SETLKW selectors to
                                      <a href="fcntl.2.html#//apple_ref/doc/man/2/fcntl">fcntl(2)</a>.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_INT_FLOCK                If this bit is set the volume format implementation supports whole
                                      file locks.  This includes <a href="flock.2.html#//apple_ref/doc/man/2/flock">flock(2)</a> and the O_EXLOCK and O_SHLOCK
                                      flags to <a href="open.2.html#//apple_ref/doc/man/2/open">open(2)</a>.

                                      Introduced with Darwin 7.0 (Mac OS X version 10.3).

     VOL_CAP_INT_EXTENDED_SECURITY    If this bit is set the volume format implementation supports extended
                                      security controls (ACLs).

                                      Introduced with Darwin 8.0 (Mac OS X version 10.4).

     VOL_CAP_INT_USERACCESS           If this bit is set the volume format implementation supports the
                                      ATTR_CMN_USERACCESS attribute.

                                      Introduced with Darwin 8.0 (Mac OS X version 10.4).

     A volume can also report which attributes it supports.  This information is returned by the
     ATTR_VOL_ATTRIBUTES attribute, which returns a <u>vol</u><b>_</b><u>attributes</u><b>_</b><u>attr</u><b>_</b><u>t</u> structure (shown below).

     typedef struct attribute_set {
         attrgroup_t commonattr; /* common attribute group */
         attrgroup_t volattr;    /* volume attribute group */
         attrgroup_t dirattr;    /* directory attribute group */
         attrgroup_t fileattr;   /* file attribute group */
         attrgroup_t forkattr;   /* fork attribute group */
     } attribute_set_t;

     typedef struct vol_attributes_attr {
         attribute_set_t validattr;
         attribute_set_t nativeattr;
     } vol_attributes_attr_t;

     The <u>validattr</u> field consists of a number of bit sets that indicate whether an attribute is supported by
     the volume format implementation.  The <u>nativeattr</u> is similar except that the bit sets indicate whether
     an attribute is supported natively by the volume format.  An attribute is supported natively if the
     volume format implementation does not have to do any complex conversions to access the attribute.  For
     example, a volume format might support persistent object identifiers, but doing so requires a complex
     table lookup that is not part of the core volume format.  In that case, the ATTR_VOL_ATTRIBUTES
     attribute would return ATTR_CMN_OBJPERMANENTID set in the <u>validattr</u> field of the <u>vol</u><b>_</b><u>attributes</u><b>_</b><u>attr</u><b>_</b><u>t</u>,
     but not in the <u>nativeattr</u> field.

<b>RETURN</b> <b>VALUES</b>
     Upon successful completion a value of 0 is returned.  Otherwise, a value of -1 is returned and <u>errno</u> is
     set to indicate the error.

<b>COMPATIBILITY</b>
     Not all volumes support <b>getattrlist</b>().  The best way to test whether a volume supports this function is
     to simply call it and check the error result.  <b>getattrlist</b>() will return ENOTSUP if it is not supported
     on a particular volume.

     The <b>getattrlist</b>() function has been undocumented for more than two years.  In that time a number of
     volume format implementations have been created without a proper specification for the behaviour of
     this routine.  You may encounter volume format implementations with slightly different behaviour than
     what is described here.  Your program is expected to be tolerant of this variant behaviour.

     If you're implementing a volume format that supports <b>getattrlist</b>(), you should be careful to support
     the behaviour specified by this document.

<b>ERRORS</b>
     <b>getattrlist</b>() will fail if:

     [ENOTSUP]          The volume does not support <b>getattrlist</b>().

     [ENOTDIR]          A component of the path prefix is not a directory.

     [ENAMETOOLONG]     A component of a path name exceeded NAME_MAX characters, or an entire path name
                        exceeded PATH_MAX characters.

     [ENOENT]           The file system object does not exist.

     [EACCES]           Search permission is denied for a component of the path prefix.

     [ELOOP]            Too many symbolic links were encountered in translating the pathname.

     [EFAULT]           <u>path</u>, <u>attrList</u> or <u>attrBuf</u> points to an invalid address.

     [EINVAL]           The <u>bitmapcount</u> field of <u>attrList</u> is not ATTR_BIT_MAP_COUNT.

     [EINVAL]           You requested an invalid attribute.

     [EINVAL]           You requested an attribute that is not supported for this file system object.

     [EINVAL]           You requested volume attributes and directory or file attributes.

     [EINVAL]           You requested volume attributes but <u>path</u> does not reference the root of the volume.

     [EROFS]            The volume is read-only but must be modified in order to return this attribute.

     [EIO]              An I/O error occurred while reading from or writing to the file system.

<b>CAVEATS</b>
     If you request any volume attributes, you must set ATTR_VOL_INFO in the <u>volattr</u> field, even though it
     generates no result in the attribute buffer.

     The order that attributes are stored in the attribute buffer almost invariably matches the order of
     attribute mask bit values.  For example, ATTR_CMN_NAME (0x00000001) comes before ATTR_CMN_DEVID
     (0x00000002) because its value is smaller.  However, you can not rely on this ordering because there is
     one key exception: ATTR_CMN_FLAGS is placed after the ATTR_CMN_NAMEDATTRCOUNT / ATTR_CMN_NAMEDATTRLIST
     pair, even though its bit position indicates that it should come before.  This is due to a bug in an
     early version of Mac OS X that can't be fixed for binary compatibility reasons.  When ordering
     attributes, you should always use the order in which they are described above.

     For more caveats, see also the compatibility notes above.

<b>EXAMPLES</b>
     The following code prints the file type and creator of a file, assuming that the volume supports the
     required attributes.

     #include &lt;assert.h&gt;
     #include &lt;stdio.h&gt;
     #include &lt;string.h&gt;
     #include &lt;sys/attr.h&gt;
     #include &lt;sys/errno.h&gt;
     #include &lt;unistd.h&gt;
     #include &lt;sys/vnode.h&gt;

     typedef struct attrlist attrlist_t;

     struct FInfoAttrBuf {
         u_int32_t       length;
         fsobj_type_t    objType;
         char            finderInfo[32];
     };
     typedef struct FInfoAttrBuf FInfoAttrBuf;

     static int FInfoDemo(const char *path)
     {
         int             err;
         attrlist_t      attrList;
         FInfoAttrBuf    attrBuf;

         memset(&amp;attrList, 0, sizeof(attrList));
         attrList.bitmapcount = ATTR_BIT_MAP_COUNT;
         attrList.commonattr  = ATTR_CMN_OBJTYPE | ATTR_CMN_FNDRINFO;

         err = getattrlist(path, &amp;attrList, &amp;attrBuf, sizeof(attrBuf), 0);
         if (err != 0) {
             err = errno;
         }

         if (err == 0) {
             assert(attrBuf.length == sizeof(attrBuf));

             printf("Finder information for %s:\n", path);
             switch (attrBuf.objType) {
                 case VREG:
                     printf("file type    = '%.4s'\n", &amp;attrBuf.finderInfo[0]);
                     printf("file creator = '%.4s'\n", &amp;attrBuf.finderInfo[4]);
                     break;
                 case VDIR:
                     printf("directory\n");
                     break;
                 default:
                     printf("other object type, %d\n", attrBuf.objType);
                     break;
             }
         }

         return err;
     }

     The following code is an alternative implementation that uses nested structures to group the related
     attributes.

     #include &lt;assert.h&gt;
     #include &lt;stdio.h&gt;
     #include &lt;stddef.h&gt;
     #include &lt;string.h&gt;
     #include &lt;sys/attr.h&gt;
     #include &lt;sys/errno.h&gt;
     #include &lt;unistd.h&gt;
     #include &lt;sys/vnode.h&gt;

     typedef struct attrlist attrlist_t;

     struct FInfo2CommonAttrBuf {
         fsobj_type_t    objType;
         char            finderInfo[32];
     };
     typedef struct FInfo2CommonAttrBuf FInfo2CommonAttrBuf;

     struct FInfo2AttrBuf {
         u_int32_t           length;
         FInfo2CommonAttrBuf common;
     };
     typedef struct FInfo2AttrBuf FInfo2AttrBuf;

     static int FInfo2Demo(const char *path)
     {
         int             err;
         attrlist_t      attrList;
         FInfo2AttrBuf   attrBuf;

         memset(&amp;attrList, 0, sizeof(attrList));
         attrList.bitmapcount = ATTR_BIT_MAP_COUNT;
         attrList.commonattr  = ATTR_CMN_OBJTYPE | ATTR_CMN_FNDRINFO;

         err = getattrlist(path, &amp;attrList, &amp;attrBuf, sizeof(attrBuf), 0);
         if (err != 0) {
             err = errno;
         }

         if (err == 0) {
             assert(attrBuf.length == sizeof(attrBuf));

             printf("Finder information for %s:\n", path);
             switch (attrBuf.common.objType) {
                 case VREG:
                     printf(
                         "file type    = '%.4s'\n",
                         &amp;attrBuf.common.finderInfo[0]
                     );
                     printf(
                         "file creator = '%.4s'\n",
                         &amp;attrBuf.common.finderInfo[4]
                     );
                     break;
                 case VDIR:
                     printf("directory\n");
                     break;
                 default:
                     printf(
                         "other object type, %d\n",
                         attrBuf.common.objType
                     );
                     break;
             }
         }

         return err;
     }

     The following example shows how to deal with variable length attributes.  It assumes that the volume
     specified by <u>path</u> supports the necessary attributes.

     #include &lt;assert.h&gt;
     #include &lt;stdio.h&gt;
     #include &lt;stddef.h&gt;
     #include &lt;string.h&gt;
     #include &lt;sys/attr.h&gt;
     #include &lt;sys/errno.h&gt;
     #include &lt;unistd.h&gt;
     #include &lt;sys/vnode.h&gt;

     typedef struct attrlist attrlist_t;

     struct VolAttrBuf {
         u_int32_t       length;
         u_int32_t       fileCount;
         u_int32_t       dirCount;
         attrreference_t mountPointRef;
         attrreference_t volNameRef;
         char            mountPointSpace[MAXPATHLEN];
         char            volNameSpace[MAXPATHLEN];
     };
     typedef struct VolAttrBuf VolAttrBuf;

     static int VolDemo(const char *path)
     {
         int             err;
         attrlist_t      attrList;
         VolAttrBuf      attrBuf;

         memset(&amp;attrList, 0, sizeof(attrList));
         attrList.bitmapcount = ATTR_BIT_MAP_COUNT;
         attrList.volattr     =   ATTR_VOL_INFO
                                | ATTR_VOL_FILECOUNT
                                | ATTR_VOL_DIRCOUNT
                                | ATTR_VOL_MOUNTPOINT
                                | ATTR_VOL_NAME;

         err = getattrlist(path, &amp;attrList, &amp;attrBuf, sizeof(attrBuf), 0);
         if (err != 0) {
             err = errno;
         }

         if (err == 0) {
             assert(attrBuf.length &gt;  offsetof(VolAttrBuf, mountPointSpace));
             assert(attrBuf.length &lt;= sizeof(attrBuf));

             printf("Volume information for %s:\n", path);
             printf("ATTR_VOL_FILECOUNT:  %lu\n", attrBuf.fileCount);
             printf("ATTR_VOL_DIRCOUNT:   %lu\n", attrBuf.dirCount);
             printf(
                 "ATTR_VOL_MOUNTPOINT: %.*s\n",
                 (int) attrBuf.mountPointRef.attr_length,
                 ( ((char *) &amp;attrBuf.mountPointRef)
                   + attrBuf.mountPointRef.attr_dataoffset )
             );
             printf(
                 "ATTR_VOL_NAME:       %.*s\n",
                 (int) attrBuf.volNameRef.attr_length,
                 ( ((char *) &amp;attrBuf.volNameRef)
                   + attrBuf.volNameRef.attr_dataoffset )
             );
         }

         return err;
     }

<b>SEE</b> <b>ALSO</b>
     <a href="access.2.html#//apple_ref/doc/man/2/access">access(2)</a>, <a href="chflags.2.html#//apple_ref/doc/man/2/chflags">chflags(2)</a>, <a href="exchangedata.2.html#//apple_ref/doc/man/2/exchangedata">exchangedata(2)</a>, <a href="fcntl.2.html#//apple_ref/doc/man/2/fcntl">fcntl(2)</a>, <a href="getdirentriesattr.2.html#//apple_ref/doc/man/2/getdirentriesattr">getdirentriesattr(2)</a>, <a href="mount.2.html#//apple_ref/doc/man/2/mount">mount(2)</a>, <a href="searchfs.2.html#//apple_ref/doc/man/2/searchfs">searchfs(2)</a>,
     <a href="setattrlist.2.html#//apple_ref/doc/man/2/setattrlist">setattrlist(2)</a>, <a href="stat.2.html#//apple_ref/doc/man/2/stat">stat(2)</a>, <a href="statfs.2.html#//apple_ref/doc/man/2/statfs">statfs(2)</a>

<b>HISTORY</b>
     A <b>getattrlist</b>() function call appeared in Darwin 1.3.1 (Mac OS X version 10.0).

Darwin                         October 14, 2004                         Darwin
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man2/getattrlist.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man2/getattrlist.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man2/getattrlist.2.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
