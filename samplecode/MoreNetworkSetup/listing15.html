<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>MoreNetworkSetup - /NetworkSetup/NetworkSetupHelpers.h</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/LegacyTechnologies/index.html">Legacy Documents</a> &gt; <a href="../../samplecode/LegacyTechnologies/idxCarbon-date.html">Carbon</a> &gt; <A HREF="javascript:location.replace('index.html');">MoreNetworkSetup</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>This document is part of the Legacy section of the ADC Reference Library. This information should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/Carbon/idxNetworking-date.html" target="_blank">Carbon > Networking</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">MoreNetworkSetup</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/NetworkSetup/NetworkSetupHelpers.h</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/MoreInterfaceLib/MoreInterfaceLib.c</option>
<option value="listing2.html">/MoreInterfaceLib/MoreInterfaceLib.h</option>
<option value="listing3.html">/MoreInterfaceLib/RemoteAccessInterface.h</option>
<option value="listing4.html">/MoreMemory/MoreMemory.c</option>
<option value="listing5.html">/MoreMemory/MoreMemory.h</option>
<option value="listing6.html">/MoreQuickDraw/MoreQuickDraw.cp</option>
<option value="listing7.html">/MoreQuickDraw/MoreQuickDraw.h</option>
<option value="listing8.html">/MoreSetup.h</option>
<option value="listing9.html">/MoreTextUtils/MoreTextUtils.cp</option>
<option value="listing10.html">/MoreTextUtils/MoreTextUtils.h</option>
<option value="listing11.html">/NetworkSetup/MoreNetworkSetup.c</option>
<option value="listing12.html">/NetworkSetup/MoreNetworkSetup.h</option>
<option value="listing13.html">/NetworkSetup/Network Setup SDK Bits/NetworkSetupBigPicture.html</option>
<option value="listing14.html">/NetworkSetup/NetworkSetupHelpers.c</option>
<option value="listing15.html">/NetworkSetup/NetworkSetupHelpers.h</option>
<option value="listing16.html">/NetworkSetup/NetworkSetupTest/NetworkSetupTest.c</option>
<option value="listing17.html">/NetworkSetup/OldStyleAPI/OldOTConfigLib.h</option>
<option value="listing18.html">/NetworkSetup/ReadMe.html</option></select>
				</p>
				</form>
				<p><strong><a href="MoreNetworkSetup.zip">Download Sample</a></strong> (&#147;MoreNetworkSetup.zip&#148;, 139.9K)<BR>
<strong><a href="MoreNetworkSetup.dmg">Download Sample</a></strong> (&#147;MoreNetworkSetup.dmg&#148;, 210.9K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*  File:    NetworkSetupHelpers.h  Contains:  High-level network preference routines.  Written by:  Quinn  Copyright:  Copyright &copy; 1998 by Apple Computer, Inc., all rights reserved.        You may incorporate this Apple sample source code into your program(s) without        restriction. This Apple sample source code has been provided &quot;AS IS&quot; and the        responsibility for its operation is yours. You are not permitted to redistribute        this Apple sample source code as &quot;Apple sample source code&quot; after having made        changes. If you're going to re-distribute the source, we require that you make        it clear in the source that the code was descended from Apple sample source        code, but that you've made changes.  Change History (most recent first):        &lt;14&gt;     18/1/00    Quinn   Further updates for the new Network Setup header file.        &lt;13&gt;     17/1/00    Quinn   Updates for latest Network Setup headers.        &lt;12&gt;     7/10/99    Quinn   Comments to cover common &quot;gotcha&quot; cases, thanks to John Norstad.        &lt;11&gt;     22/9/99    Quinn   Fixed two 'backward branches' in the comments.  Thanks to John                                    Norstad.        &lt;10&gt;     13/9/99    Quinn   Implement DHCPRelease.         &lt;9&gt;     26/5/99    Quinn   Tidied up C++ #if's.  Added cookie4 to NSHConfigurationEntry to                                    hold protocol type, and thus removed the protocol parameter from                                    NSHSelectConfiguration.  Improved comments.         &lt;8&gt;      7/5/99    Quinn   This &quot;redux&quot; word, I don't think it means what you think it                                    means.         &lt;7&gt;     22/4/99    Quinn   Added MNSEncodeRemotePassword.         &lt;6&gt;     21/4/99    Quinn   Added interface to routines which create, duplicate, get, set,                                    delete and rename configurations for TCP/IP, Remote Access, and                                    Modem.         &lt;5&gt;    10/11/98    Quinn   Convert &quot;MorePrefix.h&quot; to &quot;MoreSetup.h&quot;.         &lt;4&gt;     9/11/98    Quinn   AppleTalk on/off support.         &lt;3&gt;     9/11/98    Quinn   Add &quot;TCP will dial&quot; code.         &lt;2&gt;     5/11/98    Quinn   Fix header.         &lt;1&gt;     5/11/98    Quinn   First checked in.*/#pragma once/////////////////////////////////////////////////////////////////// MoreIsBetter Setup#include &quot;MoreSetup.h&quot;/////////////////////////////////////////////////////////////////// Mac OS Interfaces#include &lt;MacTypes.h&gt;#include &lt;NetworkSetup.h&gt;#ifdef __cplusplusextern &quot;C&quot; {#endif/////////////////////////////////////////////////////////////////// Routines to Enumerate and Switch TCP/IP and AppleTalk Preferencesstruct NSHConfigurationEntry {  Str255   name;          // user-visible name of the configuration  Boolean selected;        // true if this configuration is currently active  SInt16   cookie;          // cookies for use by this library  CfgEntityRef cookie2;  CfgEntityInfo cookie3;  OSType  cookie4;};typedef struct NSHConfigurationEntry NSHConfigurationEntry;typedef NSHConfigurationEntry *NSHConfigurationListPtr;typedef NSHConfigurationListPtr *NSHConfigurationListHandle;extern pascal ItemCount NSHCountConfigurationList(NSHConfigurationListHandle configList);  // Returns a count of the number of entries in configList.  extern pascal OSStatus  NSHGetConfigurationList(OSType protocol, NSHConfigurationListHandle configList);  // Reads the list of configurations for the specific protocol,  // placing a NSHConfigurationEntry in configList for each one.  // configList must be a non-locked handle allocated by you.  // The routine will resize it appropriate.  Specify protocol  // using one of the constants declared in &quot;NetworkSetup.h&quot;.  // Currently handles the following protocols:  //   o kOTTCPv4NetworkConnection  //   o kOTAppleTalkNetworkConnection  //   o kOTRemoteNetworkConnection  //   o kOTModemNetworkConnectionextern pascal OSStatus  NSHSelectConfiguration(const NSHConfigurationEntry *chosenEntry);  // Given an entry from the configList generated by the previous  // routine, this routine switches the network protocol to use  // that configuration.  //  // Note: In earlier versions of this sample, this routine took a  // &quot;protocol&quot; parameter.  It no longer needs this parameter because  // the protocol is now stored in one of the cookies in the  // NSHConfigurationEntry./////////////////////////////////////////////////////////////////// Routines for Internet Setup Software// ----- TCP/IP -----struct NSHTCPv4ConfigurationDigest {  OSType        fProtocol;      // always kOTTCPv4NetworkConnection for NSHTCPv4ConfigurationDigest  Str255         fConfigName;    // user-visible name of the configuration  OTPortRef      fPortRef;      // OT port for the config (lookup &quot;ddp1&quot; for MacIP)                      // &quot;Connect via&quot; in the UI  OTCfgTCPConfigMethod fConfigMethod;    // one of the constants given above                      // &quot;Configure:&quot; in the UI                      // For &quot;PPP Server&quot;, use kOTCfgManualConfig with fIPAddress of 0  InetHost      fIPAddress;      // IP address  InetHost      fSubnetMask;    // IP subnet mask  Handle        fRouterList;    // array of InetHost  Handle        fDNSServerList;    // list of DNS servers, array of InetHost  Str255        fLocalDomain;    // the local domain for this machine                      // &quot;Implicit Search Path: Starting domain name:&quot; in the UI  Str255        fAdminDomain;    // &quot;Implicit Search Path: Ending domain name:&quot; in the UI  Handle        fSearchDomains;    // STR# format  Str32        fAppleTalkZone;    // for MacIP only, specify empty string otherwise  UInt32        fFraming;      // framing attributes for this port                      // &quot;Use 802.3&quot; in the UI                      // Only for port with device type kOTEthernetDevcie                      // - use kOTFramingEthernet by default                      // - use kOTFraming8022 if the 802.3 checkbox is set                      // Set to 0 for non-Ethernet ports  OTCfgTCPUnloadAttr  fUnloadAttr;    // one of the constants given above  Str255        fHintUserVisiblePortName;  // Hints to find the port name if fPortRef is kOTInvalidPortRef  Str63        fHintPortName;  Str63        fHintDriverName;  UInt16        fHintDeviceType;};typedef struct NSHTCPv4ConfigurationDigest NSHTCPv4ConfigurationDigest;// ----- Remote Access -----struct NSHRemoteConfigurationDigest {  OSType        fProtocol;          // always kOTRemoteNetworkConnection for NSHRemoteConfigurationDigest  Str255         fConfigName;        // user-visible name of the configuration    // Main panel in UI    Boolean        fGuestLogin;        //   Boolean        fPasswordValid;        //   Str255        fUserName;          // only valid if fGuestLogin is false  Str255        fPassword;          // only valid if fGuestLogin is false and fPasswordValid is true  Str255        fPhoneNumber;        //    // Dialling tab in UI    OTCfgRemoteRedialMode fRedialMode;        // one of the constants in &quot;NetworkSetup.h&quot;  UInt32        fRedialTimes;        // only valid if fRedialOptions != kRemoteRedialNone  UInt32        fRedialDelay;        // (ms) only valid if fRedialOptions != kRemoteRedialNone  Str255        fAlternatePhoneNumber;    // only valid if fRedialOptions == kRemoteRedialMainAndAlternate  // Connection tab in UI    Boolean        fVerboseLogging;      //  Boolean        fFlashIconWhileConnected;  //  Boolean        fPromptToRemainConnected;  //  UInt32        fPromptInterval;      // (minutes)  Boolean        fDisconnectIfIdle;      //  UInt32        fDisconnectInterval;    // (ms)    // Protocol tab in UI    OTCfgRemoteProtocol  fSerialProtocol;      // one of the constants in &quot;NetworkSetup.h&quot;  Boolean        fPPPConnectAutomatically;      // only valid if fSerialProtocol == kRemoteProtocolPPP  Boolean        fPPPAllowModemCompression;      // only valid if fSerialProtocol == kRemoteProtocolPPP  Boolean        fPPPAllowTCPIPHeaderCompression;  // only valid if fSerialProtocol == kRemoteProtocolPPP  OTCfgRemotePPPConnectScript fPPPConnectMode;      // only valid if fSerialProtocol == kRemoteProtocolPPP, one of the constants given above  Str63        fPPPConnectScriptName;        // only valid if fPPPConnectMode == kOTCfgRemotePPPConnectScriptScript  Handle        fPPPConnectScript;          // only valid if fPPPConnectMode == kOTCfgRemotePPPConnectScriptScript};typedef struct NSHRemoteConfigurationDigest NSHRemoteConfigurationDigest;// ----- Modem -----struct NSHModemConfigurationDigest {  OSType           fProtocol;      // always kOTModemNetworkConnection for NSHModemConfigurationDigest  Str255            fConfigName;    // user-visible name of the configuration  OTPortRef         fPortRef;      // reference to OT serial port  FSSpec            fModemScript;    // reference to CCL file  OTCfgModemDialogToneMode fDialToneMode;    // one of the constants in &quot;NetworkSetup.h&quot;  Boolean          fSpeakerOn;      // turn on speaker  Boolean          fPulseDial;      // use pulse dial  Str63            fHintPortName;    // Hint to find the port name if fPortRef is kOTInvalidPortRef};typedef struct NSHModemConfigurationDigest NSHModemConfigurationDigest;// ----- Generic -----// NSHConfigurationDigestCommon describes the fields that must// be at the front of all protocol-specific configuration digest// records.struct NSHConfigurationDigestCommon {  OSType        fProtocol;      // protocol of the configuration  Str255         fConfigName;    // user-visible name of the configuration};typedef struct NSHConfigurationDigestCommon NSHConfigurationDigestCommon;// NSHConfigurationDigest is a union of all the protocol-specific// configuration digest records defined above.union NSHConfigurationDigest {  NSHConfigurationDigestCommon fCommon;  NSHTCPv4ConfigurationDigest  fTCPv4;  NSHRemoteConfigurationDigest fRemote;  NSHModemConfigurationDigest  fModem;};typedef union NSHConfigurationDigest NSHConfigurationDigest;extern pascal OSStatus NSHCreateConfiguration(const NSHConfigurationDigest *configurationDigest,                        NSHConfigurationEntry *createdConfig);  // Creates a new connection entity, populating it with the information  // in configurationDigest.  If createdConfig is not nil, it is filled out with  // the information needed to choose this connection using NSHSelectConfiguration.  // You can pass nil to createdConfig if you're not interested in it.  // For Handle fields in configurationDigest, a value of nil implies that it  // should take the default.  //  // When you create a configuration, you must provide a real OTPortRef for  // any fPortRef fields in the digest.  However, you do not need to set up  // the &quot;hint&quot; fields of the digest.  //  // You supply any password fields in the digest in plain text form.extern pascal OSStatus NSHDuplicateConfiguration(NSHConfigurationEntry *config,                         ConstStr255Param newConfigName,                         NSHConfigurationEntry *createdConfig);  // Duplicates the configuration specified by config, creating a new  // configuration returned in createdConfig, whose name is newConfigName.  // You can pass nil to createdConfig if you're not interested in it.  //  // These is a significant difference between duplication and create.  // When you duplicate a config, you get a copy of its preferences,  // whether they are known to this library or not.  The only difference  // is the configuration name.  When you create, the library just sets up the  // preferences it knows about.  //  // Note that making newConfigName unique is your problem.  Typically  // you do this by appending &quot; copy&quot; and then &quot; copy X&quot; until it's unique,  // handling the case where the name already ends in &quot; copy&quot; or &quot; copy X&quot;.  // The caller has to do this because the intricacies are beyond the  // scope of this library.extern pascal OSStatus NSHGetConfiguration(const NSHConfigurationEntry *config,                        NSHConfigurationDigest *configurationDigest);  // Returns in configurationDigest the information about the configuration  // specified by config.  //  // YOU MUST FILL OUT SOME FIELDS IN configurationDigest!!!  //  // Specifically, for Handle fields, you must either nil out the field or  // put an empty Handle in the field.  If you don't know the protocol  // associated with config, you don't know which fields are handles,  // so the only safe thing to do is zero configurationDigest.  //  // Also, for protocols which return an fPortRef, you should note that  // the returned fPortRef may be kOTInvalidPortRef.  This happens where  // a configuration is created, the port is removed (eg a PC Card is ejected)  // and you subsequently read the configuration.  You have to handle this  // case.  Typically, the protocol-specific digest will include hint fields  // that allow you to search the OT port registry for some other suitable port.  // I only mention it here because you might think that NSHSetConfiguration  // will always work if you pass it a digest generated by NSHGetConfiguration,  // but that's not true.  //  // Finally, this routine returns passwords in their encoded form.  This  // is a design decision.  If you want the decoded password, you have to  // decode it yourself.extern pascal OSStatus NSHSetConfiguration(const NSHConfigurationEntry *config,                        const NSHConfigurationDigest *configurationDigest);  // Sets the configuration specified by config to the information in   // configurationDigest.  For Handle fields in configurationDigest, a value  // of nil implies that this routine should not affect the current value.  //   // When you set a configuration, you must provide a real OTPortRef for  // any fPortRef fields in the digest.  However, you do not need to set up  // the &quot;hint&quot; fields of the digest.  //  // You supply any password fields in the digest in plain text form.extern pascal OSStatus NSHDeleteConfiguration(const NSHConfigurationEntry *config);  // Deletes the configuration specified by config.  Deleting an active  // configuration yields an error.  extern pascal OSStatus NSHRenameConfiguration(const NSHConfigurationEntry *config,                        ConstStr255Param newConfigName,                        NSHConfigurationEntry *newConfig);  // Renames the configuration specified by config to the name  // newConfigName.  newConfig is the returned as a reference  // to the newly renamed configuration; you can pass nil if you're not  // interested in it./////////////////////////////////////////////////////////////////// TCP/IP Will Dialenum {  kNSHTCPDialUnknown = 0,  kNSHTCPDialTCPDisabled,  kNSHTCPDialYes,  kNSHTCPDialNo};extern pascal OSStatus NSHTCPWillDial(UInt32 *willDial);  // This routine returns, in willDial, a flag indicating  // whether opening a TCP/IP provider will cause the modem   // to dial.  You must call InitOpenTransport before calling  // this routine.  [Not because it allocates memory but  // because it calls OTInetGetInterfaceInfo.]/////////////////////////////////////////////////////////////////// DHCP Releaseextern pascal OSStatus NSHDHCPRelease(void);  // This routine lets you force the OT TCP/IP stack to release  // any address it has aquired from a DHCP server and attempt  // to acquire a new address from scratch.  //  // The implementation is somewhat experimental.  Please  // let me know if you have problems.  Also, the non-database  // implementation is completely untested./////////////////////////////////////////////////////////////////// AppleTalk On/Offextern pascal OSStatus NSHIsAppleTalkActive(Boolean *active);  // Sets *active to true if the AppleTalk stack is active.extern pascal OSStatus HSHSetAppleTalkActive(Boolean active);  // Sets the active state of the AppleTalk stack to the active  // parameter./////////////////////////////////////////////////////////////////// Remote Access Password Encodeextern pascal OSStatus NSHEncodeRemotePassword(                ConstStr255Param userName,                ConstStr255Param password,                Str255 encodedPassword);  // Encodes a password to be compatible with the ARA  // 'pass' preference format.  Note that NSHCreateConfiguration and  // NSHSetConfiguration will automagically encode (using this routine)  // ARA passwords for you; this routine is exposed as a convenience of you  // need to encode passwords for some other reason./////////////////////////////////////////////////////////////////#ifdef __cplusplus}#endif</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/MoreNetworkSetup/listing15.html%3Fid%3DDTS10000240-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/MoreNetworkSetup/listing15.html%3Fid%3DDTS10000240-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/MoreNetworkSetup/listing15.html%3Fid%3DDTS10000240-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>