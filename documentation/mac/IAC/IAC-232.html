<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Resolving Object Specifier Records(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING232></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-231.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-233.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-231.html"><B>Chapter 6 - Resolving and Creating Object Specifier Records</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING232-0></A>
<H1><A NAME=MARKER-2-11></A><A NAME=MARKER-9-76></A>Resolving Object Specifier Records</H1>
 <A NAME=MARKER-9-77></A>If an Apple event parameter consists of an object specifier record, your handler for the Apple event should <B>resolve</B> the object specifier record: that is, locate the Apple event objects it describes. The first step is to call the <CODE>AEResolve</CODE> function with the object specifier record as a parameter. <A NAME=MARKER-2-25></A><P>
 The <CODE>AEResolve</CODE> function performs tasks that are required to resolve any object specifier record, such as parsing its contents, keeping track of the results of tests, and handling memory management. When necessary, <CODE>AEResolve</CODE> calls application-defined functions to perform tasks that are unique to the application, such as locating a specific Apple event object in the application's data structures or counting the number of Apple event objects in a container.<P>
<DL>
<DT><B>Note</B>
<DD>Object specifier records are only valid while the Apple event that contains them is being handled. For example, if an application receives an Apple event asking it to cut row 5 of a table, what was row 6 then becomes row 5, and the original object specifier record that referred to row 5 no longer refers to the same row.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 The <CODE>AEResolve</CODE> function can call two kinds of application-defined functions. <B>Object accessor functions</B> locate Apple event objects. <B>Object callback functions</B> perform other tasks that only an application can perform, such as counting, comparing, or marking Apple event objects. This section provides an overview of the way <CODE>AEResolve</CODE> calls object accessor and object callback functions when it resolves object specifier records. <A NAME=MARKER-2-79></A><P>
 Each time <CODE>AEResolve</CODE> calls one of your application's object accessor functions successfully, the object accessor function should return a special descriptor record created by your application, called a<B> token,</B> that identifies either an element in a specified container or a property of a specified Apple event object. The Apple Event Manager examines the token's descriptor type but does nothing with the token's data. When it needs to refer to the object the token identifies, the Apple Event Manager simply passes the token back to your application.<A NAME=MARKER-2-80></A> <A NAME=MARKER-2-33></A><P>
 Each object accessor function provided by your application should either find elements of a given object class in a container identified by a token of a given descriptor type, or find properties of an Apple event object identified by a token of a specified descriptor type. The Apple Event Manager uses the object class ID and the descriptor type of the token that identifies the object's container to determine which object accessor function to call.<P>
 It is up to you to decide how many object accessor functions you need to write for your application. You can write one object accessor function that locates Apple event objects of several different object classes, or you can write separate object accessor functions for certain object classes. Similarly, you may want to use only one descriptor type for all the tokens returned by your object accessor functions, or you may want to use several descriptor types. The way you define your tokens depends on the needs of your application. <P>
 <A NAME=MARKER-2-82></A>You can use the <CODE>AEInstallObjectAccessor</CODE> function to create an <B>object accessor dispatch table</B> that the Apple Event Manager uses to map requests for Apple event objects to the appropriate object accessor function in your application. The Apple Event Manager uses the object class of each requested object and the descriptor type of the token that identifies the object's container to determine which object accessor function to call. Depending on the container hierarchy for a given object specifier record and the way your application defines its object accessor functions, the Apple Event Manager may need to call a series of object accessor functions to resolve the nested object specifier records that describe an Apple event object's container. For information about creating and using the object accessor dispatch table, see <A HREF=IAC-239.html#MARKER-9-132>"Installing Entries in the Object Accessor Dispatch Tables,"</A> which begins on <A HREF=IAC-239.html#MARKER-9-132>page 6-27</A>. <P>
 <A NAME=MARKER-2-252></A><A HREF=#MARKER-9-85>Figure 6-1</A> illustrates the major steps involved in resolving an object specifier record. The SurfWriter application shown in <A HREF=#MARKER-9-85>Figure 6-1</A> receives a Get Data event whose direct parameter is an object specifier record for a table named "Summary of Sales" in a document named "Sales Report." The SurfWriter application's handler for the Get Data event calls the <CODE>AEResolve</CODE> function with the object specifier record as a parameter. The <CODE>AEResolve</CODE> function begins to parse the object specifier record. The first object accessor function that <CODE>AEResolve</CODE> calls is usually the function that can identify the Apple event object in the application's <B>default container--</B>the outermost container in the container hierarchy. In <A HREF=#MARKER-9-85>Figure 6-1</A>, the object specifier record for the document "Sales Report" specifies the default container, so the Apple Event Manager calls the object accessor function in the SurfWriter application that can locate a document in a container identified by a descriptor record of descriptor type <CODE>typeNull</CODE>. <P>
<B>Figure 6-1  <A NAME=MARKER-9-85></A>Resolving an object specifier record for a table in a document</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/AE-L-17.jpg"><P>
 After locating the document named "Sales Report," the SurfWriter application returns a token to the Apple Event Manager--that is, a descriptor record that SurfWriter uses to identify the document. The Apple Event Manager examines the descriptor type of the token but does not need to know anything about the token's data to continue parsing the object specifier record. Next, the Apple Event Manager calls the object accessor function that can identify a table in a container identified by a token of descriptor type <CODE>typeMyDocToken</CODE>. When the Apple Event Manager calls this object accessor function, it uses the token that describes the document to identify the table's container. After the SurfWriter application has located the table named "Summary of Sales" in the document named "Sales Report," it returns a token describing that table to the Apple Event Manager. <A NAME=MARKER-2-86></A><P>
 After your application has successfully located an Apple event object, the Apple Event Manager disposes of all previous tokens returned during resolution of the object specifier record for the object. The Apple Event Manager disposes of tokens by calling either the <CODE>AEDisposeDesc</CODE> function or your application's <B>token disposal function,</B> if you have provided one, which is an object callback function that disposes of a token. In <A HREF=#MARKER-9-85>Figure 6-1</A>, the <CODE>AEResolve</CODE> function calls the SurfWriter application's token disposal function to dispose of the token for the document after <CODE>AEResolve</CODE> receives the token for the table. After the SurfWriter application has disposed of the token for the document, the <CODE>AEResolve</CODE> function returns the result of the resolution--that is, the token for the requested table--to the handler in the SurfWriter application that originally called <CODE>AEResolve</CODE>. <A NAME=MARKER-2-287></A><P>
 The Apple Event Manager can complete the cycle of parsing the object specifier record and calling the appropriate object accessor function to obtain a token as many times as necessary to identify every container in the container hierarchy and finish resolving an object specifier record, including disposing of the tokens for the containers. However, one token will always be left over--the token that identifies the requested Apple event object. After <CODE>AEResolve</CODE> returns this final token and your application performs the action requested by the Apple event, it is up to your application to dispose of the token. Your application can do so by calling the <CODE>AEDisposeToken</CODE> function, which in turn calls either <CODE>AEDisposeDesc</CODE> or your application's token disposal function. <P>
 You need to provide a token disposal function only if a call to <CODE>AEDisposeDesc</CODE> is not sufficient by itself to dispose of a token or if you provide <B>marking callback functions,</B> which are three object callback functions that allow your application to use its own marking scheme rather than tokens when identifying large groups of Apple event objects. Your application is not required to provide marking callback functions. <A NAME=MARKER-2-27></A><P>
 To handle object specifier records that specify a test, your application must provide two object callback functions: (a) an <B>object-counting function,</B> which counts the number of elements of a given object class in a given container so that the Apple Event Manager can determine how many elements it must test to find the element or elements that meet a specified condition, and (b) an <B>object-comparison function,</B> which compares one element to another element or to a descriptor record and returns <CODE>TRUE</CODE> or <CODE>FALSE</CODE>. <P>
 Your application may also provide an <B>error callback function</B> that can identify which descriptor record caused the resolution of an object specifier record to fail. Your application is not required to provide an error callback function.<P>
 If your application resolves object specifier records without the help of the Apple Event Manager, it must extract the equivalent descriptor records and coerce them as necessary to get access to their data. The Apple Event Manager includes coercion handlers for these coercions; for information about this default coercion handling, see <A HREF=IAC-125.html#MARKER-9-5>Table 4-1 on page 4-43</A>.<P>
 For more information about object accessor functions, see <A HREF=IAC-242.html#MARKER-9-157>"Writing Object Accessor Functions,"</A> which begins on <A HREF=IAC-242.html#MARKER-9-157>page 6-34</A>. For more information about object callback functions, see <A HREF=IAC-247.html#MARKER-9-202>"Writing Object Callback Functions,"</A> which begins on <A HREF=IAC-247.html#MARKER-9-202>page 6-54</A>. <A NAME=MARKER-2-59></A> <P>
 The next section, <A HREF=IAC-233.html#MARKER-9-91>"Descriptor Records Used in Object Specifier Records,"</A> describes how the data in an object specifier record is interpreted by the Apple Event Manager. <A NAME=MARKER-2-90></A> <P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-231.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-233.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
