<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating a Size Resource(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING39></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-38.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-40.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-28.html"><B>Chapter 2 - Event Manager</B></A> / <A HREF="Toolbox-36.html"><B>Using the Event Manager</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING39-0></A>
<H2><A NAME=MARKER-9-127></A>Creating a Size Resource</H2>
 <A NAME=MARKER-2-135></A>Your application should include a size (<CODE>'SIZE'</CODE>) resource. You use a <CODE>'SIZE'</CODE> resource to inform the Operating System about the memory size requirements for your application so that the Operating System can set up a partition of the appropriate size for your application. You also use the <CODE>'SIZE'</CODE> resource to indicate certain scheduling options to <BR>the Operating System, such as whether your application can accept suspend and <BR>resume events. <P>
 You can also specify additional information in the <CODE>'SIZE'</CODE> resource in System 7, indicating whether your application is 32-bit clean, whether your application supports stationery documents, whether your application uses TextEdit's inline input services, whether your application wishes to receive notification of the termination of any applica- tions it has launched, and whether your application wishes to receive high-level events.<P>
 A <CODE>'SIZE'</CODE> resource consists of a 16-bit flags field, followed by two 32-bit size fields. The flags field specifies operating characteristics of your application, and the size fields indicate the minimum and preferred partition sizes for your application. The minimum partition size is the actual limit below which your application will not run. The preferred partition size is the memory size at which your application can run most effectively and that the Operating System attempts to secure upon launch of your application. If that amount of memory is unavailable, your application is placed into <BR>the largest contiguous block available, provided that it is larger than the specified minimum size.<A NAME=MARKER-2-526></A><P>
<DL>
<DT><B>Note</B>
<DD>If the amount of available memory is between the minimum and the <BR>preferred sizes, the Finder displays a dialog box asking if the user wants to run the application using the amount of memory available. If your <BR>application does not have a <CODE>'SIZE'</CODE> resource, it is assigned a default <BR>partition size of 512 KB and the Process Manager uses a default value <BR>of <CODE>FALSE</CODE> for all specifications normally defined by constants in the <BR>flags field. <EM>u</EM>   <IMG ALIGN = BOTTOM SRC = "graphics/diamond.gif">
</DL>
 When you define a <CODE>'SIZE'</CODE> resource, you should give it a resource ID of -1. A user can modify the preferred size in the Finder's information window for your application. If the user does alter the partition size, the Operating System creates a new <CODE>'SIZE'</CODE> resource having a resource ID of 0. At application launch time, the Process Manager looks for a <CODE>'SIZE'</CODE> resource with ID 0; if this resource is not found, it uses your original <CODE>'SIZE'</CODE> resource with ID -1. This new <CODE>'SIZE'</CODE> resource is also created when the user modifies any of the other settings in the resource.<P>
 When creating a <CODE>'SIZE'</CODE> resource, you first need to determine the various operating characteristics of your application. For example, if your application has nothing useful to do when it is in the background, then you should not set the <CODE>canBackground</CODE> flag. Similarly, if you have not tested your application in an environment that uses all 32 bits of a handle or pointer for memory addresses, then you should not set the <CODE>is32BitCompatible</CODE> flag.<P>
 <A HREF=#MARKER-9-130>Listing 2-4</A> shows the Rez input for a sample <CODE>'SIZE'</CODE> resource. (Rez is a resource compiler available with the MPW environment.)<P>
<B>Listing 2-4  <A NAME=MARKER-9-130></A>The Rez input for a sample <CODE>'SIZE'</CODE> resource <A NAME=MARKER-2-230></A></B><P>
<PRE>
resource 'SIZE' (-1) {
   reserved,                     /*reserved*/
   acceptSuspendResumeEvents,    /*accepts suspend&amp;resume events*/
   reserved,                     /*reserved*/
   canBackground,                /*can use background null */
                                 /* events*/
   doesActivateOnFGSwitch,       /*activates own windows in */
                                 /* response to OS events*/
   backgroundAndForeground,      /*application has a user */
                                 /* interface*/
   dontGetFrontClicks,           /*don't return mouse events */
                                 /* in front window on resume*/
   ignoreAppDiedEvents,          /*doesn't want app-died events*/
   is32BitCompatible,            /*works with 24- or 32-bit addr*/
   isHighLevelEventAware,        /*supports high-level events*/
   localAndRemoteHLEvents,       /*also remote high-level events*/
   isStationeryAware,            /*can use stationery documents*/
   dontUseTextEditServices,      /*can't use inline input */
                                 /* services*/
   reserved,                     /*reserved*/
   reserved,                     /*reserved*/
   reserved,                     /*reserved*/
   kPrefSize * 1024,             /*preferred memory size*/
   kMinSize * 1024               /*minimum memory size*/
};
</PRE>
 The <CODE>'SIZE'</CODE> resource specification in <A HREF=#MARKER-9-130>Listing 2-4</A> indicates, among other things, that the application accepts suspend and resume events, does processing in the background using null events, activates or deactivates any windows as necessary in response to operating-system events, can execute in both the foreground and background, and doesn't want to receive any mouse event associated with a resume event that was caused by the user clicking in the application's front window. It also indicates that the application doesn't want to receive Application Died events, can work in 24-bit or 32-bit addressing mode, does accept high-level events, including both local and network high-level events, does handle stationery documents, and doesn't use TextEdit's inline input services. In this example, the Rez-input file must define values for the constants <CODE>kPrefSize</CODE> and <CODE>kMinSize</CODE>; for example, if <CODE>kPrefSize</CODE> is set to 50, the preferred partition size is 50 KB.<P>
 The numbers you specify as your application's preferred and minimum memory sizes depend on the particular memory requirements of your application. Your application's memory requirements depend on the size of your application's static heap, dynamic heap, A5 world, and stack. (See "Introduction to Memory Management" in <I><A HREF="../Memory/Memory-2.html">Inside Macintosh: Memory</A></I> for complete details about these areas of your application's partition.)<A NAME=MARKER-2-490></A><P>
 The static heap size includes objects that are always present during the execution of your application--for example, code segments, Toolbox data structures for window records, and so on. <P>
 Dynamic heap requirements come from various objects created on a per-document basis (which may vary in size proportionally with the document itself) and objects that are required for specific commands or functions. <P>
 The size of the A5 world depends on the amount of global data and the number of intersegment jumps your application contains. <A NAME=MARKER-2-136></A><P>
 The stack contains variables, return addresses, and temporary information. The size of the application stack varies among computers, so you should base your values for the stack size according to the stack size required on a Macintosh Plus computer (8 KB). <BR>The Process Manager automatically adjusts your requested amount of memory to compensate for the different stack sizes on different machines. For example, if you request 512 KB, more stack space (approximately 16 KB) will be allocated on machines with larger default stack sizes. <A NAME=MARKER-2-416></A><P>
 Unfortunately, it is difficult to forecast all of these conditions with any great degree of reliability. You should be able to determine reasonably accurate estimates for the stack size, static heap size, A5 world, and jump table. In addition, you can use tools such as MacsBug's heap-exploring commands to help you empirically determine your application's dynamic memory requirements.<A NAME=MARKER-2-135></A><P>
 See <A HREF=Toolbox-87.html#MARKER-9-485>"The Size Resource" beginning on page 2-115</A> for additional information on the meaning of each of the fields and flags of a <CODE>'SIZE'</CODE> resource. <A NAME=MARKER-9-573></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-38.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-40.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
