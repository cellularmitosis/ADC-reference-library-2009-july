<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>DBSend(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING509></A>



<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-508.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-510.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-469.html"><B>Chapter 12 - Data Access Manager</B></A> / <A HREF="IAC-487.html"><B>Data Access Manager Reference</B></A><BR><DL><DD><A HREF="IAC-492.html"><B>Data Access Manager Routines</B></A> / <A HREF="IAC-508.html"><B>Low-Level Interface: Sending and Executing Queries</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING509-0></A>
<H3><A NAME=MARKER-9-349></A>DBSend</H3>
 <A NAME=MARKER-2-350></A><A NAME=MARKER-2-351></A><A NAME=MARKER-2-352></A>You can use the <CODE>DBSend</CODE> function to send a query or a portion of a query to a data server. <P>
<PRE>
FUNCTION DBSend (sessID: LongInt; text: Ptr; len: Integer; 
                 asyncPB: DBAsyncParmBlkPtr): OSErr;
</PRE>
<DL>
<DT><CODE>sessID</CODE>
<DD> The session ID that was returned by the <CODE>DBInit</CODE> function.
<DT><CODE>text</CODE>
<DD> A pointer to the query or query fragment that you want to send to the data server. The query or query fragment must be a character string. 
<DT><CODE>len</CODE>
<DD> The length of the character string. If the <CODE>len</CODE> parameter has a value of -1, then the character string is assumed to be <CODE>NULL</CODE> terminated (that is, the string ends with a <CODE>NULL</CODE> byte); otherwise, the <CODE>len</CODE> parameter specifies the number of bytes in the string.
<DT><CODE>asyncPB</CODE>
<DD> A pointer to an asynchronous parameter block. If you do not want to call the function asynchronously, set this parameter to <CODE>NIL</CODE>.
</DL>
<A NAME=HEADING509-7></A>
<H5>DESCRIPTION</H5>
 The <CODE>DBSend</CODE> function sends a query or a portion of a query to the data server. The data server appends this portion of the query to any portion you sent previously. Because the Data Access Manager does not modify the string you send in any way, it does not insert any delimiter between fragments of queries that you send to the data server. If you want a blank or a semicolon to be included between query fragments, or if you want to use return characters to divide the query into lines of text, you must include them in the character string that you send with this function. <P>
 The data server does not execute the query until you call the <CODE>DBExec</CODE> function.<P>
<A NAME=HEADING509-10></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 The <CODE>DBSend</CODE> function may move or purge memory. You should not call this routine from within an interrupt, such as in a completion routine or a VBL task.<P>
<A NAME=HEADING509-12></A>
<H5>ASSEMBLY-LANGUAGE INFORMATION</H5>
 The trap macro and routine selector for the <CODE>DBSend</CODE> function are
<TABLE BORDER="0" CELLPADDING=3><TH ALIGN=LEFT>Trap macro<TH>Selector<TR>
<TD>_DBSend<TD>$0706</TABLE>
<P>
<A NAME=HEADING509-14></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>rcDBError<TD>-802<TD>Error trying to send text<TR>
<TD>rcDBBadSessID<TD>-806<TD>Session ID is invalid<TR>
<TD>rcDBAsyncNotSupp<TD>-809<TD>The database extension does not support asynchronous calls<TR>
<TD>rcDBPackNotInited<TD>-813<TD>The <CODE>InitDBPack</CODE> function has not yet been called</TABLE>
</H5>
<A NAME=HEADING509-15></A>
<H5>SEE ALSO</H5>
 For a description of the asynchronous parameter block, see <A HREF=IAC-489.html#MARKER-9-246>page 12-56</A>. See <A HREF=IAC-479.html#MARKER-9-154>Listing 12-4</A> beginning on <A HREF=IAC-479.html#MARKER-9-154>page 12-32</A> for an example of the use of the <CODE>DBSend</CODE> function in sending a query fragment. See <A HREF=IAC-511.html#MARKER-9-359>page 12-79</A> for a description of the <CODE>DBExec</CODE> function.<A NAME=MARKER-2-353></A><A NAME=MARKER-2-354></A><A NAME=MARKER-2-355></A><P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-508.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-510.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
