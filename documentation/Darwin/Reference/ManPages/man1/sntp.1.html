<html><head><title>Mac OS X
 Manual Page For sntp(1)</title>
<style type="text/css"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { font-size: 1px; background: #ffffff; color: #ffffff; } --></style>
<style type="text/css" media="print, aural, braille, embossed, projection, tty"><!-- @import "../../../../adcstyle.css"; .char {background: #ffffff; color:#0000ff;}.comment {background:#ffffff; color:#236e25}.function {background:#ffffff; color:#000000;}.keyword {background:#ffffff; color:#761550;}.number {background: #ffffff; color:#0000ff;}.param {background:#ffffff; color:#000000;}.preprocessor {background:#ffffff; color:#236e25}.string {background: #ffffff; color:#891315;}.template {background:#ffffff; color:#761550;}.type {background:#ffffff; color:#761550;}.var {background:#ffffff; color:#000000;} pre.manpages {font-size: 10pt;} .graybox { border-top: 1px solid #919699; border-left: 1px solid #919699; margin-bottom: 10px; } .graybox th { padding: 4px 8px 4px 8px; background: #E2E2E2; font-size: 12px; font-weight: bold; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .graybox td { padding: 8px; font-size: 12px; text-align: left; vertical-align: top; border-bottom: 1px solid #919699; border-right: 1px solid #919699; } .whiteout { display: none; } --></style>
</head><body bgcolor="white">
<a name="//apple_ref/doc/man/1/sntp" title="Mac OS X
 Manual Page for sntp(1)"><!-- headerDoc=man; indexgroup=Section 1; uid="//apple_ref/doc/man/1/sntp"; name=sntp(1) --></a>
<!--#include virtual="/includes/framesetheader"-->
<table width=600><tr><td scope="row">
<!-- begin breadcrumb insert request --><font face="Geneva,Helvetica,Arial" size="1">
 <a target="_top" href="http://developer.apple.com">ADC Home</a> <b>&gt;</b> <a href="../../../../../referencelibrary/index.html#//apple_ref/doc/uid/TP30000943" target="_top">Reference Library</a> <b>&gt;</b> <a href="../../../../../reference/index.html#//apple_ref/doc/uid/TP30001281" target="_top">Reference</a> <b>&gt;</b> <!-- a href="" target="_top" -->Mac OS X<!-- /a --> <b>&gt;</b> <a href="../index.html#//apple_ref/doc/framework/manpages" target="_top">Mac OS X Man Pages</a></font>
<!-- end breadcrumb insert request -->
<p>&nbsp;</p>
</td></tr></table>
<!-- end of header -->
<table border="0"  cellpadding="2" cellspacing="2" width="630pt"><tr><td valign="top" height="12" colspan="5" scope="row">
<p style='text-align:justify;'>This document is a Mac OS X manual page.  Manual pages are a command-line technology
for providing documentation.  You can view these manual pages locally using the
<a href="man.1.html#//apple_ref/doc/man/1/man">man(1)</a> command.
These manual pages come from many different sources, and thus, have a variety of writing
styles.</p>
<p style='text-align:justify;'>For more information about the manual page format, see the manual page for 
<a href="../man5/manpages.5.html#//apple_ref/doc/man/5/manpages">manpages(5)</a>.</p>
</td></tr></table>
<hr />
<table border="0"  cellpadding="2" cellspacing="2" width="300"><tr><td valign="top" height="12" colspan="5" scope="row"><pre class="manpages"><tt>
SNTP(1)                                                                                              SNTP(1)



<b>NAME</b>
       sntp - a SNTP utility (command and daemon)

<b>SYNOPSIS</b>
       <b>sntp</b>  [  <b>-h</b> | <b>--help</b> | <b>-?</b>  ] [ <b>-v</b> | <b>-V</b> | <b>-W</b> ] [ <b>-q</b> [ <b>-f</b> <u>savefile</u> ] | [ { <b>-r</b> | <b>-a</b> } [ <b>-P</b> <u>prompt</u> ] [ <b>-l</b>
       <u>lockfile</u> ] ] [ <b>-e</b> <u>minerr</u> ] [ <b>-E</b> <u>maxerr</u> ] [ <b>-c</b> <u>count</u> ] [ <b>-d</b> <u>delay</u> | <b>-x</b> [ <u>separation</u> ] ] [ <b>-f</b>  <u>savefile</u>
       ] ] [ <b>-4</b> ] | [ <b>-6</b> ] [ <u>address(es)</u> ] ]

<b>DESCRIPTION</b>
       <u>sntp</u>  can  be  used as a SNTP client to query a NTP or SNTP server and either display the time or set
       the local system's time (given suitable privilege).  It can be run as an interactive  command,  in  a
       <u>cron</u>  job or as a daemon.  It can be run as a daemon to provide a SNTP server for other clients.  NTP
       is the Network Time Protocol (RFC 1305) and SNTP is the Simple Network Time Protocol (RFC 2030, which
       supersedes RFC 1769).

   <b>Options</b>
       <u>sntp</u> recognizes the following options:

       <b>-h</b>     displays  the syntax error message.  If there are no other arguments, it then stops; otherwise
              it then does what was requested.  <b>--help</b> and <b>-?</b>  are synonyms.

       <b>-v</b>     indicates that diagnostic messages for non-fatal errors and a limited amount of tracing should
              be  written to standard error.  Fatal ones always produce a diagnostic.  This option should be
              set when there is a suspected problem with the server, network or the source.

       <b>-V</b>     requests more and less comprehensible output, mainly for investigating  problems  with  appar-<font color="#ffffff" class="whiteout">ently&nbsp;apparently</font>
              ently  inconsistent  timestamps.  This option should be set when the program fails with a mes-<font color="#ffffff" class="whiteout">sage&nbsp;message</font>
              sage indicating that is the trouble.

       <b>-W</b>     requests very verbose debugging output, and will interfere with the timing when writing to the
              terminal  (because  of line buffered output from C).  Note that the times produced by this are
              the corrections needed, and not the error in the local clock.  This option should be set  only
              when debugging the source.

       <b>-q</b>     indicates that it should query a daemon save file being maintained by it.  This needs no priv-<font color="#ffffff" class="whiteout">ilege&nbsp;privilege</font>
              ilege and will change neither the save file nor the clock.

       The default is that it should behave as a client, and the following options are then relevant:

       <b>-r</b>     indicates that the system clock should be reset by <u>settimeofday</u>.  Naturally,  this  will  work
              only if the user has enough privilege.

       <b>-a</b>     indicates that the system clock should be reset by <u>adjtime</u>.  Naturally, this will work only if
              the user has enough privilege.

       The default is to write the estimated correct local date and time (i.e. not UTC) to the standard out-<font color="#ffffff" class="whiteout">put&nbsp;output</font>
       put  in a format like <b>'1996</b> <b>Oct</b> <b>15</b> <b>20:17:25.123</b> <b>+</b> <b>4.567</b> <b>+/-</b> <b>0.089</b> <b>secs'</b>, where the <b>'+</b> <b>4.567</b> <b>+/-</b> <b>0.089</b>
       <b>secs'</b> indicates the estimated error in the time on the local system.  In daemon  mode,  it  will  add
       drift  information  in  a  format  like  <b>'</b> <b>+</b> <b>1.3</b> <b>+/-</b> <b>0.1</b> <b>ppm'</b>, and display this at roughly <u>separation</u>
       intervals (see under the <b>-x</b> option for details).

       <b>-l</b> <u>lockfile</u>
              sets the name of the lock file to ensure that there is only one copy of <u>sntp</u> running at  once.
              The default is installation-dependent, but will usually be <u>/etc/sntp.pid</u>.

       <b>-e</b> <u>minerr</u>
              sets the maximum ignorable variation between the clocks to <u>minerr</u>.  Acceptable values are from
              0.001 to 1, and the default is 0.1 if a NTP host is is specified and 0.5 otherwise.

       <b>-E</b> <u>maxerr</u>
              sets the maximum value of various delays that are deemed  acceptable  to  <u>maxerr</u>.   Acceptable
              values  are from 1 to 60, and the default is 5.  It should sometimes be increased if there are
              problems with the network, NTP server or system clock, but take care.

       <b>-P</b> <u>prompt</u>
              sets the maximum clock change that will be made automatically to  <u>maxerr</u>.   Acceptable  values
              are from 1 to 3600 or <u>no</u>, and the default is 30.  If the program is being run interactively in
              ordinary client mode, and the system clock is to be changed, larger  corrections  will  prompt
              the  user  for  confirmation.  Specifying <u>no</u> will disable this and the correction will be made
              regardless.

       <b>-c</b> <u>count</u>
              sets the maximum number of NTP packets required to <u>count</u>.  Acceptable values are from 1 to  25
              if  a  NTP host is specified and from 5 to 25 otherwise, and the default is 5.  If the maximum
              isn't enough, the system needs a better consistency algorithm than this program uses.

       <b>-d</b> <u>delay</u>
              sets a rough limit on the total running time to <u>delay</u> seconds.  Acceptable values are  from  1
              to 3600, and the default is 15 if a NTP host is specified and 300 otherwise.

       <b>-x</b> <u>separation</u>
              causes  the  program  to  run  as a daemon (i.e. forever), and to estimate and correct for the
              clock drift.  <u>separation</u> sets the minimum time between calls to the server in minutes if a NTP
              host is specified, and between broadcast packets if not.  Acceptable values are from 1 to 1440
              (a day), and the default (if <b>-x</b> is specified but <u>separation</u> is omitted) is 300.

       <b>-f</b> <u>savefile</u>
              may be used with the <b>-x</b> option to store a record of previous packets, which speeds up recalcu-<font color="#ffffff" class="whiteout">lating&nbsp;recalculating</font>
              lating  the  drift after <u>sntp</u> has to be restarted (e.g. because of network or server outages).
              In order to restart the data, <u>sntp</u> must be restarted reasonably soon after it died  (within  a
              few  times  the  value of <u>separation</u>), with the same value of the <b>-c</b> option, the same value of
              <u>separation</u>, in the same mode (i.e. broadcast or client), though the NTP servers  need  not  be
              the  same  for  client mode, and with compatible values of other settings.  Note that the file
              will be created with the default ownerships and permissions, using standard C facilities.  The
              default is installation-dependent, but will usually be <u>/etc/sntp.state</u>.

       <b>-4</b>     force IPv4 DNS resolution.

       <b>-6</b>     force IPv6 DNS resolution.

       <b>address(es)</b>  are the DNS names or IP numbers of hosts to use for the challenge and response protocol;
       if no names are given, the program waits for broadcasts.  Polling a server is  vastly  more  reliable
       than  listening to broadcasts.  Note that a single component numeric address is not allowed, to avoid
       ambiguities.  If more than one name is give, they will be used in a round-robin fashion.

       Constraints:

              <b>minerr</b> must be less than <b>maxerr</b> which must be less than <b>delay</b> (or, if a NTP host is not speci-<font color="#ffffff" class="whiteout">fied&nbsp;specified</font>
              fied <b>delay</b>/<b>count</b>), and <b>count</b> must be less than half of <b>delay</b>.

              In update mode, <b>maxerr</b> must be less than <b>prompt.</b>

              In daemon mode (i.e. when <b>-x</b> is specified), <b>minerr</b> must be less than <b>maxerr</b> which must be less
              than <b>separation</b> (note that this is in minutes, not seconds, but  the  numeric  value  is  com-<font color="#ffffff" class="whiteout">pared).&nbsp;compared).</font>
              pared).

       Note  that  none  of  the above values are closely linked to the limits described in the NTP protocol
       (RFC 1305).

<b>USAGE</b>
       The simplest use of this program is as an unprivileged command to check the current time and error in
       the local clock.  For example:

              <b>sntp</b> <b>ntpserver.somewhere</b>

       It can be run as a unprivileged background process to check on the clock drift as well as the current
       error; this will probably fail if the local clock is reset while it is running.  For example:

              <b>sntp</b> <b>-x</b> <b>ntpserver.somewhere</b> <b>&gt;</b> <b>output</b> <b>2&gt;1</b>

       With suitable privilege, it can be run as a command or in a <u>cron</u> job to reset the local clock from  a
       reliable server, like the <u>ntpdate</u> and <u>rdate</u> commands.  For example:

              <b>sntp</b> <b>-a</b> <b>ntpserver.somewhere</b>

       It can also be run as a daemon to keep the local clock in step.  For example:

              <b>sntp</b> <b>-a</b> <b>-x</b> <b>ntpserver.somewhere</b> <b>&gt;</b> <b>output</b> <b>2&gt;1</b>

       More information on how to use this utility is given in the <u>README</u> file in the distribution.  In par-<font color="#ffffff" class="whiteout">ticular,&nbsp;particular,</font>
       ticular, this <u>man</u> page does not describe how to set it up as a server, which needs  special  care  to
       avoid propagating misinformation.

<b>RETURN</b> <b>VALUE</b>
       When  used  as a client in non-daemon mode, the program returns a zero exit status for success, and a
       non-zero one otherwise. When used as a daemon (either client or server), it does  not  return  except
       after a serious error.

<b>BUGS</b>
       The program implements the SNTP protocol, and does not provide all NTP facilities.  In particular, it
       contains no checks against any form of spoofing.  If this is a serious concern, some network security
       mechanism (like a firewall or even just <u>tcpwrappers</u>) should be installed.

       There  are  some errors, ambiguities and inconsistencies in the RFCs, and this code may not interwork
       with all other NTP implementations.  Any unreasonable restrictions should be reported as bugs to who-<font color="#ffffff" class="whiteout">ever&nbsp;whoever</font>
       ever is responsible.  It may be difficult to find out who that is.

       The  program  will  stop  as  soon as it feels that things have got out of control.  In client daemon
       mode, it will usually fail during an extended period of network or server inaccessibility  or  exces-<font color="#ffffff" class="whiteout">sively&nbsp;excessively</font>
       sively  slow  performance,  or  when  the local clock is reset by another process.  It will then need
       restarting manually.  Experienced system administrators can write a shell script, a <u>cron</u> job  or  put
       it in <u>inittab</u>, to do this automatically.

       The  error  cannot be estimated reliably with broadcast packets or for the drift in daemon mode (even
       with client-server packets), and the guess made by the program  may  be  wrong  (possibly  even  very
       wrong).  If this is a problem, then setting the <b>-c</b> option to a larger value may help.  Or it may not.

<b>AUTHOR</b>
       <u>sntp</u> was developed by N.M. Maclaren of the University of Cambridge Computing Service.



                                                                                                     SNTP(1)
</tt></pre>
</td></tr></table>
	<table width="100%" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/documentation/Darwin/Reference/ManPages/man1/sntp.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/documentation/Darwin/Reference/ManPages/man1/sntp.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/documentation/Darwin/Reference/ManPages/man1/sntp.1.html%3Fid%3DTP40000894-7.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

</body></html>
