<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>AEInstallEventHandler(IM:IC)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING136></A>


<!-- Top of Header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- Bottom of Header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="IAC-135.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-137.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="IAC-2.html"><B>Interapplication Communication</B></A> / <BR><DD><A HREF="IAC-115.html"><B>Chapter 4 - Responding to Apple Events</B></A> / <A HREF="IAC-130.html"><B>Reference to Responding to Apple Events</B></A><BR><DL><DD><A HREF="IAC-134.html"><B>Routines for Responding to Apple Events</B></A> / <A HREF="IAC-135.html"><B>Creating and Managing the Apple Event Dispatch Tables</B></A></DL></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING136-0></A>
<H3><A NAME=MARKER-9-466></A>AEInstallEventHandler</H3>
 <A NAME=MARKER-2-467></A><A NAME=MARKER-9-53></A><A NAME=MARKER-2-38></A>You can use the <CODE>AEInstallEventHandler</CODE> function to add an entry to either your application's Apple event dispatch table or the system Apple event dispatch table.<P>
<PRE>
FUNCTION AEInstallEventHandler (theAEEventClass: AEEventClass;
                                theAEEventID: AEEventID; 
                                handler: EventHandlerProcPtr; 
                                handlerRefcon: LongInt;
                                isSysHandler: Boolean): OSErr;
</PRE>
<DL>
<DT><CODE>theAEEventClass</CODE>
<DD> The event class for the Apple event or events to be dispatched for this entry. The <CODE>AEEventClass</CODE> data type is defined as a four-character code:
</DL>
<PRE>
            TYPE AEEventClass = PACKED ARRAY[1..4] OF Char;
</PRE>
<DL>
<DT><CODE>theAEEventID</CODE>
<DD> The event ID for the Apple event or events to be dispatched for this entry. The <CODE>AEEventID</CODE> data type is defined as a four-character code:
</DL>
<PRE>
            TYPE AEEventID = PACKED ARRAY[1..4] OF Char;
</PRE>
<DL>
<DT><CODE>handler</CODE> 
<DD> A pointer to an Apple event handler for this dispatch table entry. Note that a handler in the system dispatch table must reside in the system heap; this means that if the value of the <CODE>isSysHandler</CODE> parameter is <CODE>TRUE</CODE>, the handler parameter should point to a location in the system heap. Otherwise, if you put your system handler code in your application heap, you must use <CODE>AERemoveEventHandler</CODE> to remove the handler before your application terminates.
<DT><CODE>handlerRefcon</CODE>
<DD> <BR>A reference constant that is passed by the Apple Event Manager to the handler each time the handler is called. If your handler doesn't use a reference constant, use 0 as the value of this parameter. 
<DT><CODE>isSysHandler</CODE>
<DD> <BR>Specifies the dispatch table to which you want to add the handler. If the value of <CODE>isSysHandler</CODE> is <CODE>TRUE</CODE>, the Apple Event Manager adds the handler to the system Apple event dispatch table. Entries in the system dispatch table are available to all applications. If the value of <CODE>isSysHandler</CODE> is <CODE>FALSE</CODE>, the Apple Event Manager adds the handler to your application's Apple event dispatch table. The application's dispatch table is searched first; the system dispatch table is searched only if the necessary handler is not found in your application's dispatch table.
</DL>
<A NAME=HEADING136-10></A>
<H5>DESCRIPTION</H5>
 The <CODE>AEInstallEventHandler</CODE> function creates an entry in the Apple event dispatch table. You must supply parameters that specify the event class, the event ID, the address of the handler that handles Apple events of the specified event class and event ID, and whether the handler is to be added to the system Apple event dispatch table or your application's Apple event dispatch table. You can also specify a reference constant that the Apple Event Manager passes to your handler whenever your handler processes an Apple event.<P>
 The parameters <CODE>theAEEventClass</CODE> and <CODE>theAEEventID</CODE> specify the event class and event ID of the Apple events to be handled by the handler for this dispatch table entry. For these parameters, you must provide one of the following combinations:<P>
<UL>
<LI>the event class and event ID of a single Apple event to be dispatched to the handler
<LI>the <CODE>typeWildCard</CODE> constant for <CODE>theAEEventClass</CODE> and an event ID for <CODE>theAEEventID</CODE>, which indicate that Apple events from all event classes whose event IDs match <CODE>theAEEventID</CODE> should be dispatched to the handler
<LI>an event class for <CODE>theAEEventClass</CODE> and the <CODE>typeWildCard</CODE> constant for <CODE>theAEEventID</CODE>, which indicate that all events from the specified event class should be dispatched to the handler
<LI>the <CODE>typeWildCard</CODE> constant for both the <CODE>theAEEventClass</CODE> and <CODE>theAEEventID</CODE> parameters, which indicates that all Apple events should be dispatched to the handler<A NAME=MARKER-2-470></A><A NAME=MARKER-2-377></A><A NAME=MARKER-2-378></A> <P>
</UL>
<DL>
<DT><B>IMPORTANT</B>
<DD>If you use the <CODE>typeWildCard</CODE> constant for either the <CODE>theAEEventClass</CODE> or the <CODE>theAEEventID</CODE> parameter (or for both parameters), the corresponding handler must return the error <CODE>errAEEventNotHandled</CODE> if it does not handle a particular event.<EM></EM>  <IMG ALIGN = BOTTOM SRC = "graphics/triangle.gif">
</DL>
 If there was already an entry in the specified dispatch table for the same event class and event ID, it is replaced. Therefore, before installing a handler for a particular Apple event in the system dispatch table, use the <CODE>AEGetEventHandler</CODE> function (described next) to determine whether the table already contains a handler for that event. If an entry exists, <CODE>AEGetEventHandler</CODE> returns a reference constant and a pointer to that event handler. Chain the existing handler to your handler by providing pointers to the previous handler and its reference constant in the <CODE>handlerRefcon</CODE> parameter of <CODE>AEInstallEventHandler</CODE>. When your handler is done, use these pointers to call the previous handler. If you remove your system Apple event handler, be sure to reinstall the chained handler. <P>
<A NAME=HEADING136-19></A>
<H5>SPECIAL CONSIDERATIONS</H5>
 Before an application calls a system Apple event handler, system software has set up the A5 register for the calling application. For this reason, if you provide a system Apple event handler, it should never use A5 global variables or anything that depends on a particular context; otherwise, the application that calls the system handler may crash.<P>
<A NAME=HEADING136-21></A>
<H5>RESULT CODES
<TABLE BORDER="0" CELLPADDING=3><TD>noErr<TD>0<TD>No error<TR>
<TD>paramErr<TD>-50<TD>Parameter error (handler pointer is <CODE>NIL</CODE> or odd)<TR>
<TD>memFullErr<TD>-108<TD>Not enough room in heap zone<A NAME=MARKER-8-169></A><A NAME=MARKER-9-178></A><A NAME=MARKER-9-68></A></TABLE>
</H5>
<A NAME=HEADING136-22></A>
<H5>SEE ALSO</H5>
 For more information about installing Apple event handlers, see <A HREF=IAC-118.html#MARKER-9-233>"Installing Entries in the Apple Event Dispatch Tables,"</A> which begins on <A HREF=IAC-118.html#MARKER-9-233>page 4-7</A>.<P>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="IAC-135.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="IAC-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="IAC-529.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="IAC-137.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="IAC-3.html">&copy; Apple Computer, Inc.</A><br>7 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
