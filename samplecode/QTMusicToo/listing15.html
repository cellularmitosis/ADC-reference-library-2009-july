<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>

	<!-- BEGIN META TAG INFO -->
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<link rel="home" href="http://developer.apple.com/">
	<link rel="find" href="http://developer.apple.com/search/">
	<link rel="stylesheet" type="text/css" href="../../documentation/css/adcstyle.css" title="fonts">
	<script language="JavaScript" src="../../documentation/js/adc.js" type="text/javascript"></script>
	<!-- END META TAG INFO -->
	
	<!-- BEGIN TITLE -->
	<title>QTMusicToo - /BigEasy/BigEasyTextish.c</title>
	<!-- END TITLE -->
<script language="JavaScript">
function JumpToNewPage() {
	window.location=document.scpopupmenu.gotop.value;
	return true;
}
</script>

</head>

<!-- BEGIN BODY OPEN -->
<body>
<!--END BODY OPEN -->

<!-- START CENTER OPEN -->
<center>
<!-- END CENTER OPEN -->

	<!-- BEGIN LOGO AND SEARCH -->
	<!--#include virtual="/includes/adcnavbar"-->
	<!-- END LOGO AND SEARCH -->
		
		
	<!-- START BREADCRUMB -->
	<div id="breadcrumb">
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td scope="row"><img width="340" height="10" src="images/1dot.gif" alt=""></td>
			<td><img width="340" height="10" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr valign="middle">
			<td align="left" colspan="2">
			<a href="http://developer.apple.com/">ADC Home</a> &gt; <a href="../../referencelibrary/index.html">Reference Library</a> &gt; <a href="../../samplecode/index.html">Sample Code</a> &gt; <a href="../../samplecode/QuickTime/index.html">QuickTime</a> &gt; <a href="../../samplecode/QuickTime/idxMusicAudio-date.html">Audio</a> &gt; <A HREF="javascript:location.replace('index.html');">QTMusicToo</A> &gt; 
			</td>
		</tr>
		<tr>
			<td colspan="2" scope="row"><img width="680" height="35" src="images/1dot.gif" alt=""></td>
		</tr>
	</table>
	</div>
	<!-- END BREADCRUMB -->

	<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;"><div class="legacybox"><h1>Not Recommended Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../images/closebutton.png" width="14" height="14" border="0"  alt="close button"></a></span></h1>

<p><strong>Important: </strong>The information in this document is <strong>Not Recommended</strong> and should not be used for new development.</p>

<div class="reflibtopic">
	<p>Current information on this Reference Library topic can be found here:</p>
	<ul>
				<li><a href="http://developer.apple.com/referencelibrary/QuickTime/idxMusicAudio-date.html" target="_blank">QuickTime > Audio</a></li>
	</ul>
</div>




</div></div></div>

	<!-- START MAIN CONTENT -->
	
	<!-- START TITLE GRAPHIC AND INTRO-->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td><h1><div id="pagehead">QTMusicToo</div></h1></td>
		</tr>
	</table>
	<!-- END TITLE GRAPHIC AND INTRO -->
	<!-- START WIDE COLUMN -->
	<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr align="left" valign="top">
			<td id="scdetails">
				<h2>/BigEasy/BigEasyTextish.c</h2>
				<form name="scpopupmenu" onSubmit="return false;" method=post>
				<p><strong>View Source Code:</strong> 
					<select name="gotop" onChange="JumpToNewPage();" style="width:340px"><option selected value="ingnore">Select File</option>
<option value="listing1.html">/BigEasy/BigEasy2.c</option>
<option value="listing2.html">/BigEasy/BigEasy2.h</option>
<option value="listing3.html">/BigEasy/BigEasyControls.c</option>
<option value="listing4.html">/BigEasy/BigEasyControls.h</option>
<option value="listing5.html">/BigEasy/BigEasyDialogs.c</option>
<option value="listing6.html">/BigEasy/BigEasyDialogs.h</option>
<option value="listing7.html">/BigEasy/BigEasyGestalt.c</option>
<option value="listing8.html">/BigEasy/BigEasyGestalt.h</option>
<option value="listing9.html">/BigEasy/BigEasyGrafish.c</option>
<option value="listing10.html">/BigEasy/BigEasyGrafish.h</option>
<option value="listing11.html">/BigEasy/BigEasyPPC.c</option>
<option value="listing12.html">/BigEasy/BigEasyPPC.h</option>
<option value="listing13.html">/BigEasy/BigEasyStandardControls.c</option>
<option value="listing14.html">/BigEasy/BigEasyStandardControls.h</option>
<option value="listing15.html">/BigEasy/BigEasyTextish.c</option>
<option value="listing16.html">/BigEasy/BigEasyTextish.h</option>
<option value="listing17.html">/BigEasy/BigEasyUtils.c</option>
<option value="listing18.html">/BigEasy/BigEasyUtils.h</option>
<option value="listing19.html">/BigEasy/IconUtilsPriv.h</option>
<option value="listing20.html">/BigEasy/NWindows.c</option>
<option value="listing21.html">/BigEasy/OneWindow.c</option>
<option value="listing22.html">/•Instrument Editor/All The MIDI Components.h</option>
<option value="listing23.html">/•Instrument Editor/IE KeyboardDiagram.c</option>
<option value="listing24.html">/•Instrument Editor/IE KeyboardDiagram.h</option>
<option value="listing25.html">/•Instrument Editor/IE PrintUtilities.c</option>
<option value="listing26.html">/•Instrument Editor/IE PrintUtilities.h</option>
<option value="listing27.html">/•Instrument Editor/Instrument Editor Controls.c</option>
<option value="listing28.html">/•Instrument Editor/Instrument Editor Controls.h</option>
<option value="listing29.html">/•Instrument Editor/Instrument Editor Draw.c</option>
<option value="listing30.html">/•Instrument Editor/Instrument Editor Filing.c</option>
<option value="listing31.html">/•Instrument Editor/Instrument Editor Filing.h</option>
<option value="listing32.html">/•Instrument Editor/Instrument Editor Menus.c</option>
<option value="listing33.html">/•Instrument Editor/Instrument Editor Menus.h</option>
<option value="listing34.html">/•Instrument Editor/Instrument Editor.c</option>
<option value="listing35.html">/•Instrument Editor/Instrument Editor.h</option>
<option value="listing36.html">/•Instrument Editor/Instrument Editor.r</option>
<option value="listing37.html">/•Instrument Editor/Instrument Tests.c</option>
<option value="listing38.html">/•Instrument Editor/More IE Routines.c</option>
<option value="listing39.html">/•Instrument Editor/More IE Routines.h</option>
<option value="listing40.html">/•Instrument Picker Test/InstrumentPickerTest.c</option>
<option value="listing41.html">/•QTMusic Sample Keyboards/EasyKeyboardDiagram.c</option>
<option value="listing42.html">/•QTMusic Sample Keyboards/EasyKeyboardDiagram.h</option>
<option value="listing43.html">/•QTMusic Sample Keyboards/EasyKeyboardDiagram.r</option>
<option value="listing44.html">/•QTMusic Sample Keyboards/QTMusic Sample Keyboards.c</option>
<option value="listing45.html">/•QTMusic Sample Keyboards/QTMusic Sample Keyboards.r</option>
<option value="listing46.html">/•QTMusic Sample Sequencer/Event Priority Queue.c</option>
<option value="listing47.html">/•QTMusic Sample Sequencer/Event Priority Queue.h</option>
<option value="listing48.html">/•QTMusic Sample Sequencer/Sequencer Test Movies.c</option>
<option value="listing49.html">/•QTMusic Sample Sequencer/Sequencer Test Movies.h</option>
<option value="listing50.html">/•QTMusic Sample Sequencer/SequencerTest Filing.c</option>
<option value="listing51.html">/•QTMusic Sample Sequencer/SequencerTest Filing.h</option>
<option value="listing52.html">/•QTMusic Sample Sequencer/SequencerTest Movies.h</option>
<option value="listing53.html">/•QTMusic Sample Sequencer/SequencerTest Realtime.c</option>
<option value="listing54.html">/•QTMusic Sample Sequencer/SequencerTest Realtime.h</option>
<option value="listing55.html">/•QTMusic Sample Sequencer/SequencerTest.c</option>
<option value="listing56.html">/•QTMusic Sample Sequencer/SequencerTest.h</option></select>
				</p>
				</form>
				<p><strong><a href="QTMusicToo.zip">Download Sample</a></strong> (&#147;QTMusicToo.zip&#148;, 115.5K)<BR>
<strong><a href="QTMusicToo.dmg">Download Sample</a></strong> (&#147;QTMusicToo.dmg&#148;, 173.6K)</p>
				<!--
				<p><strong><a href="#">Download Sample</a></strong> (&#147;filename.sit&#148;, 500K)</p>
				-->
			</td>
		</tr>
		<tr>
			<td scope="row"><img width="680" height="10" src="images/1dot.gif" alt=""><br>
			<img height="1" width="680" src="images/1dot_919699.gif" alt=""><br>
			<img width="680" height="20" src="images/1dot.gif" alt=""></td>
		</tr>
		<tr>
			<td scope="row">
	<!--googleon: index -->
<pre class="sourcecodebox">/*        File:    BigEasyTextish.c              Contains:  xxx put contents here xxx              Written by:  xxx put writers here xxx              Copyright:  &copy; 1990-1992 by Apple Computer, Inc., all rights reserved.          This file is used in these builds: Warhol        Change History (most recent first):          &lt;9+&gt;    5/6/93  dvb    String-&gt;Number     &lt;9&gt;    1/7/93  dvb    New functions (TruncateString).     &lt;8&gt;   1/20/92  dvb    This kind of FixMath is KRAZEE!     &lt;7&gt;  11/12/91  dvb    General fixation     &lt;6&gt;   11/4/91  JB    Use fixmath instead of floats     &lt;5&gt;    6/3/91  dvb    Just Hackin'.     &lt;4&gt;   5/23/91  PH    THINK C 5     &lt;3&gt;   4/25/91  JB    Changing to new THINK_C interface files     &lt;2&gt;  11/16/90  dvb    Remove drawcstring    &lt;1&gt;    11/16/90  dvb    Check In! Fresh after Camplejohn Soup!              To Do:      *//* file: BigEasyTextish.c * * Started 13 July 1989, more or less. * * A set of routines for converting and * displaying textish things on the Mac. * *//************************************* Inclusions************************************/#define BigEasyTextish#include &lt;QuickDraw.h&gt;#include &lt;Packages.h&gt;#include &lt;Memory.h&gt;#include &lt;FixMath.h&gt;#include &quot;BigEasyTextish.h&quot;/************************************* Limits************************************//************************************* Types and globals************************************/static char dHexChars[] = &quot;0123456789ABCDEF&quot;;/************************************* Routines************************************/void AnyBaseToPString(long n,short b,short g,StringPtr c)/*  * Convert 32 bit number n to  *  string c, in number base b.  * g is the format: 0 - any length signed  * positive: unsigned with leading zeros  * to width g.  */  {  register short charCount;  register StringPtr w;  register unsigned long x;    /* unsigned number for divs  */  if(b&lt;2 || b&gt;16)        /* a ridiculous number base?  */    {    c[0] = 0;        /* mark as empty string    */    return;        /* bye.          */    }  if(g == 0)    {    charCount = 1;      /* initially, 1 char long    */    if(n &lt; 0)        /* number negative?    */      {      charCount++;    /* one more char      */      n = -n;        /* make it positive      */      c[1] = '-';      /* drop in a minus sign    */      if(n &lt; 0)        n --;      /* most negative? pin it. */      }    x = n;        /* find out how many digits  */    while(x /= b)      charCount++;    c[0] = charCount;    /* number of digits, plus sign  */    w = c+c[0];      /* we'll walk backwards    */    x = n;    do      {      *w-- = dHexChars[x%b];      x /= b;      } while(x);    }  else if(g &gt; 0)    {          /* leading zero format    */    c[0] = g;      /* poke in number of chars  */    x = n;        /* get our number unsigned  */    w = &amp;c[g];      /* point to end of string    */    while(g--)      {      *w-- = dHexChars[x%b];      x /= b;      }    }  else if(g &lt; 0)    {          /* leading space format   */    g = -g;    c[0] = g;        /* poke in number of chars  */    x = n;        /* get our number unsigned  */    w = &amp;c[g];      /* point to end of string    */        while(g--)      {      *w-- = dHexChars[x%b];      x /= b;      }    g = c[0]-1;    w = &amp;c[1];    while(g--)      {      if (*w == '0')        *w++ = 0xca;      else        break;      }    }  else          /* negative format passed  */    c[0] = 0;  }void DrawNum(n)/*  * Draw number n as a signed long, in decimal  */  long n;  {  Str31 c;  AnyBaseToPString(n,10,0,c);  DrawString((StringPtr)c);  }long dTens[] =  {  1,  10,  100,  1000,  10000,  100000,  1000000,  10000000,  100000000,  1000000000  };void FixedPointToPString(long n,short g,short p,StringPtr s)/*  * Draw number n in fixed point, with  * g decimal places, with p fractional  * binary places.  */  {  Str31 c;  long x;    /* This should float to avoid overflows, but JB says, No! */  s[0] = 0;  if( n &lt; 0 )    {    ConcatenatePStrings(s,&quot;\p-&quot;);    n = -n;    if(n &lt; 0)      n--;    /* pin most negative */    }  AnyBaseToPString(n&gt;&gt;p,10,0,c);  ConcatenatePStrings(s,c);  ConcatenatePStrings(s,&quot;\p.&quot;);  if(g&gt;9)    g = 9;  if(g)    {    x = (n &amp; ((1L&lt;&lt;p)-1) );    x *= dTens[g];    x /= (x,1L&lt;&lt;p);    AnyBaseToPString(x,10,g,c);    ConcatenatePStrings(s,c);    }  }void PStringToFixedPoint(StringPtr s,short g,short p,long *n)  {  long x;  unsigned long y,z,z10;  short count;  Boolean decimal;  Boolean sign;  count = *s++;  x = 0;  decimal = false;  sign = false;  z = (1L&lt;&lt;p);  z10 = 10;  while(count-- &amp;&amp; z)    {    y = *s;    if(y == '.')      decimal = true;    else if (y == '-')      sign = true;    else      {      y = y - '0';      if(y &lt; 10)        {        if(!decimal)          {          x *= 10;          x += y &lt;&lt; p;          }        else          {          x += (y * z + z10/2) / z10;          z10 *= 10;          }        }      }    s++;    }  if(sign)    x = -x;  *n = x;  }void DrawFixedPoint(long n,short g,short p)/*  * Draw number n in fixed point, with  * g decimal places, with p fractional  * binary places.  */  {  Str255 s;  FixedPointToPString(n,g,p,s);  DrawString(s);  }void DrawFixed(long n,short g)/*  * Draw number n in fixed point, with  * g decimal places.  */  {  DrawFixedPoint(n,g,16);  }void DrawFixedPointJustified(long n,short g,short p,short h)/*  * Draw number n in fixed point, with  * g decimal places, with p fractional  * binary places.  */  {  Str255 s;  Str31 c;  long x;  s[0] = 0;  if( n &lt; 0 )    {    ConcatenatePStrings(s,&quot;\p-&quot;);    n = -n;    if(n &lt; 0)      n --;      /* most negative? pin it. */    }  AnyBaseToPString(n&gt;&gt;p,10,-h,c);  ConcatenatePStrings(s,c);  ConcatenatePStrings(s,&quot;\p.&quot;);  if(g&gt;9)    g = 9;  if(g)    {        x = (n &amp; ((1L&lt;&lt;p)-1) );    x *= dTens[g];    x /= (x,1L&lt;&lt;p);    AnyBaseToPString(x,10,g,c);    ConcatenatePStrings(s,c);    }  DrawString(s);  }void DrawFixedJustified(long n,short g,short h)/*  * Draw number n in fixed point, with  * g decimal places.  */  {  DrawFixedPointJustified(n,g,16,h);  }void DrawFrac(long n,short g)/*  * Draw number n as a frac (2.30), with  * g decimal places.  */  {  DrawFixedPoint(n,g,30);  }void DrawHexLong(unsigned long n)/*  * Draw an 8-digit hex number  * with leading zeroes  */  {  Str31 c;  AnyBaseToPString(n,16,8,c);  DrawString((StringPtr)c);  }void DrawHexShort( unsigned short n)/*  * Draw a 4-digit hex number  * with leading zeroes  */  {  Str31 c;  AnyBaseToPString(n,16,4,c);  DrawString(c);  }void DrawHexByte(unsigned char n)  {  Str31 c;  AnyBaseToPString(n,16,2,c);  DrawString(c);  }void CToPString(register char *c,register StringPtr p)  {  register short i;  register StringPtr pWalker;  i = 0;  pWalker = p+1;  while(*pWalker++ = *c++)    i++;  *p = i;  }void DrawCR(void)/*  * Bump penposition down a line, to  * gLeftMargin, and +gLineHeight.  */  {  Point p;  GetPen(&amp;p);  p.h = gLeftMargin;  p.v += gLineHeight;  MoveTo(p.h,p.v);  }short CStringWidth(char *c)/*  * Do a StringWidth on a C string  */  {  Str255 p;  CToPString(c,p);  return StringWidth((StringPtr)p);  }void CopyPString(StringPtr dest,StringPtr src)  {  if(dest &amp;&amp; src)    BlockMove(src,dest,(*src) + 1);  }void ConcatenatePStrings(StringPtr dest,StringPtr src)  {  BlockMove(src+1,dest+1+(*dest),*src);  *dest += *src;  }void DrawStringRight(StringPtr s)/* * Draw the string from the current pen position * off to the left; leave the pen where it started. */  {  Point po;  GetPen(&amp;po);  Move(-StringWidth(s),0);  DrawString(s);  }void DrawStringCenter(StringPtr s)/* * Draw the string centered at * the current pen position;  * leave the pen where it started. */  {  Point po;  GetPen(&amp;po);  Move(-StringWidth(s)/2,0);  DrawString(s);  MoveTo(po.h,po.v);  }void DrawStringLeft(StringPtr s)/* * Draw the string from the current pen position * off to the right; leave the pen where it started. */  {  Point po;  GetPen(&amp;po);  DrawString(s);  MoveTo(po.h,po.v);  }void TruncateString(StringPtr s, short width)/* * Draw the string limited to the width passed, * Truncated if necessary with a trailing &quot;&quot;. */  {  while(StringWidth(s) &gt; width)    {    s[0] --;    s[s[0]] = '\xC9';    }  }void DrawStringTruncated(StringPtr s, short width)/* * Draw the string limited to the width passed, * Truncated if necessary with a trailing &quot;&quot;. */  {  Str255 s2;  CopyPString(s2,s);  TruncateString(s2,  width);  DrawString(s2);  }void OSTypeToString(StringPtr dest,OSType x)  {  dest[0] = 4;  dest[1] = (x&gt;&gt;24);  dest[2] = (x&gt;&gt;16);  dest[3] = (x&gt;&gt;8);  dest[4] = x;  }</pre>
	<!--googleoff: index -->
			</td>
		</tr>
	</table>
	<!-- END WIDE COLUMN -->

	<!-- END MAIN CONTENT -->
		<table width="680" border="0" cellpadding="0" cellspacing="0">
		<tr>
			<td><div style="width: 100%; height: 1px; background-color: #919699; margin-top: 5px; margin-bottom: 15px"></div></td>
		</tr>
		<tr>
			<td align="center"><br/>
				<table border="0" cellpadding="0" cellspacing="0" class="graybox">
					<tr>
						<th>Did this document help you?</th>
					</tr>
					<tr>
						<td>
						    <div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=1&url=/samplecode/QTMusicToo/listing15.html%3Fid%3DDTS10000915-1.0&media=dvd" target=_new>Yes</a>:  Tell us what works for you.</div>
							<div style="margin-bottom: 8px"><a href="http://developer.apple.com/feedback/?v=2&url=/samplecode/QTMusicToo/listing15.html%3Fid%3DDTS10000915-1.0&media=dvd" target=_new>It&#8217;s good, but:</a> Report typos, inaccuracies, and so forth.</div>
							<div><a href="http://developer.apple.com/feedback/?v=3&url=/samplecode/QTMusicToo/listing15.html%3Fid%3DDTS10000915-1.0&media=dvd" target=_new>It wasn&#8217;t helpful</a>: Tell us what would have helped.</div>
						</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>

	<!-- START BOTTOM APPLE NAVIGATION -->
	<!--#include virtual="/includes/footer"-->
	<!-- END BOTTOM APPLE NAVIGATION -->

<!-- START CENTER CLOSE -->
</center>
<!-- END CENTER CLOSE -->

</body>
</html>