<!-- Generated by Harlequin WebMaker 2.2.3 (23-Apr-1996)
LispWorks 3.2.2 -->
<HTML> <HEAD>
<TITLE>Creating a Bundle Resource(IM:Tb)</TITLE>
<LINK REL="stylesheet" TYPE="text/css" HREF="../../Resources/CSS/frameset_styles.css">
<script type="text/javascript" language="JavaScript" src="../../Resources/JavaScript/page.js"></script>
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000">

<div style="width:100%; position:fixed;"><div align="center" id="watermark" style="position: relative; margin-left:auto; margin-right:auto; z-index:20; width:500px;">
<div class="legacybox" style="position: relative;">
<h1>Legacy Document<span class=closebutton><a href="javascript:closeWatermark()"><img src="../../Resources/Images/closebutton.png" width="14" height="14" border="0" align="top" alt="close button"></a></span></h1><p><b>Important:</b>
The information in this document is obsolete and should not be used for new development.</p></div></div></div>


<A NAME=HEADING451></A>


<!-- start of header -->

<!--#include virtual="/includes/framesetheader" -->

<!-- end of header -->


<!-- Main Body -->

<CENTER>
<P>
<A HREF="Toolbox-450.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-452.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<FONT SIZE=-1><DL><DT><a href="../../macos8/mac8.html" onmouseover="window.status='Macintosh Documentation'; return true"><B>Inside Macintosh:</B></A> <A HREF="Toolbox-2.html"><B>Macintosh Toolbox Essentials</B></A> / <BR><DD><A HREF="Toolbox-443.html"><B>Chapter 7 - Finder Interface</B></A> / <A HREF="Toolbox-446.html"><B>Using the Finder Interface</B></A></DL></FONT><P>
<HR>
<BLOCKQUOTE>
<A NAME=HEADING451-0></A>
<H2><A NAME=MARKER-9-262></A>Creating a Bundle Resource</H2>
 <A NAME=MARKER-2-263></A>A bundle (<CODE>'BNDL'</CODE>) resource associates all of the resources used by the Finder for your application; in particular, it associates your application and its documents with their icons. The bundle resource contains<A NAME=MARKER-2-264></A><A NAME=MARKER-2-265></A><A NAME=MARKER-2-266></A><P>
<UL>
<LI>the application's signature
<LI>the resource ID number of its signature resource (which should always be 0)<A NAME=MARKER-2-267></A>
<LI>the assignment of local IDs to the resource IDs of all icon list resources defined for the application; the local IDs must be the same as those assigned within corresponding file reference resources<A NAME=MARKER-2-268></A><A NAME=MARKER-2-269></A>
<LI>the assignment, for compatibility reasons, of local IDs to file reference resource IDs (For consistency, these can be the same local IDs that are assigned inside the file reference resources, but they don't have to be--they only need to be unique for every file reference resource.)<P>
</UL>
 When the Finder first displays your application on the user's desktop, it checks the catalog file (described in detail in <A HREF=Toolbox-455.html#MARKER-9-356>"Using Finder Information in the Catalog File" beginning on page 7-30</A>) to see if your application has a bundle resource. If it doesn't, <BR>the Finder displays the default icons shown in <A HREF=Toolbox-448.html#MARKER-9-166>Figure 7-5 on page 7-12</A>. If your application has a bundle resource, the Finder installs the information from the bundle resource and all its bundled resources into either the desktop database for a hard disk <BR>or into the Desktop file for a floppy disk and uses this information to display icons for the file types associated with your application.<P>
 You must assign local IDs to your icon list resources within your bundle resource. Make sure that for all your file types with icons, these local IDs match the local IDs you assigned inside their corresponding file reference resources. In the Desktop file on floppy disks (and on hard disks running earlier versions of system software), the Finder renumbers the resource IDs that you've assigned to your resources to avoid conflicts with the resources of other applications. Therefore, the bundle resource has to rely on these local IDs to map icon list resources to their file reference resources; that is, the bundle resource uses the local ID you assign to an icon list resource to map it to the file reference resource that has specified the same local ID.<P>
 For example, the file reference resource with resource ID 208 in <A HREF=Toolbox-450.html#MARKER-9-243>Listing 7-3 on page 7-18</A> shows that the file type <CODE>'APPL'</CODE> (the SurfWriter application file) is assigned a local ID <BR>of 0. In the bundle resource shown in <A HREF=#MARKER-9-270>Listing 7-4</A>, you see that local ID 0 is assigned to the icon list resource with resource ID 128. This maps the icon defined by this resource (see <A HREF=Toolbox-448.html#MARKER-9-181>Figure 7-7 on page 7-13</A>) to the SurfWriter application file. <A HREF=#MARKER-9-270>Listing 7-4</A> shows <BR>the bundle resource for the icons and file reference resources defined in <A HREF=Toolbox-448.html#MARKER-9-183>Listing 7-2 on page 7-13</A> and in <A HREF=Toolbox-450.html#MARKER-9-243>Listing 7-3 on page 7-18</A>.<P>
<B>Listing 7-4  <A NAME=MARKER-9-270></A><A NAME=MARKER-21-271></A>Rez input for a bundle resource</B><P>
<PRE>
resource 'BNDL' (128, purgeable) {  /*SurfWriter bundle resource*/
   'WAVE',     /*SurfWriter signature*/
   0,          /*resource ID of signature resource: should be 0*/
   {
      'ICN#', {   /*mapping local IDs in 'FREF's to 'ICN#' IDs*/
      0, 128,  /*'FREF' w/ local ID 0 maps to 'ICN#' res ID 128*/
      1, 129,  /*'FREF' w/ local ID 1 maps to 'ICN#' res ID 129*/
      2, 130,  /*'FREF' w/ local ID 2 maps to 'ICN#' res ID 130*/
      3, 131   /*'FREF' w/ local ID 3 maps to 'ICN#' res ID 131*/
               /*no 'FREF' with local ID 4 in this list: */
               /* TeachText's icons used for 'ttro' file type*/
      },
      'FREF', {   /*local res IDs for 'FREF's: no duplicates*/
      10, 208, /*local ID 10 assigned to 'FREF' res ID 208*/
      11, 209, /*local ID 11 assigned to 'FREF' res ID 209*/
      12, 210, /*local ID 12 assigned to 'FREF' res ID 210*/
      13, 211, /*local ID 13 assigned to 'FREF' res ID 211*/
      14, 212  /*local ID 14 assigned to 'FREF' res ID 212*/
      }
   }
};
</PRE>
 In <A HREF=#MARKER-9-270>Listing 7-4</A>, notice that you also assign local IDs to file reference resources inside the bundle resource. This assignment is superfluous because the Finder doesn't map these local IDs to any other resources. The local ID assignment for file reference resources inside the bundle resource was implemented for the earliest versions of Macintosh system software, and it remains this way today to maintain backward compatibility. For compatibility with the format of the bundle resource, assign local IDs to file reference resource IDs. You may number them any way you like, except that each local ID in this particular list must be unique.<A NAME=MARKER-2-24></A><P>
 Of all the icon resource types that make up an icon family, you need to list only the icon list resource in the bundle resource. The Finder automatically recognizes and loads all the other members of the icon family--provided that you have given them the same resource IDs that you have assigned to your icon list resource.<P>
 If the user drags documents created by other applications to your application icon, and <BR>if you have created file reference resources for these documents' file types, the Finder launches your application and passes it the names of the documents. You should create file reference resources for all file types that your application supports. Do not provide icon resources for file types created by other applications because the Finder won't use them, but will instead use the icon resources defined by the documents' creators. Though the local IDs of such a file reference resource are superfluous in the file reference resource and at the bottom of the bundle resource, the resource formats require that you provide local IDs in both.<A NAME=MARKER-2-26></A><P>
 For example, notice in <A HREF=Toolbox-450.html#MARKER-9-243>Listing 7-3 on page 7-18</A> that the file reference resource with resource ID 212 is assigned a local ID of 4, but that no icon list resource is assigned to local ID 4 in the bundle resource in <A HREF=#MARKER-9-270>Listing 7-4 on page 7-20</A>. This file reference resource, which specifies a file type of <CODE>'ttro'</CODE>, was created in <A HREF=Toolbox-450.html#MARKER-9-243>Listing 7-3</A> to make the Finder launch the SurfWriter application when users drag TeachText read-only documents to the SurfWriter application icon. No icon mapping is made for this file type in the SurfWriter application's bundle resource because the Finder displays the icons defined for it by the TeachText application. The file reference resource with resource ID 212 is assigned to local ID 14 in the bundle resource in <A HREF=#MARKER-9-270>Listing 7-4</A> because the format of the resource requires a local ID for all associated file reference resources.<P>
 You alert the Finder that your application has a bundle resource by setting a bit in the file's Finder flags field. (Most development environments provide a simple tool for setting the bundle bit. <A HREF=Toolbox-455.html#MARKER-9-356>"Using Finder Information in the Catalog File" beginning on page 7-30</A> describes Finder flags.)<P>
 <A HREF=#MARKER-9-274>Figure 7-8</A> illustrates how the bundle resource created in <A HREF=#MARKER-9-270>Listing 7-4</A> uses local IDs to map icon list resources to file reference resources. This figure illustrates two main concepts: first, that one bundle resource ties together all the icon resources and file reference resources for your application and all of its documents; and second, that the icon resources and their associated file reference resources are mapped together by <BR>local IDs.<P>
<B>Figure 7-8  <A NAME=MARKER-9-274></A><A NAME=MARKER-21-275></A>Linking icon list resources and file reference resources in a bundle resource</B><P>
<IMG ALIGN = BOTTOM SRC = "graphics/FI-SL-04.jpg"><P>
 In <A HREF=#MARKER-9-274>Figure 7-8</A>, the application file's icon list resource has resource ID 128 while its file reference resource has resource ID 208. For easier code maintenance, you should probably assign the same resource ID to a file's file reference resource that you assign <BR>to its icon list resource. However, because the Finder renumbers these whenever it <BR>adds them to a Desktop file on floppy disks, you must map them by using local IDs. In <BR><A HREF=#MARKER-9-274>Figure 7-8</A>, the application file's icon list resource is assigned local ID 0. This maps the icon to the file type described by the file reference resource with local ID 0--in this case, the file reference resource with resource ID 208.<A NAME=MARKER-2-276></A><P>
 The general steps you must take to provide icons for applications and documents are enumerated here and assume that you are using a tool, such as ResEdit, that allows you to open and edit several resources simultaneously. (Remember that these resources must have resource IDs of 128 or greater.)<P>
 To provide your application with icon families for itself and for its documents, follow these steps:<P>
<OL>
<LI>Design a graphic element that all of your icon families can share in common and that can help users quickly identify the files associated with your product.
<LI>Create an icon list (<CODE>'ICN#'</CODE>) resource for your application file.
<LI>Create the other members of the icon family of the application file--resources of types <CODE>'ics#'</CODE>, <CODE>'icl8'</CODE>, <CODE>'icl4'</CODE>, <CODE>'ics8'</CODE>, and <CODE>'ics4'</CODE>--and give each of these the same resource ID as the icon list resource.<A NAME=MARKER-2-277></A><A NAME=MARKER-2-278></A><A NAME=MARKER-2-279></A><A NAME=MARKER-2-280></A><A NAME=MARKER-2-281></A>
<LI>Create a bundle (<CODE>'BNDL'</CODE>) resource.
<LI>Within the bundle resource, list the resource ID number of the application file's icon list resource and assign it a local ID of 0.
<LI>Create a file reference resource for the application file.
<LI>Within the file reference resource, assign the application a file type of <CODE>'APPL'</CODE> and assign it a local ID of 0.
<LI>Within the bundle resource, list the resource ID number of the file reference resource for the application file and assign it a unique local ID--for example, 0 to maintain consistency with the local ID assigned in the file reference resource.
<LI>Create another icon family--consisting of resources of types <CODE>'ICN#'</CODE>, <CODE>'ics#'</CODE>, <CODE>'icl8'</CODE>, <CODE>'icl4'</CODE>, <CODE>'ics8'</CODE>, and <CODE>'ics4'</CODE>--to represent one type of document that your application creates.
<LI>Within the application's bundle resource, list the resource ID number of the document's icon list resource and assign it a local ID of 1.
<LI>Create a file reference resource for the document.
<LI>Within the file reference resource for the document, assign it a file type (for example, <CODE>'TEXT'</CODE> or <CODE>'edtt'</CODE>) and assign it a local ID of 1.
<LI>Within the bundle resource, list the resource ID number of the file reference resource for the document and assign it a unique local ID--for example, 1 to maintain consistency with the local ID assigned in the file reference resource.
<LI>Assigning unique local IDs for every type of document your application creates, repeat steps 9 through 13.
<LI>If your application supports file types of other applications, define file reference resources for them, but do not create icon resources for them.
<LI>Create a signature resource (as described in <A HREF=Toolbox-447.html#MARKER-9-108>"Giving a Signature to Your Application and a Creator and a File Type to Your Documents" beginning on page 7-7</A>) with resource ID 0.
<LI>Set the file's <CODE>hasBundle</CODE> bit and clear the <CODE>hasBeenInited</CODE> bit in the file's Finder flags. (Finder flags are described in <A HREF=Toolbox-455.html#MARKER-9-356>"Using Finder Information in the Catalog File" beginning on page 7-30</A>.)
<LI>Save and close all of the resources. (When you restart your Macintosh computer, your application should appear with its own icon. If you later alter any of your icons, clear the <CODE>hasBeenInited</CODE> bit and rebuild your desktop database by pressing Command- Option when restarting.)<A NAME=MARKER-2-282></A><A NAME=MARKER-2-283></A><A NAME=MARKER-2-284></A><A NAME=MARKER-2-285></A><A NAME=MARKER-2-286></A><A NAME=MARKER-2-287></A><A NAME=MARKER-2-288></A><A NAME=MARKER-2-289></A><A NAME=MARKER-2-290></A><A NAME=MARKER-2-291></A><P>
</OL>
</BLOCKQUOTE>
<HR>
<center>
<A HREF="Toolbox-450.html"><IMG ALIGN = BOTTOM SRC = "prev.gif" border=none hspace=20 alt="Previous"></A> <A HREF="Toolbox-2.html"><IMG ALIGN = BOTTOM SRC = "content.gif" border=none hspace=20 alt="Book Contents"></A> <A HREF="Toolbox-490.html"><IMG ALIGN = BOTTOM SRC = "index.gif" border=none hspace=20 alt="Book Index"></A> <A HREF="Toolbox-452.html"><IMG ALIGN = BOTTOM SRC = "next.gif" border=none hspace=20 alt="Next"></A> </CENTER><P>
<center><font size=-1><A HREF="Toolbox-3.html">&copy; Apple Computer, Inc.</A><br>11 JUL 1996</center></font><P>

<!-- start of footer  -->

<!--#include virtual="/includes/framesetfooter" -->

<!-- end of footer -->


</BODY>
</HTML>  
